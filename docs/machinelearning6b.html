<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Advanced Epidemiological Methods - Replicate Results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./machinelearningF.html" rel="next">
<link href="./machinelearning6a.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CVBPG0RQMY"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-CVBPG0RQMY', { 'anonymize_ip': true});
</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta name="twitter:title" content="Advanced Epidemiological Methods - Replicate Results">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="machinelearning6b_files/figure-html/vim-1.png">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar docked slimcontent">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./machinelearning.html">Machine learning (ML)</a></li><li class="breadcrumb-item"><a href="./machinelearning6b.html">Replicate Results</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Epidemiological Methods</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Project</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data wrangling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data types</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1c.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automating tasks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Importing dataset</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data manipulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Import external data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary tables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Markdown</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Functions (W)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quiz (W)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise (W)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./accessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data accessing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Survey data sources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing1i.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Descriptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Importing CCHS to R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Importing NHANES to R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reproducing results</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Importing NHIS to R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Functions (A)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quiz (A)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise (A)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./researchquestion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research questions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predictive question-1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion2a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predictive question-2a</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion2b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predictive question-2b</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Causal question-1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Causal question-2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestionF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R functions (Q)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestionQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quiz (Q)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./confounding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Causal roles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Confounding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mediator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Collider</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Z-bias</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Collapsibility</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Change-in-estimate</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confoundingF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R functions (R)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confoundingQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quiz (R)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./predictivefactors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prediction ideas</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Collinear predictors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous outcome</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Binary outcome</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overfitting and performance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data spliting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cross-validation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bootstrap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactorsF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R functions (P)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactorsQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quiz (P)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./surveydata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Survey data analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CCHS: Revisiting PICOT</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CCHS: Assessing data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CCHS: Bivariate analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CCHS: Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CCHS: Performance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NHANES: Blood Pressure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NHANES: Cholesterol</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NHANES: Subsetting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R functions (D)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quiz (D)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise (D)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./missingdata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Missing data analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Imputation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Imputation in NHANES</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Missing in outcome</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance with NA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Subpopulations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MCAR tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Effect modification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R functions (M)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quiz (M)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise (M)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./propensityscore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Propensity score</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exact Matching (CCHS)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PSM in OA-CVD (CCHS)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PSM in OA-CVD (US)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PSM in BMI-diabetes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PSM with MI</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R functions (S)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quiz (S)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise (S)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./machinelearning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine learning (ML)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous outcome</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data spliting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cross-validation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Binary outcome</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Supervised learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unsupervised learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning6a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NHIS Example</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning6b.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Replicate Results</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R functions (L)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./machinelearningCausal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ML in causal inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motivation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SuperLearner</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Binary Outcomes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous Outcomes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Comparing results</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausalF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R functions (C)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./nonbinary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Complex outcomes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Polytomous and ordinal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Survival analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Poisson</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinaryF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R functions (N)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinaryQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quiz (N)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./longitudinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Longitudinal data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed effects models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GEE</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinalF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R functions (T)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinalQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quiz (T)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./mediation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mediation analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Baron and Kenny</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Justification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mediation Example</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediationF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R functions (I)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediationQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quiz (I)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./reporting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Writing tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reporting1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Collaborative Writing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reporting2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Formatting Tools</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#load-packages" id="toc-load-packages" class="nav-link active" data-scroll-target="#load-packages">Load packages</a></li>
  <li><a href="#analytic-dataset" id="toc-analytic-dataset" class="nav-link" data-scroll-target="#analytic-dataset">Analytic dataset</a></li>
  <li><a href="#lasso-for-surveys" id="toc-lasso-for-surveys" class="nav-link" data-scroll-target="#lasso-for-surveys">LASSO for surveys</a></li>
  <li><a href="#random-forest-for-surveys" id="toc-random-forest-for-surveys" class="nav-link" data-scroll-target="#random-forest-for-surveys">Random forest for surveys</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Replicate Results</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>The tutorial aims to guide the users through fitting machine learning techniques with health survey data. We will replicate some of the results of this article by <a href="https://doi.org/10.1016/j.jpain.2023.03.008">Falasinnu et al.&nbsp;(2023)</a>.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Falasinnu T, Hossain MB, Weber II KA, Helmick CG, Karim ME, Mackey S. The Problem of Pain in the United States: A Population-Based Characterization of Biopsychosocial Correlates of High Impact Chronic Pain Using the National Health Interview Survey. The Journal of Pain. 2023;24(6):1094-103. DOI: <a href="https://doi.org/10.1016/j.jpain.2023.03.008">10.1016/j.jpain.2023.03.008</a></p>
</div></div><p>The authors used the <a href="https://www.cdc.gov/nchs/nhis/nhis_2016_data_release.htm">National Health Interview Survey (NHIS) 2016</a> dataset to develop prediction models for predicting high impact chronic pain (HICP). They also evaluated the predictive performances of the models within sociodemographic subgroups, such as sex (male, female), age (<span class="math inline">\(&lt;65\)</span>, <span class="math inline">\(\ge 65\)</span>), and race/ethnicity (White, Black, Hispanic). They used LASSO and random forest models with 5-fold cross-validation as an internal validation. To obtain population-level predictions, they account for survey weights in both models.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>For those interested in the National Health Interview Survey (NHIS) dataset, can review the <a href="accessing5.html">earlier tutorial</a> about the dataset.</p>
</div></div><div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>To handle <a href="missingdata.html">missing data</a> in the predictors, they used multiple imputation technique. However, for simplicity, this tutorial focuses on a complete case dataset. We will also only focus on predicting HICP for people aged 65 years or older (a dataset of ~8,800 participants compared to the dataset of 33,000 participants aged 18 years or older).</p>
</div>
</div>
<section id="load-packages" class="level3"><h3 class="anchored" data-anchor-id="load-packages">Load packages</h3>
<p>We load several R packages required for fitting LASSO and random forest models.</p>
<div class="cell" data-hash="machinelearning6b_cache/html/setup_d872b18a189a3d2e6d7d6b254846ed4b">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Load required packages</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tableone)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(WeightedROC)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(ranger)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(scoring)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">library</span>(mlr3misc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="analytic-dataset" class="level3"><h3 class="anchored" data-anchor-id="analytic-dataset">Analytic dataset</h3>
<section id="load" class="level4"><h4 class="anchored" data-anchor-id="load">Load</h4>
<p>We load the dataset into the R environment and lists all available variables and objects.</p>
<div class="cell" data-hash="machinelearning6b_cache/html/load_8d0ebd5c34e404500b2caf821e42be04">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">load</span>(<span class="st">"Data/machinelearning/Falasinnu2023.RData"</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">ls</span>()</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; [1] "dat"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="machinelearning6b_cache/html/dim_1edd7abce875a0eacc876bc73b21a1fd">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">dim</span>(dat)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#&gt; [1] 8881   49</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The dataset contains 8,881 participants aged 65 years or older with 49 variables:</p>
<ul>
<li>
<code>studyid</code>: Unique identifier</li>
<li>
<code>psu</code>: Pseudo-PSU</li>
<li>
<code>strata</code>: Pseudo-stratum</li>
<li>
<code>weight</code>: Sampling weight</li>
<li>
<code>HICP</code>: HICP (binary outcome variable)</li>
<li>
<code>age</code>: Age</li>
<li>
<code>sex</code>: Sex</li>
<li>
<code>hhsize</code>: Number of people in household</li>
<li>
<code>born</code>: Citizenship</li>
<li>
<code>marital</code>: Marital status</li>
<li>
<code>region</code>: Region</li>
<li>
<code>race</code>: Race/ethnicity</li>
<li>
<code>education</code>: Education</li>
<li>
<code>employment.status</code>: Employment status</li>
<li>
<code>poverty.status</code>: Poverty status</li>
<li>
<code>veteran</code>: Veteran</li>
<li>
<code>insurance</code>: Health insurance coverage</li>
<li>
<code>sex.orientation</code>: Sexual orientation</li>
<li>
<code>worried.money</code>: Worried about money</li>
<li>
<code>good.neighborhood</code>: Good neighborhood</li>
<li>
<code>psy.symptom</code>: Psychological symptoms</li>
<li>
<code>visit.ED</code>: Number of times in ER/ED</li>
<li>
<code>surgery</code>: Number of surgeries in past 12 months</li>
<li>
<code>dr.visit</code>: Time since doctor visits</li>
<li>
<code>cancer</code>: Cancer</li>
<li>
<code>asthma</code>: Asthma</li>
<li>
<code>htn</code>: Hypertension</li>
<li>
<code>liver.disease</code>: Liver disease</li>
<li>
<code>diabetes</code>: Diabetes</li>
<li>
<code>ulcer</code>: Ulcer</li>
<li>
<code>stroke</code>: Stroke</li>
<li>
<code>emphysema</code>: Emphysema</li>
<li>
<code>copd</code>: COPD</li>
<li>
<code>high.cholesterol</code>: High cholesterol</li>
<li>
<code>coronary.heart.disease</code>: Coronary heart disease</li>
<li>
<code>angina</code>: Angina pectoris</li>
<li>
<code>heart.attack</code>: Heart attack</li>
<li>
<code>heart.disease</code>: Heart condition/disease</li>
<li>
<code>arthritis</code>: Arthritis and rheumatism</li>
<li>
<code>crohns.disease</code>: Crohn’s disease</li>
<li>
<code>place.routine.care</code>: Usual place for routine care</li>
<li>
<code>trouble.asleep</code>: Trouble falling asleep</li>
<li>
<code>obese</code>: Obesity</li>
<li>
<code>current.smoker</code>: Current smoker</li>
<li>
<code>heavy.drinker</code>: Heavy drinker</li>
<li>
<code>hospitalization</code>: Hospital stay days</li>
<li>
<code>better.health.status</code>: Better health status</li>
<li>
<code>physical.activity</code>: Physical activity</li>
</ul>
<p>See the NHIS 2016 dataset and the article for better understanding of the variables.</p>
</section><section id="complete-case-data" class="level4"><h4 class="anchored" data-anchor-id="complete-case-data">Complete case data</h4>
<div class="cell" data-hash="machinelearning6b_cache/html/desc_4101b44ac966feaa4b92db9020cfaa2e">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Age</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">table</span>(dat<span class="sc">$</span>age, <span class="at">useNA =</span> <span class="st">"always"</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; </span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt;  &lt;65  65+ &lt;NA&gt; </span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt;    0 8881    0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us consider a complete case dataset</p>
<div class="cell" data-hash="machinelearning6b_cache/html/completecase_2f49d4b0523f1515f2cf42c2c643d0d1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>dat.complete <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(dat)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">dim</span>(dat.complete)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt; [1] 7280   49</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As we can see, there are 7,280 participants with complete case information. Let’s see the descriptive statistics of the predictors stratified by HICP.</p>
</section><section id="descriptive-statistics" class="level4"><h4 class="anchored" data-anchor-id="descriptive-statistics">Descriptive statistics</h4>
<div class="cell" data-hash="machinelearning6b_cache/html/tab1_dfcf3c54347f9d857b106aa54e38268c">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Predictors</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>predictors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sex"</span>, <span class="st">"hhsize"</span>, <span class="st">"born"</span>, <span class="st">"marital"</span>, </span>
<span id="cb6-3"><a href="#cb6-3"></a>                <span class="st">"region"</span>, <span class="st">"race"</span>, <span class="st">"education"</span>, </span>
<span id="cb6-4"><a href="#cb6-4"></a>                <span class="st">"employment.status"</span>, <span class="st">"poverty.status"</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>                <span class="st">"veteran"</span>, <span class="st">"insurance"</span>, </span>
<span id="cb6-6"><a href="#cb6-6"></a>                <span class="st">"sex.orientation"</span>, <span class="st">"worried.money"</span>, </span>
<span id="cb6-7"><a href="#cb6-7"></a>                <span class="st">"good.neighborhood"</span>, </span>
<span id="cb6-8"><a href="#cb6-8"></a>                <span class="st">"psy.symptom"</span>, <span class="st">"visit.ED"</span>, <span class="st">"surgery"</span>, </span>
<span id="cb6-9"><a href="#cb6-9"></a>                <span class="st">"dr.visit"</span>, <span class="st">"cancer"</span>, </span>
<span id="cb6-10"><a href="#cb6-10"></a>                <span class="st">"asthma"</span>, <span class="st">"htn"</span>, <span class="st">"liver.disease"</span>, </span>
<span id="cb6-11"><a href="#cb6-11"></a>                <span class="st">"diabetes"</span>, <span class="st">"ulcer"</span>, <span class="st">"stroke"</span>,</span>
<span id="cb6-12"><a href="#cb6-12"></a>                <span class="st">"emphysema"</span>, <span class="st">"copd"</span>, <span class="st">"high.cholesterol"</span>,</span>
<span id="cb6-13"><a href="#cb6-13"></a>                <span class="st">"coronary.heart.disease"</span>, </span>
<span id="cb6-14"><a href="#cb6-14"></a>                <span class="st">"angina"</span>, <span class="st">"heart.attack"</span>, </span>
<span id="cb6-15"><a href="#cb6-15"></a>                <span class="st">"heart.disease"</span>, <span class="st">"arthritis"</span>, </span>
<span id="cb6-16"><a href="#cb6-16"></a>                <span class="st">"crohns.disease"</span>, <span class="st">"place.routine.care"</span>, </span>
<span id="cb6-17"><a href="#cb6-17"></a>                <span class="st">"trouble.asleep"</span>, <span class="st">"obese"</span>, </span>
<span id="cb6-18"><a href="#cb6-18"></a>                <span class="st">"current.smoker"</span>, <span class="st">"heavy.drinker"</span>,</span>
<span id="cb6-19"><a href="#cb6-19"></a>                <span class="st">"hospitalization"</span>, </span>
<span id="cb6-20"><a href="#cb6-20"></a>                <span class="st">"better.health.status"</span>, </span>
<span id="cb6-21"><a href="#cb6-21"></a>                <span class="st">"physical.activity"</span>)</span>
<span id="cb6-22"><a href="#cb6-22"></a></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co"># Table 1 - Unweighted </span></span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="fu">tbl_summary</span>(<span class="at">data =</span> dat.complete, </span>
<span id="cb6-25"><a href="#cb6-25"></a>            <span class="at">include =</span> predictors, </span>
<span id="cb6-26"><a href="#cb6-26"></a>            <span class="at">by =</span> HICP, <span class="at">missing =</span> <span class="st">"no"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-27"><a href="#cb6-27"></a>  <span class="fu">modify_spanning_header</span>(<span class="fu">c</span>(<span class="st">"stat_1"</span>, </span>
<span id="cb6-28"><a href="#cb6-28"></a>                           <span class="st">"stat_2"</span>) <span class="sc">~</span> <span class="st">"**HICP**"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="pfmcbupvxi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pfmcbupvxi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pfmcbupvxi thead, #pfmcbupvxi tbody, #pfmcbupvxi tfoot, #pfmcbupvxi tr, #pfmcbupvxi td, #pfmcbupvxi th {
  border-style: none;
}

#pfmcbupvxi p {
  margin: 0;
  padding: 0;
}

#pfmcbupvxi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pfmcbupvxi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pfmcbupvxi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pfmcbupvxi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pfmcbupvxi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pfmcbupvxi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pfmcbupvxi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pfmcbupvxi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pfmcbupvxi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pfmcbupvxi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pfmcbupvxi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pfmcbupvxi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pfmcbupvxi .gt_spanner_row {
  border-bottom-style: hidden;
}

#pfmcbupvxi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pfmcbupvxi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pfmcbupvxi .gt_from_md > :first-child {
  margin-top: 0;
}

#pfmcbupvxi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pfmcbupvxi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pfmcbupvxi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pfmcbupvxi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pfmcbupvxi .gt_row_group_first td {
  border-top-width: 2px;
}

#pfmcbupvxi .gt_row_group_first th {
  border-top-width: 2px;
}

#pfmcbupvxi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pfmcbupvxi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pfmcbupvxi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pfmcbupvxi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pfmcbupvxi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pfmcbupvxi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pfmcbupvxi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pfmcbupvxi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pfmcbupvxi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pfmcbupvxi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pfmcbupvxi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pfmcbupvxi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pfmcbupvxi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pfmcbupvxi .gt_left {
  text-align: left;
}

#pfmcbupvxi .gt_center {
  text-align: center;
}

#pfmcbupvxi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pfmcbupvxi .gt_font_normal {
  font-weight: normal;
}

#pfmcbupvxi .gt_font_bold {
  font-weight: bold;
}

#pfmcbupvxi .gt_font_italic {
  font-style: italic;
}

#pfmcbupvxi .gt_super {
  font-size: 65%;
}

#pfmcbupvxi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pfmcbupvxi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pfmcbupvxi .gt_indent_1 {
  text-indent: 5px;
}

#pfmcbupvxi .gt_indent_2 {
  text-indent: 10px;
}

#pfmcbupvxi .gt_indent_3 {
  text-indent: 15px;
}

#pfmcbupvxi .gt_indent_4 {
  text-indent: 20px;
}

#pfmcbupvxi .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="<strong>HICP</strong>">
        <span class="gt_column_spanner"><strong>HICP</strong></span>
      </th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>0</strong>, N = 6,389<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>">
<strong>0</strong>, N = 6,389<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>1</strong>, N = 891<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>">
<strong>1</strong>, N = 891<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="label" class="gt_row gt_left">sex</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Female</td>
<td headers="stat_1" class="gt_row gt_center">3,587 (56%)</td>
<td headers="stat_2" class="gt_row gt_center">569 (64%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Male</td>
<td headers="stat_1" class="gt_row gt_center">2,802 (44%)</td>
<td headers="stat_2" class="gt_row gt_center">322 (36%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">hhsize</td>
<td headers="stat_1" class="gt_row gt_center">2 (1, 2)</td>
<td headers="stat_2" class="gt_row gt_center">2 (1, 2)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">born</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Born in US</td>
<td headers="stat_1" class="gt_row gt_center">5,775 (90%)</td>
<td headers="stat_2" class="gt_row gt_center">802 (90%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Other place</td>
<td headers="stat_1" class="gt_row gt_center">614 (9.6%)</td>
<td headers="stat_2" class="gt_row gt_center">89 (10.0%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">marital</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Never married</td>
<td headers="stat_1" class="gt_row gt_center">411 (6.4%)</td>
<td headers="stat_2" class="gt_row gt_center">57 (6.4%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Married/with partner</td>
<td headers="stat_1" class="gt_row gt_center">2,990 (47%)</td>
<td headers="stat_2" class="gt_row gt_center">349 (39%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Divorced/separated</td>
<td headers="stat_1" class="gt_row gt_center">1,161 (18%)</td>
<td headers="stat_2" class="gt_row gt_center">179 (20%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Widowed</td>
<td headers="stat_1" class="gt_row gt_center">1,827 (29%)</td>
<td headers="stat_2" class="gt_row gt_center">306 (34%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">region</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Northeast</td>
<td headers="stat_1" class="gt_row gt_center">1,172 (18%)</td>
<td headers="stat_2" class="gt_row gt_center">143 (16%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Midwest</td>
<td headers="stat_1" class="gt_row gt_center">1,451 (23%)</td>
<td headers="stat_2" class="gt_row gt_center">189 (21%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;South</td>
<td headers="stat_1" class="gt_row gt_center">2,203 (34%)</td>
<td headers="stat_2" class="gt_row gt_center">331 (37%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;West</td>
<td headers="stat_1" class="gt_row gt_center">1,563 (24%)</td>
<td headers="stat_2" class="gt_row gt_center">228 (26%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">race</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;White</td>
<td headers="stat_1" class="gt_row gt_center">5,090 (80%)</td>
<td headers="stat_2" class="gt_row gt_center">694 (78%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Black</td>
<td headers="stat_1" class="gt_row gt_center">564 (8.8%)</td>
<td headers="stat_2" class="gt_row gt_center">88 (9.9%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Hispanic</td>
<td headers="stat_1" class="gt_row gt_center">406 (6.4%)</td>
<td headers="stat_2" class="gt_row gt_center">70 (7.9%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Others</td>
<td headers="stat_1" class="gt_row gt_center">329 (5.1%)</td>
<td headers="stat_2" class="gt_row gt_center">39 (4.4%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">education</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Less than high school</td>
<td headers="stat_1" class="gt_row gt_center">954 (15%)</td>
<td headers="stat_2" class="gt_row gt_center">220 (25%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;High school/GED</td>
<td headers="stat_1" class="gt_row gt_center">1,863 (29%)</td>
<td headers="stat_2" class="gt_row gt_center">269 (30%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Some college</td>
<td headers="stat_1" class="gt_row gt_center">1,716 (27%)</td>
<td headers="stat_2" class="gt_row gt_center">248 (28%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Bachelors degree or higher</td>
<td headers="stat_1" class="gt_row gt_center">1,856 (29%)</td>
<td headers="stat_2" class="gt_row gt_center">154 (17%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">employment.status</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Employed hourly</td>
<td headers="stat_1" class="gt_row gt_center">578 (9.0%)</td>
<td headers="stat_2" class="gt_row gt_center">22 (2.5%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Employed non-hourly</td>
<td headers="stat_1" class="gt_row gt_center">608 (9.5%)</td>
<td headers="stat_2" class="gt_row gt_center">27 (3.0%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Worked previously</td>
<td headers="stat_1" class="gt_row gt_center">4,923 (77%)</td>
<td headers="stat_2" class="gt_row gt_center">777 (87%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Never worked</td>
<td headers="stat_1" class="gt_row gt_center">280 (4.4%)</td>
<td headers="stat_2" class="gt_row gt_center">65 (7.3%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">poverty.status</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;&lt;100% FPL</td>
<td headers="stat_1" class="gt_row gt_center">496 (7.8%)</td>
<td headers="stat_2" class="gt_row gt_center">154 (17%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;100-200% FPL</td>
<td headers="stat_1" class="gt_row gt_center">1,401 (22%)</td>
<td headers="stat_2" class="gt_row gt_center">276 (31%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;200-400% FPL</td>
<td headers="stat_1" class="gt_row gt_center">2,157 (34%)</td>
<td headers="stat_2" class="gt_row gt_center">283 (32%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;400%+ FPL</td>
<td headers="stat_1" class="gt_row gt_center">2,335 (37%)</td>
<td headers="stat_2" class="gt_row gt_center">178 (20%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">veteran</td>
<td headers="stat_1" class="gt_row gt_center">1,482 (23%)</td>
<td headers="stat_2" class="gt_row gt_center">163 (18%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">insurance</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Uninsured</td>
<td headers="stat_1" class="gt_row gt_center">32 (0.5%)</td>
<td headers="stat_2" class="gt_row gt_center">6 (0.7%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Medicaid/Medicare</td>
<td headers="stat_1" class="gt_row gt_center">2,995 (47%)</td>
<td headers="stat_2" class="gt_row gt_center">478 (54%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Privately Insured</td>
<td headers="stat_1" class="gt_row gt_center">2,847 (45%)</td>
<td headers="stat_2" class="gt_row gt_center">311 (35%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Other</td>
<td headers="stat_1" class="gt_row gt_center">515 (8.1%)</td>
<td headers="stat_2" class="gt_row gt_center">96 (11%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">sex.orientation</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Heterosexual</td>
<td headers="stat_1" class="gt_row gt_center">6,224 (97%)</td>
<td headers="stat_2" class="gt_row gt_center">861 (97%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Other</td>
<td headers="stat_1" class="gt_row gt_center">165 (2.6%)</td>
<td headers="stat_2" class="gt_row gt_center">30 (3.4%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">worried.money</td>
<td headers="stat_1" class="gt_row gt_center">2,351 (37%)</td>
<td headers="stat_2" class="gt_row gt_center">491 (55%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">good.neighborhood</td>
<td headers="stat_1" class="gt_row gt_center">5,988 (94%)</td>
<td headers="stat_2" class="gt_row gt_center">781 (88%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">psy.symptom</td>
<td headers="stat_1" class="gt_row gt_center">694 (11%)</td>
<td headers="stat_2" class="gt_row gt_center">353 (40%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">visit.ED</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;None</td>
<td headers="stat_1" class="gt_row gt_center">5,050 (79%)</td>
<td headers="stat_2" class="gt_row gt_center">531 (60%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;One</td>
<td headers="stat_1" class="gt_row gt_center">949 (15%)</td>
<td headers="stat_2" class="gt_row gt_center">187 (21%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;2-3</td>
<td headers="stat_1" class="gt_row gt_center">313 (4.9%)</td>
<td headers="stat_2" class="gt_row gt_center">123 (14%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;4+</td>
<td headers="stat_1" class="gt_row gt_center">77 (1.2%)</td>
<td headers="stat_2" class="gt_row gt_center">50 (5.6%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">surgery</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;None</td>
<td headers="stat_1" class="gt_row gt_center">5,218 (82%)</td>
<td headers="stat_2" class="gt_row gt_center">650 (73%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;One</td>
<td headers="stat_1" class="gt_row gt_center">898 (14%)</td>
<td headers="stat_2" class="gt_row gt_center">176 (20%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Two</td>
<td headers="stat_1" class="gt_row gt_center">206 (3.2%)</td>
<td headers="stat_2" class="gt_row gt_center">44 (4.9%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;3+</td>
<td headers="stat_1" class="gt_row gt_center">67 (1.0%)</td>
<td headers="stat_2" class="gt_row gt_center">21 (2.4%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">dr.visit</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;&lt;6 months</td>
<td headers="stat_1" class="gt_row gt_center">5,390 (84%)</td>
<td headers="stat_2" class="gt_row gt_center">837 (94%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;6-12 months</td>
<td headers="stat_1" class="gt_row gt_center">591 (9.3%)</td>
<td headers="stat_2" class="gt_row gt_center">41 (4.6%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;1-5 years</td>
<td headers="stat_1" class="gt_row gt_center">281 (4.4%)</td>
<td headers="stat_2" class="gt_row gt_center">10 (1.1%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;&gt;5 years/never</td>
<td headers="stat_1" class="gt_row gt_center">127 (2.0%)</td>
<td headers="stat_2" class="gt_row gt_center">3 (0.3%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">cancer</td>
<td headers="stat_1" class="gt_row gt_center">1,566 (25%)</td>
<td headers="stat_2" class="gt_row gt_center">271 (30%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">asthma</td>
<td headers="stat_1" class="gt_row gt_center">645 (10%)</td>
<td headers="stat_2" class="gt_row gt_center">176 (20%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">htn</td>
<td headers="stat_1" class="gt_row gt_center">3,953 (62%)</td>
<td headers="stat_2" class="gt_row gt_center">689 (77%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">liver.disease</td>
<td headers="stat_1" class="gt_row gt_center">122 (1.9%)</td>
<td headers="stat_2" class="gt_row gt_center">50 (5.6%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">diabetes</td>
<td headers="stat_1" class="gt_row gt_center">1,179 (18%)</td>
<td headers="stat_2" class="gt_row gt_center">278 (31%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">ulcer</td>
<td headers="stat_1" class="gt_row gt_center">545 (8.5%)</td>
<td headers="stat_2" class="gt_row gt_center">161 (18%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">stroke</td>
<td headers="stat_1" class="gt_row gt_center">485 (7.6%)</td>
<td headers="stat_2" class="gt_row gt_center">130 (15%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">emphysema</td>
<td headers="stat_1" class="gt_row gt_center">235 (3.7%)</td>
<td headers="stat_2" class="gt_row gt_center">76 (8.5%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">copd</td>
<td headers="stat_1" class="gt_row gt_center">496 (7.8%)</td>
<td headers="stat_2" class="gt_row gt_center">145 (16%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">high.cholesterol</td>
<td headers="stat_1" class="gt_row gt_center">3,373 (53%)</td>
<td headers="stat_2" class="gt_row gt_center">577 (65%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">coronary.heart.disease</td>
<td headers="stat_1" class="gt_row gt_center">814 (13%)</td>
<td headers="stat_2" class="gt_row gt_center">211 (24%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">angina</td>
<td headers="stat_1" class="gt_row gt_center">298 (4.7%)</td>
<td headers="stat_2" class="gt_row gt_center">100 (11%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">heart.attack</td>
<td headers="stat_1" class="gt_row gt_center">552 (8.6%)</td>
<td headers="stat_2" class="gt_row gt_center">154 (17%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">heart.disease</td>
<td headers="stat_1" class="gt_row gt_center">1,083 (17%)</td>
<td headers="stat_2" class="gt_row gt_center">210 (24%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">arthritis</td>
<td headers="stat_1" class="gt_row gt_center">3,017 (47%)</td>
<td headers="stat_2" class="gt_row gt_center">700 (79%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">crohns.disease</td>
<td headers="stat_1" class="gt_row gt_center">102 (1.6%)</td>
<td headers="stat_2" class="gt_row gt_center">29 (3.3%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">place.routine.care</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;No place</td>
<td headers="stat_1" class="gt_row gt_center">235 (3.7%)</td>
<td headers="stat_2" class="gt_row gt_center">26 (2.9%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Doctor's office</td>
<td headers="stat_1" class="gt_row gt_center">4,634 (73%)</td>
<td headers="stat_2" class="gt_row gt_center">621 (70%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Hospital/Clinic</td>
<td headers="stat_1" class="gt_row gt_center">1,403 (22%)</td>
<td headers="stat_2" class="gt_row gt_center">221 (25%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Other place</td>
<td headers="stat_1" class="gt_row gt_center">117 (1.8%)</td>
<td headers="stat_2" class="gt_row gt_center">23 (2.6%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">trouble.asleep</td>
<td headers="stat_1" class="gt_row gt_center">1,970 (31%)</td>
<td headers="stat_2" class="gt_row gt_center">424 (48%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">obese</td>
<td headers="stat_1" class="gt_row gt_center">1,757 (28%)</td>
<td headers="stat_2" class="gt_row gt_center">397 (45%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">current.smoker</td>
<td headers="stat_1" class="gt_row gt_center">565 (8.8%)</td>
<td headers="stat_2" class="gt_row gt_center">111 (12%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">heavy.drinker</td>
<td headers="stat_1" class="gt_row gt_center">308 (4.8%)</td>
<td headers="stat_2" class="gt_row gt_center">25 (2.8%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">hospitalization</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;None</td>
<td headers="stat_1" class="gt_row gt_center">5,009 (78%)</td>
<td headers="stat_2" class="gt_row gt_center">503 (56%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;1-2 days</td>
<td headers="stat_1" class="gt_row gt_center">592 (9.3%)</td>
<td headers="stat_2" class="gt_row gt_center">57 (6.4%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;3-5 days</td>
<td headers="stat_1" class="gt_row gt_center">360 (5.6%)</td>
<td headers="stat_2" class="gt_row gt_center">63 (7.1%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;6+ days</td>
<td headers="stat_1" class="gt_row gt_center">428 (6.7%)</td>
<td headers="stat_2" class="gt_row gt_center">268 (30%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">better.health.status</td>
<td headers="stat_1" class="gt_row gt_center">890 (14%)</td>
<td headers="stat_2" class="gt_row gt_center">119 (13%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">physical.activity</td>
<td headers="stat_1" class="gt_row gt_center"><br></td>
<td headers="stat_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Less</td>
<td headers="stat_1" class="gt_row gt_center">3,734 (58%)</td>
<td headers="stat_2" class="gt_row gt_center">743 (83%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;Moderate</td>
<td headers="stat_1" class="gt_row gt_center">1,794 (28%)</td>
<td headers="stat_2" class="gt_row gt_center">108 (12%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;High</td>
<td headers="stat_1" class="gt_row gt_center">861 (13%)</td>
<td headers="stat_2" class="gt_row gt_center">40 (4.5%)</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr>
<td class="gt_footnote" colspan="3">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%); Median (IQR)</td>
    </tr></tfoot>
</table>
</div>
</div>
</div>
</section></section><section id="lasso-for-surveys" class="level3"><h3 class="anchored" data-anchor-id="lasso-for-surveys">LASSO for surveys</h3>
<p>Now, we will fit the LASSO model for predicting binary HICP with the listed predictors. Similar to the <a href="machinelearning6a.html">previous chapter</a>, we will normalize the weight.</p>
<section id="weight-normalization" class="level4"><h4 class="anchored" data-anchor-id="weight-normalization">Weight normalization</h4>
<div class="cell" data-hash="machinelearning6b_cache/html/weight_f1656ee24c5141bcb3927bceb1bdfca5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Normalize weight</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>dat.complete<span class="sc">$</span>wgt <span class="ot">&lt;-</span> dat.complete<span class="sc">$</span>weight <span class="sc">*</span> </span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">nrow</span>(dat.complete)<span class="sc">/</span><span class="fu">sum</span>(dat.complete<span class="sc">$</span>weight)</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co"># Weight summary</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="fu">summary</span>(dat.complete<span class="sc">$</span>weight)</span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">#&gt;     243    1503    2583    2886    3747   14662</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="fu">summary</span>(dat.complete<span class="sc">$</span>wgt)</span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">#&gt;  0.0842  0.5208  0.8950  1.0000  1.2983  5.0804</span></span>
<span id="cb7-12"><a href="#cb7-12"></a></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co"># The weighted and unweighted n are equal</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="fu">nrow</span>(dat.complete)</span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#&gt; [1] 7280</span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="fu">sum</span>(dat.complete<span class="sc">$</span>wgt)</span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="co">#&gt; [1] 7280</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="folds" class="level4"><h4 class="anchored" data-anchor-id="folds">Folds</h4>
<p>Let’s create five random folds and specify the regression formula.</p>
<div class="cell" data-hash="machinelearning6b_cache/html/folds_ed83f13804127b028219baa17830c4eb">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="fu">set.seed</span>(<span class="dv">604</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>nfolds <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>k, </span>
<span id="cb8-4"><a href="#cb8-4"></a>                 <span class="at">size =</span> <span class="fu">nrow</span>(dat.complete), </span>
<span id="cb8-5"><a href="#cb8-5"></a>                 <span class="at">replace =</span> T)</span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="fu">table</span>(nfolds)</span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt; nfolds</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt; 1451 1457 1496 1468 1408</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="formula" class="level4"><h4 class="anchored" data-anchor-id="formula">Formula</h4>
<div class="cell" data-hash="machinelearning6b_cache/html/formula_9c8abd8f9a0d5209014830d0edd2705d">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>Formula <span class="ot">&lt;-</span> <span class="fu">formula</span>(<span class="fu">paste</span>(<span class="st">"HICP ~ "</span>, <span class="fu">paste</span>(predictors, </span>
<span id="cb9-2"><a href="#cb9-2"></a>                                          <span class="at">collapse=</span><span class="st">" + "</span>)))</span>
<span id="cb9-3"><a href="#cb9-3"></a>Formula</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; HICP ~ sex + hhsize + born + marital + region + race + education + </span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt;     employment.status + poverty.status + veteran + insurance + </span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt;     sex.orientation + worried.money + good.neighborhood + psy.symptom + </span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt;     visit.ED + surgery + dr.visit + cancer + asthma + htn + liver.disease + </span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt;     diabetes + ulcer + stroke + emphysema + copd + high.cholesterol + </span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt;     coronary.heart.disease + angina + heart.attack + heart.disease + </span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt;     arthritis + crohns.disease + place.routine.care + trouble.asleep + </span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt;     obese + current.smoker + heavy.drinker + hospitalization + </span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt;     better.health.status + physical.activity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="fold-cv-lasso" class="level4"><h4 class="anchored" data-anchor-id="fold-cv-lasso">5-fold CV LASSO</h4>
<p>Now, we will fit the LASSO model with 5-fold cross-validation (CV). Here are the steps:</p>
<ul>
<li>For fold 1, folds 2-5 is the training set and fold 1 is the test set</li>
<li>Fit 5-fold cross-validation on the training set to find the value of lambda that gives minimum prediction error. Incorporate sampling weights in the model to account for survey design.</li>
<li>Fit LASSO on the training with the optimum lambda from the previous step. Incorporate sampling weights in the model to account for survey design.</li>
<li>Calculate predictive performance (e.g., AUC) on the test set</li>
<li>Repeat the analysis for all folds.</li>
</ul>
<div class="cell" data-hash="machinelearning6b_cache/html/lassofit_cc731af6091a0453bfbecfe9db30a109">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>fit.lasso <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>auc.lasso <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>cal.slope.lasso <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>brier.lasso <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="cf">for</span> (fold <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="co"># Training data</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>  dat.train <span class="ot">&lt;-</span> dat.complete[nfolds <span class="sc">!=</span> fold, ]</span>
<span id="cb10-8"><a href="#cb10-8"></a>  X.train <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Formula, dat.train)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb10-9"><a href="#cb10-9"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dat.train<span class="sc">$</span>HICP)</span>
<span id="cb10-10"><a href="#cb10-10"></a>  </span>
<span id="cb10-11"><a href="#cb10-11"></a>  <span class="co"># Test data</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>  dat.test <span class="ot">&lt;-</span> dat.complete[nfolds <span class="sc">==</span> fold, ]</span>
<span id="cb10-13"><a href="#cb10-13"></a>  X.test <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Formula, dat.test)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb10-14"><a href="#cb10-14"></a>  y.test <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dat.test<span class="sc">$</span>HICP)</span>
<span id="cb10-15"><a href="#cb10-15"></a>  </span>
<span id="cb10-16"><a href="#cb10-16"></a>  <span class="co"># Find the optimum lambda using 5-fold CV</span></span>
<span id="cb10-17"><a href="#cb10-17"></a>  fit.cv.lasso <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(<span class="at">x =</span> X.train, </span>
<span id="cb10-18"><a href="#cb10-18"></a>                            <span class="at">y =</span> y.train, </span>
<span id="cb10-19"><a href="#cb10-19"></a>                            <span class="at">nfolds =</span> <span class="dv">5</span>, </span>
<span id="cb10-20"><a href="#cb10-20"></a>                            <span class="at">alpha =</span> <span class="dv">1</span>, </span>
<span id="cb10-21"><a href="#cb10-21"></a>                            <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb10-22"><a href="#cb10-22"></a>                            <span class="at">weights =</span> dat.train<span class="sc">$</span>wgt)</span>
<span id="cb10-23"><a href="#cb10-23"></a>  </span>
<span id="cb10-24"><a href="#cb10-24"></a>  <span class="co"># Fit the model on the training set with optimum lambda</span></span>
<span id="cb10-25"><a href="#cb10-25"></a>  fit.lasso[[fold]] <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(</span>
<span id="cb10-26"><a href="#cb10-26"></a>    <span class="at">x =</span> X.train, </span>
<span id="cb10-27"><a href="#cb10-27"></a>    <span class="at">y =</span> y.train, </span>
<span id="cb10-28"><a href="#cb10-28"></a>    <span class="at">alpha =</span> <span class="dv">1</span>, </span>
<span id="cb10-29"><a href="#cb10-29"></a>    <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb10-30"><a href="#cb10-30"></a>    <span class="at">lambda =</span> fit.cv.lasso<span class="sc">$</span>lambda.min,</span>
<span id="cb10-31"><a href="#cb10-31"></a>    <span class="at">weights =</span> dat.train<span class="sc">$</span>wgt)</span>
<span id="cb10-32"><a href="#cb10-32"></a>  </span>
<span id="cb10-33"><a href="#cb10-33"></a>  <span class="co"># Prediction on the test set</span></span>
<span id="cb10-34"><a href="#cb10-34"></a>  dat.test<span class="sc">$</span>pred.lasso <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit.lasso[[fold]], </span>
<span id="cb10-35"><a href="#cb10-35"></a>                                 <span class="at">newx =</span> X.test, </span>
<span id="cb10-36"><a href="#cb10-36"></a>                                 <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb10-37"><a href="#cb10-37"></a>  </span>
<span id="cb10-38"><a href="#cb10-38"></a>  <span class="co"># AUC on the test set with sampling weights</span></span>
<span id="cb10-39"><a href="#cb10-39"></a>  auc.lasso[fold] <span class="ot">&lt;-</span> <span class="fu">WeightedAUC</span>(</span>
<span id="cb10-40"><a href="#cb10-40"></a>    <span class="fu">WeightedROC</span>(dat.test<span class="sc">$</span>pred.lasso,</span>
<span id="cb10-41"><a href="#cb10-41"></a>                dat.test<span class="sc">$</span>HICP, </span>
<span id="cb10-42"><a href="#cb10-42"></a>                <span class="at">weight =</span> dat.test<span class="sc">$</span>wgt))</span>
<span id="cb10-43"><a href="#cb10-43"></a>  </span>
<span id="cb10-44"><a href="#cb10-44"></a>  <span class="co"># Weighted calibration slope</span></span>
<span id="cb10-45"><a href="#cb10-45"></a>  mod.cal <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb10-46"><a href="#cb10-46"></a>    HICP <span class="sc">~</span> <span class="fu">Logit</span>(dat.test<span class="sc">$</span>pred.lasso), </span>
<span id="cb10-47"><a href="#cb10-47"></a>    <span class="at">data =</span> dat.test, </span>
<span id="cb10-48"><a href="#cb10-48"></a>    <span class="at">family =</span> binomial, </span>
<span id="cb10-49"><a href="#cb10-49"></a>    <span class="at">weights =</span> wgt)</span>
<span id="cb10-50"><a href="#cb10-50"></a>  cal.slope.lasso[fold] <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod.cal)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb10-51"><a href="#cb10-51"></a>  </span>
<span id="cb10-52"><a href="#cb10-52"></a>  <span class="co"># Weighted Brier Score</span></span>
<span id="cb10-53"><a href="#cb10-53"></a>  brier.lasso[fold] <span class="ot">&lt;-</span> <span class="fu">mean</span>(</span>
<span id="cb10-54"><a href="#cb10-54"></a>    <span class="fu">brierscore</span>(HICP <span class="sc">~</span> dat.test<span class="sc">$</span>pred.lasso,</span>
<span id="cb10-55"><a href="#cb10-55"></a>               <span class="at">data =</span> dat.test, </span>
<span id="cb10-56"><a href="#cb10-56"></a>               <span class="at">wt =</span> dat.test<span class="sc">$</span>wgt))</span>
<span id="cb10-57"><a href="#cb10-57"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="model-performance" class="level4"><h4 class="anchored" data-anchor-id="model-performance">Model performance</h4>
<p>Let’s check how prediction worked.</p>
<div class="cell" data-hash="machinelearning6b_cache/html/lassofit2_2d051e98e2197a7cb83b7b680962d26a">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Fitted LASSO models</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>fit.lasso[[<span class="dv">1</span>]]</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt; </span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt; Call:  glmnet(x = X.train, y = y.train, family = "binomial", weights = dat.train$wgt,      alpha = 1, lambda = fit.cv.lasso$lambda.min) </span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&gt; </span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt;   Df  %Dev   Lambda</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt; 1 46 23.91 0.002972</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>fit.lasso[[<span class="dv">2</span>]]</span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt; </span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt; Call:  glmnet(x = X.train, y = y.train, family = "binomial", weights = dat.train$wgt,      alpha = 1, lambda = fit.cv.lasso$lambda.min) </span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt; </span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#&gt;   Df  %Dev   Lambda</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">#&gt; 1 47 25.32 0.002559</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>fit.lasso[[<span class="dv">3</span>]]</span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">#&gt; </span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">#&gt; Call:  glmnet(x = X.train, y = y.train, family = "binomial", weights = dat.train$wgt,      alpha = 1, lambda = fit.cv.lasso$lambda.min) </span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">#&gt; </span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">#&gt;   Df %Dev   Lambda</span></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co">#&gt; 1 47 24.3 0.002724</span></span>
<span id="cb11-20"><a href="#cb11-20"></a>fit.lasso[[<span class="dv">4</span>]]</span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="co">#&gt; </span></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="co">#&gt; Call:  glmnet(x = X.train, y = y.train, family = "binomial", weights = dat.train$wgt,      alpha = 1, lambda = fit.cv.lasso$lambda.min) </span></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="co">#&gt; </span></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="co">#&gt;   Df  %Dev   Lambda</span></span>
<span id="cb11-25"><a href="#cb11-25"></a><span class="co">#&gt; 1 34 25.27 0.004726</span></span>
<span id="cb11-26"><a href="#cb11-26"></a>fit.lasso[[<span class="dv">5</span>]]</span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="co">#&gt; </span></span>
<span id="cb11-28"><a href="#cb11-28"></a><span class="co">#&gt; Call:  glmnet(x = X.train, y = y.train, family = "binomial", weights = dat.train$wgt,      alpha = 1, lambda = fit.cv.lasso$lambda.min) </span></span>
<span id="cb11-29"><a href="#cb11-29"></a><span class="co">#&gt; </span></span>
<span id="cb11-30"><a href="#cb11-30"></a><span class="co">#&gt;   Df  %Dev   Lambda</span></span>
<span id="cb11-31"><a href="#cb11-31"></a><span class="co">#&gt; 1 39 24.32 0.003525</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="machinelearning6b_cache/html/lassofit3_788fc12b614c076a2082cb1e0979a43b">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Intercept from the LASSO models in different folds</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>fit.lasso[[<span class="dv">1</span>]]<span class="sc">$</span>a0</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#&gt;        s0 </span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">#&gt; -3.733405</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>fit.lasso[[<span class="dv">2</span>]]<span class="sc">$</span>a0</span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#&gt;        s0 </span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#&gt; -3.534898</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>fit.lasso[[<span class="dv">3</span>]]<span class="sc">$</span>a0</span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#&gt;        s0 </span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">#&gt; -3.486223</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>fit.lasso[[<span class="dv">4</span>]]<span class="sc">$</span>a0</span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">#&gt;        s0 </span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">#&gt; -3.800206</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>fit.lasso[[<span class="dv">5</span>]]<span class="sc">$</span>a0</span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co">#&gt;       s0 </span></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="co">#&gt; -3.68776</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="machinelearning6b_cache/html/lassofit4_58b596a59736f0d77464c73d1dec6ce5">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Beta coefficients from the LASSO models in different folds</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>fit.lasso[[<span class="dv">1</span>]]<span class="sc">$</span>beta</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt; 67 x 1 sparse Matrix of class "dgCMatrix"</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt;                                                 s0</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt; sexMale                               .           </span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#&gt; hhsize                                0.0092060605</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#&gt; bornOther place                       .           </span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">#&gt; maritalMarried/with partner           .           </span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">#&gt; maritalDivorced/separated             .           </span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">#&gt; maritalWidowed                        0.0926365970</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">#&gt; regionMidwest                         .           </span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co">#&gt; regionSouth                           .           </span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co">#&gt; regionWest                            0.1470219542</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">#&gt; raceBlack                            -0.0436983700</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">#&gt; raceHispanic                          .           </span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co">#&gt; raceOthers                            .           </span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co">#&gt; educationHigh school/GED              .           </span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="co">#&gt; educationSome college                 .           </span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co">#&gt; educationBachelors degree or higher   .           </span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">#&gt; employment.statusEmployed non-hourly  .           </span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="co">#&gt; employment.statusWorked previously    0.5412332930</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co">#&gt; employment.statusNever worked         0.8300536966</span></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co">#&gt; poverty.status100-200% FPL            0.0636289868</span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="co">#&gt; poverty.status200-400% FPL           -0.0697612513</span></span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="co">#&gt; poverty.status400%+ FPL              -0.2887583235</span></span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="co">#&gt; veteranYes                           -0.0300714331</span></span>
<span id="cb13-27"><a href="#cb13-27"></a><span class="co">#&gt; insuranceMedicaid/Medicare            .           </span></span>
<span id="cb13-28"><a href="#cb13-28"></a><span class="co">#&gt; insurancePrivately Insured           -0.0924641963</span></span>
<span id="cb13-29"><a href="#cb13-29"></a><span class="co">#&gt; insuranceOther                        0.1503323815</span></span>
<span id="cb13-30"><a href="#cb13-30"></a><span class="co">#&gt; sex.orientationOther                  0.0765093892</span></span>
<span id="cb13-31"><a href="#cb13-31"></a><span class="co">#&gt; worried.moneyYes                      0.2812674935</span></span>
<span id="cb13-32"><a href="#cb13-32"></a><span class="co">#&gt; good.neighborhoodYes                 -0.2491796538</span></span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="co">#&gt; psy.symptomYes                        0.9726200151</span></span>
<span id="cb13-34"><a href="#cb13-34"></a><span class="co">#&gt; visit.EDOne                           0.0674459188</span></span>
<span id="cb13-35"><a href="#cb13-35"></a><span class="co">#&gt; visit.ED2-3                           0.1375781535</span></span>
<span id="cb13-36"><a href="#cb13-36"></a><span class="co">#&gt; visit.ED4+                            0.4225671575</span></span>
<span id="cb13-37"><a href="#cb13-37"></a><span class="co">#&gt; surgeryOne                            .           </span></span>
<span id="cb13-38"><a href="#cb13-38"></a><span class="co">#&gt; surgeryTwo                            .           </span></span>
<span id="cb13-39"><a href="#cb13-39"></a><span class="co">#&gt; surgery3+                            -0.0839622285</span></span>
<span id="cb13-40"><a href="#cb13-40"></a><span class="co">#&gt; dr.visit6-12 months                  -0.2120063637</span></span>
<span id="cb13-41"><a href="#cb13-41"></a><span class="co">#&gt; dr.visit1-5 years                    -0.4068474570</span></span>
<span id="cb13-42"><a href="#cb13-42"></a><span class="co">#&gt; dr.visit&gt;5 years/never               -0.1453128227</span></span>
<span id="cb13-43"><a href="#cb13-43"></a><span class="co">#&gt; cancerYes                             0.0993613856</span></span>
<span id="cb13-44"><a href="#cb13-44"></a><span class="co">#&gt; asthmaYes                             0.2997325771</span></span>
<span id="cb13-45"><a href="#cb13-45"></a><span class="co">#&gt; htnYes                                0.2082877598</span></span>
<span id="cb13-46"><a href="#cb13-46"></a><span class="co">#&gt; liver.diseaseYes                      0.8058966864</span></span>
<span id="cb13-47"><a href="#cb13-47"></a><span class="co">#&gt; diabetesYes                           0.0007357323</span></span>
<span id="cb13-48"><a href="#cb13-48"></a><span class="co">#&gt; ulcerYes                              0.4180133887</span></span>
<span id="cb13-49"><a href="#cb13-49"></a><span class="co">#&gt; strokeYes                             .           </span></span>
<span id="cb13-50"><a href="#cb13-50"></a><span class="co">#&gt; emphysemaYes                         -0.0509549802</span></span>
<span id="cb13-51"><a href="#cb13-51"></a><span class="co">#&gt; copdYes                               0.1002374105</span></span>
<span id="cb13-52"><a href="#cb13-52"></a><span class="co">#&gt; high.cholesterolYes                   0.1021030868</span></span>
<span id="cb13-53"><a href="#cb13-53"></a><span class="co">#&gt; coronary.heart.diseaseYes             0.0220558291</span></span>
<span id="cb13-54"><a href="#cb13-54"></a><span class="co">#&gt; anginaYes                             0.0849595261</span></span>
<span id="cb13-55"><a href="#cb13-55"></a><span class="co">#&gt; heart.attackYes                       0.2476656673</span></span>
<span id="cb13-56"><a href="#cb13-56"></a><span class="co">#&gt; heart.diseaseYes                      .           </span></span>
<span id="cb13-57"><a href="#cb13-57"></a><span class="co">#&gt; arthritisYes                          0.9746692568</span></span>
<span id="cb13-58"><a href="#cb13-58"></a><span class="co">#&gt; crohns.diseaseYes                     .           </span></span>
<span id="cb13-59"><a href="#cb13-59"></a><span class="co">#&gt; place.routine.careDoctor's office    -0.0583977619</span></span>
<span id="cb13-60"><a href="#cb13-60"></a><span class="co">#&gt; place.routine.careHospital/Clinic     .           </span></span>
<span id="cb13-61"><a href="#cb13-61"></a><span class="co">#&gt; place.routine.careOther place         .           </span></span>
<span id="cb13-62"><a href="#cb13-62"></a><span class="co">#&gt; trouble.asleepYes                     0.2030296869</span></span>
<span id="cb13-63"><a href="#cb13-63"></a><span class="co">#&gt; obeseYes                              0.3879895531</span></span>
<span id="cb13-64"><a href="#cb13-64"></a><span class="co">#&gt; current.smokerYes                     0.3374178965</span></span>
<span id="cb13-65"><a href="#cb13-65"></a><span class="co">#&gt; heavy.drinkerYes                     -0.1268971235</span></span>
<span id="cb13-66"><a href="#cb13-66"></a><span class="co">#&gt; hospitalization1-2 days               0.1192556336</span></span>
<span id="cb13-67"><a href="#cb13-67"></a><span class="co">#&gt; hospitalization3-5 days               .           </span></span>
<span id="cb13-68"><a href="#cb13-68"></a><span class="co">#&gt; hospitalization6+ days                1.0866087297</span></span>
<span id="cb13-69"><a href="#cb13-69"></a><span class="co">#&gt; better.health.statusYes              -0.1013785074</span></span>
<span id="cb13-70"><a href="#cb13-70"></a><span class="co">#&gt; physical.activityModerate            -0.7523741651</span></span>
<span id="cb13-71"><a href="#cb13-71"></a><span class="co">#&gt; physical.activityHigh                -0.6865233686</span></span>
<span id="cb13-72"><a href="#cb13-72"></a>fit.lasso[[<span class="dv">2</span>]]<span class="sc">$</span>beta</span>
<span id="cb13-73"><a href="#cb13-73"></a><span class="co">#&gt; 67 x 1 sparse Matrix of class "dgCMatrix"</span></span>
<span id="cb13-74"><a href="#cb13-74"></a><span class="co">#&gt;                                                s0</span></span>
<span id="cb13-75"><a href="#cb13-75"></a><span class="co">#&gt; sexMale                               .          </span></span>
<span id="cb13-76"><a href="#cb13-76"></a><span class="co">#&gt; hhsize                                0.018493189</span></span>
<span id="cb13-77"><a href="#cb13-77"></a><span class="co">#&gt; bornOther place                       .          </span></span>
<span id="cb13-78"><a href="#cb13-78"></a><span class="co">#&gt; maritalMarried/with partner           .          </span></span>
<span id="cb13-79"><a href="#cb13-79"></a><span class="co">#&gt; maritalDivorced/separated            -0.001903136</span></span>
<span id="cb13-80"><a href="#cb13-80"></a><span class="co">#&gt; maritalWidowed                        .          </span></span>
<span id="cb13-81"><a href="#cb13-81"></a><span class="co">#&gt; regionMidwest                        -0.077656662</span></span>
<span id="cb13-82"><a href="#cb13-82"></a><span class="co">#&gt; regionSouth                           0.066061919</span></span>
<span id="cb13-83"><a href="#cb13-83"></a><span class="co">#&gt; regionWest                            0.198988965</span></span>
<span id="cb13-84"><a href="#cb13-84"></a><span class="co">#&gt; raceBlack                            -0.313705357</span></span>
<span id="cb13-85"><a href="#cb13-85"></a><span class="co">#&gt; raceHispanic                         -0.160881871</span></span>
<span id="cb13-86"><a href="#cb13-86"></a><span class="co">#&gt; raceOthers                            .          </span></span>
<span id="cb13-87"><a href="#cb13-87"></a><span class="co">#&gt; educationHigh school/GED             -0.073948767</span></span>
<span id="cb13-88"><a href="#cb13-88"></a><span class="co">#&gt; educationSome college                 .          </span></span>
<span id="cb13-89"><a href="#cb13-89"></a><span class="co">#&gt; educationBachelors degree or higher  -0.092601336</span></span>
<span id="cb13-90"><a href="#cb13-90"></a><span class="co">#&gt; employment.statusEmployed non-hourly  .          </span></span>
<span id="cb13-91"><a href="#cb13-91"></a><span class="co">#&gt; employment.statusWorked previously    0.662301617</span></span>
<span id="cb13-92"><a href="#cb13-92"></a><span class="co">#&gt; employment.statusNever worked         0.990458783</span></span>
<span id="cb13-93"><a href="#cb13-93"></a><span class="co">#&gt; poverty.status100-200% FPL            .          </span></span>
<span id="cb13-94"><a href="#cb13-94"></a><span class="co">#&gt; poverty.status200-400% FPL           -0.253983648</span></span>
<span id="cb13-95"><a href="#cb13-95"></a><span class="co">#&gt; poverty.status400%+ FPL              -0.485846823</span></span>
<span id="cb13-96"><a href="#cb13-96"></a><span class="co">#&gt; veteranYes                           -0.095649252</span></span>
<span id="cb13-97"><a href="#cb13-97"></a><span class="co">#&gt; insuranceMedicaid/Medicare            .          </span></span>
<span id="cb13-98"><a href="#cb13-98"></a><span class="co">#&gt; insurancePrivately Insured           -0.005530756</span></span>
<span id="cb13-99"><a href="#cb13-99"></a><span class="co">#&gt; insuranceOther                        0.249278523</span></span>
<span id="cb13-100"><a href="#cb13-100"></a><span class="co">#&gt; sex.orientationOther                  .          </span></span>
<span id="cb13-101"><a href="#cb13-101"></a><span class="co">#&gt; worried.moneyYes                      0.301627606</span></span>
<span id="cb13-102"><a href="#cb13-102"></a><span class="co">#&gt; good.neighborhoodYes                 -0.554793692</span></span>
<span id="cb13-103"><a href="#cb13-103"></a><span class="co">#&gt; psy.symptomYes                        0.975043141</span></span>
<span id="cb13-104"><a href="#cb13-104"></a><span class="co">#&gt; visit.EDOne                           0.058872693</span></span>
<span id="cb13-105"><a href="#cb13-105"></a><span class="co">#&gt; visit.ED2-3                           0.255785667</span></span>
<span id="cb13-106"><a href="#cb13-106"></a><span class="co">#&gt; visit.ED4+                            0.422172434</span></span>
<span id="cb13-107"><a href="#cb13-107"></a><span class="co">#&gt; surgeryOne                            0.002831717</span></span>
<span id="cb13-108"><a href="#cb13-108"></a><span class="co">#&gt; surgeryTwo                            0.099101540</span></span>
<span id="cb13-109"><a href="#cb13-109"></a><span class="co">#&gt; surgery3+                             .          </span></span>
<span id="cb13-110"><a href="#cb13-110"></a><span class="co">#&gt; dr.visit6-12 months                  -0.105087667</span></span>
<span id="cb13-111"><a href="#cb13-111"></a><span class="co">#&gt; dr.visit1-5 years                    -0.381233762</span></span>
<span id="cb13-112"><a href="#cb13-112"></a><span class="co">#&gt; dr.visit&gt;5 years/never               -0.459656177</span></span>
<span id="cb13-113"><a href="#cb13-113"></a><span class="co">#&gt; cancerYes                             0.281041121</span></span>
<span id="cb13-114"><a href="#cb13-114"></a><span class="co">#&gt; asthmaYes                             0.427654297</span></span>
<span id="cb13-115"><a href="#cb13-115"></a><span class="co">#&gt; htnYes                                0.219625784</span></span>
<span id="cb13-116"><a href="#cb13-116"></a><span class="co">#&gt; liver.diseaseYes                      0.580991873</span></span>
<span id="cb13-117"><a href="#cb13-117"></a><span class="co">#&gt; diabetesYes                           .          </span></span>
<span id="cb13-118"><a href="#cb13-118"></a><span class="co">#&gt; ulcerYes                              0.348542693</span></span>
<span id="cb13-119"><a href="#cb13-119"></a><span class="co">#&gt; strokeYes                             0.070369016</span></span>
<span id="cb13-120"><a href="#cb13-120"></a><span class="co">#&gt; emphysemaYes                          .          </span></span>
<span id="cb13-121"><a href="#cb13-121"></a><span class="co">#&gt; copdYes                               .          </span></span>
<span id="cb13-122"><a href="#cb13-122"></a><span class="co">#&gt; high.cholesterolYes                   0.150862244</span></span>
<span id="cb13-123"><a href="#cb13-123"></a><span class="co">#&gt; coronary.heart.diseaseYes             0.009536678</span></span>
<span id="cb13-124"><a href="#cb13-124"></a><span class="co">#&gt; anginaYes                             .          </span></span>
<span id="cb13-125"><a href="#cb13-125"></a><span class="co">#&gt; heart.attackYes                       0.405053759</span></span>
<span id="cb13-126"><a href="#cb13-126"></a><span class="co">#&gt; heart.diseaseYes                      .          </span></span>
<span id="cb13-127"><a href="#cb13-127"></a><span class="co">#&gt; arthritisYes                          0.954063592</span></span>
<span id="cb13-128"><a href="#cb13-128"></a><span class="co">#&gt; crohns.diseaseYes                     .          </span></span>
<span id="cb13-129"><a href="#cb13-129"></a><span class="co">#&gt; place.routine.careDoctor's office    -0.045764606</span></span>
<span id="cb13-130"><a href="#cb13-130"></a><span class="co">#&gt; place.routine.careHospital/Clinic     .          </span></span>
<span id="cb13-131"><a href="#cb13-131"></a><span class="co">#&gt; place.routine.careOther place         0.207253975</span></span>
<span id="cb13-132"><a href="#cb13-132"></a><span class="co">#&gt; trouble.asleepYes                     0.212898902</span></span>
<span id="cb13-133"><a href="#cb13-133"></a><span class="co">#&gt; obeseYes                              0.389340100</span></span>
<span id="cb13-134"><a href="#cb13-134"></a><span class="co">#&gt; current.smokerYes                     0.332982403</span></span>
<span id="cb13-135"><a href="#cb13-135"></a><span class="co">#&gt; heavy.drinkerYes                     -0.135194457</span></span>
<span id="cb13-136"><a href="#cb13-136"></a><span class="co">#&gt; hospitalization1-2 days               .          </span></span>
<span id="cb13-137"><a href="#cb13-137"></a><span class="co">#&gt; hospitalization3-5 days               .          </span></span>
<span id="cb13-138"><a href="#cb13-138"></a><span class="co">#&gt; hospitalization6+ days                1.018420971</span></span>
<span id="cb13-139"><a href="#cb13-139"></a><span class="co">#&gt; better.health.statusYes              -0.001173805</span></span>
<span id="cb13-140"><a href="#cb13-140"></a><span class="co">#&gt; physical.activityModerate            -0.703703292</span></span>
<span id="cb13-141"><a href="#cb13-141"></a><span class="co">#&gt; physical.activityHigh                -0.677811398</span></span>
<span id="cb13-142"><a href="#cb13-142"></a>fit.lasso[[<span class="dv">3</span>]]<span class="sc">$</span>beta</span>
<span id="cb13-143"><a href="#cb13-143"></a><span class="co">#&gt; 67 x 1 sparse Matrix of class "dgCMatrix"</span></span>
<span id="cb13-144"><a href="#cb13-144"></a><span class="co">#&gt;                                               s0</span></span>
<span id="cb13-145"><a href="#cb13-145"></a><span class="co">#&gt; sexMale                              -0.03555390</span></span>
<span id="cb13-146"><a href="#cb13-146"></a><span class="co">#&gt; hhsize                                0.01276707</span></span>
<span id="cb13-147"><a href="#cb13-147"></a><span class="co">#&gt; bornOther place                       .         </span></span>
<span id="cb13-148"><a href="#cb13-148"></a><span class="co">#&gt; maritalMarried/with partner          -0.00226132</span></span>
<span id="cb13-149"><a href="#cb13-149"></a><span class="co">#&gt; maritalDivorced/separated             .         </span></span>
<span id="cb13-150"><a href="#cb13-150"></a><span class="co">#&gt; maritalWidowed                        .         </span></span>
<span id="cb13-151"><a href="#cb13-151"></a><span class="co">#&gt; regionMidwest                         .         </span></span>
<span id="cb13-152"><a href="#cb13-152"></a><span class="co">#&gt; regionSouth                           .         </span></span>
<span id="cb13-153"><a href="#cb13-153"></a><span class="co">#&gt; regionWest                            0.25300309</span></span>
<span id="cb13-154"><a href="#cb13-154"></a><span class="co">#&gt; raceBlack                            -0.21629021</span></span>
<span id="cb13-155"><a href="#cb13-155"></a><span class="co">#&gt; raceHispanic                          .         </span></span>
<span id="cb13-156"><a href="#cb13-156"></a><span class="co">#&gt; raceOthers                            0.07458935</span></span>
<span id="cb13-157"><a href="#cb13-157"></a><span class="co">#&gt; educationHigh school/GED             -0.07527970</span></span>
<span id="cb13-158"><a href="#cb13-158"></a><span class="co">#&gt; educationSome college                 .         </span></span>
<span id="cb13-159"><a href="#cb13-159"></a><span class="co">#&gt; educationBachelors degree or higher  -0.08524865</span></span>
<span id="cb13-160"><a href="#cb13-160"></a><span class="co">#&gt; employment.statusEmployed non-hourly  .         </span></span>
<span id="cb13-161"><a href="#cb13-161"></a><span class="co">#&gt; employment.statusWorked previously    0.66693373</span></span>
<span id="cb13-162"><a href="#cb13-162"></a><span class="co">#&gt; employment.statusNever worked         0.96274685</span></span>
<span id="cb13-163"><a href="#cb13-163"></a><span class="co">#&gt; poverty.status100-200% FPL            .         </span></span>
<span id="cb13-164"><a href="#cb13-164"></a><span class="co">#&gt; poverty.status200-400% FPL           -0.11543598</span></span>
<span id="cb13-165"><a href="#cb13-165"></a><span class="co">#&gt; poverty.status400%+ FPL              -0.31422327</span></span>
<span id="cb13-166"><a href="#cb13-166"></a><span class="co">#&gt; veteranYes                           -0.08849244</span></span>
<span id="cb13-167"><a href="#cb13-167"></a><span class="co">#&gt; insuranceMedicaid/Medicare            .         </span></span>
<span id="cb13-168"><a href="#cb13-168"></a><span class="co">#&gt; insurancePrivately Insured           -0.14856615</span></span>
<span id="cb13-169"><a href="#cb13-169"></a><span class="co">#&gt; insuranceOther                        0.14368311</span></span>
<span id="cb13-170"><a href="#cb13-170"></a><span class="co">#&gt; sex.orientationOther                  .         </span></span>
<span id="cb13-171"><a href="#cb13-171"></a><span class="co">#&gt; worried.moneyYes                      0.28107756</span></span>
<span id="cb13-172"><a href="#cb13-172"></a><span class="co">#&gt; good.neighborhoodYes                 -0.37214169</span></span>
<span id="cb13-173"><a href="#cb13-173"></a><span class="co">#&gt; psy.symptomYes                        1.02129791</span></span>
<span id="cb13-174"><a href="#cb13-174"></a><span class="co">#&gt; visit.EDOne                           0.11427725</span></span>
<span id="cb13-175"><a href="#cb13-175"></a><span class="co">#&gt; visit.ED2-3                           0.23654896</span></span>
<span id="cb13-176"><a href="#cb13-176"></a><span class="co">#&gt; visit.ED4+                            0.53011900</span></span>
<span id="cb13-177"><a href="#cb13-177"></a><span class="co">#&gt; surgeryOne                            0.06030144</span></span>
<span id="cb13-178"><a href="#cb13-178"></a><span class="co">#&gt; surgeryTwo                            .         </span></span>
<span id="cb13-179"><a href="#cb13-179"></a><span class="co">#&gt; surgery3+                            -0.28355643</span></span>
<span id="cb13-180"><a href="#cb13-180"></a><span class="co">#&gt; dr.visit6-12 months                  -0.04219568</span></span>
<span id="cb13-181"><a href="#cb13-181"></a><span class="co">#&gt; dr.visit1-5 years                    -0.83131719</span></span>
<span id="cb13-182"><a href="#cb13-182"></a><span class="co">#&gt; dr.visit&gt;5 years/never               -0.48832578</span></span>
<span id="cb13-183"><a href="#cb13-183"></a><span class="co">#&gt; cancerYes                             0.18366379</span></span>
<span id="cb13-184"><a href="#cb13-184"></a><span class="co">#&gt; asthmaYes                             0.13556093</span></span>
<span id="cb13-185"><a href="#cb13-185"></a><span class="co">#&gt; htnYes                                0.12622357</span></span>
<span id="cb13-186"><a href="#cb13-186"></a><span class="co">#&gt; liver.diseaseYes                      0.62123990</span></span>
<span id="cb13-187"><a href="#cb13-187"></a><span class="co">#&gt; diabetesYes                           .         </span></span>
<span id="cb13-188"><a href="#cb13-188"></a><span class="co">#&gt; ulcerYes                              0.39650846</span></span>
<span id="cb13-189"><a href="#cb13-189"></a><span class="co">#&gt; strokeYes                             .         </span></span>
<span id="cb13-190"><a href="#cb13-190"></a><span class="co">#&gt; emphysemaYes                          .         </span></span>
<span id="cb13-191"><a href="#cb13-191"></a><span class="co">#&gt; copdYes                               0.16563326</span></span>
<span id="cb13-192"><a href="#cb13-192"></a><span class="co">#&gt; high.cholesterolYes                   0.10541633</span></span>
<span id="cb13-193"><a href="#cb13-193"></a><span class="co">#&gt; coronary.heart.diseaseYes             0.08229669</span></span>
<span id="cb13-194"><a href="#cb13-194"></a><span class="co">#&gt; anginaYes                             .         </span></span>
<span id="cb13-195"><a href="#cb13-195"></a><span class="co">#&gt; heart.attackYes                       0.37154172</span></span>
<span id="cb13-196"><a href="#cb13-196"></a><span class="co">#&gt; heart.diseaseYes                      .         </span></span>
<span id="cb13-197"><a href="#cb13-197"></a><span class="co">#&gt; arthritisYes                          0.91902311</span></span>
<span id="cb13-198"><a href="#cb13-198"></a><span class="co">#&gt; crohns.diseaseYes                    -0.01478240</span></span>
<span id="cb13-199"><a href="#cb13-199"></a><span class="co">#&gt; place.routine.careDoctor's office    -0.04968533</span></span>
<span id="cb13-200"><a href="#cb13-200"></a><span class="co">#&gt; place.routine.careHospital/Clinic     .         </span></span>
<span id="cb13-201"><a href="#cb13-201"></a><span class="co">#&gt; place.routine.careOther place         0.20094580</span></span>
<span id="cb13-202"><a href="#cb13-202"></a><span class="co">#&gt; trouble.asleepYes                     0.07725267</span></span>
<span id="cb13-203"><a href="#cb13-203"></a><span class="co">#&gt; obeseYes                              0.40542559</span></span>
<span id="cb13-204"><a href="#cb13-204"></a><span class="co">#&gt; current.smokerYes                     0.27207489</span></span>
<span id="cb13-205"><a href="#cb13-205"></a><span class="co">#&gt; heavy.drinkerYes                     -0.06932537</span></span>
<span id="cb13-206"><a href="#cb13-206"></a><span class="co">#&gt; hospitalization1-2 days              -0.13525647</span></span>
<span id="cb13-207"><a href="#cb13-207"></a><span class="co">#&gt; hospitalization3-5 days               .         </span></span>
<span id="cb13-208"><a href="#cb13-208"></a><span class="co">#&gt; hospitalization6+ days                1.02580763</span></span>
<span id="cb13-209"><a href="#cb13-209"></a><span class="co">#&gt; better.health.statusYes               .         </span></span>
<span id="cb13-210"><a href="#cb13-210"></a><span class="co">#&gt; physical.activityModerate            -0.74686507</span></span>
<span id="cb13-211"><a href="#cb13-211"></a><span class="co">#&gt; physical.activityHigh                -0.90554222</span></span>
<span id="cb13-212"><a href="#cb13-212"></a>fit.lasso[[<span class="dv">4</span>]]<span class="sc">$</span>beta</span>
<span id="cb13-213"><a href="#cb13-213"></a><span class="co">#&gt; 67 x 1 sparse Matrix of class "dgCMatrix"</span></span>
<span id="cb13-214"><a href="#cb13-214"></a><span class="co">#&gt;                                                s0</span></span>
<span id="cb13-215"><a href="#cb13-215"></a><span class="co">#&gt; sexMale                               .          </span></span>
<span id="cb13-216"><a href="#cb13-216"></a><span class="co">#&gt; hhsize                                .          </span></span>
<span id="cb13-217"><a href="#cb13-217"></a><span class="co">#&gt; bornOther place                       .          </span></span>
<span id="cb13-218"><a href="#cb13-218"></a><span class="co">#&gt; maritalMarried/with partner           .          </span></span>
<span id="cb13-219"><a href="#cb13-219"></a><span class="co">#&gt; maritalDivorced/separated             .          </span></span>
<span id="cb13-220"><a href="#cb13-220"></a><span class="co">#&gt; maritalWidowed                        .          </span></span>
<span id="cb13-221"><a href="#cb13-221"></a><span class="co">#&gt; regionMidwest                         .          </span></span>
<span id="cb13-222"><a href="#cb13-222"></a><span class="co">#&gt; regionSouth                           .          </span></span>
<span id="cb13-223"><a href="#cb13-223"></a><span class="co">#&gt; regionWest                            0.151732262</span></span>
<span id="cb13-224"><a href="#cb13-224"></a><span class="co">#&gt; raceBlack                            -0.063747960</span></span>
<span id="cb13-225"><a href="#cb13-225"></a><span class="co">#&gt; raceHispanic                          .          </span></span>
<span id="cb13-226"><a href="#cb13-226"></a><span class="co">#&gt; raceOthers                            .          </span></span>
<span id="cb13-227"><a href="#cb13-227"></a><span class="co">#&gt; educationHigh school/GED              .          </span></span>
<span id="cb13-228"><a href="#cb13-228"></a><span class="co">#&gt; educationSome college                 .          </span></span>
<span id="cb13-229"><a href="#cb13-229"></a><span class="co">#&gt; educationBachelors degree or higher   .          </span></span>
<span id="cb13-230"><a href="#cb13-230"></a><span class="co">#&gt; employment.statusEmployed non-hourly  .          </span></span>
<span id="cb13-231"><a href="#cb13-231"></a><span class="co">#&gt; employment.statusWorked previously    0.521879242</span></span>
<span id="cb13-232"><a href="#cb13-232"></a><span class="co">#&gt; employment.statusNever worked         0.671265401</span></span>
<span id="cb13-233"><a href="#cb13-233"></a><span class="co">#&gt; poverty.status100-200% FPL            .          </span></span>
<span id="cb13-234"><a href="#cb13-234"></a><span class="co">#&gt; poverty.status200-400% FPL           -0.014851029</span></span>
<span id="cb13-235"><a href="#cb13-235"></a><span class="co">#&gt; poverty.status400%+ FPL              -0.229122884</span></span>
<span id="cb13-236"><a href="#cb13-236"></a><span class="co">#&gt; veteranYes                            .          </span></span>
<span id="cb13-237"><a href="#cb13-237"></a><span class="co">#&gt; insuranceMedicaid/Medicare            .          </span></span>
<span id="cb13-238"><a href="#cb13-238"></a><span class="co">#&gt; insurancePrivately Insured           -0.092128877</span></span>
<span id="cb13-239"><a href="#cb13-239"></a><span class="co">#&gt; insuranceOther                        .          </span></span>
<span id="cb13-240"><a href="#cb13-240"></a><span class="co">#&gt; sex.orientationOther                  0.150490732</span></span>
<span id="cb13-241"><a href="#cb13-241"></a><span class="co">#&gt; worried.moneyYes                      0.282333603</span></span>
<span id="cb13-242"><a href="#cb13-242"></a><span class="co">#&gt; good.neighborhoodYes                 -0.104236603</span></span>
<span id="cb13-243"><a href="#cb13-243"></a><span class="co">#&gt; psy.symptomYes                        1.132555465</span></span>
<span id="cb13-244"><a href="#cb13-244"></a><span class="co">#&gt; visit.EDOne                           0.009230339</span></span>
<span id="cb13-245"><a href="#cb13-245"></a><span class="co">#&gt; visit.ED2-3                           0.288663967</span></span>
<span id="cb13-246"><a href="#cb13-246"></a><span class="co">#&gt; visit.ED4+                            0.673934923</span></span>
<span id="cb13-247"><a href="#cb13-247"></a><span class="co">#&gt; surgeryOne                            .          </span></span>
<span id="cb13-248"><a href="#cb13-248"></a><span class="co">#&gt; surgeryTwo                            .          </span></span>
<span id="cb13-249"><a href="#cb13-249"></a><span class="co">#&gt; surgery3+                             .          </span></span>
<span id="cb13-250"><a href="#cb13-250"></a><span class="co">#&gt; dr.visit6-12 months                  -0.018831608</span></span>
<span id="cb13-251"><a href="#cb13-251"></a><span class="co">#&gt; dr.visit1-5 years                    -0.496368171</span></span>
<span id="cb13-252"><a href="#cb13-252"></a><span class="co">#&gt; dr.visit&gt;5 years/never               -0.415165313</span></span>
<span id="cb13-253"><a href="#cb13-253"></a><span class="co">#&gt; cancerYes                             .          </span></span>
<span id="cb13-254"><a href="#cb13-254"></a><span class="co">#&gt; asthmaYes                             0.240957776</span></span>
<span id="cb13-255"><a href="#cb13-255"></a><span class="co">#&gt; htnYes                                0.125845727</span></span>
<span id="cb13-256"><a href="#cb13-256"></a><span class="co">#&gt; liver.diseaseYes                      0.672282863</span></span>
<span id="cb13-257"><a href="#cb13-257"></a><span class="co">#&gt; diabetesYes                           .          </span></span>
<span id="cb13-258"><a href="#cb13-258"></a><span class="co">#&gt; ulcerYes                              0.352645788</span></span>
<span id="cb13-259"><a href="#cb13-259"></a><span class="co">#&gt; strokeYes                             .          </span></span>
<span id="cb13-260"><a href="#cb13-260"></a><span class="co">#&gt; emphysemaYes                          .          </span></span>
<span id="cb13-261"><a href="#cb13-261"></a><span class="co">#&gt; copdYes                               0.054275559</span></span>
<span id="cb13-262"><a href="#cb13-262"></a><span class="co">#&gt; high.cholesterolYes                   0.057735457</span></span>
<span id="cb13-263"><a href="#cb13-263"></a><span class="co">#&gt; coronary.heart.diseaseYes             0.070550439</span></span>
<span id="cb13-264"><a href="#cb13-264"></a><span class="co">#&gt; anginaYes                             .          </span></span>
<span id="cb13-265"><a href="#cb13-265"></a><span class="co">#&gt; heart.attackYes                       0.234807175</span></span>
<span id="cb13-266"><a href="#cb13-266"></a><span class="co">#&gt; heart.diseaseYes                      .          </span></span>
<span id="cb13-267"><a href="#cb13-267"></a><span class="co">#&gt; arthritisYes                          1.043934915</span></span>
<span id="cb13-268"><a href="#cb13-268"></a><span class="co">#&gt; crohns.diseaseYes                     0.086038829</span></span>
<span id="cb13-269"><a href="#cb13-269"></a><span class="co">#&gt; place.routine.careDoctor's office     .          </span></span>
<span id="cb13-270"><a href="#cb13-270"></a><span class="co">#&gt; place.routine.careHospital/Clinic     .          </span></span>
<span id="cb13-271"><a href="#cb13-271"></a><span class="co">#&gt; place.routine.careOther place         .          </span></span>
<span id="cb13-272"><a href="#cb13-272"></a><span class="co">#&gt; trouble.asleepYes                     0.177916442</span></span>
<span id="cb13-273"><a href="#cb13-273"></a><span class="co">#&gt; obeseYes                              0.363088024</span></span>
<span id="cb13-274"><a href="#cb13-274"></a><span class="co">#&gt; current.smokerYes                     0.339985811</span></span>
<span id="cb13-275"><a href="#cb13-275"></a><span class="co">#&gt; heavy.drinkerYes                      .          </span></span>
<span id="cb13-276"><a href="#cb13-276"></a><span class="co">#&gt; hospitalization1-2 days               .          </span></span>
<span id="cb13-277"><a href="#cb13-277"></a><span class="co">#&gt; hospitalization3-5 days               0.073321609</span></span>
<span id="cb13-278"><a href="#cb13-278"></a><span class="co">#&gt; hospitalization6+ days                1.066617646</span></span>
<span id="cb13-279"><a href="#cb13-279"></a><span class="co">#&gt; better.health.statusYes               .          </span></span>
<span id="cb13-280"><a href="#cb13-280"></a><span class="co">#&gt; physical.activityModerate            -0.699175264</span></span>
<span id="cb13-281"><a href="#cb13-281"></a><span class="co">#&gt; physical.activityHigh                -0.642594150</span></span>
<span id="cb13-282"><a href="#cb13-282"></a>fit.lasso[[<span class="dv">5</span>]]<span class="sc">$</span>beta</span>
<span id="cb13-283"><a href="#cb13-283"></a><span class="co">#&gt; 67 x 1 sparse Matrix of class "dgCMatrix"</span></span>
<span id="cb13-284"><a href="#cb13-284"></a><span class="co">#&gt;                                               s0</span></span>
<span id="cb13-285"><a href="#cb13-285"></a><span class="co">#&gt; sexMale                               .         </span></span>
<span id="cb13-286"><a href="#cb13-286"></a><span class="co">#&gt; hhsize                                0.01585559</span></span>
<span id="cb13-287"><a href="#cb13-287"></a><span class="co">#&gt; bornOther place                       .         </span></span>
<span id="cb13-288"><a href="#cb13-288"></a><span class="co">#&gt; maritalMarried/with partner           .         </span></span>
<span id="cb13-289"><a href="#cb13-289"></a><span class="co">#&gt; maritalDivorced/separated            -0.04982466</span></span>
<span id="cb13-290"><a href="#cb13-290"></a><span class="co">#&gt; maritalWidowed                        0.03837620</span></span>
<span id="cb13-291"><a href="#cb13-291"></a><span class="co">#&gt; regionMidwest                        -0.25040909</span></span>
<span id="cb13-292"><a href="#cb13-292"></a><span class="co">#&gt; regionSouth                           .         </span></span>
<span id="cb13-293"><a href="#cb13-293"></a><span class="co">#&gt; regionWest                            0.08288425</span></span>
<span id="cb13-294"><a href="#cb13-294"></a><span class="co">#&gt; raceBlack                            -0.07020324</span></span>
<span id="cb13-295"><a href="#cb13-295"></a><span class="co">#&gt; raceHispanic                          .         </span></span>
<span id="cb13-296"><a href="#cb13-296"></a><span class="co">#&gt; raceOthers                            .         </span></span>
<span id="cb13-297"><a href="#cb13-297"></a><span class="co">#&gt; educationHigh school/GED              .         </span></span>
<span id="cb13-298"><a href="#cb13-298"></a><span class="co">#&gt; educationSome college                 .         </span></span>
<span id="cb13-299"><a href="#cb13-299"></a><span class="co">#&gt; educationBachelors degree or higher   .         </span></span>
<span id="cb13-300"><a href="#cb13-300"></a><span class="co">#&gt; employment.statusEmployed non-hourly  .         </span></span>
<span id="cb13-301"><a href="#cb13-301"></a><span class="co">#&gt; employment.statusWorked previously    0.64497666</span></span>
<span id="cb13-302"><a href="#cb13-302"></a><span class="co">#&gt; employment.statusNever worked         0.83560645</span></span>
<span id="cb13-303"><a href="#cb13-303"></a><span class="co">#&gt; poverty.status100-200% FPL            .         </span></span>
<span id="cb13-304"><a href="#cb13-304"></a><span class="co">#&gt; poverty.status200-400% FPL           -0.03113577</span></span>
<span id="cb13-305"><a href="#cb13-305"></a><span class="co">#&gt; poverty.status400%+ FPL              -0.22313059</span></span>
<span id="cb13-306"><a href="#cb13-306"></a><span class="co">#&gt; veteranYes                           -0.20269803</span></span>
<span id="cb13-307"><a href="#cb13-307"></a><span class="co">#&gt; insuranceMedicaid/Medicare            .         </span></span>
<span id="cb13-308"><a href="#cb13-308"></a><span class="co">#&gt; insurancePrivately Insured           -0.14170986</span></span>
<span id="cb13-309"><a href="#cb13-309"></a><span class="co">#&gt; insuranceOther                        0.19604683</span></span>
<span id="cb13-310"><a href="#cb13-310"></a><span class="co">#&gt; sex.orientationOther                  .         </span></span>
<span id="cb13-311"><a href="#cb13-311"></a><span class="co">#&gt; worried.moneyYes                      0.31572735</span></span>
<span id="cb13-312"><a href="#cb13-312"></a><span class="co">#&gt; good.neighborhoodYes                 -0.31850186</span></span>
<span id="cb13-313"><a href="#cb13-313"></a><span class="co">#&gt; psy.symptomYes                        1.15194136</span></span>
<span id="cb13-314"><a href="#cb13-314"></a><span class="co">#&gt; visit.EDOne                           0.05961452</span></span>
<span id="cb13-315"><a href="#cb13-315"></a><span class="co">#&gt; visit.ED2-3                           0.34349175</span></span>
<span id="cb13-316"><a href="#cb13-316"></a><span class="co">#&gt; visit.ED4+                            0.25637410</span></span>
<span id="cb13-317"><a href="#cb13-317"></a><span class="co">#&gt; surgeryOne                            .         </span></span>
<span id="cb13-318"><a href="#cb13-318"></a><span class="co">#&gt; surgeryTwo                            .         </span></span>
<span id="cb13-319"><a href="#cb13-319"></a><span class="co">#&gt; surgery3+                             .         </span></span>
<span id="cb13-320"><a href="#cb13-320"></a><span class="co">#&gt; dr.visit6-12 months                   .         </span></span>
<span id="cb13-321"><a href="#cb13-321"></a><span class="co">#&gt; dr.visit1-5 years                    -0.32790023</span></span>
<span id="cb13-322"><a href="#cb13-322"></a><span class="co">#&gt; dr.visit&gt;5 years/never                .         </span></span>
<span id="cb13-323"><a href="#cb13-323"></a><span class="co">#&gt; cancerYes                             0.21372688</span></span>
<span id="cb13-324"><a href="#cb13-324"></a><span class="co">#&gt; asthmaYes                             0.21206722</span></span>
<span id="cb13-325"><a href="#cb13-325"></a><span class="co">#&gt; htnYes                                0.13025900</span></span>
<span id="cb13-326"><a href="#cb13-326"></a><span class="co">#&gt; liver.diseaseYes                      0.44892643</span></span>
<span id="cb13-327"><a href="#cb13-327"></a><span class="co">#&gt; diabetesYes                           0.05119678</span></span>
<span id="cb13-328"><a href="#cb13-328"></a><span class="co">#&gt; ulcerYes                              0.27325347</span></span>
<span id="cb13-329"><a href="#cb13-329"></a><span class="co">#&gt; strokeYes                             .         </span></span>
<span id="cb13-330"><a href="#cb13-330"></a><span class="co">#&gt; emphysemaYes                          .         </span></span>
<span id="cb13-331"><a href="#cb13-331"></a><span class="co">#&gt; copdYes                               0.04954730</span></span>
<span id="cb13-332"><a href="#cb13-332"></a><span class="co">#&gt; high.cholesterolYes                   0.14824572</span></span>
<span id="cb13-333"><a href="#cb13-333"></a><span class="co">#&gt; coronary.heart.diseaseYes             .         </span></span>
<span id="cb13-334"><a href="#cb13-334"></a><span class="co">#&gt; anginaYes                             .         </span></span>
<span id="cb13-335"><a href="#cb13-335"></a><span class="co">#&gt; heart.attackYes                       0.27924438</span></span>
<span id="cb13-336"><a href="#cb13-336"></a><span class="co">#&gt; heart.diseaseYes                      .         </span></span>
<span id="cb13-337"><a href="#cb13-337"></a><span class="co">#&gt; arthritisYes                          1.00382986</span></span>
<span id="cb13-338"><a href="#cb13-338"></a><span class="co">#&gt; crohns.diseaseYes                     .         </span></span>
<span id="cb13-339"><a href="#cb13-339"></a><span class="co">#&gt; place.routine.careDoctor's office    -0.01943640</span></span>
<span id="cb13-340"><a href="#cb13-340"></a><span class="co">#&gt; place.routine.careHospital/Clinic     .         </span></span>
<span id="cb13-341"><a href="#cb13-341"></a><span class="co">#&gt; place.routine.careOther place         0.07273335</span></span>
<span id="cb13-342"><a href="#cb13-342"></a><span class="co">#&gt; trouble.asleepYes                     0.14684831</span></span>
<span id="cb13-343"><a href="#cb13-343"></a><span class="co">#&gt; obeseYes                              0.38029871</span></span>
<span id="cb13-344"><a href="#cb13-344"></a><span class="co">#&gt; current.smokerYes                     0.14111139</span></span>
<span id="cb13-345"><a href="#cb13-345"></a><span class="co">#&gt; heavy.drinkerYes                      .         </span></span>
<span id="cb13-346"><a href="#cb13-346"></a><span class="co">#&gt; hospitalization1-2 days              -0.02310396</span></span>
<span id="cb13-347"><a href="#cb13-347"></a><span class="co">#&gt; hospitalization3-5 days               .         </span></span>
<span id="cb13-348"><a href="#cb13-348"></a><span class="co">#&gt; hospitalization6+ days                1.08731840</span></span>
<span id="cb13-349"><a href="#cb13-349"></a><span class="co">#&gt; better.health.statusYes               .         </span></span>
<span id="cb13-350"><a href="#cb13-350"></a><span class="co">#&gt; physical.activityModerate            -0.76639891</span></span>
<span id="cb13-351"><a href="#cb13-351"></a><span class="co">#&gt; physical.activityHigh                -0.38546251</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="machinelearning6b_cache/html/lassoauc_36349cba1953d870def227d8eef3f54b">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># AUCs from different folds</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>auc.lasso</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#&gt; [1] 0.8396619 0.8129805 0.8465035 0.7896878 0.8342721</span></span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co"># Calibration slope from different folds</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>cal.slope.lasso</span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt; [1] 1.1287166 0.9985467 1.1224240 0.8934633 1.0131154</span></span>
<span id="cb14-8"><a href="#cb14-8"></a></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co"># Brier score from different folds</span></span>
<span id="cb14-10"><a href="#cb14-10"></a>brier.lasso</span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">#&gt; [1] 0.08524781 0.08476661 0.08666820 0.09071329 0.08911735</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we will average out the model performance measures:</p>
<div class="cell" data-hash="machinelearning6b_cache/html/lassoaucmean_ab2b52bfd3395ec2c06ddd1b5036860b">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Average AUC</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="fu">mean</span>(auc.lasso)</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">#&gt; [1] 0.8246212</span></span>
<span id="cb15-4"><a href="#cb15-4"></a></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co"># Average calibration slope</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="fu">mean</span>(cal.slope.lasso)</span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">#&gt; [1] 1.031253</span></span>
<span id="cb15-8"><a href="#cb15-8"></a></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co"># Average Brier score</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="fu">mean</span>(brier.lasso)</span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">#&gt; [1] 0.08730265</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Although the authors used multiple imputation, our AUC from the LASSO model with complete case data analysis is not that different. Note: the authors reported the AUC values in Table 2.</p>
</section></section><section id="random-forest-for-surveys" class="level3"><h3 class="anchored" data-anchor-id="random-forest-for-surveys">Random forest for surveys</h3>
<p>Now, we will fit the random forest model for predicting binary HICP with the listed predictors. Here are the steps for fitting the model with 5-fold CV:</p>
<ul>
<li>For fold 1, folds 2-5 is the training set and fold 1 is the test set</li>
<li>Fit random forest model on the training set to find the value of the hyperparameters (number of trees, number of predictors to split at in each node, and minimal node size to split at) that gives minimum prediction error. Incorporate sampling weights in the model to account for survey design.</li>
<li>Grid-search with out-of-sample error approach is widely used in the literature. In this approach, we create a data frame from all combinations of the hyperparameters and check which combination gives the lowest out-of-sample error.</li>
<li>Fit the random forest model on the training with the selected hyperparameters from the previous step. Incorporate sampling weights in the model to account for survey design.</li>
<li>Calculate predictive performance (e.g., AUC) on the test set</li>
<li>Repeat the analysis for all folds.</li>
</ul>
<section id="folds-1" class="level4"><h4 class="anchored" data-anchor-id="folds-1">Folds</h4>
<div class="cell" data-hash="machinelearning6b_cache/html/foldsrf_cd0dd9509d7ec7e610487f93d741e062">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">table</span>(nfolds)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#&gt; nfolds</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#&gt; 1451 1457 1496 1468 1408</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="formula-1" class="level4"><h4 class="anchored" data-anchor-id="formula-1">Formula</h4>
<div class="cell" data-hash="machinelearning6b_cache/html/formularf_0c0dfa2f30058dc86c63609344213d48">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>Formula</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">#&gt; HICP ~ sex + hhsize + born + marital + region + race + education + </span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">#&gt;     employment.status + poverty.status + veteran + insurance + </span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">#&gt;     sex.orientation + worried.money + good.neighborhood + psy.symptom + </span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co">#&gt;     visit.ED + surgery + dr.visit + cancer + asthma + htn + liver.disease + </span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co">#&gt;     diabetes + ulcer + stroke + emphysema + copd + high.cholesterol + </span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co">#&gt;     coronary.heart.disease + angina + heart.attack + heart.disease + </span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">#&gt;     arthritis + crohns.disease + place.routine.care + trouble.asleep + </span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">#&gt;     obese + current.smoker + heavy.drinker + hospitalization + </span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co">#&gt;     better.health.status + physical.activity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="fold-cv-random-forest" class="level4"><h4 class="anchored" data-anchor-id="fold-cv-random-forest">5-fold CV random forest</h4>
<div class="cell" data-hash="machinelearning6b_cache/html/rffit_3dea5a0285e4af03cd1d88f5ed047796">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>fit.rf <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>auc.rf <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>cal.slope.rf <span class="ot">&lt;-</span> brier.rf <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="cf">for</span> (fold <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="co"># Training data</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>  dat.train <span class="ot">&lt;-</span> dat.complete[nfolds <span class="sc">!=</span> fold, ]</span>
<span id="cb18-7"><a href="#cb18-7"></a>  </span>
<span id="cb18-8"><a href="#cb18-8"></a>  <span class="co"># Test data</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>  dat.test <span class="ot">&lt;-</span> dat.complete[nfolds <span class="sc">==</span> fold, ]</span>
<span id="cb18-10"><a href="#cb18-10"></a>  </span>
<span id="cb18-11"><a href="#cb18-11"></a>  <span class="co"># Tuning the hyperparameters </span></span>
<span id="cb18-12"><a href="#cb18-12"></a>  <span class="do">## Grid with 1000 models - huge time consuming</span></span>
<span id="cb18-13"><a href="#cb18-13"></a>  <span class="co">#grid.search &lt;- expand.grid(mtry = 1:10, node.size = 1:10, </span></span>
<span id="cb18-14"><a href="#cb18-14"></a>  <span class="co">#                          num.trees = seq(50,500,50), </span></span>
<span id="cb18-15"><a href="#cb18-15"></a>  <span class="co">#                           OOB_RMSE = 0)</span></span>
<span id="cb18-16"><a href="#cb18-16"></a>  </span>
<span id="cb18-17"><a href="#cb18-17"></a>  <span class="do">## Grid with 36 models as an exercise</span></span>
<span id="cb18-18"><a href="#cb18-18"></a>  grid.search <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb18-19"><a href="#cb18-19"></a>    <span class="at">mtry =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>, </span>
<span id="cb18-20"><a href="#cb18-20"></a>    <span class="at">node.size =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb18-21"><a href="#cb18-21"></a>    <span class="at">num.trees =</span> <span class="fu">seq</span>(<span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">100</span>),</span>
<span id="cb18-22"><a href="#cb18-22"></a>    <span class="at">OOB_RMSE =</span> <span class="dv">0</span>) </span>
<span id="cb18-23"><a href="#cb18-23"></a>  </span>
<span id="cb18-24"><a href="#cb18-24"></a>  <span class="do">## Model with grids </span></span>
<span id="cb18-25"><a href="#cb18-25"></a>  <span class="cf">for</span>(ii <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid.search)) {</span>
<span id="cb18-26"><a href="#cb18-26"></a>    <span class="co"># Model on training set with grid</span></span>
<span id="cb18-27"><a href="#cb18-27"></a>    fit.rf.tune <span class="ot">&lt;-</span> <span class="fu">ranger</span>(</span>
<span id="cb18-28"><a href="#cb18-28"></a>      <span class="at">formula =</span> Formula,</span>
<span id="cb18-29"><a href="#cb18-29"></a>      <span class="at">data =</span> dat.train, </span>
<span id="cb18-30"><a href="#cb18-30"></a>      <span class="at">num.trees =</span> grid.search<span class="sc">$</span>num.trees[ii],</span>
<span id="cb18-31"><a href="#cb18-31"></a>      <span class="at">mtry =</span> grid.search<span class="sc">$</span>mtry[ii], </span>
<span id="cb18-32"><a href="#cb18-32"></a>      <span class="at">min.node.size =</span> grid.search<span class="sc">$</span>node.size[ii],</span>
<span id="cb18-33"><a href="#cb18-33"></a>      <span class="at">importance =</span> <span class="st">'impurity'</span>, </span>
<span id="cb18-34"><a href="#cb18-34"></a>      <span class="at">case.weights =</span> dat.train<span class="sc">$</span>wgt)</span>
<span id="cb18-35"><a href="#cb18-35"></a>    </span>
<span id="cb18-36"><a href="#cb18-36"></a>    <span class="co"># Add Out-of-bag (OOB) error to grid</span></span>
<span id="cb18-37"><a href="#cb18-37"></a>    grid.search<span class="sc">$</span>OOB_RMSE[ii] <span class="ot">&lt;-</span> </span>
<span id="cb18-38"><a href="#cb18-38"></a>      <span class="fu">sqrt</span>(fit.rf.tune<span class="sc">$</span>prediction.error)</span>
<span id="cb18-39"><a href="#cb18-39"></a>  }</span>
<span id="cb18-40"><a href="#cb18-40"></a>  <span class="co"># Position of the tuned hyperparameters</span></span>
<span id="cb18-41"><a href="#cb18-41"></a>  position <span class="ot">&lt;-</span> <span class="fu">which.min</span>(grid.search<span class="sc">$</span>OOB_RMSE)</span>
<span id="cb18-42"><a href="#cb18-42"></a>  </span>
<span id="cb18-43"><a href="#cb18-43"></a>  <span class="co"># Fit the model on the training set with tuned hyperparameters</span></span>
<span id="cb18-44"><a href="#cb18-44"></a>  fit.rf[[fold]] <span class="ot">&lt;-</span> <span class="fu">ranger</span>(</span>
<span id="cb18-45"><a href="#cb18-45"></a>    <span class="at">formula =</span> Formula,</span>
<span id="cb18-46"><a href="#cb18-46"></a>    <span class="at">data =</span> dat.train, </span>
<span id="cb18-47"><a href="#cb18-47"></a>    <span class="at">case.weights =</span> dat.train<span class="sc">$</span>wgt, </span>
<span id="cb18-48"><a href="#cb18-48"></a>    <span class="at">probability =</span> T,</span>
<span id="cb18-49"><a href="#cb18-49"></a>    <span class="at">num.trees =</span> grid.search<span class="sc">$</span>num.trees[position],</span>
<span id="cb18-50"><a href="#cb18-50"></a>    <span class="at">min.node.size =</span> grid.search<span class="sc">$</span>node.size[position], </span>
<span id="cb18-51"><a href="#cb18-51"></a>    <span class="at">mtry =</span> grid.search<span class="sc">$</span>mtry[position], </span>
<span id="cb18-52"><a href="#cb18-52"></a>    <span class="at">importance =</span> <span class="st">'impurity'</span>)</span>
<span id="cb18-53"><a href="#cb18-53"></a>  </span>
<span id="cb18-54"><a href="#cb18-54"></a>  <span class="co"># Prediction on the test set</span></span>
<span id="cb18-55"><a href="#cb18-55"></a>  dat.test<span class="sc">$</span>pred.rf <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb18-56"><a href="#cb18-56"></a>    fit.rf[[fold]], </span>
<span id="cb18-57"><a href="#cb18-57"></a>    <span class="at">data =</span> dat.test)<span class="sc">$</span>predictions[,<span class="dv">2</span>]</span>
<span id="cb18-58"><a href="#cb18-58"></a>  </span>
<span id="cb18-59"><a href="#cb18-59"></a>  <span class="co"># AUC on the test set with sampling weights</span></span>
<span id="cb18-60"><a href="#cb18-60"></a>  auc.rf[fold] <span class="ot">&lt;-</span> <span class="fu">WeightedAUC</span>(</span>
<span id="cb18-61"><a href="#cb18-61"></a>    <span class="fu">WeightedROC</span>(dat.test<span class="sc">$</span>pred.rf, </span>
<span id="cb18-62"><a href="#cb18-62"></a>                dat.test<span class="sc">$</span>HICP, </span>
<span id="cb18-63"><a href="#cb18-63"></a>                <span class="at">weight =</span> dat.test<span class="sc">$</span>wgt))</span>
<span id="cb18-64"><a href="#cb18-64"></a>  </span>
<span id="cb18-65"><a href="#cb18-65"></a>  <span class="co"># Weighted calibration slope</span></span>
<span id="cb18-66"><a href="#cb18-66"></a>  dat.test<span class="sc">$</span>pred.rf[dat.test<span class="sc">$</span>pred.rf <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fl">0.00001</span></span>
<span id="cb18-67"><a href="#cb18-67"></a>  mod.cal <span class="ot">&lt;-</span> <span class="fu">glm</span>(HICP <span class="sc">~</span> <span class="fu">Logit</span>(dat.test<span class="sc">$</span>pred.rf), </span>
<span id="cb18-68"><a href="#cb18-68"></a>                 <span class="at">data =</span> dat.test, </span>
<span id="cb18-69"><a href="#cb18-69"></a>                 <span class="at">family =</span> binomial, </span>
<span id="cb18-70"><a href="#cb18-70"></a>                 <span class="at">weights =</span> wgt)</span>
<span id="cb18-71"><a href="#cb18-71"></a>  cal.slope.rf[fold] <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod.cal)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb18-72"><a href="#cb18-72"></a>  </span>
<span id="cb18-73"><a href="#cb18-73"></a>  <span class="co"># Weighted Brier Score</span></span>
<span id="cb18-74"><a href="#cb18-74"></a>  brier.rf[fold] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">brierscore</span>(</span>
<span id="cb18-75"><a href="#cb18-75"></a>    HICP <span class="sc">~</span> dat.test<span class="sc">$</span>pred.rf, </span>
<span id="cb18-76"><a href="#cb18-76"></a>    <span class="at">data =</span> dat.test,</span>
<span id="cb18-77"><a href="#cb18-77"></a>    <span class="at">wt =</span> dat.test<span class="sc">$</span>wgt))</span>
<span id="cb18-78"><a href="#cb18-78"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="model-performance-1" class="level4"><h4 class="anchored" data-anchor-id="model-performance-1">Model performance</h4>
<p>Let’s check how prediction worked.</p>
<div class="cell" data-hash="machinelearning6b_cache/html/rffit2_dfa1c37aa20651577ff9e875ef91697c">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Fitted random forest models</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>fit.rf[[<span class="dv">1</span>]]</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#&gt; Ranger result</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">#&gt; </span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co">#&gt; Call:</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co">#&gt;  ranger(formula = Formula, data = dat.train, case.weights = dat.train$wgt,      probability = T, num.trees = grid.search$num.trees[position],      min.node.size = grid.search$node.size[position], mtry = grid.search$mtry[position],      importance = "impurity") </span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co">#&gt; </span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co">#&gt; Type:                             Probability estimation </span></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="co">#&gt; Number of trees:                  500 </span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="co">#&gt; Sample size:                      5829 </span></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="co">#&gt; Number of independent variables:  42 </span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="co">#&gt; Mtry:                             5 </span></span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="co">#&gt; Target node size:                 3 </span></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="co">#&gt; Variable importance mode:         impurity </span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co">#&gt; Splitrule:                        gini </span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="co">#&gt; OOB prediction error (Brier s.):  0.0899798</span></span>
<span id="cb19-17"><a href="#cb19-17"></a>fit.rf[[<span class="dv">2</span>]]</span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="co">#&gt; Ranger result</span></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="co">#&gt; </span></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="co">#&gt; Call:</span></span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="co">#&gt;  ranger(formula = Formula, data = dat.train, case.weights = dat.train$wgt,      probability = T, num.trees = grid.search$num.trees[position],      min.node.size = grid.search$node.size[position], mtry = grid.search$mtry[position],      importance = "impurity") </span></span>
<span id="cb19-22"><a href="#cb19-22"></a><span class="co">#&gt; </span></span>
<span id="cb19-23"><a href="#cb19-23"></a><span class="co">#&gt; Type:                             Probability estimation </span></span>
<span id="cb19-24"><a href="#cb19-24"></a><span class="co">#&gt; Number of trees:                  400 </span></span>
<span id="cb19-25"><a href="#cb19-25"></a><span class="co">#&gt; Sample size:                      5823 </span></span>
<span id="cb19-26"><a href="#cb19-26"></a><span class="co">#&gt; Number of independent variables:  42 </span></span>
<span id="cb19-27"><a href="#cb19-27"></a><span class="co">#&gt; Mtry:                             5 </span></span>
<span id="cb19-28"><a href="#cb19-28"></a><span class="co">#&gt; Target node size:                 2 </span></span>
<span id="cb19-29"><a href="#cb19-29"></a><span class="co">#&gt; Variable importance mode:         impurity </span></span>
<span id="cb19-30"><a href="#cb19-30"></a><span class="co">#&gt; Splitrule:                        gini </span></span>
<span id="cb19-31"><a href="#cb19-31"></a><span class="co">#&gt; OOB prediction error (Brier s.):  0.0899217</span></span>
<span id="cb19-32"><a href="#cb19-32"></a>fit.rf[[<span class="dv">3</span>]]</span>
<span id="cb19-33"><a href="#cb19-33"></a><span class="co">#&gt; Ranger result</span></span>
<span id="cb19-34"><a href="#cb19-34"></a><span class="co">#&gt; </span></span>
<span id="cb19-35"><a href="#cb19-35"></a><span class="co">#&gt; Call:</span></span>
<span id="cb19-36"><a href="#cb19-36"></a><span class="co">#&gt;  ranger(formula = Formula, data = dat.train, case.weights = dat.train$wgt,      probability = T, num.trees = grid.search$num.trees[position],      min.node.size = grid.search$node.size[position], mtry = grid.search$mtry[position],      importance = "impurity") </span></span>
<span id="cb19-37"><a href="#cb19-37"></a><span class="co">#&gt; </span></span>
<span id="cb19-38"><a href="#cb19-38"></a><span class="co">#&gt; Type:                             Probability estimation </span></span>
<span id="cb19-39"><a href="#cb19-39"></a><span class="co">#&gt; Number of trees:                  500 </span></span>
<span id="cb19-40"><a href="#cb19-40"></a><span class="co">#&gt; Sample size:                      5784 </span></span>
<span id="cb19-41"><a href="#cb19-41"></a><span class="co">#&gt; Number of independent variables:  42 </span></span>
<span id="cb19-42"><a href="#cb19-42"></a><span class="co">#&gt; Mtry:                             5 </span></span>
<span id="cb19-43"><a href="#cb19-43"></a><span class="co">#&gt; Target node size:                 3 </span></span>
<span id="cb19-44"><a href="#cb19-44"></a><span class="co">#&gt; Variable importance mode:         impurity </span></span>
<span id="cb19-45"><a href="#cb19-45"></a><span class="co">#&gt; Splitrule:                        gini </span></span>
<span id="cb19-46"><a href="#cb19-46"></a><span class="co">#&gt; OOB prediction error (Brier s.):  0.08972587</span></span>
<span id="cb19-47"><a href="#cb19-47"></a>fit.rf[[<span class="dv">4</span>]]</span>
<span id="cb19-48"><a href="#cb19-48"></a><span class="co">#&gt; Ranger result</span></span>
<span id="cb19-49"><a href="#cb19-49"></a><span class="co">#&gt; </span></span>
<span id="cb19-50"><a href="#cb19-50"></a><span class="co">#&gt; Call:</span></span>
<span id="cb19-51"><a href="#cb19-51"></a><span class="co">#&gt;  ranger(formula = Formula, data = dat.train, case.weights = dat.train$wgt,      probability = T, num.trees = grid.search$num.trees[position],      min.node.size = grid.search$node.size[position], mtry = grid.search$mtry[position],      importance = "impurity") </span></span>
<span id="cb19-52"><a href="#cb19-52"></a><span class="co">#&gt; </span></span>
<span id="cb19-53"><a href="#cb19-53"></a><span class="co">#&gt; Type:                             Probability estimation </span></span>
<span id="cb19-54"><a href="#cb19-54"></a><span class="co">#&gt; Number of trees:                  400 </span></span>
<span id="cb19-55"><a href="#cb19-55"></a><span class="co">#&gt; Sample size:                      5812 </span></span>
<span id="cb19-56"><a href="#cb19-56"></a><span class="co">#&gt; Number of independent variables:  42 </span></span>
<span id="cb19-57"><a href="#cb19-57"></a><span class="co">#&gt; Mtry:                             5 </span></span>
<span id="cb19-58"><a href="#cb19-58"></a><span class="co">#&gt; Target node size:                 3 </span></span>
<span id="cb19-59"><a href="#cb19-59"></a><span class="co">#&gt; Variable importance mode:         impurity </span></span>
<span id="cb19-60"><a href="#cb19-60"></a><span class="co">#&gt; Splitrule:                        gini </span></span>
<span id="cb19-61"><a href="#cb19-61"></a><span class="co">#&gt; OOB prediction error (Brier s.):  0.08934626</span></span>
<span id="cb19-62"><a href="#cb19-62"></a>fit.rf[[<span class="dv">5</span>]]</span>
<span id="cb19-63"><a href="#cb19-63"></a><span class="co">#&gt; Ranger result</span></span>
<span id="cb19-64"><a href="#cb19-64"></a><span class="co">#&gt; </span></span>
<span id="cb19-65"><a href="#cb19-65"></a><span class="co">#&gt; Call:</span></span>
<span id="cb19-66"><a href="#cb19-66"></a><span class="co">#&gt;  ranger(formula = Formula, data = dat.train, case.weights = dat.train$wgt,      probability = T, num.trees = grid.search$num.trees[position],      min.node.size = grid.search$node.size[position], mtry = grid.search$mtry[position],      importance = "impurity") </span></span>
<span id="cb19-67"><a href="#cb19-67"></a><span class="co">#&gt; </span></span>
<span id="cb19-68"><a href="#cb19-68"></a><span class="co">#&gt; Type:                             Probability estimation </span></span>
<span id="cb19-69"><a href="#cb19-69"></a><span class="co">#&gt; Number of trees:                  400 </span></span>
<span id="cb19-70"><a href="#cb19-70"></a><span class="co">#&gt; Sample size:                      5872 </span></span>
<span id="cb19-71"><a href="#cb19-71"></a><span class="co">#&gt; Number of independent variables:  42 </span></span>
<span id="cb19-72"><a href="#cb19-72"></a><span class="co">#&gt; Mtry:                             5 </span></span>
<span id="cb19-73"><a href="#cb19-73"></a><span class="co">#&gt; Target node size:                 3 </span></span>
<span id="cb19-74"><a href="#cb19-74"></a><span class="co">#&gt; Variable importance mode:         impurity </span></span>
<span id="cb19-75"><a href="#cb19-75"></a><span class="co">#&gt; Splitrule:                        gini </span></span>
<span id="cb19-76"><a href="#cb19-76"></a><span class="co">#&gt; OOB prediction error (Brier s.):  0.08929408</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="machinelearning6b_cache/html/rfauc_a7128f01b54952d97832a4a5d7dac8f7">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># AUCs from different folds</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>auc.rf</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co">#&gt; [1] 0.8393204 0.7905715 0.8244523 0.7811141 0.8301950</span></span>
<span id="cb20-4"><a href="#cb20-4"></a></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co"># Calibration slope from different folds</span></span>
<span id="cb20-6"><a href="#cb20-6"></a>cal.slope.rf</span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co">#&gt; [1] 1.2842866 0.9933553 1.1486583 0.9134864 1.2263184</span></span>
<span id="cb20-8"><a href="#cb20-8"></a></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co"># Brier score from different folds</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>brier.rf</span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co">#&gt; [1] 0.08745016 0.08881079 0.08913696 0.09163393 0.08895764</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we will average out the model performance measures:</p>
<div class="cell" data-hash="machinelearning6b_cache/html/rfaucmean_54d3c65730822e18bbbb141ea7177aca">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># Average AUC</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="fu">mean</span>(auc.rf)</span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co">#&gt; [1] 0.8131307</span></span>
<span id="cb21-4"><a href="#cb21-4"></a></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co"># Average calibration slope</span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="fu">mean</span>(cal.slope.rf)</span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co">#&gt; [1] 1.113221</span></span>
<span id="cb21-8"><a href="#cb21-8"></a></span>
<span id="cb21-9"><a href="#cb21-9"></a><span class="co"># Average Brier score</span></span>
<span id="cb21-10"><a href="#cb21-10"></a><span class="fu">mean</span>(brier.rf)</span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="co">#&gt; [1] 0.0891979</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This AUC from random forest is approximately the same as obtained from the LASSO model.</p>
</section><section id="variable-importance" class="level4"><h4 class="anchored" data-anchor-id="variable-importance">Variable importance</h4>
<p>One nice feature of random forest is that we can rank the variables and generate a variable importance plot.</p>
<div class="cell" data-hash="machinelearning6b_cache/html/vim_d23543e72659e248a624c11d9bbd2968">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Fold 1</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="fu">ggplot</span>(</span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">enframe</span>(fit.rf[[<span class="dv">1</span>]]<span class="sc">$</span>variable.importance, </span>
<span id="cb22-4"><a href="#cb22-4"></a>          <span class="at">name =</span> <span class="st">"variable"</span>, </span>
<span id="cb22-5"><a href="#cb22-5"></a>          <span class="at">value =</span> <span class="st">"importance"</span>),</span>
<span id="cb22-6"><a href="#cb22-6"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable, importance), </span>
<span id="cb22-7"><a href="#cb22-7"></a>      <span class="at">y =</span> importance, <span class="at">fill =</span> importance)) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb22-9"><a href="#cb22-9"></a>           <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>  <span class="fu">ylab</span>(<span class="st">"Variable Importance"</span>) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb22-13"><a href="#cb22-13"></a>  <span class="fu">ggtitle</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"grey"</span>, </span>
<span id="cb22-16"><a href="#cb22-16"></a>                      <span class="at">high =</span> <span class="st">"grey10"</span>) <span class="sc">+</span> </span>
<span id="cb22-17"><a href="#cb22-17"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="machinelearning6b_files/figure-html/vim-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co"># Fold 5</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="fu">ggplot</span>(</span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="fu">enframe</span>(fit.rf[[<span class="dv">5</span>]]<span class="sc">$</span>variable.importance,</span>
<span id="cb23-5"><a href="#cb23-5"></a>          <span class="at">name =</span> <span class="st">"variable"</span>, </span>
<span id="cb23-6"><a href="#cb23-6"></a>          <span class="at">value =</span> <span class="st">"importance"</span>),</span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable, importance), </span>
<span id="cb23-8"><a href="#cb23-8"></a>      <span class="at">y =</span> importance, <span class="at">fill =</span> importance)) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb23-10"><a href="#cb23-10"></a>           <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12"></a>  <span class="fu">ylab</span>(<span class="st">"Variable Importance"</span>) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb23-14"><a href="#cb23-14"></a>  <span class="fu">ggtitle</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"grey"</span>, </span>
<span id="cb23-17"><a href="#cb23-17"></a>                      <span class="at">high =</span> <span class="st">"grey10"</span>) <span class="sc">+</span> </span>
<span id="cb23-18"><a href="#cb23-18"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="machinelearning6b_files/figure-html/vim-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="references" class="level3"><h3 class="anchored" data-anchor-id="references">References</h3>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./machinelearning6a.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">NHIS Example</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./machinelearningF.html" class="pagination-link">
        <span class="nav-page-text">R functions (L)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>