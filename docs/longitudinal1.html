<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Advanced Epidemiological Methods - Mixed effects models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./longitudinal2.html" rel="next">
<link href="./longitudinal0.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CVBPG0RQMY"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-CVBPG0RQMY', { 'anonymize_ip': true});
</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta name="twitter:title" content="Advanced Epidemiological Methods - Mixed effects models">
<meta name="twitter:description" content="In this section, we will learn about mixed effects models. Mixed effects models are popular choices for modeling repeated measurements, such as longitudinal or clustered data.">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-sidebar docked slimcontent">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Mixed effects models</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Epidemiological Methods</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">The Project</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./wrangling.html" class="sidebar-item-text sidebar-link">Data wrangling</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1a.html" class="sidebar-item-text sidebar-link">R basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1b.html" class="sidebar-item-text sidebar-link">Data types</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1c.html" class="sidebar-item-text sidebar-link">Automating tasks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling2.html" class="sidebar-item-text sidebar-link">Importing dataset</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling3.html" class="sidebar-item-text sidebar-link">Data manipulation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling4.html" class="sidebar-item-text sidebar-link">Import external data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling5.html" class="sidebar-item-text sidebar-link">Summary tables</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling6.html" class="sidebar-item-text sidebar-link">R Markdown</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingF.html" class="sidebar-item-text sidebar-link">R Functions (W)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingQ.html" class="sidebar-item-text sidebar-link">Quiz (W)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingS.html" class="sidebar-item-text sidebar-link">App (W)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingE.html" class="sidebar-item-text sidebar-link">Exercise (W)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./accessing.html" class="sidebar-item-text sidebar-link">Accessing data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing0.html" class="sidebar-item-text sidebar-link">Concepts (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing1.html" class="sidebar-item-text sidebar-link">Survey data sources</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing1i.html" class="sidebar-item-text sidebar-link">Descriptions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing2.html" class="sidebar-item-text sidebar-link">Importing CCHS to R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing3.html" class="sidebar-item-text sidebar-link">Importing NHANES to R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing4.html" class="sidebar-item-text sidebar-link">Reproducing NHANES results</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing5.html" class="sidebar-item-text sidebar-link">Importing NHIS to R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing7.html" class="sidebar-item-text sidebar-link">Linking mortality data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing8.html" class="sidebar-item-text sidebar-link">Replicate Data Creation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingF.html" class="sidebar-item-text sidebar-link">R Functions (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingQ.html" class="sidebar-item-text sidebar-link">Quiz (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingS.html" class="sidebar-item-text sidebar-link">App (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingE.html" class="sidebar-item-text sidebar-link">Exercise 1 (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingEsolution.html" class="sidebar-item-text sidebar-link">Exercise 1 Solution (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingE2.html" class="sidebar-item-text sidebar-link">Exercise 2 (A)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./researchquestion.html" class="sidebar-item-text sidebar-link">Research questions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion0.html" class="sidebar-item-text sidebar-link">Concepts (Q)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion1.html" class="sidebar-item-text sidebar-link">Predictive question-1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion2a.html" class="sidebar-item-text sidebar-link">Predictive question-2a</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion2b.html" class="sidebar-item-text sidebar-link">Predictive question-2b</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion3.html" class="sidebar-item-text sidebar-link">Causal question-1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion4.html" class="sidebar-item-text sidebar-link">Causal question-2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestionF.html" class="sidebar-item-text sidebar-link">R functions (Q)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestionQ.html" class="sidebar-item-text sidebar-link">Quiz (Q)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestionS.html" class="sidebar-item-text sidebar-link">App (Q)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./confounding.html" class="sidebar-item-text sidebar-link">Causal roles</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding0.html" class="sidebar-item-text sidebar-link">Concepts (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding1.html" class="sidebar-item-text sidebar-link">Confounding</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding2.html" class="sidebar-item-text sidebar-link">Mediator</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding3.html" class="sidebar-item-text sidebar-link">Collider</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding3b.html" class="sidebar-item-text sidebar-link">Simpson’s Paradox</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding4.html" class="sidebar-item-text sidebar-link">Z-bias</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding5.html" class="sidebar-item-text sidebar-link">Collapsibility</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding6.html" class="sidebar-item-text sidebar-link">Change-in-estimate</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confoundingF.html" class="sidebar-item-text sidebar-link">R functions (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confoundingQ.html" class="sidebar-item-text sidebar-link">Quiz (R)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./predictivefactors.html" class="sidebar-item-text sidebar-link">Prediction ideas</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors0.html" class="sidebar-item-text sidebar-link">Concepts (P)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors1.html" class="sidebar-item-text sidebar-link">Collinear predictors</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors2.html" class="sidebar-item-text sidebar-link">Continuous outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors3.html" class="sidebar-item-text sidebar-link">Binary outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors4.html" class="sidebar-item-text sidebar-link">Overfitting and performance</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors5.html" class="sidebar-item-text sidebar-link">Data Splitting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors6.html" class="sidebar-item-text sidebar-link">Cross-validation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors7.html" class="sidebar-item-text sidebar-link">Bootstrap</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactorsF.html" class="sidebar-item-text sidebar-link">R functions (P)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactorsQ.html" class="sidebar-item-text sidebar-link">Quiz (P)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./surveydata.html" class="sidebar-item-text sidebar-link">Survey data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata0.html" class="sidebar-item-text sidebar-link">Concepts (D)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata1.html" class="sidebar-item-text sidebar-link">CCHS: Revisiting PICOT</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata2.html" class="sidebar-item-text sidebar-link">CCHS: Assessing data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata3.html" class="sidebar-item-text sidebar-link">CCHS: Bivariate analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata4.html" class="sidebar-item-text sidebar-link">CCHS: Regression</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata5.html" class="sidebar-item-text sidebar-link">CCHS: Performance</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata6.html" class="sidebar-item-text sidebar-link">NHANES: Blood Pressure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata7.html" class="sidebar-item-text sidebar-link">NHANES: Cholesterol</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata8.html" class="sidebar-item-text sidebar-link">NHANES: Subsetting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataF.html" class="sidebar-item-text sidebar-link">R functions (D)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataQ.html" class="sidebar-item-text sidebar-link">Quiz (D)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataS.html" class="sidebar-item-text sidebar-link">App (D)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataE.html" class="sidebar-item-text sidebar-link">Exercise (D)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./missingdata.html" class="sidebar-item-text sidebar-link">Missing data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata0.html" class="sidebar-item-text sidebar-link">Concepts (M)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata1.html" class="sidebar-item-text sidebar-link">Imputation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata2.html" class="sidebar-item-text sidebar-link">Imputation in NHANES</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata3.html" class="sidebar-item-text sidebar-link">Missing in outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata4.html" class="sidebar-item-text sidebar-link">Performance with NA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata5.html" class="sidebar-item-text sidebar-link">Subpopulations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata6.html" class="sidebar-item-text sidebar-link">MCAR tests</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata7.html" class="sidebar-item-text sidebar-link">Effect modification</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataF.html" class="sidebar-item-text sidebar-link">R functions (M)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataQ.html" class="sidebar-item-text sidebar-link">Quiz (M)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataS.html" class="sidebar-item-text sidebar-link">App (M)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataE.html" class="sidebar-item-text sidebar-link">Exercise (M)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./propensityscore.html" class="sidebar-item-text sidebar-link">Propensity score</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore0.html" class="sidebar-item-text sidebar-link">Concepts (S)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore1.html" class="sidebar-item-text sidebar-link">Exact Matching (CCHS)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore2.html" class="sidebar-item-text sidebar-link">PSM in OA-CVD (CCHS)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore3.html" class="sidebar-item-text sidebar-link">PSM in OA-CVD (US)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore4.html" class="sidebar-item-text sidebar-link">PSM in BMI-diabetes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore5.html" class="sidebar-item-text sidebar-link">PSM with MI</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore6.html" class="sidebar-item-text sidebar-link">PS Weighting (US)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore7.html" class="sidebar-item-text sidebar-link">PSM with MI in subset</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore8.html" class="sidebar-item-text sidebar-link">PSW with MI in subset</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore9.html" class="sidebar-item-text sidebar-link">PSW with multiple tx</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreF.html" class="sidebar-item-text sidebar-link">R functions (S)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreQ.html" class="sidebar-item-text sidebar-link">Quiz (S)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreS.html" class="sidebar-item-text sidebar-link">App (S)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreE.html" class="sidebar-item-text sidebar-link">Exercise (S)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./machinelearning.html" class="sidebar-item-text sidebar-link">Machine learning (ML)</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning0.html" class="sidebar-item-text sidebar-link">Concepts (L)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning1.html" class="sidebar-item-text sidebar-link">Continuous outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning2.html" class="sidebar-item-text sidebar-link">Data spliting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning3.html" class="sidebar-item-text sidebar-link">Cross-validation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning4.html" class="sidebar-item-text sidebar-link">Binary outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning5.html" class="sidebar-item-text sidebar-link">Supervised learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning6.html" class="sidebar-item-text sidebar-link">Unsupervised learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning6a.html" class="sidebar-item-text sidebar-link">NHIS Example</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning6b.html" class="sidebar-item-text sidebar-link">Replicate Results</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningQ.html" class="sidebar-item-text sidebar-link">Quiz (L)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningF.html" class="sidebar-item-text sidebar-link">R functions (L)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./machinelearningCausal.html" class="sidebar-item-text sidebar-link">ML in causal inference</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal0.html" class="sidebar-item-text sidebar-link">Concepts (C)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal1.html" class="sidebar-item-text sidebar-link">Motivation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal2.html" class="sidebar-item-text sidebar-link">SuperLearner</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal3.html" class="sidebar-item-text sidebar-link">Binary Outcomes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal4.html" class="sidebar-item-text sidebar-link">Continuous Outcomes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal5.html" class="sidebar-item-text sidebar-link">Comparing results</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausalQ.html" class="sidebar-item-text sidebar-link">Quiz (C)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausalF.html" class="sidebar-item-text sidebar-link">R functions (C)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./nonbinary.html" class="sidebar-item-text sidebar-link">Complex outcomes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary0.html" class="sidebar-item-text sidebar-link">Concepts (N)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary1.html" class="sidebar-item-text sidebar-link">Polytomous and ordinal</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary2.html" class="sidebar-item-text sidebar-link">Survival analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary2a.html" class="sidebar-item-text sidebar-link">Survival analysis: NHANES</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary3.html" class="sidebar-item-text sidebar-link">Poisson</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinaryF.html" class="sidebar-item-text sidebar-link">R functions (N)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinaryQ.html" class="sidebar-item-text sidebar-link">Quiz (N)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./longitudinal.html" class="sidebar-item-text sidebar-link">Longitudinal data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal0.html" class="sidebar-item-text sidebar-link">Concepts (T)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal1.html" class="sidebar-item-text sidebar-link active">Mixed effects models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal2.html" class="sidebar-item-text sidebar-link">GEE</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinalF.html" class="sidebar-item-text sidebar-link">R functions (T)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinalQ.html" class="sidebar-item-text sidebar-link">Quiz (T)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./mediation.html" class="sidebar-item-text sidebar-link">Mediation analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation0.html" class="sidebar-item-text sidebar-link">Concepts (I)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation1.html" class="sidebar-item-text sidebar-link">Baron and Kenny</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation2.html" class="sidebar-item-text sidebar-link">Justification</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation3.html" class="sidebar-item-text sidebar-link">Mediation Example</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediationF.html" class="sidebar-item-text sidebar-link">R functions (I)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediationQ.html" class="sidebar-item-text sidebar-link">Quiz (I)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./reporting.html" class="sidebar-item-text sidebar-link">Writing tools</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reporting1.html" class="sidebar-item-text sidebar-link">Collaborative Writing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reporting2.html" class="sidebar-item-text sidebar-link">Formatting Tools</a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#repeated-measures" id="toc-repeated-measures" class="nav-link active" data-scroll-target="#repeated-measures">Repeated measures</a></li>
  <li><a href="#linear-mixed-effects-models-for-repeated-measures-data" id="toc-linear-mixed-effects-models-for-repeated-measures-data" class="nav-link" data-scroll-target="#linear-mixed-effects-models-for-repeated-measures-data">Linear Mixed Effects Models for Repeated Measures Data</a></li>
  <li><a href="#prediction-of-random-effects" id="toc-prediction-of-random-effects" class="nav-link" data-scroll-target="#prediction-of-random-effects">Prediction of Random Effects</a></li>
  <li><a href="#check-assumptions" id="toc-check-assumptions" class="nav-link" data-scroll-target="#check-assumptions">Check assumptions</a></li>
  <li><a href="#video-content-optional" id="toc-video-content-optional" class="nav-link" data-scroll-target="#video-content-optional">Video content (optional)</a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference">Reference</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">Mixed effects models</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>In this section, we will learn about mixed effects models. Mixed effects models are popular choices for modeling repeated measurements, such as longitudinal or clustered data. Examples of longitudinal data include blood pressure measurements taken over time from the same individuals and CD4 count over time from the same individuals. Examples of clustered data include students within schools and patients within hospitals. There are two components in a mixed effects model: fixed effects and random effects:</p>
<ul>
<li><p>Fixed effects refer to general trends that are applicable to all subjects/clusters. This implies that we might want to investigate how students perform (on average) in different subjects such as math and history. These effects are commonly observed, i.e., fixed, across all schools.</p></li>
<li><p>Random Effects capture the unique characteristics of each subject/cluster that differentiate them from one another. For instance, some schools may have better resources, more experienced teachers, or a more supportive learning environment. These differences are specific to each school, and we use random effects to capture them.</p></li>
</ul>
<div class="cell" data-hash="longitudinal1_cache/html/setup_58725617b16b2963e015093a96c937a7">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Load required packages</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">require</span>(kableExtra)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">require</span>(Matrix)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">require</span>(jtools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="repeated-measures" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="repeated-measures">Repeated measures</h3>

<div class="no-row-height column-margin column-container"><div class="">
<p>A useful reference on repeated measures is Section 9.2 of <span class="citation" data-cites="faraway2016extending">Faraway (<a href="#ref-faraway2016extending" role="doc-biblioref">2016</a>)</span>.</p>
</div></div><p>In repeated measurement design, the response variable are measured multiple times for each individuals.</p>
</section><section id="linear-mixed-effects-models-for-repeated-measures-data" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="linear-mixed-effects-models-for-repeated-measures-data">Linear Mixed Effects Models for Repeated Measures Data</h3>

<div class="no-row-height column-margin column-container"><div class="">
<p>A useful reference on linear mixed effects models is Section 12.4 of <span class="citation" data-cites="hothorn2014handbook">Hothorn and Everitt (<a href="#ref-hothorn2014handbook" role="doc-biblioref">2014</a>)</span>.</p>
</div></div><div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>The linear mixed effect models are based on the idea that the correlation of an individual’s responses depends on some unobserved individual characteristics.</p></li>
<li><p>In linear mixed effect models, we treat these unobserved characteristics as random effects in our model. If we could conditional on the random effects, then the repeated measurements can be assumed to be independent.</p></li>
</ul>
</div>
</div>
<section id="data" class="level4"><h4 class="anchored" data-anchor-id="data">Data</h4>
<p>We are going to use the <code>BtheB</code> dataset from the <code>HSAUR2</code> package to explain the linear mixed effect model:</p>
<div class="cell" data-hash="longitudinal1_cache/html/load_0562535e592778473f771abfa11844ee">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(HSAUR2)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">data</span>(<span class="st">"BtheB"</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">kable</span>(<span class="fu">head</span>(BtheB))<span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> F, </span>
<span id="cb2-5"><a href="#cb2-5"></a>                <span class="at">position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped" style="width: auto !important; ">
<thead><tr>
<th style="text-align:left;"> drug </th>
   <th style="text-align:left;"> length </th>
   <th style="text-align:left;"> treatment </th>
   <th style="text-align:right;"> bdi.pre </th>
   <th style="text-align:right;"> bdi.2m </th>
   <th style="text-align:right;"> bdi.3m </th>
   <th style="text-align:right;"> bdi.5m </th>
   <th style="text-align:right;"> bdi.8m </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> No </td>
   <td style="text-align:left;"> &gt;6m </td>
   <td style="text-align:left;"> TAU </td>
   <td style="text-align:right;"> 29 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
<tr>
<td style="text-align:left;"> Yes </td>
   <td style="text-align:left;"> &gt;6m </td>
   <td style="text-align:left;"> BtheB </td>
   <td style="text-align:right;"> 32 </td>
   <td style="text-align:right;"> 16 </td>
   <td style="text-align:right;"> 24 </td>
   <td style="text-align:right;"> 17 </td>
   <td style="text-align:right;"> 20 </td>
  </tr>
<tr>
<td style="text-align:left;"> Yes </td>
   <td style="text-align:left;"> &lt;6m </td>
   <td style="text-align:left;"> TAU </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
<tr>
<td style="text-align:left;"> No </td>
   <td style="text-align:left;"> &gt;6m </td>
   <td style="text-align:left;"> BtheB </td>
   <td style="text-align:right;"> 21 </td>
   <td style="text-align:right;"> 17 </td>
   <td style="text-align:right;"> 16 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
<tr>
<td style="text-align:left;"> Yes </td>
   <td style="text-align:left;"> &gt;6m </td>
   <td style="text-align:left;"> BtheB </td>
   <td style="text-align:right;"> 26 </td>
   <td style="text-align:right;"> 23 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
<tr>
<td style="text-align:left;"> Yes </td>
   <td style="text-align:left;"> &lt;6m </td>
   <td style="text-align:left;"> BtheB </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>
</div>
</div>
<ul>
<li><p>A typical form of repeated measurement data from a clinical trial data.</p></li>
<li><p>The individuals are allocated to different treatments then the response Beck Depression Inventory II were taken at baseline, 2, 3, 5, and 8 months</p></li>
</ul>
<div class="cell" data-hash="longitudinal1_cache/html/data1_6bc259bccfadb6f1ac4dcc298c7af6d1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="do">## Box-plot of responses at different time points in treatment and control groups</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">data</span>(<span class="st">"BtheB"</span>, <span class="at">package =</span> <span class="st">"HSAUR2"</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb3-4"><a href="#cb3-4"></a>ylim <span class="ot">&lt;-</span> <span class="fu">range</span>(BtheB[,<span class="fu">grep</span>(<span class="st">"bdi"</span>, <span class="fu">names</span>(BtheB))],<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>tau <span class="ot">&lt;-</span> <span class="fu">subset</span>(BtheB, treatment <span class="sc">==</span> <span class="st">"TAU"</span>)[, <span class="fu">grep</span>(<span class="st">"bdi"</span>, <span class="fu">names</span>(BtheB))]</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="fu">boxplot</span>(tau, <span class="at">main =</span> <span class="st">"Treated as Usual"</span>, <span class="at">ylab =</span> <span class="st">"BDI"</span>,</span>
<span id="cb3-7"><a href="#cb3-7"></a>        <span class="at">xlab =</span> <span class="st">"Time (in months)"</span>, </span>
<span id="cb3-8"><a href="#cb3-8"></a>        <span class="at">names =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>),<span class="at">ylim =</span> ylim)</span>
<span id="cb3-9"><a href="#cb3-9"></a>btheb <span class="ot">&lt;-</span> <span class="fu">subset</span>(BtheB, treatment <span class="sc">==</span> <span class="st">"BtheB"</span>)[, <span class="fu">grep</span>(<span class="st">"bdi"</span>, <span class="fu">names</span>(BtheB))]</span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="fu">boxplot</span>(btheb, <span class="at">main =</span> <span class="st">"Beat the Blues"</span>, <span class="at">ylab =</span> <span class="st">"BDI"</span>,</span>
<span id="cb3-11"><a href="#cb3-11"></a>        <span class="at">xlab =</span> <span class="st">"Time (in months)"</span>, </span>
<span id="cb3-12"><a href="#cb3-12"></a>        <span class="at">names =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>),<span class="at">ylim =</span> ylim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="longitudinal1_files/figure-html/data1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><p>The side-by-side box plots show the distributions of BDI overtime between control (Treated as Usual) and intervention (Beat the Blues) groups.</p></li>
<li><p>As time goes, drops in BDI are more obvious in intervention which may indicate the intervention is effective.</p></li>
</ul></section><section id="regular-model-fixed-intercept-and-slope" class="level4"><h4 class="anchored" data-anchor-id="regular-model-fixed-intercept-and-slope">Regular model fixed intercept and slope</h4>
<p>To compare, we start with fixed effect linear model, i.e., a regular linear model without any random effect:</p>
<div class="cell" data-hash="longitudinal1_cache/html/fixed_27129be5f2fdfc1f382af1d1c2b29d96">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="do">## To analyze the data, we first need to convert the dataset to a analysis-ready form</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>BtheB<span class="sc">$</span>subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rownames</span>(BtheB))</span>
<span id="cb4-3"><a href="#cb4-3"></a>nobs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(BtheB)</span>
<span id="cb4-4"><a href="#cb4-4"></a>BtheB_long <span class="ot">&lt;-</span> <span class="fu">reshape</span>(BtheB, <span class="at">idvar =</span> <span class="st">"subject"</span>, </span>
<span id="cb4-5"><a href="#cb4-5"></a>                      <span class="at">varying =</span> <span class="fu">c</span>(<span class="st">"bdi.2m"</span>, <span class="st">"bdi.3m"</span>, <span class="st">"bdi.5m"</span>, </span>
<span id="cb4-6"><a href="#cb4-6"></a>                                  <span class="st">"bdi.8m"</span>), </span>
<span id="cb4-7"><a href="#cb4-7"></a>                      <span class="at">direction =</span> <span class="st">"long"</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a>BtheB_long<span class="sc">$</span>time <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>), <span class="fu">rep</span>(nobs, <span class="dv">4</span>))</span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="fu">kable</span>(<span class="fu">head</span>(BtheB_long))<span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> F, </span>
<span id="cb4-11"><a href="#cb4-11"></a>                <span class="at">position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped" style="width: auto !important; ">
<thead><tr>
<th style="text-align:left;">   </th>
   <th style="text-align:left;"> drug </th>
   <th style="text-align:left;"> length </th>
   <th style="text-align:left;"> treatment </th>
   <th style="text-align:right;"> bdi.pre </th>
   <th style="text-align:left;"> subject </th>
   <th style="text-align:right;"> time </th>
   <th style="text-align:right;"> bdi </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> 1.2m </td>
   <td style="text-align:left;"> No </td>
   <td style="text-align:left;"> &gt;6m </td>
   <td style="text-align:left;"> TAU </td>
   <td style="text-align:right;"> 29 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
<tr>
<td style="text-align:left;"> 2.2m </td>
   <td style="text-align:left;"> Yes </td>
   <td style="text-align:left;"> &gt;6m </td>
   <td style="text-align:left;"> BtheB </td>
   <td style="text-align:right;"> 32 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 16 </td>
  </tr>
<tr>
<td style="text-align:left;"> 3.2m </td>
   <td style="text-align:left;"> Yes </td>
   <td style="text-align:left;"> &lt;6m </td>
   <td style="text-align:left;"> TAU </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 20 </td>
  </tr>
<tr>
<td style="text-align:left;"> 4.2m </td>
   <td style="text-align:left;"> No </td>
   <td style="text-align:left;"> &gt;6m </td>
   <td style="text-align:left;"> BtheB </td>
   <td style="text-align:right;"> 21 </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 17 </td>
  </tr>
<tr>
<td style="text-align:left;"> 5.2m </td>
   <td style="text-align:left;"> Yes </td>
   <td style="text-align:left;"> &gt;6m </td>
   <td style="text-align:left;"> BtheB </td>
   <td style="text-align:right;"> 26 </td>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 23 </td>
  </tr>
<tr>
<td style="text-align:left;"> 6.2m </td>
   <td style="text-align:left;"> Yes </td>
   <td style="text-align:left;"> &lt;6m </td>
   <td style="text-align:left;"> BtheB </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:left;"> 6 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">unique</span>(BtheB_long<span class="sc">$</span>subject)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt;   [1] 1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16  17  18 </span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt;  [19] 19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36 </span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt;  [37] 37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54 </span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt;  [55] 55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72 </span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt;  [73] 73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90 </span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt;  [91] 91  92  93  94  95  96  97  98  99  100</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt; 100 Levels: 1 10 100 11 12 13 14 15 16 17 18 19 2 20 21 22 23 24 25 26 27 ... 99</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="fu">kable</span>(<span class="fu">subset</span>(BtheB_long,  subject <span class="sc">==</span> <span class="dv">2</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> F, </span>
<span id="cb5-11"><a href="#cb5-11"></a>                <span class="at">position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped" style="width: auto !important; ">
<thead><tr>
<th style="text-align:left;">   </th>
   <th style="text-align:left;"> drug </th>
   <th style="text-align:left;"> length </th>
   <th style="text-align:left;"> treatment </th>
   <th style="text-align:right;"> bdi.pre </th>
   <th style="text-align:left;"> subject </th>
   <th style="text-align:right;"> time </th>
   <th style="text-align:right;"> bdi </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> 2.2m </td>
   <td style="text-align:left;"> Yes </td>
   <td style="text-align:left;"> &gt;6m </td>
   <td style="text-align:left;"> BtheB </td>
   <td style="text-align:right;"> 32 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 16 </td>
  </tr>
<tr>
<td style="text-align:left;"> 2.3m </td>
   <td style="text-align:left;"> Yes </td>
   <td style="text-align:left;"> &gt;6m </td>
   <td style="text-align:left;"> BtheB </td>
   <td style="text-align:right;"> 32 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 24 </td>
  </tr>
<tr>
<td style="text-align:left;"> 2.5m </td>
   <td style="text-align:left;"> Yes </td>
   <td style="text-align:left;"> &gt;6m </td>
   <td style="text-align:left;"> BtheB </td>
   <td style="text-align:right;"> 32 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 17 </td>
  </tr>
<tr>
<td style="text-align:left;"> 2.8m </td>
   <td style="text-align:left;"> Yes </td>
   <td style="text-align:left;"> &gt;6m </td>
   <td style="text-align:left;"> BtheB </td>
   <td style="text-align:right;"> 32 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 20 </td>
  </tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">kable</span>(<span class="fu">subset</span>(BtheB_long,  subject <span class="sc">==</span> <span class="dv">99</span>))<span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> F, </span>
<span id="cb6-3"><a href="#cb6-3"></a>                <span class="at">position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped" style="width: auto !important; ">
<thead><tr>
<th style="text-align:left;">   </th>
   <th style="text-align:left;"> drug </th>
   <th style="text-align:left;"> length </th>
   <th style="text-align:left;"> treatment </th>
   <th style="text-align:right;"> bdi.pre </th>
   <th style="text-align:left;"> subject </th>
   <th style="text-align:right;"> time </th>
   <th style="text-align:right;"> bdi </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> 99.2m </td>
   <td style="text-align:left;"> No </td>
   <td style="text-align:left;"> &lt;6m </td>
   <td style="text-align:left;"> TAU </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:left;"> 99 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 5 </td>
  </tr>
<tr>
<td style="text-align:left;"> 99.3m </td>
   <td style="text-align:left;"> No </td>
   <td style="text-align:left;"> &lt;6m </td>
   <td style="text-align:left;"> TAU </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:left;"> 99 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 5 </td>
  </tr>
<tr>
<td style="text-align:left;"> 99.5m </td>
   <td style="text-align:left;"> No </td>
   <td style="text-align:left;"> &lt;6m </td>
   <td style="text-align:left;"> TAU </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:left;"> 99 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
<tr>
<td style="text-align:left;"> 99.8m </td>
   <td style="text-align:left;"> No </td>
   <td style="text-align:left;"> &lt;6m </td>
   <td style="text-align:left;"> TAU </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:left;"> 99 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a></span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a>lmfit <span class="ot">&lt;-</span> <span class="fu">lm</span>(bdi <span class="sc">~</span> bdi.pre <span class="sc">+</span> time <span class="sc">+</span> treatment <span class="sc">+</span> drug <span class="sc">+</span>length, </span>
<span id="cb7-4"><a href="#cb7-4"></a>            <span class="at">data =</span> BtheB_long, <span class="at">na.action =</span> na.omit)</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="fu">require</span>(jtools)</span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="fu">summ</span>(lmfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> Observations </td>
   <td style="text-align:right;"> 280 (120 missing obs. deleted) </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Dependent variable </td>
   <td style="text-align:right;"> bdi </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Type </td>
   <td style="text-align:right;"> OLS linear regression </td>
  </tr>
</tbody></table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> F(5,274) </td>
   <td style="text-align:right;"> 35.78 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> R² </td>
   <td style="text-align:right;"> 0.40 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Adj. R² </td>
   <td style="text-align:right;"> 0.38 </td>
  </tr>
</tbody></table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead><tr>
<th style="text-align:left;">   </th>
   <th style="text-align:right;"> Est. </th>
   <th style="text-align:right;"> S.E. </th>
   <th style="text-align:right;"> t val. </th>
   <th style="text-align:right;"> p </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> (Intercept) </td>
   <td style="text-align:right;"> 7.32 </td>
   <td style="text-align:right;"> 1.73 </td>
   <td style="text-align:right;"> 4.24 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> bdi.pre </td>
   <td style="text-align:right;"> 0.57 </td>
   <td style="text-align:right;"> 0.05 </td>
   <td style="text-align:right;"> 10.44 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> time </td>
   <td style="text-align:right;"> -0.94 </td>
   <td style="text-align:right;"> 0.24 </td>
   <td style="text-align:right;"> -3.97 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> treatmentBtheB </td>
   <td style="text-align:right;"> -3.32 </td>
   <td style="text-align:right;"> 1.10 </td>
   <td style="text-align:right;"> -3.02 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> drugYes </td>
   <td style="text-align:right;"> -3.57 </td>
   <td style="text-align:right;"> 1.15 </td>
   <td style="text-align:right;"> -3.11 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> length&gt;6m </td>
   <td style="text-align:right;"> 1.71 </td>
   <td style="text-align:right;"> 1.11 </td>
   <td style="text-align:right;"> 1.54 </td>
   <td style="text-align:right;"> 0.12 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<sup></sup> Standard errors: OLS</td></tr></tfoot>
</table>
</div>
</div>
</section><section id="random-intercept-but-fixed-slope" class="level4"><h4 class="anchored" data-anchor-id="random-intercept-but-fixed-slope">Random intercept but fixed slope</h4>
<p>Let us start with a model with a random intercept but fixed slope. In this case, the resulting regression line for each individual is parallel (for fixed slope) but have different intercepts (for random intercept).</p>
<div class="cell" data-hash="longitudinal1_cache/html/random_76a4541fbfdfd38e369eb754646159d6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="do">## Fit a random intercept model with lme4 package</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="fu">library</span>(<span class="st">"lme4"</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>BtheB_lmer1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(bdi <span class="sc">~</span> bdi.pre <span class="sc">+</span> time <span class="sc">+</span> treatment <span class="sc">+</span> drug <span class="sc">+</span>length </span>
<span id="cb8-4"><a href="#cb8-4"></a>                    <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> subject), <span class="at">data =</span> BtheB_long, </span>
<span id="cb8-5"><a href="#cb8-5"></a>                    <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="at">na.action =</span> na.omit)</span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="fu">summary</span>(BtheB_lmer1)</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt; Linear mixed model fit by maximum likelihood  ['lmerMod']</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt; Formula: bdi ~ bdi.pre + time + treatment + drug + length + (1 | subject)</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt;    Data: BtheB_long</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">#&gt; </span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">#&gt;   1887.5   1916.6   -935.7   1871.5      272 </span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#&gt; </span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">#&gt; Scaled residuals: </span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co">#&gt; -2.6975 -0.5026 -0.0638  0.4124  3.8203 </span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="co">#&gt; </span></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co">#&gt;  subject  (Intercept) 48.78    6.984   </span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">#&gt;  Residual             25.14    5.014   </span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">#&gt; Number of obs: 280, groups:  subject, 97</span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co">#&gt; </span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co">#&gt; Fixed effects:</span></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="co">#&gt;                Estimate Std. Error t value</span></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="co">#&gt; (Intercept)     5.59239    2.24244   2.494</span></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co">#&gt; bdi.pre         0.63968    0.07789   8.212</span></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="co">#&gt; time           -0.70476    0.14639  -4.814</span></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="co">#&gt; treatmentBtheB -2.32908    1.67036  -1.394</span></span>
<span id="cb8-31"><a href="#cb8-31"></a><span class="co">#&gt; drugYes        -2.82495    1.72684  -1.636</span></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="co">#&gt; length&gt;6m       0.19708    1.63832   0.120</span></span>
<span id="cb8-33"><a href="#cb8-33"></a><span class="co">#&gt; </span></span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span id="cb8-35"><a href="#cb8-35"></a><span class="co">#&gt;             (Intr) bdi.pr time   trtmBB drugYs</span></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="co">#&gt; bdi.pre     -0.682                            </span></span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="co">#&gt; time        -0.238  0.020                     </span></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="co">#&gt; tretmntBthB -0.390  0.121  0.018              </span></span>
<span id="cb8-39"><a href="#cb8-39"></a><span class="co">#&gt; drugYes     -0.073 -0.237 -0.022 -0.323       </span></span>
<span id="cb8-40"><a href="#cb8-40"></a><span class="co">#&gt; length&gt;6m   -0.243 -0.242 -0.036  0.002  0.157</span></span>
<span id="cb8-41"><a href="#cb8-41"></a><span class="fu">summ</span>(BtheB_lmer1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> Observations </td>
   <td style="text-align:right;"> 280 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Dependent variable </td>
   <td style="text-align:right;"> bdi </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Type </td>
   <td style="text-align:right;"> Mixed effects linear regression </td>
  </tr>
</tbody></table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> AIC </td>
   <td style="text-align:right;"> 1887.49 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> BIC </td>
   <td style="text-align:right;"> 1916.57 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Pseudo-R² (fixed effects) </td>
   <td style="text-align:right;"> 0.39 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Pseudo-R² (total) </td>
   <td style="text-align:right;"> 0.79 </td>
  </tr>
</tbody></table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="6"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Fixed Effects</div></th></tr>
<tr>
<th style="text-align:left;">   </th>
   <th style="text-align:right;"> Est. </th>
   <th style="text-align:right;"> S.E. </th>
   <th style="text-align:right;"> t val. </th>
   <th style="text-align:right;"> d.f. </th>
   <th style="text-align:right;"> p </th>
  </tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> (Intercept) </td>
   <td style="text-align:right;"> 5.59 </td>
   <td style="text-align:right;"> 2.24 </td>
   <td style="text-align:right;"> 2.49 </td>
   <td style="text-align:right;"> 108.98 </td>
   <td style="text-align:right;"> 0.01 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> bdi.pre </td>
   <td style="text-align:right;"> 0.64 </td>
   <td style="text-align:right;"> 0.08 </td>
   <td style="text-align:right;"> 8.21 </td>
   <td style="text-align:right;"> 104.08 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> time </td>
   <td style="text-align:right;"> -0.70 </td>
   <td style="text-align:right;"> 0.15 </td>
   <td style="text-align:right;"> -4.81 </td>
   <td style="text-align:right;"> 199.32 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> treatmentBtheB </td>
   <td style="text-align:right;"> -2.33 </td>
   <td style="text-align:right;"> 1.67 </td>
   <td style="text-align:right;"> -1.39 </td>
   <td style="text-align:right;"> 97.12 </td>
   <td style="text-align:right;"> 0.17 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> drugYes </td>
   <td style="text-align:right;"> -2.82 </td>
   <td style="text-align:right;"> 1.73 </td>
   <td style="text-align:right;"> -1.64 </td>
   <td style="text-align:right;"> 98.20 </td>
   <td style="text-align:right;"> 0.11 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> length&gt;6m </td>
   <td style="text-align:right;"> 0.20 </td>
   <td style="text-align:right;"> 1.64 </td>
   <td style="text-align:right;"> 0.12 </td>
   <td style="text-align:right;"> 100.26 </td>
   <td style="text-align:right;"> 0.90 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<sup></sup>  p values calculated using Satterthwaite d.f. </td></tr></tfoot>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Random Effects</div></th></tr>
<tr>
<th> Group </th>
   <th> Parameter </th>
   <th> Std. Dev. </th>
  </tr>
</thead>
<tbody>
<tr>
<td> subject </td>
   <td> (Intercept) </td>
   <td> 6.98 </td>
  </tr>
<tr>
<td> Residual </td>
   <td>  </td>
   <td> 5.01 </td>
  </tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Grouping Variables</div></th></tr>
<tr>
<th> Group </th>
   <th> # groups </th>
   <th> ICC </th>
  </tr>
</thead>
<tbody><tr>
<td> subject </td>
   <td> 97 </td>
   <td> 0.66 </td>
  </tr></tbody>
</table>
</div>
</div>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>AIC, BIC, and -loglik etc are goodness-of-fit statistics, which tells you how well the model fits your data. Since there is no standard to tell what values of these statistics are good, without comparison with other models, they have little information to tell.</p></li>
<li><p>Fixed effects: this is the standard output we will have in any fixed-effect model. The interpretation of estimated coefficients will be similar to a regular linear model.</p></li>
<li><p>You may compare the outputs with the regular linear model, then you will find that <strong>lm</strong> tends to <strong>underestimate</strong> the SE for estimated coefficients.</p></li>
</ul>
</div>
</div>
<div class="cell" data-hash="longitudinal1_cache/html/random2_217ae8cee45db2c04c675c6d73b0faea">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-2"><a href="#cb9-2"></a>BtheB_longna <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(BtheB_long)</span>
<span id="cb9-3"><a href="#cb9-3"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time=</span>BtheB_longna<span class="sc">$</span>time,<span class="at">pred=</span><span class="fu">fitted</span>(BtheB_lmer1),</span>
<span id="cb9-4"><a href="#cb9-4"></a>                  <span class="at">Subject=</span> BtheB_longna<span class="sc">$</span>subject)</span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dat,<span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>pred, <span class="at">group=</span>Subject, </span>
<span id="cb9-6"><a href="#cb9-6"></a>                    <span class="at">color=</span>Subject)) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>    <span class="fu">geom_line</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="longitudinal1_files/figure-html/random2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As we can see, for each individual, we have different intercepts but the slope over follow-up time is the same. Next, we will fit the model with random intercept and random slope.</p>
</section><section id="random-intercept-and-random-slope" class="level4"><h4 class="anchored" data-anchor-id="random-intercept-and-random-slope">Random intercept and random slope</h4>
<p>In the codes below, we fitted a mixed effects model with both random intercept and random slope:</p>
<div class="cell" data-hash="longitudinal1_cache/html/random3_6050327661a81a02013ab346f1a3081f">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="do">## We can fit a random slope and intercept model using lme4 package and treat variable time as random slope. </span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">library</span>(<span class="st">"lme4"</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a>BtheB_lmer2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(bdi <span class="sc">~</span> bdi.pre <span class="sc">+</span> time <span class="sc">+</span> treatment <span class="sc">+</span> drug <span class="sc">+</span>length <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4"></a>                   (time <span class="sc">|</span> subject), <span class="at">data =</span> BtheB_long, <span class="at">REML =</span> <span class="cn">FALSE</span>, </span>
<span id="cb10-5"><a href="#cb10-5"></a>                   <span class="at">na.action =</span> na.omit)</span>
<span id="cb10-6"><a href="#cb10-6"></a></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="fu">summ</span>(BtheB_lmer2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> Observations </td>
   <td style="text-align:right;"> 280 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Dependent variable </td>
   <td style="text-align:right;"> bdi </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Type </td>
   <td style="text-align:right;"> Mixed effects linear regression </td>
  </tr>
</tbody></table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> AIC </td>
   <td style="text-align:right;"> 1891.04 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> BIC </td>
   <td style="text-align:right;"> 1927.39 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Pseudo-R² (fixed effects) </td>
   <td style="text-align:right;"> 0.39 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Pseudo-R² (total) </td>
   <td style="text-align:right;"> 0.80 </td>
  </tr>
</tbody></table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="6"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Fixed Effects</div></th></tr>
<tr>
<th style="text-align:left;">   </th>
   <th style="text-align:right;"> Est. </th>
   <th style="text-align:right;"> S.E. </th>
   <th style="text-align:right;"> t val. </th>
   <th style="text-align:right;"> d.f. </th>
   <th style="text-align:right;"> p </th>
  </tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> (Intercept) </td>
   <td style="text-align:right;"> 5.61 </td>
   <td style="text-align:right;"> 2.25 </td>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 106.79 </td>
   <td style="text-align:right;"> 0.01 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> bdi.pre </td>
   <td style="text-align:right;"> 0.64 </td>
   <td style="text-align:right;"> 0.08 </td>
   <td style="text-align:right;"> 8.25 </td>
   <td style="text-align:right;"> 102.78 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> time </td>
   <td style="text-align:right;"> -0.70 </td>
   <td style="text-align:right;"> 0.15 </td>
   <td style="text-align:right;"> -4.56 </td>
   <td style="text-align:right;"> 57.69 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> treatmentBtheB </td>
   <td style="text-align:right;"> -2.38 </td>
   <td style="text-align:right;"> 1.67 </td>
   <td style="text-align:right;"> -1.42 </td>
   <td style="text-align:right;"> 97.12 </td>
   <td style="text-align:right;"> 0.16 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> drugYes </td>
   <td style="text-align:right;"> -2.87 </td>
   <td style="text-align:right;"> 1.73 </td>
   <td style="text-align:right;"> -1.66 </td>
   <td style="text-align:right;"> 98.18 </td>
   <td style="text-align:right;"> 0.10 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> length&gt;6m </td>
   <td style="text-align:right;"> 0.14 </td>
   <td style="text-align:right;"> 1.64 </td>
   <td style="text-align:right;"> 0.09 </td>
   <td style="text-align:right;"> 100.04 </td>
   <td style="text-align:right;"> 0.93 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<sup></sup>  p values calculated using Satterthwaite d.f. </td></tr></tfoot>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Random Effects</div></th></tr>
<tr>
<th> Group </th>
   <th> Parameter </th>
   <th> Std. Dev. </th>
  </tr>
</thead>
<tbody>
<tr>
<td> subject </td>
   <td> (Intercept) </td>
   <td> 7.12 </td>
  </tr>
<tr>
<td> subject </td>
   <td> time </td>
   <td> 0.43 </td>
  </tr>
<tr>
<td> Residual </td>
   <td>  </td>
   <td> 4.90 </td>
  </tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr><th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Grouping Variables</div></th></tr>
<tr>
<th> Group </th>
   <th> # groups </th>
   <th> ICC </th>
  </tr>
</thead>
<tbody><tr>
<td> subject </td>
   <td> 97 </td>
   <td> 0.68 </td>
  </tr></tbody>
</table>
</div>
</div>
<p>The interpretation of the model outputs will be similar to the model with only random intercepts. Let us plot the data:</p>
<div class="cell" data-hash="longitudinal1_cache/html/random5_cc87e90d75a3734b7bd9200210498a02">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2"></a>BtheB_longna <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(BtheB_long)</span>
<span id="cb11-3"><a href="#cb11-3"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time=</span>BtheB_longna<span class="sc">$</span>time,<span class="at">pred=</span><span class="fu">fitted</span>(BtheB_lmer2),</span>
<span id="cb11-4"><a href="#cb11-4"></a>                  <span class="at">Subject=</span> BtheB_longna<span class="sc">$</span>subject)</span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dat,<span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>pred, <span class="at">group=</span>Subject, <span class="at">color=</span>Subject)) <span class="sc">+</span> </span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>    <span class="fu">geom_line</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="longitudinal1_files/figure-html/random5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the figure, we can see, we have different intercepts and different slopes over follow-up time for each individual.</p>
</section><section id="choice-among-models" class="level4"><h4 class="anchored" data-anchor-id="choice-among-models">Choice among models</h4>
<p>A common question is to ask should I add random slope to our model or random intercept is good enough. We may want to compare the models in terms of AIC and BIC. Smaller values indicate a better model.</p>
<ul>
<li><p><strong>lm</strong> usually will not be considered as a competitor of <strong>lme</strong> as they basically apply to different types of data.</p></li>
<li><p>When choosing between random intercept and random slope, a quick solution is to fit all possible models then do likelihood ratio tests.</p></li>
<li><p>For example, I am not sure whether I should use random intercept only or random intercept + random slope. I could fit both model, then do a likelihood ratio test:</p></li>
</ul>
<div class="cell" data-hash="longitudinal1_cache/html/model_22ffdd3681dfb4ca3f24273ae2a0b7d9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">anova</span>(BtheB_lmer1, BtheB_lmer2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["npar"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"8","2":"1887.492","3":"1916.570","4":"-935.7460","5":"1871.492","6":"NA","7":"NA","8":"NA","_rn_":"BtheB_lmer1"},{"1":"10","2":"1891.038","3":"1927.386","4":"-935.5189","5":"1871.038","6":"0.4541645","7":"2","8":"0.7968552","_rn_":"BtheB_lmer2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="do">## The non-significant p-value shows that the second model is not </span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="do">## statistically different from the first model. Therefore, adding a </span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="do">## random slope is not necessary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The p-value is greater than 0.05, which indicate that adding a random slope does not make the fitting significantly better. To keep the model simple, we may just use random intercept.</p>
</section></section><section id="prediction-of-random-effects" class="level3"><h3 class="anchored" data-anchor-id="prediction-of-random-effects">Prediction of Random Effects</h3>
<ul>
<li>Ref: <span class="citation" data-cites="hothorn2014handbook">(<a href="#ref-hothorn2014handbook" role="doc-biblioref">Hothorn and Everitt 2014</a>)</span> Section 12.5</li>
</ul>
<p>If you have noticed in the R output of linear mixed effect model. Random effects are not estimated in the model.</p>
<ul>
<li><p>We could use the fitted model to predict random effects.</p></li>
<li><p>Also, the predicted random effects can be used to examine the assumptions we have for linear mixed effect model.</p></li>
</ul>
<p>The <strong>ranef</strong> function is used to predict the random effect in R</p>
<div class="cell" data-hash="longitudinal1_cache/html/pred_956223a1a2a1dfcb862fdf962734b5a4">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>qint <span class="ot">&lt;-</span> <span class="fu">ranef</span>(BtheB_lmer1)<span class="sc">$</span>subject[[<span class="st">"(Intercept)"</span>]]</span>
<span id="cb14-2"><a href="#cb14-2"></a>qint</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#&gt;  [1] -16.36173411  -2.44276827  -3.81655251   3.05333928   3.45142248</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">#&gt;  [6]   7.76598376   2.72263773  -7.22484569   6.84680617  -1.02552084</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#&gt; [11]   2.40417048   1.16611114  -8.55346533  -6.25844483  -2.26117896</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#&gt; [16]  -5.23031336   2.52509381  -1.64263857  -1.07523649   3.93689163</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt; [21]   7.66903473 -16.38156595   1.74883174  -1.31871410  -9.02883854</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">#&gt; [26]  -2.75150756   2.38884151   2.72740404  -3.41918542   6.27519245</span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">#&gt; [31]  -4.52154811  -8.67437225  -0.34470208  -0.63972054  -0.08927194</span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">#&gt; [36]   7.61914282   2.91050412  -2.58455318   4.24637616 -16.01664364</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">#&gt; [41]   5.90993779   3.21014012  -7.04631398   3.09608824   4.71327710</span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">#&gt; [46]  16.70161338   2.26241522   2.26584476  15.77002952   1.75410838</span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co">#&gt; [51]   6.18741474   1.99791717   0.56774362   4.04107968  10.72891321</span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co">#&gt; [56]  -1.54551028  -5.28330207   2.04552526   2.36472056  -1.56879952</span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="co">#&gt; [61]   6.63565636   5.45929329  -4.19695096  -6.39632488  -2.21496288</span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="co">#&gt; [66]  -0.95956136  -3.96021851   7.17628718  -1.41644518  -4.99763144</span></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="co">#&gt; [71]  -2.83374092  -1.28015494   8.79345988  -0.33213428   1.43146353</span></span>
<span id="cb14-18"><a href="#cb14-18"></a><span class="co">#&gt; [76]  -3.13316295  -6.52989461   2.51445573   5.93415004   3.42003755</span></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="co">#&gt; [81]   4.49954804   3.75178702  -6.44832897  12.88173218  -9.36110814</span></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="co">#&gt; [86]   2.02028152 -18.09960241  -6.53428535   5.06613705  -3.31816912</span></span>
<span id="cb14-21"><a href="#cb14-21"></a><span class="co">#&gt; [91]   7.26187445   0.03103101  -8.14350181  -4.89326763   2.92437698</span></span>
<span id="cb14-22"><a href="#cb14-22"></a><span class="co">#&gt; [96]   5.24835927  -5.96778945</span></span>
<span id="cb14-23"><a href="#cb14-23"></a><span class="do">## predict random effects using the fitted model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="check-assumptions" class="level3"><h3 class="anchored" data-anchor-id="check-assumptions">Check assumptions</h3>
<p>Remember, we have two assumptions in the linear mixed effect model with random intercept:</p>
<ul>
<li>error term follows normal distribution</li>
<li>beta for subject <span class="math inline">\(i\)</span> follows normal distribution</li>
</ul>
<p>We have predict the values of random effect and we could extract residuals from the fitted model. Therefore, we can use QQ-plot to check their normality</p>
<div class="cell" data-hash="longitudinal1_cache/html/assumption_b868c68417cf5c5992f4d3fde7aa6b0f">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Assumption 1</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>qres <span class="ot">&lt;-</span> <span class="fu">residuals</span>(BtheB_lmer1)</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="fu">qqnorm</span>(qres, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>), </span>
<span id="cb15-4"><a href="#cb15-4"></a>       <span class="at">ylab =</span> <span class="st">"Estimated residuals"</span>,</span>
<span id="cb15-5"><a href="#cb15-5"></a>       <span class="at">main =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="fu">qqline</span>(qres)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="longitudinal1_files/figure-html/assumption-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co"># Assumption 2</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>qint <span class="ot">&lt;-</span> <span class="fu">ranef</span>(BtheB_lmer1)<span class="sc">$</span>subject[[<span class="st">"(Intercept)"</span>]]</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="fu">qqnorm</span>(qint, <span class="at">ylab =</span> <span class="st">"Estimated random intercepts"</span>, </span>
<span id="cb16-5"><a href="#cb16-5"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>),</span>
<span id="cb16-6"><a href="#cb16-6"></a>       <span class="at">main =</span> <span class="st">"Random intercepts"</span>)</span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="fu">qqline</span>(qint)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="longitudinal1_files/figure-html/assumption-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Since points are almost on the lines, we can say that the normality assumption is met.</p>
</section><section id="video-content-optional" class="level3"><h3 class="anchored" data-anchor-id="video-content-optional">Video content (optional)</h3>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For those who prefer a video walkthrough, feel free to watch the video below, which offers a description of an earlier version of the above content.</p>
</div>
</div>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
<iframe src="https://www.youtube.com/embed/kocX69kMX0s" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen="">
</iframe>
</div>
</section><section id="reference" class="level3"><h3 class="anchored" data-anchor-id="reference">Reference</h3>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-faraway2016extending" class="csl-entry" role="doc-biblioentry">
Faraway, Julian J. 2016. <em><span class="nocase">Extending the linear model with R: generalized linear, mixed effects and nonparametric regression models</span></em>. CRC press.
</div>
<div id="ref-hothorn2014handbook" class="csl-entry" role="doc-biblioentry">
Hothorn, Torsten, and Brian S Everitt. 2014. <em>A Handbook of Statistical Analyses Using r</em>. CRC press.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./longitudinal0.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Concepts (T)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./longitudinal2.html" class="pagination-link">
        <span class="nav-page-text">GEE</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>