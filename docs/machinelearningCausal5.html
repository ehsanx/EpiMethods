<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Advanced Epidemiological Methods - Comparing results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./machinelearningCausalF.html" rel="next">
<link href="./machinelearningCausal4.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CVBPG0RQMY"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-CVBPG0RQMY', { 'anonymize_ip': true});
</script><link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="site_libs/tabwid-1.1.3/tabwid.js"></script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta name="twitter:title" content="Advanced Epidemiological Methods - Comparing results">
<meta name="twitter:description" content="In this tutorial, we will use the RHC dataset in exploring the relationship between RHC (yes/no) and death (yes/no). We will use the following approaches:">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-sidebar docked">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Comparing results</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Epidemiological Methods</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">The Project</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./wrangling.html" class="sidebar-item-text sidebar-link">Data wrangling</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1a.html" class="sidebar-item-text sidebar-link">R basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1b.html" class="sidebar-item-text sidebar-link">Data types</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1c.html" class="sidebar-item-text sidebar-link">Automating tasks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling2.html" class="sidebar-item-text sidebar-link">Importing dataset</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling3.html" class="sidebar-item-text sidebar-link">Data manipulation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling4.html" class="sidebar-item-text sidebar-link">Import external data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling5.html" class="sidebar-item-text sidebar-link">Summary tables</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling6.html" class="sidebar-item-text sidebar-link">R Markdown</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingF.html" class="sidebar-item-text sidebar-link">R Functions (W)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingQ.html" class="sidebar-item-text sidebar-link">Quiz (W)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingE.html" class="sidebar-item-text sidebar-link">Exercise (W)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./accessing.html" class="sidebar-item-text sidebar-link">Data accessing</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing0.html" class="sidebar-item-text sidebar-link">Concepts (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing1.html" class="sidebar-item-text sidebar-link">Survey data sources</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing1i.html" class="sidebar-item-text sidebar-link">Descriptions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing2.html" class="sidebar-item-text sidebar-link">Importing CCHS to R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing3.html" class="sidebar-item-text sidebar-link">Importing NHANES to R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing4.html" class="sidebar-item-text sidebar-link">Reproducing results</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing5.html" class="sidebar-item-text sidebar-link">Importing NHIS to R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingF.html" class="sidebar-item-text sidebar-link">R Functions (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingQ.html" class="sidebar-item-text sidebar-link">Quiz (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingE.html" class="sidebar-item-text sidebar-link">Exercise (A)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./researchquestion.html" class="sidebar-item-text sidebar-link">Research questions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion0.html" class="sidebar-item-text sidebar-link">Concepts (Q)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion1.html" class="sidebar-item-text sidebar-link">Predictive question-1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion2a.html" class="sidebar-item-text sidebar-link">Predictive question-2a</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion2b.html" class="sidebar-item-text sidebar-link">Predictive question-2b</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion3.html" class="sidebar-item-text sidebar-link">Causal question-1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion4.html" class="sidebar-item-text sidebar-link">Causal question-2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestionF.html" class="sidebar-item-text sidebar-link">R functions (Q)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestionQ.html" class="sidebar-item-text sidebar-link">Quiz (Q)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./confounding.html" class="sidebar-item-text sidebar-link">Causal roles</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding0.html" class="sidebar-item-text sidebar-link">Concepts (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding1.html" class="sidebar-item-text sidebar-link">Confounding</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding2.html" class="sidebar-item-text sidebar-link">Mediator</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding3.html" class="sidebar-item-text sidebar-link">Collider</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding4.html" class="sidebar-item-text sidebar-link">Z-bias</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding5.html" class="sidebar-item-text sidebar-link">Collapsibility</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding6.html" class="sidebar-item-text sidebar-link">Change-in-estimate</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confoundingF.html" class="sidebar-item-text sidebar-link">R functions (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confoundingQ.html" class="sidebar-item-text sidebar-link">Quiz (R)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./predictivefactors.html" class="sidebar-item-text sidebar-link">Prediction ideas</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors0.html" class="sidebar-item-text sidebar-link">Concepts (P)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors1.html" class="sidebar-item-text sidebar-link">Collinear predictors</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors2.html" class="sidebar-item-text sidebar-link">Continuous outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors3.html" class="sidebar-item-text sidebar-link">Binary outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors4.html" class="sidebar-item-text sidebar-link">Overfitting and performance</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors5.html" class="sidebar-item-text sidebar-link">Data spliting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors6.html" class="sidebar-item-text sidebar-link">Cross-validation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors7.html" class="sidebar-item-text sidebar-link">Bootstrap</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactorsF.html" class="sidebar-item-text sidebar-link">R functions (P)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactorsQ.html" class="sidebar-item-text sidebar-link">Quiz (P)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./surveydata.html" class="sidebar-item-text sidebar-link">Survey data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata0.html" class="sidebar-item-text sidebar-link">Concepts (D)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata1.html" class="sidebar-item-text sidebar-link">CCHS: Revisiting PICOT</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata2.html" class="sidebar-item-text sidebar-link">CCHS: Assessing data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata3.html" class="sidebar-item-text sidebar-link">CCHS: Bivariate analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata4.html" class="sidebar-item-text sidebar-link">CCHS: Regression</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata5.html" class="sidebar-item-text sidebar-link">CCHS: Performance</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata6.html" class="sidebar-item-text sidebar-link">NHANES: Blood Pressure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata7.html" class="sidebar-item-text sidebar-link">NHANES: Cholesterol</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata8.html" class="sidebar-item-text sidebar-link">NHANES: Subsetting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataF.html" class="sidebar-item-text sidebar-link">R functions (D)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataQ.html" class="sidebar-item-text sidebar-link">Quiz (D)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataE.html" class="sidebar-item-text sidebar-link">Exercise (D)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./missingdata.html" class="sidebar-item-text sidebar-link">Missing data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata0.html" class="sidebar-item-text sidebar-link">Concepts (M)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata1.html" class="sidebar-item-text sidebar-link">Imputation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata2.html" class="sidebar-item-text sidebar-link">Imputation in NHANES</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata3.html" class="sidebar-item-text sidebar-link">Missing in outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata4.html" class="sidebar-item-text sidebar-link">Performance with NA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata5.html" class="sidebar-item-text sidebar-link">Subpopulations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata6.html" class="sidebar-item-text sidebar-link">MCAR tests</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata7.html" class="sidebar-item-text sidebar-link">Effect modification</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataF.html" class="sidebar-item-text sidebar-link">R functions (M)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataQ.html" class="sidebar-item-text sidebar-link">Quiz (M)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataE.html" class="sidebar-item-text sidebar-link">Exercise (M)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./propensityscore.html" class="sidebar-item-text sidebar-link">Propensity score</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore0.html" class="sidebar-item-text sidebar-link">Concepts (S)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore1.html" class="sidebar-item-text sidebar-link">Exact Matching (CCHS)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore2.html" class="sidebar-item-text sidebar-link">PSM in OA-CVD (CCHS)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore3.html" class="sidebar-item-text sidebar-link">PSM in OA-CVD (US)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore4.html" class="sidebar-item-text sidebar-link">PSM in BMI-diabetes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore5.html" class="sidebar-item-text sidebar-link">PSM with MI</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreF.html" class="sidebar-item-text sidebar-link">R functions (S)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreQ.html" class="sidebar-item-text sidebar-link">Quiz (S)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreE.html" class="sidebar-item-text sidebar-link">Exercise (S)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./machinelearning.html" class="sidebar-item-text sidebar-link">Machine learning (ML)</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning0.html" class="sidebar-item-text sidebar-link">Concepts (L)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning1.html" class="sidebar-item-text sidebar-link">Continuous outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning2.html" class="sidebar-item-text sidebar-link">Data spliting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning3.html" class="sidebar-item-text sidebar-link">Cross-validation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning4.html" class="sidebar-item-text sidebar-link">Binary outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning5.html" class="sidebar-item-text sidebar-link">Supervised learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning6.html" class="sidebar-item-text sidebar-link">Unsupervised learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning6a.html" class="sidebar-item-text sidebar-link">NHIS Example</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning6b.html" class="sidebar-item-text sidebar-link">Replicate Results</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningF.html" class="sidebar-item-text sidebar-link">R functions (L)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./machinelearningCausal.html" class="sidebar-item-text sidebar-link">ML in causal inference</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal0.html" class="sidebar-item-text sidebar-link">Concepts (C)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal1.html" class="sidebar-item-text sidebar-link">Motivation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal2.html" class="sidebar-item-text sidebar-link">SuperLearner</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal3.html" class="sidebar-item-text sidebar-link">Binary Outcomes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal4.html" class="sidebar-item-text sidebar-link">Continuous Outcomes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausal5.html" class="sidebar-item-text sidebar-link active">Comparing results</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausalF.html" class="sidebar-item-text sidebar-link">R functions (C)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./nonbinary.html" class="sidebar-item-text sidebar-link">Complex outcomes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary0.html" class="sidebar-item-text sidebar-link">Concepts (N)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary1.html" class="sidebar-item-text sidebar-link">Polytomous and ordinal</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary2.html" class="sidebar-item-text sidebar-link">Survival analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary3.html" class="sidebar-item-text sidebar-link">Poisson</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinaryF.html" class="sidebar-item-text sidebar-link">R functions (N)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinaryQ.html" class="sidebar-item-text sidebar-link">Quiz (N)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./longitudinal.html" class="sidebar-item-text sidebar-link">Longitudinal data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal0.html" class="sidebar-item-text sidebar-link">Concepts (T)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal1.html" class="sidebar-item-text sidebar-link">Mixed effects models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal2.html" class="sidebar-item-text sidebar-link">GEE</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinalF.html" class="sidebar-item-text sidebar-link">R functions (T)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinalQ.html" class="sidebar-item-text sidebar-link">Quiz (T)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./mediation.html" class="sidebar-item-text sidebar-link">Mediation analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation0.html" class="sidebar-item-text sidebar-link">Concepts (I)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation1.html" class="sidebar-item-text sidebar-link">Baron and Kenny</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation2.html" class="sidebar-item-text sidebar-link">Justification</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation3.html" class="sidebar-item-text sidebar-link">Mediation Example</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediationF.html" class="sidebar-item-text sidebar-link">R functions (I)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediationQ.html" class="sidebar-item-text sidebar-link">Quiz (I)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./reporting.html" class="sidebar-item-text sidebar-link">Writing tools</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reporting1.html" class="sidebar-item-text sidebar-link">Collaborative Writing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reporting2.html" class="sidebar-item-text sidebar-link">Formatting Tools</a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#load-packages" id="toc-load-packages" class="nav-link active" data-scroll-target="#load-packages">Load packages</a></li>
  <li><a href="#load-dataset" id="toc-load-dataset" class="nav-link" data-scroll-target="#load-dataset">Load dataset</a></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">Logistic regression</a></li>
  <li><a href="#propensity-score-matching-with-logistic-regression" id="toc-propensity-score-matching-with-logistic-regression" class="nav-link" data-scroll-target="#propensity-score-matching-with-logistic-regression">Propensity score matching with logistic regression</a></li>
  <li><a href="#propensity-score-weighting-with-logistic-regression" id="toc-propensity-score-weighting-with-logistic-regression" class="nav-link" data-scroll-target="#propensity-score-weighting-with-logistic-regression">Propensity score weighting with logistic regression</a></li>
  <li><a href="#propensity-score-matching-with-super-learner" id="toc-propensity-score-matching-with-super-learner" class="nav-link" data-scroll-target="#propensity-score-matching-with-super-learner">Propensity score matching with super learner</a></li>
  <li><a href="#propensity-score-weighting-with-super-learner" id="toc-propensity-score-weighting-with-super-learner" class="nav-link" data-scroll-target="#propensity-score-weighting-with-super-learner">Propensity score weighting with super learner</a></li>
  <li><a href="#tmle" id="toc-tmle" class="nav-link" data-scroll-target="#tmle">TMLE</a></li>
  <li><a href="#results-comparison" id="toc-results-comparison" class="nav-link" data-scroll-target="#results-comparison">Results comparison</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">Comparing results</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>In this tutorial, we will use the RHC dataset in exploring the relationship between RHC (yes/no) and death (yes/no). We will use the following approaches:</p>
<ul>
<li>logistic regression</li>
<li>propensity score matching and weighting with logistic regression</li>
<li>propensity score matching and weighting with Super Learner</li>
<li>TMLE</li>
</ul>
<section id="load-packages" class="level3"><h3 class="anchored" data-anchor-id="load-packages">Load packages</h3>
<p>We load several R packages required for fitting the models.</p>
<div class="cell" data-hash="machinelearningCausal5_cache/html/setup_12a6f9d508d055e19ce23c8cc9a591d7">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Load required packages</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tableone)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(Publish)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(tmle)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(SuperLearner)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(dbarts)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">library</span>(MatchIt)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu">library</span>(cobalt)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu">library</span>(survey)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu">library</span>(knitr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="load-dataset" class="level3"><h3 class="anchored" data-anchor-id="load-dataset">Load dataset</h3>
<div class="cell" data-hash="machinelearningCausal5_cache/html/data_92977a4fd9d3db59a9e3ed688453a9be">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"Data/machinelearningCausal/cl2.RData"</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">ls</span>()</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; [1] "baselinevars"    "has_annotations" "ObsData"         "tab0"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="machinelearningCausal5_cache/html/data2_6e0cf85d523baf03d2d247d2ccdd310b">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Data</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>dat <span class="ot">&lt;-</span> ObsData</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">head</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Disease.category"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Cancer"],"name":[2],"type":["fct"],"align":["left"]},{"label":["Cardiovascular"],"name":[3],"type":["fct"],"align":["left"]},{"label":["Congestive.HF"],"name":[4],"type":["fct"],"align":["left"]},{"label":["Dementia"],"name":[5],"type":["fct"],"align":["left"]},{"label":["Psychiatric"],"name":[6],"type":["fct"],"align":["left"]},{"label":["Pulmonary"],"name":[7],"type":["fct"],"align":["left"]},{"label":["Renal"],"name":[8],"type":["fct"],"align":["left"]},{"label":["Hepatic"],"name":[9],"type":["fct"],"align":["left"]},{"label":["GI.Bleed"],"name":[10],"type":["fct"],"align":["left"]},{"label":["Tumor"],"name":[11],"type":["fct"],"align":["left"]},{"label":["Immunosupperssion"],"name":[12],"type":["fct"],"align":["left"]},{"label":["Transfer.hx"],"name":[13],"type":["fct"],"align":["left"]},{"label":["MI"],"name":[14],"type":["fct"],"align":["left"]},{"label":["age"],"name":[15],"type":["fct"],"align":["left"]},{"label":["sex"],"name":[16],"type":["fct"],"align":["left"]},{"label":["edu"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["DASIndex"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["APACHE.score"],"name":[19],"type":["int"],"align":["right"]},{"label":["Glasgow.Coma.Score"],"name":[20],"type":["int"],"align":["right"]},{"label":["blood.pressure"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["WBC"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["Heart.rate"],"name":[23],"type":["int"],"align":["right"]},{"label":["Respiratory.rate"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["Temperature"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["PaO2vs.FIO2"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["Albumin"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["Hematocrit"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["Bilirubin"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["Creatinine"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["Sodium"],"name":[31],"type":["int"],"align":["right"]},{"label":["Potassium"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["PaCo2"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["PH"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["Weight"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["DNR.status"],"name":[36],"type":["fct"],"align":["left"]},{"label":["Medical.insurance"],"name":[37],"type":["fct"],"align":["left"]},{"label":["Respiratory.Diag"],"name":[38],"type":["fct"],"align":["left"]},{"label":["Cardiovascular.Diag"],"name":[39],"type":["fct"],"align":["left"]},{"label":["Neurological.Diag"],"name":[40],"type":["fct"],"align":["left"]},{"label":["Gastrointestinal.Diag"],"name":[41],"type":["fct"],"align":["left"]},{"label":["Renal.Diag"],"name":[42],"type":["fct"],"align":["left"]},{"label":["Metabolic.Diag"],"name":[43],"type":["fct"],"align":["left"]},{"label":["Hematologic.Diag"],"name":[44],"type":["fct"],"align":["left"]},{"label":["Sepsis.Diag"],"name":[45],"type":["fct"],"align":["left"]},{"label":["Trauma.Diag"],"name":[46],"type":["fct"],"align":["left"]},{"label":["Orthopedic.Diag"],"name":[47],"type":["fct"],"align":["left"]},{"label":["race"],"name":[48],"type":["fct"],"align":["left"]},{"label":["income"],"name":[49],"type":["fct"],"align":["left"]},{"label":["Length.of.Stay"],"name":[50],"type":["int"],"align":["right"]},{"label":["Death"],"name":[51],"type":["dbl"],"align":["right"]},{"label":["RHC.use"],"name":[52],"type":["dbl"],"align":["right"]}],"data":[{"1":"Other","2":"Localized (Yes)","3":"0","4":"0","5":"0","6":"0","7":"1","8":"0","9":"0","10":"0","11":"1","12":"0","13":"0","14":"0","15":"[70,80)","16":"Male","17":"12.000000","18":"23.50000","19":"46","20":"0","21":"41","22":"22.09765620","23":"124","24":"10","25":"38.69531","26":"68.0000","27":"3.500000","28":"58.00000","29":"1.0097656","30":"1.1999512","31":"145","32":"4.000000","33":"40","34":"7.359375","35":"64.69995","36":"No","37":"Medicare","38":"Yes","39":"Yes","40":"No","41":"No","42":"No","43":"No","44":"No","45":"No","46":"No","47":"No","48":"white","49":"Under $11k","50":"9","51":"0","52":"0","_rn_":"1"},{"1":"MOSF","2":"None","3":"1","4":"1","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"1","13":"1","14":"0","15":"[70,80)","16":"Female","17":"12.000000","18":"14.75195","19":"50","20":"0","21":"63","22":"28.89843750","23":"137","24":"38","25":"38.89844","26":"218.3125","27":"2.599609","28":"32.50000","29":"0.6999512","30":"0.5999756","31":"137","32":"3.299805","33":"34","34":"7.329102","35":"45.69998","36":"No","37":"Private & Medicare","38":"No","39":"No","40":"No","41":"No","42":"No","43":"No","44":"No","45":"Yes","46":"No","47":"No","48":"white","49":"Under $11k","50":"45","51":"1","52":"1","_rn_":"2"},{"1":"MOSF","2":"Localized (Yes)","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"1","12":"1","13":"0","14":"0","15":"[-Inf,50)","16":"Female","17":"14.069916","18":"18.13672","19":"82","20":"0","21":"57","22":"0.04999542","23":"130","24":"40","25":"36.39844","26":"275.5000","27":"3.500000","28":"21.09766","29":"1.0097656","30":"2.5996094","31":"146","32":"2.899902","33":"16","34":"7.359375","35":"0.00000","36":"No","37":"Private","38":"No","39":"Yes","40":"No","41":"No","42":"No","43":"No","44":"No","45":"No","46":"No","47":"No","48":"white","49":"$25-$50k","50":"60","51":"0","52":"1","_rn_":"3"},{"1":"ARF","2":"None","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"1","13":"0","14":"0","15":"[70,80)","16":"Female","17":"9.000000","18":"22.92969","19":"48","20":"0","21":"55","22":"23.29687500","23":"58","24":"26","25":"35.79688","26":"156.6562","27":"3.500000","28":"26.29688","29":"0.3999634","30":"1.6999512","31":"117","32":"5.799805","33":"30","34":"7.459961","35":"54.59998","36":"No","37":"Private & Medicare","38":"Yes","39":"No","40":"No","41":"No","42":"No","43":"No","44":"No","45":"No","46":"No","47":"No","48":"white","49":"$11-$25k","50":"37","51":"1","52":"0","_rn_":"4"},{"1":"MOSF","2":"None","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"[60,70)","16":"Male","17":"9.945259","18":"21.05078","19":"72","20":"41","21":"65","22":"29.69921880","23":"125","24":"27","25":"34.79688","26":"478.0000","27":"3.500000","28":"24.00000","29":"1.0097656","30":"3.5996094","31":"126","32":"5.799805","33":"17","34":"7.229492","35":"78.39996","36":"Yes","37":"Medicare","38":"No","39":"Yes","40":"No","41":"No","42":"No","43":"No","44":"No","45":"No","46":"No","47":"No","48":"white","49":"Under $11k","50":"2","51":"1","52":"1","_rn_":"5"},{"1":"Other","2":"None","3":"0","4":"1","5":"0","6":"0","7":"1","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"[80, Inf)","16":"Female","17":"8.000000","18":"17.50000","19":"38","20":"0","21":"115","22":"18.00000000","23":"134","24":"36","25":"39.19531","26":"184.1875","27":"3.099609","28":"30.50000","29":"1.0097656","30":"1.3999023","31":"138","32":"5.399414","33":"68","34":"7.299805","35":"54.89999","36":"No","37":"Medicare","38":"Yes","39":"No","40":"No","41":"No","42":"No","43":"No","44":"No","45":"No","46":"No","47":"No","48":"white","49":"Under $11k","50":"7","51":"0","52":"0","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># Data dimension</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="fu">dim</span>(dat)</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt; [1] 5735   52</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Confounder list in the <code>baselinevars</code> vector is</p>
<div class="cell" data-hash="machinelearningCausal5_cache/html/data2x_b3f517296694d126af93c462837b0d0b">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;">Confounders</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Disease.category</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cancer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cardiovascular</td>
</tr>
<tr class="even">
<td style="text-align: left;">Congestive.HF</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dementia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pulmonary</td>
</tr>
<tr class="even">
<td style="text-align: left;">Renal</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hepatic</td>
</tr>
<tr class="even">
<td style="text-align: left;">GI.Bleed</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tumor</td>
</tr>
<tr class="even">
<td style="text-align: left;">Immunosupperssion</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Transfer.hx</td>
</tr>
<tr class="even">
<td style="text-align: left;">MI</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex</td>
</tr>
<tr class="odd">
<td style="text-align: left;">edu</td>
</tr>
<tr class="even">
<td style="text-align: left;">DASIndex</td>
</tr>
<tr class="odd">
<td style="text-align: left;">APACHE.score</td>
</tr>
<tr class="even">
<td style="text-align: left;">Glasgow.Coma.Score</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blood.pressure</td>
</tr>
<tr class="even">
<td style="text-align: left;">WBC</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Heart.rate</td>
</tr>
<tr class="even">
<td style="text-align: left;">Respiratory.rate</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Temperature</td>
</tr>
<tr class="even">
<td style="text-align: left;">PaO2vs.FIO2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Albumin</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hematocrit</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bilirubin</td>
</tr>
<tr class="even">
<td style="text-align: left;">Creatinine</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sodium</td>
</tr>
<tr class="even">
<td style="text-align: left;">Potassium</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PaCo2</td>
</tr>
<tr class="even">
<td style="text-align: left;">PH</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Weight</td>
</tr>
<tr class="even">
<td style="text-align: left;">DNR.status</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Medical.insurance</td>
</tr>
<tr class="even">
<td style="text-align: left;">Respiratory.Diag</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cardiovascular.Diag</td>
</tr>
<tr class="even">
<td style="text-align: left;">Neurological.Diag</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gastrointestinal.Diag</td>
</tr>
<tr class="even">
<td style="text-align: left;">Renal.Diag</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Metabolic.Diag</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hematologic.Diag</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sepsis.Diag</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trauma.Diag</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Orthopedic.Diag</td>
</tr>
<tr class="even">
<td style="text-align: left;">race</td>
</tr>
<tr class="odd">
<td style="text-align: left;">income</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="logistic-regression" class="level3"><h3 class="anchored" data-anchor-id="logistic-regression">Logistic regression</h3>
<p>Let us define the regression formula and fit logistic regression, adjusting for baseline confounders.</p>
<div class="cell" data-hash="machinelearningCausal5_cache/html/logistic_dadcad3d7ba617f01a348f5449b2da30">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Formula</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>Formula <span class="ot">&lt;-</span> <span class="fu">formula</span>(<span class="fu">paste</span>(<span class="st">"Death ~ RHC.use + "</span>, </span>
<span id="cb5-3"><a href="#cb5-3"></a>                         <span class="fu">paste</span>(baselinevars, </span>
<span id="cb5-4"><a href="#cb5-4"></a>                               <span class="at">collapse =</span> <span class="st">" + "</span>)))</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co"># Logistic regression</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>fit.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(Formula, </span>
<span id="cb5-8"><a href="#cb5-8"></a>               <span class="at">data =</span> dat, </span>
<span id="cb5-9"><a href="#cb5-9"></a>               <span class="at">family =</span> binomial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can use <code>flextable</code> package to view <code>fit.glm</code>, the regression output:</p>
<div class="cell" data-caption="Your Table Title" data-hash="machinelearningCausal5_cache/html/unnamed-chunk-1_75d6e76c6f45f65b11a4dafe0daf4ec7">
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-b2d52732{table-layout:auto;width:50%;}.cl-b2cbd1fa{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b2cf7c42{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b2cf9b3c{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b2cf9b46{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-b2d52732">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-b2cf9b3c"><p class="cl-b2cf7c42"><span class="cl-b2cbd1fa">Variable</span></p></th>
<th class="cl-b2cf9b3c"><p class="cl-b2cf7c42"><span class="cl-b2cbd1fa">Odds_Ratio</span></p></th>
<th class="cl-b2cf9b3c"><p class="cl-b2cf7c42"><span class="cl-b2cbd1fa">CI_Lower</span></p></th>
<th class="cl-b2cf9b3c"><p class="cl-b2cf7c42"><span class="cl-b2cbd1fa">CI_Upper</span></p></th>
</tr></thead>
<tbody><tr style="overflow-wrap:break-word;">
<td class="cl-b2cf9b46"><p class="cl-b2cf7c42"><span class="cl-b2cbd1fa">RHC.use</span></p></td>
<td class="cl-b2cf9b46"><p class="cl-b2cf7c42"><span class="cl-b2cbd1fa">1.42</span></p></td>
<td class="cl-b2cf9b46"><p class="cl-b2cf7c42"><span class="cl-b2cbd1fa">1.23</span></p></td>
<td class="cl-b2cf9b46"><p class="cl-b2cf7c42"><span class="cl-b2cbd1fa">1.65</span></p></td>
</tr></tbody>
</table>
</div>
</div>
</div>
<p>As we can see, the odds of death was 42% higher among those participants with RHC use than those with no RHC use.</p>
</section><section id="propensity-score-matching-with-logistic-regression" class="level3"><h3 class="anchored" data-anchor-id="propensity-score-matching-with-logistic-regression">Propensity score matching with logistic regression</h3>
<p>Now we will use propensity score matching, where propensity score will be estimated using logistic regression. The first step is to define the propensity score formula and estimate the propensity scores.</p>
<section id="step-1" class="level4"><h4 class="anchored" data-anchor-id="step-1">Step 1</h4>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psml1_e861ae90ab9b8a0f84cc02d1c035c5c2">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Propensity score model define</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>ps.formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"RHC.use ~ "</span>, </span>
<span id="cb6-3"><a href="#cb6-3"></a>                                <span class="fu">paste</span>(baselinevars, </span>
<span id="cb6-4"><a href="#cb6-4"></a>                                      <span class="at">collapse =</span> <span class="st">"+"</span>)))</span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co"># Propensity score model fitting</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>fit.ps <span class="ot">&lt;-</span> <span class="fu">glm</span>(ps.formula, </span>
<span id="cb6-8"><a href="#cb6-8"></a>              <span class="at">data =</span> dat, </span>
<span id="cb6-9"><a href="#cb6-9"></a>              <span class="at">family =</span> binomial)</span>
<span id="cb6-10"><a href="#cb6-10"></a></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co"># Propensity scores</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>dat<span class="sc">$</span>ps <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit.ps, </span>
<span id="cb6-13"><a href="#cb6-13"></a>                  <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="fu">summary</span>(dat<span class="sc">$</span>ps)</span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">#&gt; 0.002478 0.161446 0.358300 0.380819 0.574319 0.968425</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="step-2" class="level4"><h4 class="anchored" data-anchor-id="step-2">Step 2</h4>
<p>The second step is to match exposed (i.e., RHC users) to unexposed (i.e., RHC non-users) based on the propensity scores. We will use nearest neighborhood and caliper approach.</p>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psml2a_64dc1b777968c9b866f816976b2257f1">

</div>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psml2b_23bbf062e274a914f181e27ccdd16a49">

</div>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psml2c_eb10a16190211da92319445117c70705">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Caliper</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>caliper <span class="ot">&lt;-</span> <span class="fl">0.2</span><span class="sc">*</span><span class="fu">sd</span>(<span class="fu">log</span>(dat<span class="sc">$</span>ps<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>dat<span class="sc">$</span>ps)))</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># 1:1 matching</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a>match.obj <span class="ot">&lt;-</span> <span class="fu">matchit</span>(ps.formula, </span>
<span id="cb7-7"><a href="#cb7-7"></a>                     <span class="at">data =</span> dat,</span>
<span id="cb7-8"><a href="#cb7-8"></a>                     <span class="at">distance =</span> dat<span class="sc">$</span>ps, </span>
<span id="cb7-9"><a href="#cb7-9"></a>                     <span class="at">method =</span> <span class="st">"nearest"</span>,</span>
<span id="cb7-10"><a href="#cb7-10"></a>                     <span class="at">ratio =</span> <span class="dv">1</span>,</span>
<span id="cb7-11"><a href="#cb7-11"></a>                     <span class="at">caliper =</span> caliper)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psml2d_325207ab81ead1ccef3bef28e2fbf5cb">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># See how many matched</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>match.obj </span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">#&gt; A matchit object</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt;  - method: 1:1 nearest neighbor matching without replacement</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt;  - distance: User-defined [caliper]</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt;  - caliper: &lt;distance&gt; (0.068)</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt;  - number of obs.: 5735 (original), 3478 (matched)</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt;  - target estimand: ATT</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt;  - covariates: too many to name</span></span>
<span id="cb8-10"><a href="#cb8-10"></a></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co"># Extract matched data</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>matched.data <span class="ot">&lt;-</span> <span class="fu">match.data</span>(match.obj)</span>
<span id="cb8-13"><a href="#cb8-13"></a></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co"># Overlap checking</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="fu">bal.plot</span>(match.obj,</span>
<span id="cb8-16"><a href="#cb8-16"></a>         <span class="at">var.name=</span><span class="st">"distance"</span>,</span>
<span id="cb8-17"><a href="#cb8-17"></a>         <span class="at">which=</span><span class="st">"both"</span>,</span>
<span id="cb8-18"><a href="#cb8-18"></a>         <span class="at">type =</span> <span class="st">"density"</span>,</span>
<span id="cb8-19"><a href="#cb8-19"></a>         <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="machinelearningCausal5_files/figure-html/psml2d-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="step-3" class="level4"><h4 class="anchored" data-anchor-id="step-3">Step 3</h4>
<p>The third step is to check the balancing on the matched data. We will compare the similarity of baseline characteristics between RHC users and non-users in the propensity score matched sample. Lets consider SMD &gt;0.1 as imbalanced.</p>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psml3_d811f0fbeabcdf8e4db86920e4910959">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Balance checking in terms of SMD - using love plot</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">love.plot</span>(match.obj, </span>
<span id="cb9-3"><a href="#cb9-3"></a>          <span class="at">binary =</span> <span class="st">"std"</span>, </span>
<span id="cb9-4"><a href="#cb9-4"></a>          <span class="at">grid =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-5"><a href="#cb9-5"></a>          <span class="at">thresholds =</span> <span class="fu">c</span>(<span class="at">m =</span> .<span class="dv">1</span>),</span>
<span id="cb9-6"><a href="#cb9-6"></a>          <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="machinelearningCausal5_files/figure-html/psml3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co"># Balance checking in terms of SMD - using tableone</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>tab1b <span class="ot">&lt;-</span> <span class="fu">CreateTableOne</span>(<span class="at">vars =</span> baselinevars, <span class="at">strata =</span> <span class="st">"RHC.use"</span>, </span>
<span id="cb10-4"><a href="#cb10-4"></a>                        <span class="at">data =</span> matched.data, <span class="at">includeNA =</span> T,</span>
<span id="cb10-5"><a href="#cb10-5"></a>                        <span class="at">addOverall =</span> F, <span class="at">test =</span> F)</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#print(tab1b, showAllLevels = T, catDigits = 2, smd = T)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>ExtractSmd(tab1b)</code> shows</p>
<div class="cell" data-caption="Your Table Title" data-hash="machinelearningCausal5_cache/html/unnamed-chunk-2_7a10af6977073227e8dda76768136129">
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-f2c64512{}.cl-f2bab012{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f2bf7bba{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f2bf7bce{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f2bfa5f4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2bfa608{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2bfa609{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2bfa612{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2bfa613{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2bfa61c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-f2c64512">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-f2bfa5f4"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Variables</span></p></th>
<th class="cl-f2bfa608"><p class="cl-f2bf7bce"><span class="cl-f2bab012">1 vs 2</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Disease.category</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.06</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Cancer</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Cardiovascular</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Congestive.HF</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Dementia</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Psychiatric</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Pulmonary</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Renal</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Hepatic</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">GI.Bleed</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Tumor</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Immunosupperssion</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Transfer.hx</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">MI</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">age</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">sex</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">edu</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">DASIndex</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">APACHE.score</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.08</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Glasgow.Coma.Score</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">blood.pressure</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.07</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">WBC</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Heart.rate</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Respiratory.rate</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Temperature</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">PaO2vs.FIO2</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.06</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Albumin</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Hematocrit</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Bilirubin</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Creatinine</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Sodium</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Potassium</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">PaCo2</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">PH</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Weight</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">DNR.status</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Medical.insurance</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.06</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Respiratory.Diag</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.06</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Cardiovascular.Diag</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Neurological.Diag</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Gastrointestinal.Diag</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Renal.Diag</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Metabolic.Diag</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Hematologic.Diag</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Sepsis.Diag</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Trauma.Diag</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">Orthopedic.Diag</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa609"><p class="cl-f2bf7bba"><span class="cl-f2bab012">race</span></p></td>
<td class="cl-f2bfa612"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-f2bfa613"><p class="cl-f2bf7bba"><span class="cl-f2bab012">income</span></p></td>
<td class="cl-f2bfa61c"><p class="cl-f2bf7bce"><span class="cl-f2bab012">0.06</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>After propensity score matching, all the confounders are balanced in terms of SMD. Now, we will fit the outcome model on the matched data.</p>
</section><section id="step-4" class="level4"><h4 class="anchored" data-anchor-id="step-4">Step 4</h4>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psml4_c8499cd46e30926a95b40aaf3a61ad78">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>fit.psm <span class="ot">&lt;-</span> <span class="fu">glm</span>(Death <span class="sc">~</span> RHC.use, </span>
<span id="cb11-2"><a href="#cb11-2"></a>               <span class="at">data =</span> matched.data, </span>
<span id="cb11-3"><a href="#cb11-3"></a>               <span class="at">family =</span> binomial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Summary of <code>fit.psm</code>:</p>
<div class="cell" data-caption="Your Table Title" data-hash="machinelearningCausal5_cache/html/unnamed-chunk-3_0aad1600bbfa18f1e525698922869056">
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-b30f6fdc{table-layout:auto;width:50%;}.cl-b306a32a{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b30a19f6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b30a31ca{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b30a31d4{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-b30f6fdc">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-b30a31ca"><p class="cl-b30a19f6"><span class="cl-b306a32a">Variable</span></p></th>
<th class="cl-b30a31ca"><p class="cl-b30a19f6"><span class="cl-b306a32a">Odds_Ratio</span></p></th>
<th class="cl-b30a31ca"><p class="cl-b30a19f6"><span class="cl-b306a32a">CI_Lower</span></p></th>
<th class="cl-b30a31ca"><p class="cl-b30a19f6"><span class="cl-b306a32a">CI_Upper</span></p></th>
</tr></thead>
<tbody><tr style="overflow-wrap:break-word;">
<td class="cl-b30a31d4"><p class="cl-b30a19f6"><span class="cl-b306a32a">RHC.use</span></p></td>
<td class="cl-b30a31d4"><p class="cl-b30a19f6"><span class="cl-b306a32a">1.29</span></p></td>
<td class="cl-b30a31d4"><p class="cl-b30a19f6"><span class="cl-b306a32a">1.12</span></p></td>
<td class="cl-b30a31d4"><p class="cl-b30a19f6"><span class="cl-b306a32a">1.48</span></p></td>
</tr></tbody>
</table>
</div>
</div>
</div>
<p>In the propensity score matched data, the odds of death was 29% higher among those participants with RHC use than those with no RHC use.</p>
</section></section><section id="propensity-score-weighting-with-logistic-regression" class="level3"><h3 class="anchored" data-anchor-id="propensity-score-weighting-with-logistic-regression">Propensity score weighting with logistic regression</h3>
<p>Now we will use the propensity score weighting approach where propensity scores are estimated using logistic regression.</p>
<section id="step-1-1" class="level4"><h4 class="anchored" data-anchor-id="step-1-1">Step 1</h4>
<p>Step 1 is the same as we did it for the propensity score matching.</p>
</section><section id="step-2-1" class="level4"><h4 class="anchored" data-anchor-id="step-2-1">Step 2</h4>
<p>For the second step, we will calculate the stabilized inverse probability weight.</p>
<div class="cell" data-hash="machinelearningCausal5_cache/html/pswl2_4898abcbf420248bd40e58c4bf87f464">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>dat<span class="sc">$</span>ipw <span class="ot">&lt;-</span> <span class="fu">with</span>(dat, <span class="fu">ifelse</span>(RHC.use<span class="sc">==</span><span class="dv">1</span>, <span class="fu">mean</span>(RHC.use)<span class="sc">/</span>ps, </span>
<span id="cb12-2"><a href="#cb12-2"></a>                            <span class="fu">mean</span>(<span class="dv">1</span><span class="sc">-</span>RHC.use)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>ps)))</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="fu">summary</span>(dat<span class="sc">$</span>ipw)</span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#&gt;  0.3932  0.6571  0.7781  0.9953  1.0624 24.1854</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="step-3-1" class="level4"><h4 class="anchored" data-anchor-id="step-3-1">Step 3</h4>
<p>Now, we will check the balance in terms of SMD.</p>
<div class="cell" data-hash="machinelearningCausal5_cache/html/pswl3_8121837d7a21b1d32043d6b244c11b34">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Design with inverse probability weights</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>w.design <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">id =</span> <span class="sc">~</span><span class="dv">1</span>, <span class="at">weights =</span> <span class="sc">~</span>ipw, <span class="at">data =</span> dat, <span class="at">nest =</span> F)</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co"># Balance checking in terms of SMD</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>tab1e <span class="ot">&lt;-</span> <span class="fu">svyCreateTableOne</span>(<span class="at">vars =</span> baselinevars, <span class="at">strata =</span> <span class="st">"RHC.use"</span>, </span>
<span id="cb13-6"><a href="#cb13-6"></a>                           <span class="at">data =</span> w.design, <span class="at">includeNA =</span> T, </span>
<span id="cb13-7"><a href="#cb13-7"></a>                           <span class="at">addOverall =</span> F, <span class="at">test =</span> F)</span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">#print(tab1e, showAllLevels = T, catDigits = 2, smd = T)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>ExtractSmd(tab1e)</code> shows</p>
<div class="cell" data-caption="Your Table Title" data-hash="machinelearningCausal5_cache/html/unnamed-chunk-4_f8542230d6232854d81457a4233baa85">
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-c09199e2{}.cl-c087a950{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c08b7a44{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c08b7a4e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c08b9420{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c08b942a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c08b942b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c08b942c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c08b9434{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c08b9435{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-c09199e2">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-c08b9420"><p class="cl-c08b7a44"><span class="cl-c087a950">Variables</span></p></th>
<th class="cl-c08b942a"><p class="cl-c08b7a4e"><span class="cl-c087a950">1 vs 2</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Disease.category</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Cancer</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Cardiovascular</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Congestive.HF</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Dementia</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Psychiatric</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Pulmonary</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Renal</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Hepatic</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">GI.Bleed</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Tumor</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Immunosupperssion</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Transfer.hx</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">MI</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">age</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">sex</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">edu</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">DASIndex</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">APACHE.score</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Glasgow.Coma.Score</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">blood.pressure</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">WBC</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Heart.rate</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Respiratory.rate</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Temperature</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">PaO2vs.FIO2</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Albumin</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Hematocrit</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Bilirubin</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Creatinine</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Sodium</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Potassium</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">PaCo2</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">PH</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Weight</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">DNR.status</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Medical.insurance</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Respiratory.Diag</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Cardiovascular.Diag</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Neurological.Diag</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Gastrointestinal.Diag</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Renal.Diag</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Metabolic.Diag</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Hematologic.Diag</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Sepsis.Diag</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Trauma.Diag</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">Orthopedic.Diag</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b942b"><p class="cl-c08b7a44"><span class="cl-c087a950">race</span></p></td>
<td class="cl-c08b942c"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c08b9434"><p class="cl-c08b7a44"><span class="cl-c087a950">income</span></p></td>
<td class="cl-c08b9435"><p class="cl-c08b7a4e"><span class="cl-c087a950">0.02</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>All confounders are balanced (SMD &lt; 0.1).</p>
</section><section id="step-4-1" class="level4"><h4 class="anchored" data-anchor-id="step-4-1">Step 4</h4>
<div class="cell" data-hash="machinelearningCausal5_cache/html/pswl4_9a4439d7bc0da3eed46f6bad5f92f16a">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>fit.ipw <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(Death <span class="sc">~</span> RHC.use, </span>
<span id="cb14-2"><a href="#cb14-2"></a>                  <span class="at">design =</span> w.design, </span>
<span id="cb14-3"><a href="#cb14-3"></a>                  <span class="at">family =</span> binomial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Summary of <code>fit.ipw</code>:</p>
<div class="cell" data-caption="Your Table Title" data-hash="machinelearningCausal5_cache/html/unnamed-chunk-5_67f99b5e12efebb2a489c995e52ff743">
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-b347308e{table-layout:auto;width:50%;}.cl-b33e0f54{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b341a632{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b341bf6e{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b341bf6f{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-b347308e">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-b341bf6e"><p class="cl-b341a632"><span class="cl-b33e0f54">Variable</span></p></th>
<th class="cl-b341bf6e"><p class="cl-b341a632"><span class="cl-b33e0f54">Odds_Ratio</span></p></th>
<th class="cl-b341bf6e"><p class="cl-b341a632"><span class="cl-b33e0f54">CI_Lower</span></p></th>
<th class="cl-b341bf6e"><p class="cl-b341a632"><span class="cl-b33e0f54">CI_Upper</span></p></th>
</tr></thead>
<tbody><tr style="overflow-wrap:break-word;">
<td class="cl-b341bf6f"><p class="cl-b341a632"><span class="cl-b33e0f54">RHC.use</span></p></td>
<td class="cl-b341bf6f"><p class="cl-b341a632"><span class="cl-b33e0f54">1.30</span></p></td>
<td class="cl-b341bf6f"><p class="cl-b341a632"><span class="cl-b33e0f54">1.11</span></p></td>
<td class="cl-b341bf6f"><p class="cl-b341a632"><span class="cl-b33e0f54">1.53</span></p></td>
</tr></tbody>
</table>
</div>
</div>
</div>
<p>In the propensity score weighted data, the odds of death was 30% higher among those participants with RHC use than those with no RHC use.</p>
</section></section><section id="propensity-score-matching-with-super-learner" class="level3"><h3 class="anchored" data-anchor-id="propensity-score-matching-with-super-learner">Propensity score matching with super learner</h3>
<p>Now we will use the propensity score matching, where we will be using super learner to calculate the propensity scores. We use logistic, LASSO, and XGBoost as the candidate learners.</p>
<section id="step-1-2" class="level4"><h4 class="anchored" data-anchor-id="step-1-2">Step 1</h4>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psmSL1b_da138a285bcad12717722c6c78b1bb45">

</div>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psmSL1c_9f9d16dbcc269b25fa0eb5ffc14a4b47">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>ps.fit <span class="ot">&lt;-</span> <span class="fu">CV.SuperLearner</span>(</span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="at">Y =</span> dat<span class="sc">$</span>RHC.use,</span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="at">X =</span> dat[,baselinevars], </span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="at">SL.library =</span> <span class="fu">c</span>(<span class="st">"SL.glm"</span>, <span class="st">"SL.glmnet"</span>, <span class="st">"SL.xgboost"</span>), </span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="at">V =</span> <span class="dv">5</span>, </span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="at">method =</span> <span class="st">"method.NNLS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psmSL1d_09e88e7ea2add718e7b26db0652c6126">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Propensity scores for all learners  </span></span>
<span id="cb16-2"><a href="#cb16-2"></a>predictions <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ps.fit<span class="sc">$</span>SL.predict, ps.fit<span class="sc">$</span>library.predict)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="fu">head</span>(predictions)</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">#&gt;                SL.glm_All SL.glmnet_All SL.xgboost_All</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#&gt; [1,] 0.3632635 0.39789364    0.39569431     0.32144672</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#&gt; [2,] 0.5870492 0.64983590    0.61497078     0.54465985</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#&gt; [3,] 0.5740246 0.66329951    0.65396650     0.46847290</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">#&gt; [4,] 0.2172501 0.33044244    0.34478278     0.02363573</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">#&gt; [5,] 0.6347749 0.45972157    0.43779434     0.86645132</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co">#&gt; [6,] 0.0272532 0.03420477    0.03629319     0.01730520</span></span>
<span id="cb16-11"><a href="#cb16-11"></a></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co"># Propensity scores for super learner</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>dat<span class="sc">$</span>ps.sl <span class="ot">&lt;-</span> predictions[,<span class="dv">1</span>]</span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="fu">summary</span>(dat<span class="sc">$</span>ps.sl)</span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co">#&gt; 0.001671 0.147762 0.337664 0.376282 0.587237 0.975584</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="step-2-2" class="level4"><h4 class="anchored" data-anchor-id="step-2-2">Step 2</h4>
<p>The same as before, we will match exposed to unexposed based on their propensity scores.</p>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psmSL2a_5b23e1eecc5204da5f7f6d0cf363ad5b">

</div>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psmSL2b_9b55f2ac2ea16dfe5eb69aad9574a2b4">

</div>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psmSL2c_e2333f2db7b33aa1491c3fe39bf5be46">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Caliper</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>caliper <span class="ot">&lt;-</span> <span class="fl">0.2</span><span class="sc">*</span><span class="fu">sd</span>(<span class="fu">log</span>(dat<span class="sc">$</span>ps.sl<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>dat<span class="sc">$</span>ps.sl)))</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># 1:1 matching</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb17-6"><a href="#cb17-6"></a>match.obj2 <span class="ot">&lt;-</span> <span class="fu">matchit</span>(ps.formula, </span>
<span id="cb17-7"><a href="#cb17-7"></a>                      <span class="at">data =</span> dat,</span>
<span id="cb17-8"><a href="#cb17-8"></a>                      <span class="at">distance =</span> dat<span class="sc">$</span>ps.sl, </span>
<span id="cb17-9"><a href="#cb17-9"></a>                      <span class="at">method =</span> <span class="st">"nearest"</span>,</span>
<span id="cb17-10"><a href="#cb17-10"></a>                      <span class="at">ratio =</span> <span class="dv">1</span>,</span>
<span id="cb17-11"><a href="#cb17-11"></a>                      <span class="at">caliper =</span> caliper)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psmSL2_814b90d51bcc542b634246f9a205f060">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># See how many matched</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>match.obj2 </span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">#&gt; A matchit object</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">#&gt;  - method: 1:1 nearest neighbor matching without replacement</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">#&gt;  - distance: User-defined [caliper]</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co">#&gt;  - caliper: &lt;distance&gt; (0.075)</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">#&gt;  - number of obs.: 5735 (original), 3430 (matched)</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="co">#&gt;  - target estimand: ATT</span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">#&gt;  - covariates: too many to name</span></span>
<span id="cb18-10"><a href="#cb18-10"></a></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co"># Extract matched data</span></span>
<span id="cb18-12"><a href="#cb18-12"></a>matched.data.sl <span class="ot">&lt;-</span> <span class="fu">match.data</span>(match.obj2) </span>
<span id="cb18-13"><a href="#cb18-13"></a></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="co"># Overlap checking</span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="fu">bal.plot</span>(match.obj2,</span>
<span id="cb18-16"><a href="#cb18-16"></a>         <span class="at">var.name=</span><span class="st">"distance"</span>,</span>
<span id="cb18-17"><a href="#cb18-17"></a>         <span class="at">which=</span><span class="st">"both"</span>,</span>
<span id="cb18-18"><a href="#cb18-18"></a>         <span class="at">type =</span> <span class="st">"density"</span>,</span>
<span id="cb18-19"><a href="#cb18-19"></a>         <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="machinelearningCausal5_files/figure-html/psmSL2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="step-3-2" class="level4"><h4 class="anchored" data-anchor-id="step-3-2">Step 3</h4>
<p>Now we will check the balancing on the matched data.</p>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psmSL3_98319c925f83bb41494c68dda93e630a">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Balance checking in terms of SMD - using love plot</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="fu">love.plot</span>(match.obj2, </span>
<span id="cb19-3"><a href="#cb19-3"></a>          <span class="at">binary =</span> <span class="st">"std"</span>, </span>
<span id="cb19-4"><a href="#cb19-4"></a>          <span class="at">grid =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-5"><a href="#cb19-5"></a>          <span class="at">thresholds =</span> <span class="fu">c</span>(<span class="at">m =</span> .<span class="dv">1</span>),</span>
<span id="cb19-6"><a href="#cb19-6"></a>          <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="machinelearningCausal5_files/figure-html/psmSL3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co"># Balance checking in terms of SMD - using tableone</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>tab1c <span class="ot">&lt;-</span> <span class="fu">CreateTableOne</span>(<span class="at">vars =</span> baselinevars, <span class="at">strata =</span> <span class="st">"RHC.use"</span>, </span>
<span id="cb20-4"><a href="#cb20-4"></a>                        <span class="at">data =</span> matched.data.sl, <span class="at">includeNA =</span> T, </span>
<span id="cb20-5"><a href="#cb20-5"></a>                        <span class="at">addOverall =</span> T, <span class="at">test =</span> F)</span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">#print(tab1c, showAllLevels = T, catDigits = 2, smd = T)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>ExtractSmd(tab1c)</code> shows</p>
<div class="cell" data-caption="Your Table Title" data-hash="machinelearningCausal5_cache/html/unnamed-chunk-6_cd072275b8662806d7ab8fa0d422fd0f">
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-c10af29c{}.cl-c100e202{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c104c868{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c104c872{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c104e276{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c104e280{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c104e281{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c104e282{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c104e28a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c104e28b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-c10af29c">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-c104e276"><p class="cl-c104c868"><span class="cl-c100e202">Variables</span></p></th>
<th class="cl-c104e280"><p class="cl-c104c872"><span class="cl-c100e202">1 vs 2</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Disease.category</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.08</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Cancer</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Cardiovascular</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Congestive.HF</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Dementia</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Psychiatric</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Pulmonary</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Renal</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Hepatic</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">GI.Bleed</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Tumor</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Immunosupperssion</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Transfer.hx</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.06</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">MI</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">age</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.06</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">sex</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">edu</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">DASIndex</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">APACHE.score</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.08</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Glasgow.Coma.Score</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">blood.pressure</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">WBC</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Heart.rate</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Respiratory.rate</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Temperature</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">PaO2vs.FIO2</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.09</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Albumin</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Hematocrit</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Bilirubin</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Creatinine</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Sodium</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Potassium</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">PaCo2</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">PH</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.06</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Weight</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.06</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">DNR.status</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Medical.insurance</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.06</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Respiratory.Diag</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.08</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Cardiovascular.Diag</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Neurological.Diag</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Gastrointestinal.Diag</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Renal.Diag</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Metabolic.Diag</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Hematologic.Diag</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Sepsis.Diag</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Trauma.Diag</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.06</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">Orthopedic.Diag</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.06</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e281"><p class="cl-c104c868"><span class="cl-c100e202">race</span></p></td>
<td class="cl-c104e282"><p class="cl-c104c872"><span class="cl-c100e202">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c104e28a"><p class="cl-c104c868"><span class="cl-c100e202">income</span></p></td>
<td class="cl-c104e28b"><p class="cl-c104c872"><span class="cl-c100e202">0.04</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Again, all confounders are balanced in terms of SMD (all SMDs &lt; 0.1). Next, we will fit the outcome model.</p>
</section><section id="step-4-2" class="level4"><h4 class="anchored" data-anchor-id="step-4-2">Step 4</h4>
<div class="cell" data-hash="machinelearningCausal5_cache/html/psmSL4_577c3c31b0066fe73e15991bff45f79b">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>fit.psm.sl <span class="ot">&lt;-</span> <span class="fu">glm</span>(Death <span class="sc">~</span> RHC.use, </span>
<span id="cb21-2"><a href="#cb21-2"></a>                  <span class="at">data =</span> matched.data.sl, </span>
<span id="cb21-3"><a href="#cb21-3"></a>                  <span class="at">family =</span> binomial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Summary of <code>fit.psm.sl</code>:</p>
<div class="cell" data-caption="Your Table Title" data-hash="machinelearningCausal5_cache/html/unnamed-chunk-7_bf747d4187ee293548f1a4731ba247b8">
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-b36bf9e6{table-layout:auto;width:50%;}.cl-b3632320{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b366a216{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b366b9f4{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b366b9fe{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-b36bf9e6">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-b366b9f4"><p class="cl-b366a216"><span class="cl-b3632320">Variable</span></p></th>
<th class="cl-b366b9f4"><p class="cl-b366a216"><span class="cl-b3632320">Odds_Ratio</span></p></th>
<th class="cl-b366b9f4"><p class="cl-b366a216"><span class="cl-b3632320">CI_Lower</span></p></th>
<th class="cl-b366b9f4"><p class="cl-b366a216"><span class="cl-b3632320">CI_Upper</span></p></th>
</tr></thead>
<tbody><tr style="overflow-wrap:break-word;">
<td class="cl-b366b9fe"><p class="cl-b366a216"><span class="cl-b3632320">RHC.use</span></p></td>
<td class="cl-b366b9fe"><p class="cl-b366a216"><span class="cl-b3632320">1.26</span></p></td>
<td class="cl-b366b9fe"><p class="cl-b366a216"><span class="cl-b3632320">1.09</span></p></td>
<td class="cl-b366b9fe"><p class="cl-b366a216"><span class="cl-b3632320">1.45</span></p></td>
</tr></tbody>
</table>
</div>
</div>
</div>
<p>The interpretation is the same as before. In the propensity score matched data, the odds of death was 26% higher among those participants with RHC use than those without RHC use.</p>
</section></section><section id="propensity-score-weighting-with-super-learner" class="level3"><h3 class="anchored" data-anchor-id="propensity-score-weighting-with-super-learner">Propensity score weighting with super learner</h3>
<section id="step-1-3" class="level4"><h4 class="anchored" data-anchor-id="step-1-3">Step 1</h4>
<p>Step 1 is the same as we did it for the propensity score matching.</p>
</section><section id="step-2-3" class="level4"><h4 class="anchored" data-anchor-id="step-2-3">Step 2</h4>
<p>For the second step, we will calculate the stabilized inverse probability weight.</p>
<div class="cell" data-hash="machinelearningCausal5_cache/html/pswSL2_9f0e0d9f9d209d5c4e74df1713f4dc75">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>dat<span class="sc">$</span>ipw.sl <span class="ot">&lt;-</span> <span class="fu">with</span>(dat, <span class="fu">ifelse</span>(RHC.use<span class="sc">==</span><span class="dv">1</span>, <span class="fu">mean</span>(RHC.use)<span class="sc">/</span>ps.sl, </span>
<span id="cb22-2"><a href="#cb22-2"></a>                               <span class="fu">mean</span>(<span class="dv">1</span><span class="sc">-</span>RHC.use)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>ps.sl)))</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="fu">summary</span>(dat<span class="sc">$</span>ipw.sl)</span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#&gt;  0.3903  0.6496  0.7647  1.0191  1.0468 41.4490</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="step-3-3" class="level4"><h4 class="anchored" data-anchor-id="step-3-3">Step 3</h4>
<p>Next, we will check the balance in terms of SMD.</p>
<div class="cell" data-hash="machinelearningCausal5_cache/html/pswSL3_2cc40420ceca6565318b831c52f8b0fb">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># Design with inverse probability weights</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>w.design.sl <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">id =</span> <span class="sc">~</span><span class="dv">1</span>, <span class="at">weights =</span> <span class="sc">~</span>ipw.sl, </span>
<span id="cb23-3"><a href="#cb23-3"></a>                         <span class="at">data =</span> dat, <span class="at">nest =</span> F)</span>
<span id="cb23-4"><a href="#cb23-4"></a></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co"># Balance checking in terms of SMD</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>tab1k <span class="ot">&lt;-</span> <span class="fu">svyCreateTableOne</span>(<span class="at">vars =</span> baselinevars, <span class="at">strata =</span> <span class="st">"RHC.use"</span>, </span>
<span id="cb23-7"><a href="#cb23-7"></a>                           <span class="at">data =</span> w.design.sl, <span class="at">includeNA =</span> T, </span>
<span id="cb23-8"><a href="#cb23-8"></a>                           <span class="at">addOverall =</span> T, <span class="at">test =</span> F)</span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co">#print(tab1k, showAllLevels = T, catDigits = 2, smd = T)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>ExtractSmd(tab1k)</code> shows</p>
<div class="cell" data-caption="Your Table Title" data-hash="machinelearningCausal5_cache/html/unnamed-chunk-8_c2db30fdd42a9f73d4c187885471cebe">
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-c15f9a90{}.cl-c1558eec{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c1596db4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c1596dbe{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c15987b8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c15987c2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c15987c3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c15987cc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c15987cd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c15987d6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-c15f9a90">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-c15987b8"><p class="cl-c1596db4"><span class="cl-c1558eec">Variables</span></p></th>
<th class="cl-c15987c2"><p class="cl-c1596dbe"><span class="cl-c1558eec">1 vs 2</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Disease.category</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Cancer</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Cardiovascular</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Congestive.HF</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Dementia</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Psychiatric</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Pulmonary</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Renal</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Hepatic</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">GI.Bleed</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Tumor</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Immunosupperssion</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Transfer.hx</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">MI</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">age</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.07</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">sex</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">edu</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">DASIndex</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.04</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">APACHE.score</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Glasgow.Coma.Score</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">blood.pressure</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">WBC</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.06</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Heart.rate</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Respiratory.rate</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Temperature</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">PaO2vs.FIO2</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Albumin</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Hematocrit</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Bilirubin</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Creatinine</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Sodium</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Potassium</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">PaCo2</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">PH</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Weight</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">DNR.status</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Medical.insurance</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.03</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Respiratory.Diag</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Cardiovascular.Diag</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Neurological.Diag</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Gastrointestinal.Diag</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Renal.Diag</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Metabolic.Diag</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Hematologic.Diag</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Sepsis.Diag</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Trauma.Diag</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">Orthopedic.Diag</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.02</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987c3"><p class="cl-c1596db4"><span class="cl-c1558eec">race</span></p></td>
<td class="cl-c15987cc"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.05</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c15987cd"><p class="cl-c1596db4"><span class="cl-c1558eec">income</span></p></td>
<td class="cl-c15987d6"><p class="cl-c1596dbe"><span class="cl-c1558eec">0.05</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>All confounders are balanced (SMD &lt; 0.1).</p>
</section><section id="step-4-3" class="level4"><h4 class="anchored" data-anchor-id="step-4-3">Step 4</h4>
<div class="cell" data-hash="machinelearningCausal5_cache/html/pswSL4_de12e545188f645abc3bd406c102b5c1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>fit.ipw.sl <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(Death <span class="sc">~</span> RHC.use, </span>
<span id="cb24-2"><a href="#cb24-2"></a>                     <span class="at">design =</span> w.design.sl, </span>
<span id="cb24-3"><a href="#cb24-3"></a>                     <span class="at">family =</span> binomial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Summary of <code>fit.ipw.sl</code>:</p>
<div class="cell" data-caption="Your Table Title" data-hash="machinelearningCausal5_cache/html/unnamed-chunk-9_57182b2b78effcbf2fd47c2cc3e84830">
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-b3a64a9c{table-layout:auto;width:50%;}.cl-b39d8c90{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b3a10744{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b3a12184{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3a1218e{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-b3a64a9c">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-b3a12184"><p class="cl-b3a10744"><span class="cl-b39d8c90">Variable</span></p></th>
<th class="cl-b3a12184"><p class="cl-b3a10744"><span class="cl-b39d8c90">Odds_Ratio</span></p></th>
<th class="cl-b3a12184"><p class="cl-b3a10744"><span class="cl-b39d8c90">CI_Lower</span></p></th>
<th class="cl-b3a12184"><p class="cl-b3a10744"><span class="cl-b39d8c90">CI_Upper</span></p></th>
</tr></thead>
<tbody><tr style="overflow-wrap:break-word;">
<td class="cl-b3a1218e"><p class="cl-b3a10744"><span class="cl-b39d8c90">RHC.use</span></p></td>
<td class="cl-b3a1218e"><p class="cl-b3a10744"><span class="cl-b39d8c90">1.26</span></p></td>
<td class="cl-b3a1218e"><p class="cl-b3a10744"><span class="cl-b39d8c90">1.04</span></p></td>
<td class="cl-b3a1218e"><p class="cl-b3a10744"><span class="cl-b39d8c90">1.52</span></p></td>
</tr></tbody>
</table>
</div>
</div>
</div>
<p>In the propensity score weighted data, the odds of death was 26% higher among those participants with RHC use than those without RHC use.</p>
</section></section><section id="tmle" class="level3"><h3 class="anchored" data-anchor-id="tmle">TMLE</h3>
<p>From the previous tutorial, we calculated the effective sample size for the outcome model as well as for the exposure model:</p>
<div class="cell" data-hash="machinelearningCausal5_cache/html/neffY_bd530b53ebc6ecf1058d5f84b3090c85">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dat) </span>
<span id="cb25-2"><a href="#cb25-2"></a>pY <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dat[dat<span class="sc">$</span>Death <span class="sc">==</span> <span class="dv">1</span>,])<span class="sc">/</span>n </span>
<span id="cb25-3"><a href="#cb25-3"></a>n_eff <span class="ot">&lt;-</span> <span class="fu">min</span>(n, <span class="dv">5</span><span class="sc">*</span>(n<span class="sc">*</span><span class="fu">min</span>(pY, <span class="dv">1</span> <span class="sc">-</span> pY))) </span>
<span id="cb25-4"><a href="#cb25-4"></a>n_eff</span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="co">#&gt; [1] 5735</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="machinelearningCausal5_cache/html/neffA_55f367178d062b3ad56ca9addf741867">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dat) </span>
<span id="cb26-2"><a href="#cb26-2"></a>pA <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dat[dat<span class="sc">$</span>RHC.use <span class="sc">==</span> <span class="dv">1</span>,])<span class="sc">/</span>n </span>
<span id="cb26-3"><a href="#cb26-3"></a>n_eff <span class="ot">&lt;-</span> <span class="fu">min</span>(n, <span class="dv">5</span><span class="sc">*</span>(n<span class="sc">*</span><span class="fu">min</span>(pA, <span class="dv">1</span> <span class="sc">-</span> pA))) </span>
<span id="cb26-4"><a href="#cb26-4"></a>n_eff</span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co">#&gt; [1] 5735</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since the effective sample size is <span class="math inline">\(\ge 5,000\)</span> for both model, we can consider <span class="math inline">\(5 \le \text{V} \le 10\)</span>, where V is the number of folds. Lets work with 10-fold cross-validation for both the exposure and the outcome model, with the default super learner library.</p>
<div class="cell" data-hash="machinelearningCausal5_cache/html/tmle1a_5a80739e5c68a1006ce9a48c49cf8134">

</div>
<div class="cell" data-hash="machinelearningCausal5_cache/html/tmle1b_de023b98203f5db56a8cfe3e273979fb">

</div>
<div class="cell" data-hash="machinelearningCausal5_cache/html/tmle1c_4d717f0c67f4ecea1bb8365ac04ae99c">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>fit.tmle <span class="ot">&lt;-</span> <span class="fu">tmle</span>(<span class="at">Y =</span> dat<span class="sc">$</span>Death, </span>
<span id="cb27-2"><a href="#cb27-2"></a>                 <span class="at">A =</span> dat<span class="sc">$</span>RHC.use, </span>
<span id="cb27-3"><a href="#cb27-3"></a>                 <span class="at">W =</span> dat[,baselinevars], </span>
<span id="cb27-4"><a href="#cb27-4"></a>                 <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb27-5"><a href="#cb27-5"></a>                 <span class="at">V.Q =</span> <span class="dv">10</span>, </span>
<span id="cb27-6"><a href="#cb27-6"></a>                 <span class="at">V.g =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="machinelearningCausal5_cache/html/tmle1OR_633aa80aa57071bbd8eb1779c6f2eb8d">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># OR</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="fu">round</span>(fit.tmle<span class="sc">$</span>estimates<span class="sc">$</span>OR<span class="sc">$</span>psi, <span class="dv">2</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co">#&gt; [1] 1.26</span></span>
<span id="cb28-4"><a href="#cb28-4"></a></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co"># 95% CI</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="fu">round</span>(fit.tmle<span class="sc">$</span>estimates<span class="sc">$</span>OR<span class="sc">$</span>CI, <span class="dv">2</span>)</span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="co">#&gt; [1] 1.12 1.42</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As we can see that the odds of death was 26% higher among those participants with RHC use than those without RHC use.</p>
</section><section id="results-comparison" class="level3"><h3 class="anchored" data-anchor-id="results-comparison">Results comparison</h3>
<div class="cell">
<div class="cell-output-display">

<table class="table" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;"> Model </th>
   <th style="text-align:right;"> OR </th>
   <th style="text-align:left;"> 95% CI </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;"> Logistic regression </td>
   <td style="text-align:right;width: 15%; "> 1.42 </td>
   <td style="text-align:left;width: 15%; "> 1.32-1.65 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Propensity score matching with logistic </td>
   <td style="text-align:right;width: 15%; "> 1.29 </td>
   <td style="text-align:left;width: 15%; "> 1.12-1.48 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Propensity score weighting with logistic </td>
   <td style="text-align:right;width: 15%; "> 1.30 </td>
   <td style="text-align:left;width: 15%; "> 1.11-1.53 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Propensity score matching with super learner (logistic, LASSO, and XGBoost) </td>
   <td style="text-align:right;width: 15%; "> 1.26 </td>
   <td style="text-align:left;width: 15%; "> 1.09-1.45 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> Propensity score weighting with super learner (logistic, LASSO, and XGBoost) </td>
   <td style="text-align:right;width: 15%; "> 1.26 </td>
   <td style="text-align:left;width: 15%; "> 1.04-1.52 </td>
  </tr>
<tr>
<td style="text-align:left;font-weight: bold;"> TMLE (default SL library) </td>
   <td style="text-align:right;width: 15%; "> 1.26 </td>
   <td style="text-align:left;width: 15%; "> 1.12-1.42 </td>
  </tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="machinelearningCausal5_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">Forest Plot of Odds Ratios</figcaption><p></p>
</figure>
</div>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./machinelearningCausal4.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Continuous Outcomes</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./machinelearningCausalF.html" class="pagination-link">
        <span class="nav-page-text">R functions (C)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>