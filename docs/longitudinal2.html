<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>OER: Advanced Epidemiological Methods - GEE</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./longitudinalF.html" rel="next">
<link href="./longitudinal1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CVBPG0RQMY"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-CVBPG0RQMY', { 'anonymize_ip': true});
</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta name="twitter:title" content="OER: Advanced Epidemiological Methods - GEE">
<meta name="twitter:description" content="In this section, we will learn about generalized estimating equation (GEE). GEE is another popular method for modeling longitudinal or clustered data.">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-sidebar docked">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">GEE</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">OER: Advanced Epidemiological Methods</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">The Project</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./wrangling.html" class="sidebar-item-text sidebar-link">Data wrangling</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1a.html" class="sidebar-item-text sidebar-link">R basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1b.html" class="sidebar-item-text sidebar-link">Data types</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1c.html" class="sidebar-item-text sidebar-link">Automating tasks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling2.html" class="sidebar-item-text sidebar-link">Importing dataset</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling3.html" class="sidebar-item-text sidebar-link">Data manipulation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling4.html" class="sidebar-item-text sidebar-link">Import external data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling5.html" class="sidebar-item-text sidebar-link">Summary tables</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling6.html" class="sidebar-item-text sidebar-link">R Markdown</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingF.html" class="sidebar-item-text sidebar-link">R Functions (W)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingQ.html" class="sidebar-item-text sidebar-link">Quiz (W)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingE.html" class="sidebar-item-text sidebar-link">Exercise (W)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./accessing.html" class="sidebar-item-text sidebar-link">Data accessing</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing1.html" class="sidebar-item-text sidebar-link">Survey data sources</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing2.html" class="sidebar-item-text sidebar-link">Importing CCHS to R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing3.html" class="sidebar-item-text sidebar-link">Importing NHANES to R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing4.html" class="sidebar-item-text sidebar-link">Reproducing results</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing5.html" class="sidebar-item-text sidebar-link">Importing NHIS to R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingF.html" class="sidebar-item-text sidebar-link">R Functions (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingQ.html" class="sidebar-item-text sidebar-link">Quiz (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingE.html" class="sidebar-item-text sidebar-link">Exercise (A)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./researchquestion.html" class="sidebar-item-text sidebar-link">Research questions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion1.html" class="sidebar-item-text sidebar-link">Predictive question-1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion2a.html" class="sidebar-item-text sidebar-link">Predictive question-2a</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion2b.html" class="sidebar-item-text sidebar-link">Predictive question-2b</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion3.html" class="sidebar-item-text sidebar-link">Causal question-1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion4.html" class="sidebar-item-text sidebar-link">Causal question-2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestionF.html" class="sidebar-item-text sidebar-link">R functions (Q)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestionQ.html" class="sidebar-item-text sidebar-link">Quiz (Q)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./confounding.html" class="sidebar-item-text sidebar-link">Causal roles</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding1.html" class="sidebar-item-text sidebar-link">Confounding</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding2.html" class="sidebar-item-text sidebar-link">Mediator</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding3.html" class="sidebar-item-text sidebar-link">Collider</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding4.html" class="sidebar-item-text sidebar-link">Z-bias</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding5.html" class="sidebar-item-text sidebar-link">Collapsibility</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding6.html" class="sidebar-item-text sidebar-link">Change-in-estimate</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confoundingF.html" class="sidebar-item-text sidebar-link">R functions (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confoundingQ.html" class="sidebar-item-text sidebar-link">Quiz (R)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./predictivefactors.html" class="sidebar-item-text sidebar-link">Prediction ideas</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors1.html" class="sidebar-item-text sidebar-link">Collinear predictors</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors2.html" class="sidebar-item-text sidebar-link">Continuous outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors3.html" class="sidebar-item-text sidebar-link">Binary outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors4.html" class="sidebar-item-text sidebar-link">Overfitting and performance</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors5.html" class="sidebar-item-text sidebar-link">Data spliting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors6.html" class="sidebar-item-text sidebar-link">Cross-validation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors7.html" class="sidebar-item-text sidebar-link">Bootstrap</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactorsF.html" class="sidebar-item-text sidebar-link">R functions (P)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactorsQ.html" class="sidebar-item-text sidebar-link">Quiz (P)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./surveydata.html" class="sidebar-item-text sidebar-link">Survey data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata1.html" class="sidebar-item-text sidebar-link">CCHS: Revisiting PICOT</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata2.html" class="sidebar-item-text sidebar-link">CCHS: Assessing data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata3.html" class="sidebar-item-text sidebar-link">CCHS: Bivariate analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata4.html" class="sidebar-item-text sidebar-link">CCHS: Regression</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata5.html" class="sidebar-item-text sidebar-link">CCHS: Performance</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata6.html" class="sidebar-item-text sidebar-link">NHANES: Blood Pressure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata7.html" class="sidebar-item-text sidebar-link">NHANES: Cholesterol</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata8.html" class="sidebar-item-text sidebar-link">NHANES: Subsetting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataF.html" class="sidebar-item-text sidebar-link">R functions (D)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataQ.html" class="sidebar-item-text sidebar-link">Quiz (D)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataE.html" class="sidebar-item-text sidebar-link">Exercise (D)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./missingdata.html" class="sidebar-item-text sidebar-link">Missing data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata1.html" class="sidebar-item-text sidebar-link">Imputation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata2.html" class="sidebar-item-text sidebar-link">Imputation in NHANES</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata3.html" class="sidebar-item-text sidebar-link">Missing in outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata4.html" class="sidebar-item-text sidebar-link">Performance with NA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata5.html" class="sidebar-item-text sidebar-link">Subpopulations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata6.html" class="sidebar-item-text sidebar-link">MCAR tests</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata7.html" class="sidebar-item-text sidebar-link">Effect modification</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataF.html" class="sidebar-item-text sidebar-link">R functions (M)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataQ.html" class="sidebar-item-text sidebar-link">Quiz (M)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataE.html" class="sidebar-item-text sidebar-link">Exercise (M)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./propensityscore.html" class="sidebar-item-text sidebar-link">Propensity score</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore1.html" class="sidebar-item-text sidebar-link">Exact Matching (CCHS)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore2.html" class="sidebar-item-text sidebar-link">PSM in OA-CVD (CCHS)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore3.html" class="sidebar-item-text sidebar-link">PSM in OA-CVD (US)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore4.html" class="sidebar-item-text sidebar-link">PSM in BMI-diabetes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore5.html" class="sidebar-item-text sidebar-link">PSM with MI</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreF.html" class="sidebar-item-text sidebar-link">R functions (S)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreQ.html" class="sidebar-item-text sidebar-link">Quiz (S)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreE.html" class="sidebar-item-text sidebar-link">Exercise (S)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./machinelearning.html" class="sidebar-item-text sidebar-link">Machine learning</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning1.html" class="sidebar-item-text sidebar-link">Continuous outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning2.html" class="sidebar-item-text sidebar-link">Data spliting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning3.html" class="sidebar-item-text sidebar-link">Cross-validation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning4.html" class="sidebar-item-text sidebar-link">Binary outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning5.html" class="sidebar-item-text sidebar-link">Supervised learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning6.html" class="sidebar-item-text sidebar-link">Unsupervised learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning6a.html" class="sidebar-item-text sidebar-link">Replicate Results</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningF.html" class="sidebar-item-text sidebar-link">R functions (L)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./machinelearningCausal.html" class="sidebar-item-text sidebar-link">Causal learning</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausalF.html" class="sidebar-item-text sidebar-link">R functions (C)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./nonbinary.html" class="sidebar-item-text sidebar-link">Complex outcomes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary1.html" class="sidebar-item-text sidebar-link">Polytomous and ordinal</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary2.html" class="sidebar-item-text sidebar-link">Survival analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinary3.html" class="sidebar-item-text sidebar-link">Poisson</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinaryF.html" class="sidebar-item-text sidebar-link">R functions (N)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonbinaryQ.html" class="sidebar-item-text sidebar-link">Quiz (N)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./longitudinal.html" class="sidebar-item-text sidebar-link">Longitudinal data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal1.html" class="sidebar-item-text sidebar-link">Mixed effects models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal2.html" class="sidebar-item-text sidebar-link active">GEE</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinalF.html" class="sidebar-item-text sidebar-link">R functions (T)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinalQ.html" class="sidebar-item-text sidebar-link">Quiz (T)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./mediation.html" class="sidebar-item-text sidebar-link">Mediation analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation1.html" class="sidebar-item-text sidebar-link">Baron and Kenny</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation2.html" class="sidebar-item-text sidebar-link">Justification</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediation3.html" class="sidebar-item-text sidebar-link">Mediation Example</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediationF.html" class="sidebar-item-text sidebar-link">R functions (I)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mediationQ.html" class="sidebar-item-text sidebar-link">Quiz (I)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./reporting.html" class="sidebar-item-text sidebar-link">Writing Tools</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reporting1.html" class="sidebar-item-text sidebar-link">Collaborative Writing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reporting2.html" class="sidebar-item-text sidebar-link">Formatting Tools</a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#data-description" id="toc-data-description" class="nav-link active" data-scroll-target="#data-description">Data Description</a></li>
  <li><a href="#methods-for-non-normal-distributions" id="toc-methods-for-non-normal-distributions" class="nav-link" data-scroll-target="#methods-for-non-normal-distributions">Methods for Non-normal Distributions</a></li>
  <li><a href="#marginal-models" id="toc-marginal-models" class="nav-link" data-scroll-target="#marginal-models">Marginal Models</a></li>
  <li><a href="#conditional-models" id="toc-conditional-models" class="nav-link" data-scroll-target="#conditional-models">Conditional Models</a></li>
  <li><a href="#gee-models" id="toc-gee-models" class="nav-link" data-scroll-target="#gee-models">GEE models</a></li>
  <li><a href="#compare-with-random-effects" id="toc-compare-with-random-effects" class="nav-link" data-scroll-target="#compare-with-random-effects">Compare with Random Effects</a></li>
  <li><a href="#video-content-optional" id="toc-video-content-optional" class="nav-link" data-scroll-target="#video-content-optional">Video content (optional)</a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference">Reference</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">GEE</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i></button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>In this section, we will learn about generalized estimating equation (GEE). GEE is another popular method for modeling longitudinal or clustered data. In contrast to the mixed effects models where we assume error term and beta coefficients for subject <span class="math inline">\(i\)</span> both follow normal distribution, GEE is distribution free. However, we assume some correlation structures for within subjects/clusters. Hence, we can use GEE for non-normal data such as skewed data, binary data, or count data.</p>
<div class="cell" data-hash="longitudinal2_cache/html/setup_6333dae9ba0ceffab9d38e23af58751e">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Load required packages</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">require</span>(HSAUR2)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(gee)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(geepack)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(<span class="st">"lme4"</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">require</span>(afex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="data-description" class="level3"><h3 class="anchored" data-anchor-id="data-description">Data Description</h3>
<p>In addition to BtheB dataset in part 1, we used respiratory data from <strong>HSAUR2</strong> package to demonstrate the analysis with non-normal responses:</p>
<ul>
<li>The response variable in this dataset is <strong>status</strong> (the respiratory status), which is a binary response</li>
<li>Other covariates are: treatment, age, gender, the study center</li>
<li>The response has been measured at 0, 1, 2, 3, 4 mths for each subject</li>
</ul>
<div class="cell" data-hash="longitudinal2_cache/html/load_99283276f39b43df1ec4e1a3e99bf10d">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">data</span>(<span class="st">"respiratory"</span>, <span class="at">package =</span> <span class="st">"HSAUR2"</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">head</span>(respiratory)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["centre"],"name":[1],"type":["fct"],"align":["left"]},{"label":["treatment"],"name":[2],"type":["fct"],"align":["left"]},{"label":["gender"],"name":[3],"type":["fct"],"align":["left"]},{"label":["age"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["status"],"name":[5],"type":["fct"],"align":["left"]},{"label":["month"],"name":[6],"type":["ord"],"align":["right"]},{"label":["subject"],"name":[7],"type":["fct"],"align":["left"]}],"data":[{"1":"1","2":"placebo","3":"female","4":"46","5":"poor","6":"0","7":"1","_rn_":"1"},{"1":"1","2":"placebo","3":"female","4":"46","5":"poor","6":"1","7":"1","_rn_":"112"},{"1":"1","2":"placebo","3":"female","4":"46","5":"poor","6":"2","7":"1","_rn_":"223"},{"1":"1","2":"placebo","3":"female","4":"46","5":"poor","6":"3","7":"1","_rn_":"334"},{"1":"1","2":"placebo","3":"female","4":"46","5":"poor","6":"4","7":"1","_rn_":"445"},{"1":"1","2":"placebo","3":"female","4":"28","5":"poor","6":"0","7":"2","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="methods-for-non-normal-distributions" class="level3"><h3 class="anchored" data-anchor-id="methods-for-non-normal-distributions">Methods for Non-normal Distributions</h3>
<ul>
<li><p>ref: <span class="citation" data-cites="hothorn2014handbook">(<a href="#ref-hothorn2014handbook" role="doc-biblioref">Hothorn and Everitt 2014</a>)</span> Section 13.2</p></li>
<li><p>In addition to normally distributed response variables, the response variable can also follow non-normal distributions, such as binary or count responses.</p></li>
<li><p>We have learned logistic regression or Poisson regression (glm) to analyze binary and count data but they are not considering the “repeated measurement” structure.</p></li>
<li><p>The consequence of ignoring the longitudinal/repeated measurements structure is to have the wrong estimated standard errors for regression coefficients. Hence, our inference will be invalid. However, the glm still gives consistent estimated beta coefficients.</p></li>
<li><p>There are many correlation structures in modelling GEE.</p></li>
<li><p>With non-normal responses, different assumptions about these correlation structures can lead to different interpretations of the beta coefficients. Here, we will introduce two different GEE models: <strong>marginal model</strong> and <strong>conditional model</strong>.</p></li>
</ul></section><section id="marginal-models" class="level3"><h3 class="anchored" data-anchor-id="marginal-models">Marginal Models</h3>
<ul>
<li>ref: <span class="citation" data-cites="hothorn2014handbook">(<a href="#ref-hothorn2014handbook" role="doc-biblioref">Hothorn and Everitt 2014</a>)</span> Section 13.2.1</li>
</ul>
<p>Repeated measurement and longitudinal data has responses taken at different time points. Therefore, we could simply review them as many series of cross-sectional data. Each cross-sectional data can be analyzed using glm introduced in previous lectures. Then a correlation structure can be assumed to connect different “cross-sections”. The common correlation structures are:</p>
<section id="an-independent-structure" class="level4"><h4 class="anchored" data-anchor-id="an-independent-structure">An independent structure</h4>
<p>An independent structure which assumes the repeated measures are independent. An example of independent structure is basically is an identity matrix:</p>
<p><span class="math display">\[
\left(\begin{array}{ccc}
1 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 1
\end{array}\right)
\]</span></p>
</section><section id="an-exchangeable-correlation" class="level4"><h4 class="anchored" data-anchor-id="an-exchangeable-correlation">An exchangeable correlation</h4>
<p>An exchangeable correlation assumes that for the each individual, the correlation between each pair of repeated measurements is the same, i.e., <span class="math inline">\(Cor(Y_{ij},Y_{ik})=\rho\)</span>. In the correlation matrix, only <span class="math inline">\(\rho\)</span> is unknown. Therefore, it is a single parameter working correlation matrix. An example of exchangeable correlation matrix is:</p>
<p><span class="math display">\[
\left(\begin{array}{ccc}
1 &amp; \rho &amp; \rho\\
\rho &amp; 1 &amp; \rho\\
\rho &amp; \rho &amp; 1
\end{array}\right)
\]</span></p>
</section><section id="an-ar-1-autoregressive-correlation" class="level4"><h4 class="anchored" data-anchor-id="an-ar-1-autoregressive-correlation">An AR-1 autoregressive correlation</h4>
<p>Defined as <span class="math inline">\(Cor(Y_{ij},Y_{ik})=\rho^{|k-j|}\)</span>. If two measurements are taken at two closer time points the correlation is higher than these taken at two farther apart time points. It is also a single parameter working correlation matrix. An example of AR-1 correlation matrix is:</p>
<p><span class="math display">\[
\left(\begin{array}{ccc}
1 &amp; \rho &amp; \rho^2\\
\rho &amp; 1 &amp; \rho\\
\rho^2 &amp; \rho &amp; 1
\end{array}\right)
\]</span></p>
</section><section id="an-unstructured-correlation" class="level4"><h4 class="anchored" data-anchor-id="an-unstructured-correlation">An unstructured correlation</h4>
<p>Different pairs of observation for each individual have different correlations <span class="math inline">\(Cor(Y_{ij},Y_{ik})=\rho_{jk}\)</span>. Assume that each individual has <span class="math inline">\(K\)</span> pairs of measurements, it is a <span class="math inline">\(K(K-1)/2\)</span> parameters working correlation matrix. An example of unstructured correlation matrix is:</p>
<p><span class="math display">\[
\left(\begin{array}{ccc}
1 &amp; \rho_{12} &amp; \rho_{13}\\
\rho_{12} &amp; 1 &amp; \rho_{23}\\
\rho_{13} &amp; \rho_{23} &amp; 1
\end{array}\right)
\]</span></p>
<ul>
<li>Sometimes, specifying a “right” correlation matrix is hard. However, the marginal model (usually we use GEE) gives us consistent estimated coefficients even with misspecified correlation structure.</li>
</ul></section></section><section id="conditional-models" class="level3"><h3 class="anchored" data-anchor-id="conditional-models">Conditional Models</h3>
<ul>
<li><p>ref: <span class="citation" data-cites="hothorn2014handbook">(<a href="#ref-hothorn2014handbook" role="doc-biblioref">Hothorn and Everitt 2014</a>)</span> Section 13.2.2</p></li>
<li><p>In GEE marginal models, the estimated regression coefficients are marginal (or population-averaged) effects. Therefore, the interpretation are at population-level. It is almost impossible to make inference on any specific individual or cluster.</p></li>
<li><p>One solution is to do conditional models. The random effect approach in the part 1 can be extended to non-Gaussian response.</p></li>
</ul></section><section id="gee-models" class="level3"><h3 class="anchored" data-anchor-id="gee-models">GEE models</h3>
<p>After the short introduction of two models, let’s take a look at real examples</p>
<ul>
<li>ref: <span class="citation" data-cites="hothorn2014handbook">(<a href="#ref-hothorn2014handbook" role="doc-biblioref">Hothorn and Everitt 2014</a>)</span> Section 13.3</li>
<li>ref: <span class="citation" data-cites="faraway2016extending">(<a href="#ref-faraway2016extending" role="doc-biblioref">Faraway 2016</a>)</span> Section 10.2</li>
</ul>
<section id="binary-response" class="level4"><h4 class="anchored" data-anchor-id="binary-response">Binary response</h4>
<p>We started with binary response using respiratory dataset:</p>
<div class="cell" data-hash="longitudinal2_cache/html/gee1_7d5e1da0e27b26919d6a07d7e8de9e62">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(gee)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">data</span>(<span class="st">"respiratory"</span>, <span class="at">package =</span> <span class="st">"HSAUR2"</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="do">## Data manipulation</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>resp <span class="ot">&lt;-</span> <span class="fu">subset</span>(respiratory, month <span class="sc">&gt;</span> <span class="st">"0"</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>resp<span class="sc">$</span>baseline <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">subset</span>(respiratory, month <span class="sc">==</span> <span class="st">"0"</span>)<span class="sc">$</span>status, <span class="fu">rep</span>(<span class="dv">4</span>, <span class="dv">111</span>))</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="do">## Change the response to 0 and 1</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>resp<span class="sc">$</span>nstat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(resp<span class="sc">$</span>status <span class="sc">==</span> <span class="st">"good"</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a>resp<span class="sc">$</span>month <span class="ot">&lt;-</span> resp<span class="sc">$</span>month[, drop <span class="ot">=</span> <span class="cn">TRUE</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now we will fit a regular glm, i.e., model without random effect or any correlation structures. For binary outcomes, the estimated coefficients are log odds.</p>
<div class="cell" data-hash="longitudinal2_cache/html/gee2_a91915f6f777365d3b80b8b691ff3571">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="do">## Regular GLM </span></span>
<span id="cb4-2"><a href="#cb4-2"></a>resp_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(status <span class="sc">~</span> centre <span class="sc">+</span> treatment <span class="sc">+</span> gender <span class="sc">+</span> baseline<span class="sc">+</span> age, </span>
<span id="cb4-3"><a href="#cb4-3"></a>                <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="fu">summary</span>(resp_glm)</span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt; </span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt; Call:</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#&gt; glm(formula = status ~ centre + treatment + gender + baseline + </span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt;     age, family = "binomial", data = resp)</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">#&gt; </span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt;                     Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt; (Intercept)        -0.900171   0.337653  -2.666  0.00768 ** </span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt; centre2             0.671601   0.239567   2.803  0.00506 ** </span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt; treatmenttreatment  1.299216   0.236841   5.486 4.12e-08 ***</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#&gt; gendermale          0.119244   0.294671   0.405  0.68572    </span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">#&gt; baselinegood        1.882029   0.241290   7.800 6.20e-15 ***</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co">#&gt; age                -0.018166   0.008864  -2.049  0.04043 *  </span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co">#&gt; ---</span></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="co">#&gt; </span></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="co">#&gt; </span></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="co">#&gt;     Null deviance: 608.93  on 443  degrees of freedom</span></span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="co">#&gt; Residual deviance: 483.22  on 438  degrees of freedom</span></span>
<span id="cb4-25"><a href="#cb4-25"></a><span class="co">#&gt; AIC: 495.22</span></span>
<span id="cb4-26"><a href="#cb4-26"></a><span class="co">#&gt; </span></span>
<span id="cb4-27"><a href="#cb4-27"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now we will fit GEE with independent correlation structure:</p>
<div class="cell" data-hash="longitudinal2_cache/html/gee3_4484726709f384097e6e9b1d85153a97">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="do">## GEE with identity matrix</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>resp_gee.in <span class="ot">&lt;-</span> <span class="fu">gee</span>(nstat <span class="sc">~</span> centre <span class="sc">+</span> treatment <span class="sc">+</span> gender <span class="sc">+</span> baseline <span class="sc">+</span> age, </span>
<span id="cb5-3"><a href="#cb5-3"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb5-4"><a href="#cb5-4"></a>                 <span class="at">id =</span> subject,<span class="at">corstr =</span> <span class="st">"independence"</span>, </span>
<span id="cb5-5"><a href="#cb5-5"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>, <span class="at">scale.value =</span> <span class="dv">1</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt; Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt; running glm to get initial regression estimate</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt;        (Intercept)            centre2 treatmenttreatment         gendermale </span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt;        -0.90017133         0.67160098         1.29921589         0.11924365 </span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt;       baselinegood                age </span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt;         1.88202860        -0.01816588</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="fu">summary</span>(resp_gee.in)</span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt; </span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#&gt;  GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA</span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">#&gt;  gee S-function, version 4.13 modified 98/01/27 (1998) </span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">#&gt; </span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">#&gt; Model:</span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co">#&gt;  Link:                      Logit </span></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="co">#&gt;  Variance to Mean Relation: Binomial </span></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">#&gt;  Correlation Structure:     Independent </span></span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="co">#&gt; </span></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="co">#&gt; Call:</span></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="co">#&gt; gee(formula = nstat ~ centre + treatment + gender + baseline + </span></span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="co">#&gt;     age, id = subject, data = resp, family = "binomial", corstr = "independence", </span></span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="co">#&gt;     scale.fix = TRUE, scale.value = 1)</span></span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="co">#&gt; </span></span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="co">#&gt; Summary of Residuals:</span></span>
<span id="cb5-28"><a href="#cb5-28"></a><span class="co">#&gt;         Min          1Q      Median          3Q         Max </span></span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="co">#&gt; -0.93134415 -0.30623174  0.08973552  0.33018952  0.84307712 </span></span>
<span id="cb5-30"><a href="#cb5-30"></a><span class="co">#&gt; </span></span>
<span id="cb5-31"><a href="#cb5-31"></a><span class="co">#&gt; </span></span>
<span id="cb5-32"><a href="#cb5-32"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb5-33"><a href="#cb5-33"></a><span class="co">#&gt;                       Estimate  Naive S.E.   Naive z Robust S.E.   Robust z</span></span>
<span id="cb5-34"><a href="#cb5-34"></a><span class="co">#&gt; (Intercept)        -0.90017133 0.337653052 -2.665965  0.46032700 -1.9555041</span></span>
<span id="cb5-35"><a href="#cb5-35"></a><span class="co">#&gt; centre2             0.67160098 0.239566599  2.803400  0.35681913  1.8821889</span></span>
<span id="cb5-36"><a href="#cb5-36"></a><span class="co">#&gt; treatmenttreatment  1.29921589 0.236841017  5.485603  0.35077797  3.7038127</span></span>
<span id="cb5-37"><a href="#cb5-37"></a><span class="co">#&gt; gendermale          0.11924365 0.294671045  0.404667  0.44320235  0.2690501</span></span>
<span id="cb5-38"><a href="#cb5-38"></a><span class="co">#&gt; baselinegood        1.88202860 0.241290221  7.799854  0.35005152  5.3764332</span></span>
<span id="cb5-39"><a href="#cb5-39"></a><span class="co">#&gt; age                -0.01816588 0.008864403 -2.049306  0.01300426 -1.3969169</span></span>
<span id="cb5-40"><a href="#cb5-40"></a><span class="co">#&gt; </span></span>
<span id="cb5-41"><a href="#cb5-41"></a><span class="co">#&gt; Estimated Scale Parameter:  1</span></span>
<span id="cb5-42"><a href="#cb5-42"></a><span class="co">#&gt; Number of Iterations:  1</span></span>
<span id="cb5-43"><a href="#cb5-43"></a><span class="co">#&gt; </span></span>
<span id="cb5-44"><a href="#cb5-44"></a><span class="co">#&gt; Working Correlation</span></span>
<span id="cb5-45"><a href="#cb5-45"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb5-46"><a href="#cb5-46"></a><span class="co">#&gt; [1,]    1    0    0    0</span></span>
<span id="cb5-47"><a href="#cb5-47"></a><span class="co">#&gt; [2,]    0    1    0    0</span></span>
<span id="cb5-48"><a href="#cb5-48"></a><span class="co">#&gt; [3,]    0    0    1    0</span></span>
<span id="cb5-49"><a href="#cb5-49"></a><span class="co">#&gt; [4,]    0    0    0    1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><p>This model assumes an independent correlation structure, the output will be equal to glm.</p></li>
<li><p>The outputs started from a summary of residuals</p></li>
<li><p>The estimated coefficients are the same as GLM. For binary outcome, you may still interpret them as log odds. Naive SE and z value are estimated directly from this model. Robust SE and z are sandwich estimates.</p></li>
<li><p>The difference between naive and robust indicates that the correlation structure may not be good.</p></li>
<li><p>Working Correlation is the correlation structure estimated from the data (identity matrix for independence).</p></li>
</ul>
<p>Let fit the GEE model with exchangeable correlation structure:</p>
<div class="cell" data-hash="longitudinal2_cache/html/geeex_7bf08876572249e14a2686b9335f9230">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="do">## GEE with exchangeable matrix</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>resp_gee.ex <span class="ot">&lt;-</span> <span class="fu">gee</span>(nstat <span class="sc">~</span> centre <span class="sc">+</span> treatment <span class="sc">+</span> gender <span class="sc">+</span> baseline<span class="sc">+</span> age, </span>
<span id="cb6-3"><a href="#cb6-3"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb6-4"><a href="#cb6-4"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb6-5"><a href="#cb6-5"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>, <span class="at">scale.value =</span> <span class="dv">1</span>)</span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt; Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt; running glm to get initial regression estimate</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt;        (Intercept)            centre2 treatmenttreatment         gendermale </span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt;        -0.90017133         0.67160098         1.29921589         0.11924365 </span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt;       baselinegood                age </span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt;         1.88202860        -0.01816588</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="fu">summary</span>(resp_gee.ex)</span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">#&gt; </span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">#&gt;  GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#&gt;  gee S-function, version 4.13 modified 98/01/27 (1998) </span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">#&gt; </span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">#&gt; Model:</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">#&gt;  Link:                      Logit </span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#&gt;  Variance to Mean Relation: Binomial </span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co">#&gt;  Correlation Structure:     Exchangeable </span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co">#&gt; </span></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co">#&gt; Call:</span></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co">#&gt; gee(formula = nstat ~ centre + treatment + gender + baseline + </span></span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="co">#&gt;     age, id = subject, data = resp, family = "binomial", corstr = "exchangeable", </span></span>
<span id="cb6-25"><a href="#cb6-25"></a><span class="co">#&gt;     scale.fix = TRUE, scale.value = 1)</span></span>
<span id="cb6-26"><a href="#cb6-26"></a><span class="co">#&gt; </span></span>
<span id="cb6-27"><a href="#cb6-27"></a><span class="co">#&gt; Summary of Residuals:</span></span>
<span id="cb6-28"><a href="#cb6-28"></a><span class="co">#&gt;         Min          1Q      Median          3Q         Max </span></span>
<span id="cb6-29"><a href="#cb6-29"></a><span class="co">#&gt; -0.93134415 -0.30623174  0.08973552  0.33018952  0.84307712 </span></span>
<span id="cb6-30"><a href="#cb6-30"></a><span class="co">#&gt; </span></span>
<span id="cb6-31"><a href="#cb6-31"></a><span class="co">#&gt; </span></span>
<span id="cb6-32"><a href="#cb6-32"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb6-33"><a href="#cb6-33"></a><span class="co">#&gt;                       Estimate Naive S.E.    Naive z Robust S.E.   Robust z</span></span>
<span id="cb6-34"><a href="#cb6-34"></a><span class="co">#&gt; (Intercept)        -0.90017133  0.4784634 -1.8813796  0.46032700 -1.9555041</span></span>
<span id="cb6-35"><a href="#cb6-35"></a><span class="co">#&gt; centre2             0.67160098  0.3394723  1.9783676  0.35681913  1.8821889</span></span>
<span id="cb6-36"><a href="#cb6-36"></a><span class="co">#&gt; treatmenttreatment  1.29921589  0.3356101  3.8712064  0.35077797  3.7038127</span></span>
<span id="cb6-37"><a href="#cb6-37"></a><span class="co">#&gt; gendermale          0.11924365  0.4175568  0.2855747  0.44320235  0.2690501</span></span>
<span id="cb6-38"><a href="#cb6-38"></a><span class="co">#&gt; baselinegood        1.88202860  0.3419147  5.5043802  0.35005152  5.3764332</span></span>
<span id="cb6-39"><a href="#cb6-39"></a><span class="co">#&gt; age                -0.01816588  0.0125611 -1.4462014  0.01300426 -1.3969169</span></span>
<span id="cb6-40"><a href="#cb6-40"></a><span class="co">#&gt; </span></span>
<span id="cb6-41"><a href="#cb6-41"></a><span class="co">#&gt; Estimated Scale Parameter:  1</span></span>
<span id="cb6-42"><a href="#cb6-42"></a><span class="co">#&gt; Number of Iterations:  1</span></span>
<span id="cb6-43"><a href="#cb6-43"></a><span class="co">#&gt; </span></span>
<span id="cb6-44"><a href="#cb6-44"></a><span class="co">#&gt; Working Correlation</span></span>
<span id="cb6-45"><a href="#cb6-45"></a><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]</span></span>
<span id="cb6-46"><a href="#cb6-46"></a><span class="co">#&gt; [1,] 1.0000000 0.3359883 0.3359883 0.3359883</span></span>
<span id="cb6-47"><a href="#cb6-47"></a><span class="co">#&gt; [2,] 0.3359883 1.0000000 0.3359883 0.3359883</span></span>
<span id="cb6-48"><a href="#cb6-48"></a><span class="co">#&gt; [3,] 0.3359883 0.3359883 1.0000000 0.3359883</span></span>
<span id="cb6-49"><a href="#cb6-49"></a><span class="co">#&gt; [4,] 0.3359883 0.3359883 0.3359883 1.0000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><p>This model assumes an exchangeable correlation structure.</p></li>
<li><p>The outputs started from a summary of residuals</p></li>
<li><p>The estimated coefficients are the same GLM. For binary outcome, you may still interpret them as log odds. Naive S.E and z value are estimated directly from this model. Robust SE and z are sandwich estimates</p></li>
<li><p>The difference between naive and robust is smaller, which indicates that the correlation structure is better specified.</p></li>
<li><p>Working Correlation is the correlation structure estimated from the data</p></li>
</ul>
<p>Let’s check the estimated coefficients from all three models.</p>
<div class="cell" data-hash="longitudinal2_cache/html/summ_d40d8fc800fe119fd600a3e5b3cedefa">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">summary</span>(resp_glm)<span class="sc">$</span>coefficients</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">#&gt;                       Estimate  Std. Error    z value     Pr(&gt;|z|)</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt; (Intercept)        -0.90017133 0.337652992 -2.6659658 7.676750e-03</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt; centre2             0.67160098 0.239566555  2.8034004 5.056684e-03</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt; treatmenttreatment  1.29921589 0.236840962  5.4856047 4.120574e-08</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt; gendermale          0.11924365 0.294671000  0.4046671 6.857223e-01</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt; baselinegood        1.88202860 0.241290163  7.7998563 6.197770e-15</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">#&gt; age                -0.01816588 0.008864401 -2.0493065 4.043215e-02</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="fu">summary</span>(resp_gee.in)<span class="sc">$</span>coefficients</span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">#&gt;                       Estimate  Naive S.E.   Naive z Robust S.E.   Robust z</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">#&gt; (Intercept)        -0.90017133 0.337653052 -2.665965  0.46032700 -1.9555041</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">#&gt; centre2             0.67160098 0.239566599  2.803400  0.35681913  1.8821889</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">#&gt; treatmenttreatment  1.29921589 0.236841017  5.485603  0.35077797  3.7038127</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">#&gt; gendermale          0.11924365 0.294671045  0.404667  0.44320235  0.2690501</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#&gt; baselinegood        1.88202860 0.241290221  7.799854  0.35005152  5.3764332</span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">#&gt; age                -0.01816588 0.008864403 -2.049306  0.01300426 -1.3969169</span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="fu">summary</span>(resp_gee.ex)<span class="sc">$</span>coefficients</span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">#&gt;                       Estimate Naive S.E.    Naive z Robust S.E.   Robust z</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">#&gt; (Intercept)        -0.90017133  0.4784634 -1.8813796  0.46032700 -1.9555041</span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">#&gt; centre2             0.67160098  0.3394723  1.9783676  0.35681913  1.8821889</span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">#&gt; treatmenttreatment  1.29921589  0.3356101  3.8712064  0.35077797  3.7038127</span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co">#&gt; gendermale          0.11924365  0.4175568  0.2855747  0.44320235  0.2690501</span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co">#&gt; baselinegood        1.88202860  0.3419147  5.5043802  0.35005152  5.3764332</span></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="co">#&gt; age                -0.01816588  0.0125611 -1.4462014  0.01300426 -1.3969169</span></span>
<span id="cb7-25"><a href="#cb7-25"></a><span class="co"># Same estimated coefficients but different SEs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>GEE with identity matrix is the same as GLM model. If we change the correlation structure to exchangeable does not change the beta estimates, but the naive SEs are closer to Robust SE, which indicates that the exchangeable correlation structure is a better reflection of the correlation structures.</p>
</section><section id="gaussian-response" class="level4"><h4 class="anchored" data-anchor-id="gaussian-response">Gaussian response</h4>
<p>GEE can also be applied to Gaussian response</p>
<div class="cell" data-hash="longitudinal2_cache/html/gaus_14acb07d6181d1525ffd157f31545295">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">library</span>(gee)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="fu">library</span>(HSAUR2)</span>
<span id="cb8-3"><a href="#cb8-3"></a>BtheB<span class="sc">$</span>subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rownames</span>(BtheB))</span>
<span id="cb8-4"><a href="#cb8-4"></a>nobs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(BtheB)</span>
<span id="cb8-5"><a href="#cb8-5"></a>BtheB_long <span class="ot">&lt;-</span> <span class="fu">reshape</span>(BtheB, <span class="at">idvar =</span> <span class="st">"subject"</span>, </span>
<span id="cb8-6"><a href="#cb8-6"></a>                      <span class="at">varying =</span> <span class="fu">c</span>(<span class="st">"bdi.2m"</span>, <span class="st">"bdi.3m"</span>, <span class="st">"bdi.5m"</span>, <span class="st">"bdi.8m"</span>), </span>
<span id="cb8-7"><a href="#cb8-7"></a>                      <span class="at">direction =</span> <span class="st">"long"</span>)</span>
<span id="cb8-8"><a href="#cb8-8"></a>BtheB_long<span class="sc">$</span>time <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>), <span class="fu">rep</span>(nobs, <span class="dv">4</span>))</span>
<span id="cb8-9"><a href="#cb8-9"></a>osub <span class="ot">&lt;-</span> <span class="fu">order</span>(<span class="fu">as.integer</span>(BtheB_long<span class="sc">$</span>subject))</span>
<span id="cb8-10"><a href="#cb8-10"></a>BtheB_long <span class="ot">&lt;-</span> BtheB_long[osub,]</span>
<span id="cb8-11"><a href="#cb8-11"></a>btb_gee.ind <span class="ot">&lt;-</span> <span class="fu">gee</span>(bdi <span class="sc">~</span> bdi.pre <span class="sc">+</span> treatment <span class="sc">+</span> length <span class="sc">+</span> drug, </span>
<span id="cb8-12"><a href="#cb8-12"></a>               <span class="at">data =</span> BtheB_long, <span class="at">id =</span> subject, </span>
<span id="cb8-13"><a href="#cb8-13"></a>               <span class="at">family =</span> gaussian, <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#&gt; Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">#&gt; running glm to get initial regression estimate</span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co">#&gt;    (Intercept)        bdi.pre treatmentBtheB      length&gt;6m        drugYes </span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co">#&gt;      3.5686314      0.5818494     -3.2372285      1.4577182     -3.7412982</span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="fu">summary</span>(btb_gee.ind)</span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co">#&gt; </span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">#&gt;  GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co">#&gt;  gee S-function, version 4.13 modified 98/01/27 (1998) </span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">#&gt; </span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">#&gt; Model:</span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co">#&gt;  Link:                      Identity </span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co">#&gt;  Variance to Mean Relation: Gaussian </span></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="co">#&gt;  Correlation Structure:     Independent </span></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="co">#&gt; </span></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co">#&gt; Call:</span></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="co">#&gt; gee(formula = bdi ~ bdi.pre + treatment + length + drug, id = subject, </span></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="co">#&gt;     data = BtheB_long, family = gaussian, corstr = "independence")</span></span>
<span id="cb8-31"><a href="#cb8-31"></a><span class="co">#&gt; </span></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="co">#&gt; Summary of Residuals:</span></span>
<span id="cb8-33"><a href="#cb8-33"></a><span class="co">#&gt;         Min          1Q      Median          3Q         Max </span></span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="co">#&gt; -21.6497810  -5.8485100   0.1131663   5.5838383  28.1871039 </span></span>
<span id="cb8-35"><a href="#cb8-35"></a><span class="co">#&gt; </span></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="co">#&gt; </span></span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="co">#&gt;                  Estimate Naive S.E.   Naive z Robust S.E.   Robust z</span></span>
<span id="cb8-39"><a href="#cb8-39"></a><span class="co">#&gt; (Intercept)     3.5686314  1.4833349  2.405816  2.26947617  1.5724472</span></span>
<span id="cb8-40"><a href="#cb8-40"></a><span class="co">#&gt; bdi.pre         0.5818494  0.0563904 10.318235  0.09156455  6.3545274</span></span>
<span id="cb8-41"><a href="#cb8-41"></a><span class="co">#&gt; treatmentBtheB -3.2372285  1.1295569 -2.865928  1.77459534 -1.8242066</span></span>
<span id="cb8-42"><a href="#cb8-42"></a><span class="co">#&gt; length&gt;6m       1.4577182  1.1380277  1.280916  1.48255866  0.9832449</span></span>
<span id="cb8-43"><a href="#cb8-43"></a><span class="co">#&gt; drugYes        -3.7412982  1.1766321 -3.179667  1.78271179 -2.0986557</span></span>
<span id="cb8-44"><a href="#cb8-44"></a><span class="co">#&gt; </span></span>
<span id="cb8-45"><a href="#cb8-45"></a><span class="co">#&gt; Estimated Scale Parameter:  79.25813</span></span>
<span id="cb8-46"><a href="#cb8-46"></a><span class="co">#&gt; Number of Iterations:  1</span></span>
<span id="cb8-47"><a href="#cb8-47"></a><span class="co">#&gt; </span></span>
<span id="cb8-48"><a href="#cb8-48"></a><span class="co">#&gt; Working Correlation</span></span>
<span id="cb8-49"><a href="#cb8-49"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb8-50"><a href="#cb8-50"></a><span class="co">#&gt; [1,]    1    0    0    0</span></span>
<span id="cb8-51"><a href="#cb8-51"></a><span class="co">#&gt; [2,]    0    1    0    0</span></span>
<span id="cb8-52"><a href="#cb8-52"></a><span class="co">#&gt; [3,]    0    0    1    0</span></span>
<span id="cb8-53"><a href="#cb8-53"></a><span class="co">#&gt; [4,]    0    0    0    1</span></span>
<span id="cb8-54"><a href="#cb8-54"></a><span class="co"># require(Publish)</span></span>
<span id="cb8-55"><a href="#cb8-55"></a><span class="co"># publish(btb_gee.ind)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><p>This model assumes an independent correlation structure.</p></li>
<li><p>The outputs started from a summary of residuals</p></li>
<li><p>The estimated coefficient will be interpreted the same way as linear model. Naive S.E and z value are estimated directly from this model. Robust SE and z are sandwich estimates</p></li>
<li><p>Working Correlation is the correlation struture estimated from the data (identity matrix for indepedence)</p></li>
</ul>
<p>With exchangeable correlation matrix:</p>
<div class="cell" data-hash="longitudinal2_cache/html/gausex_66fe70cd53f1a5cf812e4a4231c968b6">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>btb_gee.ex <span class="ot">&lt;-</span> <span class="fu">gee</span>(bdi <span class="sc">~</span> bdi.pre <span class="sc">+</span> treatment <span class="sc">+</span> length <span class="sc">+</span> drug,</span>
<span id="cb9-2"><a href="#cb9-2"></a>                <span class="at">data =</span> BtheB_long, <span class="at">id =</span> subject, </span>
<span id="cb9-3"><a href="#cb9-3"></a>                <span class="at">family =</span> gaussian, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt; running glm to get initial regression estimate</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt;    (Intercept)        bdi.pre treatmentBtheB      length&gt;6m        drugYes </span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt;      3.5686314      0.5818494     -3.2372285      1.4577182     -3.7412982</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="fu">summary</span>(btb_gee.ex)</span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt; </span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt;  GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt;  gee S-function, version 4.13 modified 98/01/27 (1998) </span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt; </span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt; Model:</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt;  Link:                      Identity </span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt;  Variance to Mean Relation: Gaussian </span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt;  Correlation Structure:     Exchangeable </span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">#&gt; </span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">#&gt; Call:</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">#&gt; gee(formula = bdi ~ bdi.pre + treatment + length + drug, id = subject, </span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">#&gt;     data = BtheB_long, family = gaussian, corstr = "exchangeable")</span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co">#&gt; </span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co">#&gt; Summary of Residuals:</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">#&gt;        Min         1Q     Median         3Q        Max </span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">#&gt; -23.955980  -6.643864  -1.109741   4.257688  25.452310 </span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">#&gt; </span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="co">#&gt; </span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="co">#&gt;                  Estimate Naive S.E.     Naive z Robust S.E.   Robust z</span></span>
<span id="cb9-29"><a href="#cb9-29"></a><span class="co">#&gt; (Intercept)     3.0231602 2.30390185  1.31219140  2.23204410  1.3544357</span></span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="co">#&gt; bdi.pre         0.6479276 0.08228567  7.87412417  0.08351405  7.7583066</span></span>
<span id="cb9-31"><a href="#cb9-31"></a><span class="co">#&gt; treatmentBtheB -2.1692863 1.76642861 -1.22806339  1.73614385 -1.2494854</span></span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="co">#&gt; length&gt;6m      -0.1112910 1.73091679 -0.06429596  1.55092705 -0.0717577</span></span>
<span id="cb9-33"><a href="#cb9-33"></a><span class="co">#&gt; drugYes        -2.9995608 1.82569913 -1.64296559  1.73155411 -1.7322940</span></span>
<span id="cb9-34"><a href="#cb9-34"></a><span class="co">#&gt; </span></span>
<span id="cb9-35"><a href="#cb9-35"></a><span class="co">#&gt; Estimated Scale Parameter:  81.7349</span></span>
<span id="cb9-36"><a href="#cb9-36"></a><span class="co">#&gt; Number of Iterations:  5</span></span>
<span id="cb9-37"><a href="#cb9-37"></a><span class="co">#&gt; </span></span>
<span id="cb9-38"><a href="#cb9-38"></a><span class="co">#&gt; Working Correlation</span></span>
<span id="cb9-39"><a href="#cb9-39"></a><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]</span></span>
<span id="cb9-40"><a href="#cb9-40"></a><span class="co">#&gt; [1,] 1.0000000 0.6757951 0.6757951 0.6757951</span></span>
<span id="cb9-41"><a href="#cb9-41"></a><span class="co">#&gt; [2,] 0.6757951 1.0000000 0.6757951 0.6757951</span></span>
<span id="cb9-42"><a href="#cb9-42"></a><span class="co">#&gt; [3,] 0.6757951 0.6757951 1.0000000 0.6757951</span></span>
<span id="cb9-43"><a href="#cb9-43"></a><span class="co">#&gt; [4,] 0.6757951 0.6757951 0.6757951 1.0000000</span></span>
<span id="cb9-44"><a href="#cb9-44"></a><span class="co">#publish(btb_gee.ex)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><p>The interpretation of estimated coefficients are similar to LM. Naive S.E and z value are estimated directly from this model. Robust SE and z are sandwich estimates</p></li>
<li><p>Working Correlation is the correlation structure estimated from the data</p></li>
<li><p>When we change the structure of correlation, the estimates and naive SE and z changed. A closer naive SE to robust SE indicates that the correlation structure is better specified.</p></li>
</ul></section></section><section id="compare-with-random-effects" class="level3"><h3 class="anchored" data-anchor-id="compare-with-random-effects">Compare with Random Effects</h3>
<ul>
<li>ref: <span class="citation" data-cites="hothorn2014handbook">(<a href="#ref-hothorn2014handbook" role="doc-biblioref">Hothorn and Everitt 2014</a>)</span> Section 13.4 We then use the conditional models (i.e., adding random effect) with non-normal response</li>
</ul>
<p>Let us compare the GEE models with the mixed effect models.</p>
<div class="cell" data-hash="longitudinal2_cache/html/comp_0f4b290426cd8cb2ce71d619cab31e5d">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="do">## Generalized mixed effect model model</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">library</span>(<span class="st">"lme4"</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a>resp_lmer <span class="ot">&lt;-</span> <span class="fu">glmer</span>(nstat <span class="sc">~</span> baseline <span class="sc">+</span> month <span class="sc">+</span> treatment <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4"></a>                   gender <span class="sc">+</span> age <span class="sc">+</span> centre <span class="sc">+</span> </span>
<span id="cb10-5"><a href="#cb10-5"></a>                    (<span class="dv">1</span> <span class="sc">|</span> subject), <span class="at">family =</span> <span class="fu">binomial</span>(), </span>
<span id="cb10-6"><a href="#cb10-6"></a>                  <span class="at">data =</span> resp)</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt; Model failed to converge with max|grad| = 0.197453 (tol = 0.002, component 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="longitudinal2_cache/html/comp2_f531cf739ce75ef04e849a7d92ac98c3">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">require</span>(afex)</span>
<span id="cb11-2"><a href="#cb11-2"></a>resp_afex <span class="ot">&lt;-</span> <span class="fu">mixed</span>(nstat <span class="sc">~</span> baseline <span class="sc">+</span> month <span class="sc">+</span> treatment <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3"></a>                   gender <span class="sc">+</span> age <span class="sc">+</span> centre <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4"></a>                    (<span class="dv">1</span> <span class="sc">|</span> subject), <span class="at">family =</span> <span class="fu">binomial</span>(), </span>
<span id="cb11-5"><a href="#cb11-5"></a>                  <span class="at">data =</span> resp, <span class="at">method =</span> <span class="st">"LRT"</span>)</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt; Contrasts set to contr.sum for the following variables: baseline, month, treatment, gender, centre, subject</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt; Numerical variables NOT centered on 0: age</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt; If in interactions, interpretation of lower order (e.g., main) effects difficult.</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt; Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt; Model failed to converge with max|grad| = 0.00495318 (tol = 0.002, component 1)</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt; Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#&gt; Model failed to converge with max|grad| = 0.0047889 (tol = 0.002, component 1)</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">#&gt; Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">#&gt; Model failed to converge with max|grad| = 0.0466122 (tol = 0.002, component 1)</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">#&gt; Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">#&gt; Model failed to converge with max|grad| = 0.0949357 (tol = 0.002, component 1)</span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">#&gt; Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :</span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">#&gt; Model failed to converge with max|grad| = 0.041661 (tol = 0.002, component 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="longitudinal2_cache/html/comp3_affe3a131cd5439e5e0f9b5164f917c9">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="do">## GEE model</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>resp_gee3 <span class="ot">&lt;-</span> <span class="fu">gee</span>(nstat <span class="sc">~</span> baseline <span class="sc">+</span> month <span class="sc">+</span> treatment <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3"></a>                   gender <span class="sc">+</span> age <span class="sc">+</span> centre, </span>
<span id="cb12-4"><a href="#cb12-4"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb12-5"><a href="#cb12-5"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb12-6"><a href="#cb12-6"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>, <span class="at">scale.value =</span> <span class="dv">1</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#&gt; Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#&gt; running glm to get initial regression estimate</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#&gt;        (Intercept)       baselinegood            month.L            month.Q </span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">#&gt;        -0.90363465         1.88945124        -0.14372490        -0.02455122 </span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co">#&gt;            month.C treatmenttreatment         gendermale                age </span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">#&gt;        -0.23255161         1.30410916         0.11969528        -0.01823703 </span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">#&gt;            centre2 </span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co">#&gt;         0.67417628</span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="fu">library</span>(geepack)</span>
<span id="cb12-17"><a href="#cb12-17"></a>resp_gee4 <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> baseline <span class="sc">+</span> month <span class="sc">+</span> treatment <span class="sc">+</span> </span>
<span id="cb12-18"><a href="#cb12-18"></a>                   gender <span class="sc">+</span> age <span class="sc">+</span> centre, </span>
<span id="cb12-19"><a href="#cb12-19"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb12-20"><a href="#cb12-20"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb12-21"><a href="#cb12-21"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-22"><a href="#cb12-22"></a>resp_gee5 <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> baseline <span class="sc">+</span> month <span class="sc">+</span> treatment <span class="sc">+</span> </span>
<span id="cb12-23"><a href="#cb12-23"></a>                   gender <span class="sc">+</span> age <span class="sc">+</span> centre, </span>
<span id="cb12-24"><a href="#cb12-24"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb12-25"><a href="#cb12-25"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"independence"</span>, </span>
<span id="cb12-26"><a href="#cb12-26"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-27"><a href="#cb12-27"></a>resp_gee6 <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> baseline <span class="sc">+</span> month <span class="sc">+</span> treatment <span class="sc">+</span> </span>
<span id="cb12-28"><a href="#cb12-28"></a>                   gender <span class="sc">+</span> age <span class="sc">+</span> centre, </span>
<span id="cb12-29"><a href="#cb12-29"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb12-30"><a href="#cb12-30"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"ar1"</span>, </span>
<span id="cb12-31"><a href="#cb12-31"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-32"><a href="#cb12-32"></a><span class="fu">QIC</span>(resp_gee4)</span>
<span id="cb12-33"><a href="#cb12-33"></a><span class="co">#&gt;        QIC       QICu  Quasi Lik        CIC     params       QICC </span></span>
<span id="cb12-34"><a href="#cb12-34"></a><span class="co">#&gt;  510.94098  499.71690 -240.85845   14.61204    9.00000  513.14098</span></span>
<span id="cb12-35"><a href="#cb12-35"></a><span class="fu">QIC</span>(resp_gee5)</span>
<span id="cb12-36"><a href="#cb12-36"></a><span class="co">#&gt;        QIC       QICu  Quasi Lik        CIC     params       QICC </span></span>
<span id="cb12-37"><a href="#cb12-37"></a><span class="co">#&gt;  511.14981  499.69791 -240.84895   14.72595    9.00000  512.93199</span></span>
<span id="cb12-38"><a href="#cb12-38"></a><span class="fu">QIC</span>(resp_gee6)</span>
<span id="cb12-39"><a href="#cb12-39"></a><span class="co">#&gt;        QIC       QICu  Quasi Lik        CIC     params       QICC </span></span>
<span id="cb12-40"><a href="#cb12-40"></a><span class="co">#&gt;  511.81242  500.27657 -241.13829   14.76792    9.00000  514.01242</span></span>
<span id="cb12-41"><a href="#cb12-41"></a><span class="co"># Smaller QIC values for correlation structure represents better models</span></span>
<span id="cb12-42"><a href="#cb12-42"></a><span class="co"># i.e., "exchangeable" in our case</span></span>
<span id="cb12-43"><a href="#cb12-43"></a></span>
<span id="cb12-44"><a href="#cb12-44"></a>resp_gee4a <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> month <span class="sc">+</span> treatment <span class="sc">+</span> gender <span class="sc">+</span> age <span class="sc">+</span> centre, </span>
<span id="cb12-45"><a href="#cb12-45"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb12-46"><a href="#cb12-46"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb12-47"><a href="#cb12-47"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-48"><a href="#cb12-48"></a></span>
<span id="cb12-49"><a href="#cb12-49"></a>resp_gee4b <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> treatment <span class="sc">+</span> gender <span class="sc">+</span> age <span class="sc">+</span> centre, </span>
<span id="cb12-50"><a href="#cb12-50"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb12-51"><a href="#cb12-51"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb12-52"><a href="#cb12-52"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-53"><a href="#cb12-53"></a></span>
<span id="cb12-54"><a href="#cb12-54"></a>resp_gee4c <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> gender <span class="sc">+</span> age <span class="sc">+</span> centre, </span>
<span id="cb12-55"><a href="#cb12-55"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb12-56"><a href="#cb12-56"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb12-57"><a href="#cb12-57"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-58"><a href="#cb12-58"></a></span>
<span id="cb12-59"><a href="#cb12-59"></a>resp_gee4d <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> age <span class="sc">+</span> centre, </span>
<span id="cb12-60"><a href="#cb12-60"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb12-61"><a href="#cb12-61"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb12-62"><a href="#cb12-62"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-63"><a href="#cb12-63"></a></span>
<span id="cb12-64"><a href="#cb12-64"></a>resp_gee4e <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> centre, </span>
<span id="cb12-65"><a href="#cb12-65"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb12-66"><a href="#cb12-66"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb12-67"><a href="#cb12-67"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-68"><a href="#cb12-68"></a><span class="fu">QIC</span>(resp_gee4)</span>
<span id="cb12-69"><a href="#cb12-69"></a><span class="co">#&gt;        QIC       QICu  Quasi Lik        CIC     params       QICC </span></span>
<span id="cb12-70"><a href="#cb12-70"></a><span class="co">#&gt;  510.94098  499.71690 -240.85845   14.61204    9.00000  513.14098</span></span>
<span id="cb12-71"><a href="#cb12-71"></a><span class="fu">QIC</span>(resp_gee4a)[<span class="dv">2</span>]</span>
<span id="cb12-72"><a href="#cb12-72"></a><span class="co">#&gt;   QICu </span></span>
<span id="cb12-73"><a href="#cb12-73"></a><span class="co">#&gt; 567.35</span></span>
<span id="cb12-74"><a href="#cb12-74"></a><span class="fu">QIC</span>(resp_gee4b)[<span class="dv">2</span>]</span>
<span id="cb12-75"><a href="#cb12-75"></a><span class="co">#&gt;     QICu </span></span>
<span id="cb12-76"><a href="#cb12-76"></a><span class="co">#&gt; 562.6247</span></span>
<span id="cb12-77"><a href="#cb12-77"></a><span class="fu">QIC</span>(resp_gee4c)[<span class="dv">2</span>]</span>
<span id="cb12-78"><a href="#cb12-78"></a><span class="co">#&gt;     QICu </span></span>
<span id="cb12-79"><a href="#cb12-79"></a><span class="co">#&gt; 585.3099</span></span>
<span id="cb12-80"><a href="#cb12-80"></a><span class="fu">QIC</span>(resp_gee4d)[<span class="dv">2</span>]</span>
<span id="cb12-81"><a href="#cb12-81"></a><span class="co">#&gt;     QICu </span></span>
<span id="cb12-82"><a href="#cb12-82"></a><span class="co">#&gt; 586.1581</span></span>
<span id="cb12-83"><a href="#cb12-83"></a><span class="fu">QIC</span>(resp_gee4e)[<span class="dv">2</span>]</span>
<span id="cb12-84"><a href="#cb12-84"></a><span class="co">#&gt;     QICu </span></span>
<span id="cb12-85"><a href="#cb12-85"></a><span class="co">#&gt; 592.3437</span></span>
<span id="cb12-86"><a href="#cb12-86"></a><span class="fu">QIC</span>(resp_gee4d)[<span class="dv">2</span>]</span>
<span id="cb12-87"><a href="#cb12-87"></a><span class="co">#&gt;     QICu </span></span>
<span id="cb12-88"><a href="#cb12-88"></a><span class="co">#&gt; 586.1581</span></span>
<span id="cb12-89"><a href="#cb12-89"></a><span class="co"># Covariates are selected based on the QICu criteria</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="longitudinal2_cache/html/compsumm_9fd0a47cf7d4c1361464409d4736fa38">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="do">## compare estimates (conditional vs. marginal)</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="fu">summary</span>(resp_lmer)<span class="sc">$</span>coefficients <span class="co"># Model failed to converge</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt;                       Estimate Std. Error    z value     Pr(&gt;|z|)</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt; (Intercept)        -1.65464822 0.77621551 -2.1316866 3.303262e-02</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt; baselinegood        3.08898642 0.59858787  5.1604561 2.463489e-07</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#&gt; month.L            -0.20348428 0.27957512 -0.7278340 4.667152e-01</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#&gt; month.Q            -0.02821472 0.27907476 -0.1011009 9.194703e-01</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">#&gt; month.C            -0.35569321 0.28084908 -1.2664923 2.053369e-01</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">#&gt; treatmenttreatment  2.16621998 0.55157850  3.9273104 8.590108e-05</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">#&gt; gendermale          0.23836172 0.66606490  0.3578656 7.204439e-01</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">#&gt; age                -0.02557199 0.01993989 -1.2824544 1.996833e-01</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co">#&gt; centre2             1.03849559 0.54182606  1.9166586 5.528132e-02</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="fu">summary</span>(resp_afex)<span class="sc">$</span>coefficients <span class="co"># Model failed to converge</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">#&gt;                Estimate Std. Error    z value     Pr(&gt;|z|)</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">#&gt; (Intercept)  1.61366355 0.79597814  2.0272712 4.263469e-02</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co">#&gt; baseline1   -1.55321951 0.30467425 -5.0979678 3.433192e-07</span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co">#&gt; month1       0.21660822 0.24441639  0.8862263 3.754956e-01</span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="co">#&gt; month2      -0.17701748 0.24250556 -0.7299523 4.654194e-01</span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co">#&gt; month3       0.21559489 0.24440392  0.8821253 3.777090e-01</span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">#&gt; treatment1  -1.09162957 0.28098692 -3.8849836 1.023368e-04</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="co">#&gt; gender1     -0.10313396 0.33932808 -0.3039358 7.611768e-01</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co">#&gt; age         -0.02576276 0.02031564 -1.2681244 2.047535e-01</span></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co">#&gt; centre1     -0.52829986 0.27639119 -1.9114207 5.595053e-02</span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="fu">summary</span>(resp_gee3)<span class="sc">$</span>coefficients <span class="co"># Marginalized model</span></span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="co">#&gt;                       Estimate Naive S.E.    Naive z Robust S.E.   Robust z</span></span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="co">#&gt; (Intercept)        -0.90565507 0.47940039 -1.8891413  0.46042640 -1.9669920</span></span>
<span id="cb13-27"><a href="#cb13-27"></a><span class="co">#&gt; baselinegood        1.86665412 0.34220231  5.4548261  0.35023043  5.3297885</span></span>
<span id="cb13-28"><a href="#cb13-28"></a><span class="co">#&gt; month.L            -0.14330949 0.18044542 -0.7941986  0.18210027 -0.7869812</span></span>
<span id="cb13-29"><a href="#cb13-29"></a><span class="co">#&gt; month.Q            -0.02448267 0.18034926 -0.1357514  0.18329974 -0.1335663</span></span>
<span id="cb13-30"><a href="#cb13-30"></a><span class="co">#&gt; month.C            -0.23187407 0.18073662 -1.2829391  0.15929035 -1.4556693</span></span>
<span id="cb13-31"><a href="#cb13-31"></a><span class="co">#&gt; treatmenttreatment  1.28311415 0.33592099  3.8196903  0.35055323  3.6602548</span></span>
<span id="cb13-32"><a href="#cb13-32"></a><span class="co">#&gt; gendermale          0.11513183 0.41851611  0.2750953  0.44135628  0.2608592</span></span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="co">#&gt; age                -0.01785399 0.01258158 -1.4190585  0.01299686 -1.3737157</span></span>
<span id="cb13-34"><a href="#cb13-34"></a><span class="co">#&gt; centre2             0.68481139 0.34010911  2.0135050  0.35681635  1.9192265</span></span>
<span id="cb13-35"><a href="#cb13-35"></a><span class="fu">summary</span>(resp_gee4)<span class="sc">$</span>coefficients <span class="co"># Marginalized model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Estimate"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Std.err"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Wald"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>|W|)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"-0.90565577","2":"0.46042559","3":"3.86907740","4":"4.918355e-02","_rn_":"(Intercept)"},{"1":"1.86664028","2":"0.35022955","3":"28.40636763","4":"9.834132e-08","_rn_":"baselinegood"},{"1":"-0.14330937","2":"0.18209975","3":"0.61934188","4":"4.312920e-01","_rn_":"month.L"},{"1":"-0.02448266","2":"0.18329922","3":"0.01784004","4":"8.937453e-01","_rn_":"month.Q"},{"1":"-0.23187385","2":"0.15928992","3":"2.11898053","4":"1.454834e-01","_rn_":"month.C"},{"1":"1.28310331","2":"0.35055239","3":"13.39730286","4":"2.519864e-04","_rn_":"treatmenttreatment"},{"1":"0.11513002","2":"0.44135474","3":"0.06804584","4":"7.942036e-01","_rn_":"gendermale"},{"1":"-0.01785382","2":"0.01299683","3":"1.88706809","4":"1.695330e-01","_rn_":"age"},{"1":"0.68481801","2":"0.35681558","3":"3.68351745","4":"5.495281e-02","_rn_":"centre2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The significance of variables are similar in both variables, but the estimated coefficients are larger in generalized mixed effect model. However, it does not mean the estimated coefficients are inconsistent. Instead, two models are estimating different parameters. Remember, the mixed effect model is conditional on random effects, while the GEE is a marginalized model.</p>
</section><section id="video-content-optional" class="level3"><h3 class="anchored" data-anchor-id="video-content-optional">Video content (optional)</h3>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For those who prefer a video walkthrough, feel free to watch the video below, which offers a description of an earlier version of the above content.</p>
</div>
</div>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
<iframe src="https://www.youtube.com/embed/qoqhPq_VILc" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen="">
</iframe>
</div>
</section><section id="reference" class="level3"><h3 class="anchored" data-anchor-id="reference">Reference</h3>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-faraway2016extending" class="csl-entry" role="doc-biblioentry">
Faraway, Julian J. 2016. <em>Extending the Linear Model with r: Generalized Linear, Mixed Effects and Nonparametric Regression Models</em>. CRC press.
</div>
<div id="ref-hothorn2014handbook" class="csl-entry" role="doc-biblioentry">
Hothorn, Torsten, and Brian S Everitt. 2014. <em>A Handbook of Statistical Analyses Using r</em>. CRC press.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./longitudinal1.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Mixed effects models</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./longitudinalF.html" class="pagination-link">
        <span class="nav-page-text">R functions (T)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb14" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">## GEE {.unnumbered}</span></span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a>In this section, we will learn about generalized estimating equation (GEE). GEE is another popular method for modeling longitudinal or clustered data. In contrast to the mixed effects models where we assume error term and beta coefficients for subject $i$ both follow normal distribution, GEE is distribution free. However, we assume some correlation structures for within subjects/clusters. Hence, we can use GEE for non-normal data such as skewed data, binary data, or count data.</span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="in">```{r setup, warning=FALSE, message=FALSE, cache=TRUE}</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co"># Load required packages</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="fu">require</span>(HSAUR2)</span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="fu">library</span>(gee)</span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="fu">library</span>(geepack)</span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="fu">library</span>(<span class="st">"lme4"</span>)</span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="fu">require</span>(afex)</span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="in">```</span></span>
<span id="cb14-15"><a href="#cb14-15"></a></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="fu">### Data Description</span></span>
<span id="cb14-17"><a href="#cb14-17"></a></span>
<span id="cb14-18"><a href="#cb14-18"></a>In addition to BtheB dataset in part 1, we used respiratory data from **HSAUR2** package to demonstrate the analysis with non-normal responses:</span>
<span id="cb14-19"><a href="#cb14-19"></a></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="ss">-   </span>The response variable in this dataset is **status** (the respiratory status), which is a binary response</span>
<span id="cb14-21"><a href="#cb14-21"></a><span class="ss">-   </span>Other covariates are: treatment, age, gender, the study center</span>
<span id="cb14-22"><a href="#cb14-22"></a><span class="ss">-   </span>The response has been measured at 0, 1, 2, 3, 4 mths for each subject</span>
<span id="cb14-23"><a href="#cb14-23"></a></span>
<span id="cb14-24"><a href="#cb14-24"></a><span class="in">```{r load, cache=TRUE}</span></span>
<span id="cb14-25"><a href="#cb14-25"></a><span class="fu">data</span>(<span class="st">"respiratory"</span>, <span class="at">package =</span> <span class="st">"HSAUR2"</span>)</span>
<span id="cb14-26"><a href="#cb14-26"></a><span class="fu">head</span>(respiratory)</span>
<span id="cb14-27"><a href="#cb14-27"></a><span class="in">```</span></span>
<span id="cb14-28"><a href="#cb14-28"></a></span>
<span id="cb14-29"><a href="#cb14-29"></a><span class="fu">### Methods for Non-normal Distributions</span></span>
<span id="cb14-30"><a href="#cb14-30"></a></span>
<span id="cb14-31"><a href="#cb14-31"></a><span class="ss">-   </span>ref: <span class="co">[</span><span class="ot">@hothorn2014handbook</span><span class="co">]</span> Section 13.2</span>
<span id="cb14-32"><a href="#cb14-32"></a></span>
<span id="cb14-33"><a href="#cb14-33"></a><span class="ss">-   </span>In addition to normally distributed response variables, the response variable can also follow non-normal distributions, such as binary or count responses.</span>
<span id="cb14-34"><a href="#cb14-34"></a></span>
<span id="cb14-35"><a href="#cb14-35"></a><span class="ss">-   </span>We have learned logistic regression or Poisson regression (glm) to analyze binary and count data but they are not considering the "repeated measurement" structure.</span>
<span id="cb14-36"><a href="#cb14-36"></a></span>
<span id="cb14-37"><a href="#cb14-37"></a><span class="ss">-   </span>The consequence of ignoring the longitudinal/repeated measurements structure is to have the wrong estimated standard errors for regression coefficients. Hence, our inference will be invalid. However, the glm still gives consistent estimated beta coefficients.</span>
<span id="cb14-38"><a href="#cb14-38"></a></span>
<span id="cb14-39"><a href="#cb14-39"></a><span class="ss">-   </span>There are many correlation structures in modelling GEE.</span>
<span id="cb14-40"><a href="#cb14-40"></a></span>
<span id="cb14-41"><a href="#cb14-41"></a><span class="ss">-   </span>With non-normal responses, different assumptions about these correlation structures can lead to different interpretations of the beta coefficients. Here, we will introduce two different GEE models: **marginal model** and **conditional model**.</span>
<span id="cb14-42"><a href="#cb14-42"></a></span>
<span id="cb14-43"><a href="#cb14-43"></a><span class="fu">### Marginal Models</span></span>
<span id="cb14-44"><a href="#cb14-44"></a></span>
<span id="cb14-45"><a href="#cb14-45"></a><span class="ss">-   </span>ref: <span class="co">[</span><span class="ot">@hothorn2014handbook</span><span class="co">]</span> Section 13.2.1</span>
<span id="cb14-46"><a href="#cb14-46"></a></span>
<span id="cb14-47"><a href="#cb14-47"></a>Repeated measurement and longitudinal data has responses taken at different time points. Therefore, we could simply review them as many series of cross-sectional data. Each cross-sectional data can be analyzed using glm introduced in previous lectures. Then a correlation structure can be assumed to connect different "cross-sections". The common correlation structures are:</span>
<span id="cb14-48"><a href="#cb14-48"></a></span>
<span id="cb14-49"><a href="#cb14-49"></a><span class="fu">#### An independent structure</span></span>
<span id="cb14-50"><a href="#cb14-50"></a></span>
<span id="cb14-51"><a href="#cb14-51"></a>An independent structure which assumes the repeated measures are independent. An example of independent structure is basically is an identity matrix:</span>
<span id="cb14-52"><a href="#cb14-52"></a></span>
<span id="cb14-53"><a href="#cb14-53"></a>$$</span>
<span id="cb14-54"><a href="#cb14-54"></a>\left(\begin{array}{ccc} </span>
<span id="cb14-55"><a href="#cb14-55"></a>1 &amp; 0 &amp; 0<span class="sc">\\</span> </span>
<span id="cb14-56"><a href="#cb14-56"></a>0 &amp; 1 &amp; 0<span class="sc">\\</span></span>
<span id="cb14-57"><a href="#cb14-57"></a>0 &amp; 0 &amp; 1</span>
<span id="cb14-58"><a href="#cb14-58"></a>\end{array}\right)</span>
<span id="cb14-59"><a href="#cb14-59"></a>$$</span>
<span id="cb14-60"><a href="#cb14-60"></a></span>
<span id="cb14-61"><a href="#cb14-61"></a><span class="fu">#### An exchangeable correlation</span></span>
<span id="cb14-62"><a href="#cb14-62"></a></span>
<span id="cb14-63"><a href="#cb14-63"></a>An exchangeable correlation assumes that for the each individual, the correlation between each pair of repeated measurements is the same, i.e., $Cor(Y_{ij},Y_{ik})=\rho$. In the correlation matrix, only $\rho$ is unknown. Therefore, it is a single parameter working correlation matrix. An example of exchangeable correlation matrix is:</span>
<span id="cb14-64"><a href="#cb14-64"></a></span>
<span id="cb14-65"><a href="#cb14-65"></a>$$</span>
<span id="cb14-66"><a href="#cb14-66"></a>\left(\begin{array}{ccc} </span>
<span id="cb14-67"><a href="#cb14-67"></a>1 &amp; \rho &amp; \rho<span class="sc">\\</span> </span>
<span id="cb14-68"><a href="#cb14-68"></a>\rho &amp; 1 &amp; \rho<span class="sc">\\</span></span>
<span id="cb14-69"><a href="#cb14-69"></a>\rho &amp; \rho &amp; 1</span>
<span id="cb14-70"><a href="#cb14-70"></a>\end{array}\right)</span>
<span id="cb14-71"><a href="#cb14-71"></a>$$</span>
<span id="cb14-72"><a href="#cb14-72"></a></span>
<span id="cb14-73"><a href="#cb14-73"></a><span class="fu">#### An AR-1 autoregressive correlation</span></span>
<span id="cb14-74"><a href="#cb14-74"></a></span>
<span id="cb14-75"><a href="#cb14-75"></a>Defined as $Cor(Y_{ij},Y_{ik})=\rho^{|k-j|}$. If two measurements are taken at two closer time points the correlation is higher than these taken at two farther apart time points. It is also a single parameter working correlation matrix. An example of AR-1 correlation matrix is:</span>
<span id="cb14-76"><a href="#cb14-76"></a></span>
<span id="cb14-77"><a href="#cb14-77"></a>$$</span>
<span id="cb14-78"><a href="#cb14-78"></a>\left(\begin{array}{ccc} </span>
<span id="cb14-79"><a href="#cb14-79"></a>1 &amp; \rho &amp; \rho^2<span class="sc">\\</span> </span>
<span id="cb14-80"><a href="#cb14-80"></a>\rho &amp; 1 &amp; \rho<span class="sc">\\</span></span>
<span id="cb14-81"><a href="#cb14-81"></a>\rho^2 &amp; \rho &amp; 1</span>
<span id="cb14-82"><a href="#cb14-82"></a>\end{array}\right)</span>
<span id="cb14-83"><a href="#cb14-83"></a>$$</span>
<span id="cb14-84"><a href="#cb14-84"></a></span>
<span id="cb14-85"><a href="#cb14-85"></a><span class="fu">#### An unstructured correlation</span></span>
<span id="cb14-86"><a href="#cb14-86"></a></span>
<span id="cb14-87"><a href="#cb14-87"></a>Different pairs of observation for each individual have different correlations $Cor(Y_{ij},Y_{ik})=\rho_{jk}$. Assume that each individual has $K$ pairs of measurements, it is a $K(K-1)/2$ parameters working correlation matrix. An example of unstructured correlation matrix is:</span>
<span id="cb14-88"><a href="#cb14-88"></a></span>
<span id="cb14-89"><a href="#cb14-89"></a>$$</span>
<span id="cb14-90"><a href="#cb14-90"></a>\left(\begin{array}{ccc} </span>
<span id="cb14-91"><a href="#cb14-91"></a>1 &amp; \rho_{12} &amp; \rho_{13}<span class="sc">\\</span> </span>
<span id="cb14-92"><a href="#cb14-92"></a>\rho_{12} &amp; 1 &amp; \rho_{23}<span class="sc">\\</span></span>
<span id="cb14-93"><a href="#cb14-93"></a>\rho_{13} &amp; \rho_{23} &amp; 1</span>
<span id="cb14-94"><a href="#cb14-94"></a>\end{array}\right)</span>
<span id="cb14-95"><a href="#cb14-95"></a>$$</span>
<span id="cb14-96"><a href="#cb14-96"></a></span>
<span id="cb14-97"><a href="#cb14-97"></a><span class="ss">-   </span>Sometimes, specifying a "right" correlation matrix is hard. However, the marginal model (usually we use GEE) gives us consistent estimated coefficients even with misspecified correlation structure.</span>
<span id="cb14-98"><a href="#cb14-98"></a></span>
<span id="cb14-99"><a href="#cb14-99"></a><span class="fu">### Conditional Models</span></span>
<span id="cb14-100"><a href="#cb14-100"></a></span>
<span id="cb14-101"><a href="#cb14-101"></a><span class="ss">-   </span>ref: <span class="co">[</span><span class="ot">@hothorn2014handbook</span><span class="co">]</span> Section 13.2.2</span>
<span id="cb14-102"><a href="#cb14-102"></a></span>
<span id="cb14-103"><a href="#cb14-103"></a><span class="ss">-   </span>In GEE marginal models, the estimated regression coefficients are marginal (or population-averaged) effects. Therefore, the interpretation are at population-level. It is almost impossible to make inference on any specific individual or cluster.</span>
<span id="cb14-104"><a href="#cb14-104"></a></span>
<span id="cb14-105"><a href="#cb14-105"></a><span class="ss">-   </span>One solution is to do conditional models. The random effect approach in the part 1 can be extended to non-Gaussian response.</span>
<span id="cb14-106"><a href="#cb14-106"></a></span>
<span id="cb14-107"><a href="#cb14-107"></a><span class="fu">### GEE models</span></span>
<span id="cb14-108"><a href="#cb14-108"></a></span>
<span id="cb14-109"><a href="#cb14-109"></a>After the short introduction of two models, let's take a look at real examples</span>
<span id="cb14-110"><a href="#cb14-110"></a></span>
<span id="cb14-111"><a href="#cb14-111"></a><span class="ss">-   </span>ref: <span class="co">[</span><span class="ot">@hothorn2014handbook</span><span class="co">]</span> Section 13.3</span>
<span id="cb14-112"><a href="#cb14-112"></a><span class="ss">-   </span>ref: <span class="co">[</span><span class="ot">@faraway2016extending</span><span class="co">]</span> Section 10.2</span>
<span id="cb14-113"><a href="#cb14-113"></a></span>
<span id="cb14-114"><a href="#cb14-114"></a><span class="fu">#### Binary response</span></span>
<span id="cb14-115"><a href="#cb14-115"></a></span>
<span id="cb14-116"><a href="#cb14-116"></a>We started with binary response using respiratory dataset:</span>
<span id="cb14-117"><a href="#cb14-117"></a></span>
<span id="cb14-118"><a href="#cb14-118"></a><span class="in">```{r gee1, cache=TRUE}</span></span>
<span id="cb14-119"><a href="#cb14-119"></a><span class="fu">library</span>(gee)</span>
<span id="cb14-120"><a href="#cb14-120"></a><span class="fu">data</span>(<span class="st">"respiratory"</span>, <span class="at">package =</span> <span class="st">"HSAUR2"</span>)</span>
<span id="cb14-121"><a href="#cb14-121"></a><span class="do">## Data manipulation</span></span>
<span id="cb14-122"><a href="#cb14-122"></a>resp <span class="ot">&lt;-</span> <span class="fu">subset</span>(respiratory, month <span class="sc">&gt;</span> <span class="st">"0"</span>)</span>
<span id="cb14-123"><a href="#cb14-123"></a>resp<span class="sc">$</span>baseline <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">subset</span>(respiratory, month <span class="sc">==</span> <span class="st">"0"</span>)<span class="sc">$</span>status, <span class="fu">rep</span>(<span class="dv">4</span>, <span class="dv">111</span>))</span>
<span id="cb14-124"><a href="#cb14-124"></a><span class="do">## Change the response to 0 and 1</span></span>
<span id="cb14-125"><a href="#cb14-125"></a>resp<span class="sc">$</span>nstat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(resp<span class="sc">$</span>status <span class="sc">==</span> <span class="st">"good"</span>)</span>
<span id="cb14-126"><a href="#cb14-126"></a>resp<span class="sc">$</span>month <span class="ot">&lt;-</span> resp<span class="sc">$</span>month[, drop <span class="ot">=</span> <span class="cn">TRUE</span>]</span>
<span id="cb14-127"><a href="#cb14-127"></a><span class="in">```</span></span>
<span id="cb14-128"><a href="#cb14-128"></a></span>
<span id="cb14-129"><a href="#cb14-129"></a>Now we will fit a regular glm, i.e., model without random effect or any correlation structures. For binary outcomes, the estimated coefficients are log odds.</span>
<span id="cb14-130"><a href="#cb14-130"></a></span>
<span id="cb14-131"><a href="#cb14-131"></a><span class="in">```{r gee2, cache=TRUE}</span></span>
<span id="cb14-132"><a href="#cb14-132"></a><span class="do">## Regular GLM </span></span>
<span id="cb14-133"><a href="#cb14-133"></a>resp_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(status <span class="sc">~</span> centre <span class="sc">+</span> treatment <span class="sc">+</span> gender <span class="sc">+</span> baseline<span class="sc">+</span> age, </span>
<span id="cb14-134"><a href="#cb14-134"></a>                <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb14-135"><a href="#cb14-135"></a><span class="fu">summary</span>(resp_glm)</span>
<span id="cb14-136"><a href="#cb14-136"></a><span class="in">```</span></span>
<span id="cb14-137"><a href="#cb14-137"></a></span>
<span id="cb14-138"><a href="#cb14-138"></a>Now we will fit GEE with independent correlation structure:</span>
<span id="cb14-139"><a href="#cb14-139"></a></span>
<span id="cb14-140"><a href="#cb14-140"></a><span class="in">```{r gee3, cache=TRUE}</span></span>
<span id="cb14-141"><a href="#cb14-141"></a><span class="do">## GEE with identity matrix</span></span>
<span id="cb14-142"><a href="#cb14-142"></a>resp_gee.in <span class="ot">&lt;-</span> <span class="fu">gee</span>(nstat <span class="sc">~</span> centre <span class="sc">+</span> treatment <span class="sc">+</span> gender <span class="sc">+</span> baseline <span class="sc">+</span> age, </span>
<span id="cb14-143"><a href="#cb14-143"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb14-144"><a href="#cb14-144"></a>                 <span class="at">id =</span> subject,<span class="at">corstr =</span> <span class="st">"independence"</span>, </span>
<span id="cb14-145"><a href="#cb14-145"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>, <span class="at">scale.value =</span> <span class="dv">1</span>)</span>
<span id="cb14-146"><a href="#cb14-146"></a><span class="fu">summary</span>(resp_gee.in)</span>
<span id="cb14-147"><a href="#cb14-147"></a><span class="in">```</span></span>
<span id="cb14-148"><a href="#cb14-148"></a></span>
<span id="cb14-149"><a href="#cb14-149"></a><span class="ss">-   </span>This model assumes an independent correlation structure, the output will be equal to glm.</span>
<span id="cb14-150"><a href="#cb14-150"></a></span>
<span id="cb14-151"><a href="#cb14-151"></a><span class="ss">-   </span>The outputs started from a summary of residuals</span>
<span id="cb14-152"><a href="#cb14-152"></a></span>
<span id="cb14-153"><a href="#cb14-153"></a><span class="ss">-   </span>The estimated coefficients are the same as GLM. For binary outcome, you may still interpret them as log odds. Naive SE and z value are estimated directly from this model. Robust SE and z are sandwich estimates.</span>
<span id="cb14-154"><a href="#cb14-154"></a></span>
<span id="cb14-155"><a href="#cb14-155"></a><span class="ss">-   </span>The difference between naive and robust indicates that the correlation structure may not be good.</span>
<span id="cb14-156"><a href="#cb14-156"></a></span>
<span id="cb14-157"><a href="#cb14-157"></a><span class="ss">-   </span>Working Correlation is the correlation structure estimated from the data (identity matrix for independence).</span>
<span id="cb14-158"><a href="#cb14-158"></a></span>
<span id="cb14-159"><a href="#cb14-159"></a>Let fit the GEE model with exchangeable correlation structure:</span>
<span id="cb14-160"><a href="#cb14-160"></a></span>
<span id="cb14-161"><a href="#cb14-161"></a><span class="in">```{r geeex, cache=TRUE}</span></span>
<span id="cb14-162"><a href="#cb14-162"></a><span class="do">## GEE with exchangeable matrix</span></span>
<span id="cb14-163"><a href="#cb14-163"></a>resp_gee.ex <span class="ot">&lt;-</span> <span class="fu">gee</span>(nstat <span class="sc">~</span> centre <span class="sc">+</span> treatment <span class="sc">+</span> gender <span class="sc">+</span> baseline<span class="sc">+</span> age, </span>
<span id="cb14-164"><a href="#cb14-164"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb14-165"><a href="#cb14-165"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb14-166"><a href="#cb14-166"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>, <span class="at">scale.value =</span> <span class="dv">1</span>)</span>
<span id="cb14-167"><a href="#cb14-167"></a><span class="fu">summary</span>(resp_gee.ex)</span>
<span id="cb14-168"><a href="#cb14-168"></a><span class="in">```</span></span>
<span id="cb14-169"><a href="#cb14-169"></a></span>
<span id="cb14-170"><a href="#cb14-170"></a><span class="ss">-   </span>This model assumes an exchangeable correlation structure.</span>
<span id="cb14-171"><a href="#cb14-171"></a></span>
<span id="cb14-172"><a href="#cb14-172"></a><span class="ss">-   </span>The outputs started from a summary of residuals</span>
<span id="cb14-173"><a href="#cb14-173"></a></span>
<span id="cb14-174"><a href="#cb14-174"></a><span class="ss">-   </span>The estimated coefficients are the same GLM. For binary outcome, you may still interpret them as log odds. Naive S.E and z value are estimated directly from this model. Robust SE and z are sandwich estimates</span>
<span id="cb14-175"><a href="#cb14-175"></a></span>
<span id="cb14-176"><a href="#cb14-176"></a><span class="ss">-   </span>The difference between naive and robust is smaller, which indicates that the correlation structure is better specified.</span>
<span id="cb14-177"><a href="#cb14-177"></a></span>
<span id="cb14-178"><a href="#cb14-178"></a><span class="ss">-   </span>Working Correlation is the correlation structure estimated from the data</span>
<span id="cb14-179"><a href="#cb14-179"></a></span>
<span id="cb14-180"><a href="#cb14-180"></a>Let's check the estimated coefficients from all three models.</span>
<span id="cb14-181"><a href="#cb14-181"></a></span>
<span id="cb14-182"><a href="#cb14-182"></a><span class="in">```{r summ, cache=TRUE}</span></span>
<span id="cb14-183"><a href="#cb14-183"></a><span class="fu">summary</span>(resp_glm)<span class="sc">$</span>coefficients</span>
<span id="cb14-184"><a href="#cb14-184"></a><span class="fu">summary</span>(resp_gee.in)<span class="sc">$</span>coefficients</span>
<span id="cb14-185"><a href="#cb14-185"></a><span class="fu">summary</span>(resp_gee.ex)<span class="sc">$</span>coefficients</span>
<span id="cb14-186"><a href="#cb14-186"></a><span class="co"># Same estimated coefficients but different SEs</span></span>
<span id="cb14-187"><a href="#cb14-187"></a><span class="in">```</span></span>
<span id="cb14-188"><a href="#cb14-188"></a></span>
<span id="cb14-189"><a href="#cb14-189"></a>GEE with identity matrix is the same as GLM model. If we change the correlation structure to exchangeable does not change the beta estimates, but the naive SEs are closer to Robust SE, which indicates that the exchangeable correlation structure is a better reflection of the correlation structures.</span>
<span id="cb14-190"><a href="#cb14-190"></a></span>
<span id="cb14-191"><a href="#cb14-191"></a><span class="fu">#### Gaussian response</span></span>
<span id="cb14-192"><a href="#cb14-192"></a></span>
<span id="cb14-193"><a href="#cb14-193"></a>GEE can also be applied to Gaussian response</span>
<span id="cb14-194"><a href="#cb14-194"></a></span>
<span id="cb14-195"><a href="#cb14-195"></a><span class="in">```{r gaus, cache=TRUE}</span></span>
<span id="cb14-196"><a href="#cb14-196"></a><span class="fu">library</span>(gee)</span>
<span id="cb14-197"><a href="#cb14-197"></a><span class="fu">library</span>(HSAUR2)</span>
<span id="cb14-198"><a href="#cb14-198"></a>BtheB<span class="sc">$</span>subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rownames</span>(BtheB))</span>
<span id="cb14-199"><a href="#cb14-199"></a>nobs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(BtheB)</span>
<span id="cb14-200"><a href="#cb14-200"></a>BtheB_long <span class="ot">&lt;-</span> <span class="fu">reshape</span>(BtheB, <span class="at">idvar =</span> <span class="st">"subject"</span>, </span>
<span id="cb14-201"><a href="#cb14-201"></a>                      <span class="at">varying =</span> <span class="fu">c</span>(<span class="st">"bdi.2m"</span>, <span class="st">"bdi.3m"</span>, <span class="st">"bdi.5m"</span>, <span class="st">"bdi.8m"</span>), </span>
<span id="cb14-202"><a href="#cb14-202"></a>                      <span class="at">direction =</span> <span class="st">"long"</span>)</span>
<span id="cb14-203"><a href="#cb14-203"></a>BtheB_long<span class="sc">$</span>time <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>), <span class="fu">rep</span>(nobs, <span class="dv">4</span>))</span>
<span id="cb14-204"><a href="#cb14-204"></a>osub <span class="ot">&lt;-</span> <span class="fu">order</span>(<span class="fu">as.integer</span>(BtheB_long<span class="sc">$</span>subject))</span>
<span id="cb14-205"><a href="#cb14-205"></a>BtheB_long <span class="ot">&lt;-</span> BtheB_long[osub,]</span>
<span id="cb14-206"><a href="#cb14-206"></a>btb_gee.ind <span class="ot">&lt;-</span> <span class="fu">gee</span>(bdi <span class="sc">~</span> bdi.pre <span class="sc">+</span> treatment <span class="sc">+</span> length <span class="sc">+</span> drug, </span>
<span id="cb14-207"><a href="#cb14-207"></a>               <span class="at">data =</span> BtheB_long, <span class="at">id =</span> subject, </span>
<span id="cb14-208"><a href="#cb14-208"></a>               <span class="at">family =</span> gaussian, <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb14-209"><a href="#cb14-209"></a><span class="fu">summary</span>(btb_gee.ind)</span>
<span id="cb14-210"><a href="#cb14-210"></a><span class="co"># require(Publish)</span></span>
<span id="cb14-211"><a href="#cb14-211"></a><span class="co"># publish(btb_gee.ind)</span></span>
<span id="cb14-212"><a href="#cb14-212"></a><span class="in">```</span></span>
<span id="cb14-213"><a href="#cb14-213"></a></span>
<span id="cb14-214"><a href="#cb14-214"></a><span class="ss">-   </span>This model assumes an independent correlation structure.</span>
<span id="cb14-215"><a href="#cb14-215"></a></span>
<span id="cb14-216"><a href="#cb14-216"></a><span class="ss">-   </span>The outputs started from a summary of residuals</span>
<span id="cb14-217"><a href="#cb14-217"></a></span>
<span id="cb14-218"><a href="#cb14-218"></a><span class="ss">-   </span>The estimated coefficient will be interpreted the same way as linear model. Naive S.E and z value are estimated directly from this model. Robust SE and z are sandwich estimates</span>
<span id="cb14-219"><a href="#cb14-219"></a></span>
<span id="cb14-220"><a href="#cb14-220"></a><span class="ss">-   </span>Working Correlation is the correlation struture estimated from the data (identity matrix for indepedence)</span>
<span id="cb14-221"><a href="#cb14-221"></a></span>
<span id="cb14-222"><a href="#cb14-222"></a>With exchangeable correlation matrix:</span>
<span id="cb14-223"><a href="#cb14-223"></a></span>
<span id="cb14-224"><a href="#cb14-224"></a><span class="in">```{r gausex,cache=TRUE}</span></span>
<span id="cb14-225"><a href="#cb14-225"></a>btb_gee.ex <span class="ot">&lt;-</span> <span class="fu">gee</span>(bdi <span class="sc">~</span> bdi.pre <span class="sc">+</span> treatment <span class="sc">+</span> length <span class="sc">+</span> drug,</span>
<span id="cb14-226"><a href="#cb14-226"></a>                <span class="at">data =</span> BtheB_long, <span class="at">id =</span> subject, </span>
<span id="cb14-227"><a href="#cb14-227"></a>                <span class="at">family =</span> gaussian, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>)</span>
<span id="cb14-228"><a href="#cb14-228"></a><span class="fu">summary</span>(btb_gee.ex)</span>
<span id="cb14-229"><a href="#cb14-229"></a><span class="co">#publish(btb_gee.ex)</span></span>
<span id="cb14-230"><a href="#cb14-230"></a><span class="in">```</span></span>
<span id="cb14-231"><a href="#cb14-231"></a></span>
<span id="cb14-232"><a href="#cb14-232"></a><span class="ss">-   </span>The interpretation of estimated coefficients are similar to LM. Naive S.E and z value are estimated directly from this model. Robust SE and z are sandwich estimates</span>
<span id="cb14-233"><a href="#cb14-233"></a></span>
<span id="cb14-234"><a href="#cb14-234"></a><span class="ss">-   </span>Working Correlation is the correlation structure estimated from the data</span>
<span id="cb14-235"><a href="#cb14-235"></a></span>
<span id="cb14-236"><a href="#cb14-236"></a><span class="ss">-   </span>When we change the structure of correlation, the estimates and naive SE and z changed. A closer naive SE to robust SE indicates that the correlation structure is better specified.</span>
<span id="cb14-237"><a href="#cb14-237"></a></span>
<span id="cb14-238"><a href="#cb14-238"></a><span class="fu">### Compare with Random Effects</span></span>
<span id="cb14-239"><a href="#cb14-239"></a></span>
<span id="cb14-240"><a href="#cb14-240"></a><span class="ss">-   </span>ref: <span class="co">[</span><span class="ot">@hothorn2014handbook</span><span class="co">]</span> Section 13.4 We then use the conditional models (i.e., adding random effect) with non-normal response</span>
<span id="cb14-241"><a href="#cb14-241"></a></span>
<span id="cb14-242"><a href="#cb14-242"></a>Let us compare the GEE models with the mixed effect models.</span>
<span id="cb14-243"><a href="#cb14-243"></a></span>
<span id="cb14-244"><a href="#cb14-244"></a><span class="in">```{r comp,cache=TRUE}</span></span>
<span id="cb14-245"><a href="#cb14-245"></a><span class="do">## Generalized mixed effect model model</span></span>
<span id="cb14-246"><a href="#cb14-246"></a><span class="fu">library</span>(<span class="st">"lme4"</span>)</span>
<span id="cb14-247"><a href="#cb14-247"></a>resp_lmer <span class="ot">&lt;-</span> <span class="fu">glmer</span>(nstat <span class="sc">~</span> baseline <span class="sc">+</span> month <span class="sc">+</span> treatment <span class="sc">+</span> </span>
<span id="cb14-248"><a href="#cb14-248"></a>                   gender <span class="sc">+</span> age <span class="sc">+</span> centre <span class="sc">+</span> </span>
<span id="cb14-249"><a href="#cb14-249"></a>                    (<span class="dv">1</span> <span class="sc">|</span> subject), <span class="at">family =</span> <span class="fu">binomial</span>(), </span>
<span id="cb14-250"><a href="#cb14-250"></a>                  <span class="at">data =</span> resp)</span>
<span id="cb14-251"><a href="#cb14-251"></a><span class="in">```</span></span>
<span id="cb14-252"><a href="#cb14-252"></a></span>
<span id="cb14-253"><a href="#cb14-253"></a><span class="in">```{r comp2,cache=TRUE}</span></span>
<span id="cb14-254"><a href="#cb14-254"></a><span class="fu">require</span>(afex)</span>
<span id="cb14-255"><a href="#cb14-255"></a>resp_afex <span class="ot">&lt;-</span> <span class="fu">mixed</span>(nstat <span class="sc">~</span> baseline <span class="sc">+</span> month <span class="sc">+</span> treatment <span class="sc">+</span> </span>
<span id="cb14-256"><a href="#cb14-256"></a>                   gender <span class="sc">+</span> age <span class="sc">+</span> centre <span class="sc">+</span> </span>
<span id="cb14-257"><a href="#cb14-257"></a>                    (<span class="dv">1</span> <span class="sc">|</span> subject), <span class="at">family =</span> <span class="fu">binomial</span>(), </span>
<span id="cb14-258"><a href="#cb14-258"></a>                  <span class="at">data =</span> resp, <span class="at">method =</span> <span class="st">"LRT"</span>)</span>
<span id="cb14-259"><a href="#cb14-259"></a><span class="in">```</span></span>
<span id="cb14-260"><a href="#cb14-260"></a></span>
<span id="cb14-261"><a href="#cb14-261"></a><span class="in">```{r comp3,cache=TRUE}</span></span>
<span id="cb14-262"><a href="#cb14-262"></a><span class="do">## GEE model</span></span>
<span id="cb14-263"><a href="#cb14-263"></a>resp_gee3 <span class="ot">&lt;-</span> <span class="fu">gee</span>(nstat <span class="sc">~</span> baseline <span class="sc">+</span> month <span class="sc">+</span> treatment <span class="sc">+</span> </span>
<span id="cb14-264"><a href="#cb14-264"></a>                   gender <span class="sc">+</span> age <span class="sc">+</span> centre, </span>
<span id="cb14-265"><a href="#cb14-265"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb14-266"><a href="#cb14-266"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb14-267"><a href="#cb14-267"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>, <span class="at">scale.value =</span> <span class="dv">1</span>)</span>
<span id="cb14-268"><a href="#cb14-268"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb14-269"><a href="#cb14-269"></a><span class="fu">library</span>(geepack)</span>
<span id="cb14-270"><a href="#cb14-270"></a>resp_gee4 <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> baseline <span class="sc">+</span> month <span class="sc">+</span> treatment <span class="sc">+</span> </span>
<span id="cb14-271"><a href="#cb14-271"></a>                   gender <span class="sc">+</span> age <span class="sc">+</span> centre, </span>
<span id="cb14-272"><a href="#cb14-272"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb14-273"><a href="#cb14-273"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb14-274"><a href="#cb14-274"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-275"><a href="#cb14-275"></a>resp_gee5 <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> baseline <span class="sc">+</span> month <span class="sc">+</span> treatment <span class="sc">+</span> </span>
<span id="cb14-276"><a href="#cb14-276"></a>                   gender <span class="sc">+</span> age <span class="sc">+</span> centre, </span>
<span id="cb14-277"><a href="#cb14-277"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb14-278"><a href="#cb14-278"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"independence"</span>, </span>
<span id="cb14-279"><a href="#cb14-279"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-280"><a href="#cb14-280"></a>resp_gee6 <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> baseline <span class="sc">+</span> month <span class="sc">+</span> treatment <span class="sc">+</span> </span>
<span id="cb14-281"><a href="#cb14-281"></a>                   gender <span class="sc">+</span> age <span class="sc">+</span> centre, </span>
<span id="cb14-282"><a href="#cb14-282"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb14-283"><a href="#cb14-283"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"ar1"</span>, </span>
<span id="cb14-284"><a href="#cb14-284"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-285"><a href="#cb14-285"></a><span class="fu">QIC</span>(resp_gee4)</span>
<span id="cb14-286"><a href="#cb14-286"></a><span class="fu">QIC</span>(resp_gee5)</span>
<span id="cb14-287"><a href="#cb14-287"></a><span class="fu">QIC</span>(resp_gee6)</span>
<span id="cb14-288"><a href="#cb14-288"></a><span class="co"># Smaller QIC values for correlation structure represents better models</span></span>
<span id="cb14-289"><a href="#cb14-289"></a><span class="co"># i.e., "exchangeable" in our case</span></span>
<span id="cb14-290"><a href="#cb14-290"></a></span>
<span id="cb14-291"><a href="#cb14-291"></a>resp_gee4a <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> month <span class="sc">+</span> treatment <span class="sc">+</span> gender <span class="sc">+</span> age <span class="sc">+</span> centre, </span>
<span id="cb14-292"><a href="#cb14-292"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb14-293"><a href="#cb14-293"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb14-294"><a href="#cb14-294"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-295"><a href="#cb14-295"></a></span>
<span id="cb14-296"><a href="#cb14-296"></a>resp_gee4b <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> treatment <span class="sc">+</span> gender <span class="sc">+</span> age <span class="sc">+</span> centre, </span>
<span id="cb14-297"><a href="#cb14-297"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb14-298"><a href="#cb14-298"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb14-299"><a href="#cb14-299"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-300"><a href="#cb14-300"></a></span>
<span id="cb14-301"><a href="#cb14-301"></a>resp_gee4c <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> gender <span class="sc">+</span> age <span class="sc">+</span> centre, </span>
<span id="cb14-302"><a href="#cb14-302"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb14-303"><a href="#cb14-303"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb14-304"><a href="#cb14-304"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-305"><a href="#cb14-305"></a></span>
<span id="cb14-306"><a href="#cb14-306"></a>resp_gee4d <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> age <span class="sc">+</span> centre, </span>
<span id="cb14-307"><a href="#cb14-307"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb14-308"><a href="#cb14-308"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb14-309"><a href="#cb14-309"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-310"><a href="#cb14-310"></a></span>
<span id="cb14-311"><a href="#cb14-311"></a>resp_gee4e <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(nstat <span class="sc">~</span> centre, </span>
<span id="cb14-312"><a href="#cb14-312"></a>                 <span class="at">data =</span> resp, <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb14-313"><a href="#cb14-313"></a>                 <span class="at">id =</span> subject, <span class="at">corstr =</span> <span class="st">"exchangeable"</span>, </span>
<span id="cb14-314"><a href="#cb14-314"></a>                 <span class="at">scale.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-315"><a href="#cb14-315"></a><span class="fu">QIC</span>(resp_gee4)</span>
<span id="cb14-316"><a href="#cb14-316"></a><span class="fu">QIC</span>(resp_gee4a)[<span class="dv">2</span>]</span>
<span id="cb14-317"><a href="#cb14-317"></a><span class="fu">QIC</span>(resp_gee4b)[<span class="dv">2</span>]</span>
<span id="cb14-318"><a href="#cb14-318"></a><span class="fu">QIC</span>(resp_gee4c)[<span class="dv">2</span>]</span>
<span id="cb14-319"><a href="#cb14-319"></a><span class="fu">QIC</span>(resp_gee4d)[<span class="dv">2</span>]</span>
<span id="cb14-320"><a href="#cb14-320"></a><span class="fu">QIC</span>(resp_gee4e)[<span class="dv">2</span>]</span>
<span id="cb14-321"><a href="#cb14-321"></a><span class="fu">QIC</span>(resp_gee4d)[<span class="dv">2</span>]</span>
<span id="cb14-322"><a href="#cb14-322"></a><span class="co"># Covariates are selected based on the QICu criteria</span></span>
<span id="cb14-323"><a href="#cb14-323"></a><span class="in">```</span></span>
<span id="cb14-324"><a href="#cb14-324"></a></span>
<span id="cb14-325"><a href="#cb14-325"></a><span class="in">```{r compsumm,cache=TRUE}</span></span>
<span id="cb14-326"><a href="#cb14-326"></a><span class="do">## compare estimates (conditional vs. marginal)</span></span>
<span id="cb14-327"><a href="#cb14-327"></a><span class="fu">summary</span>(resp_lmer)<span class="sc">$</span>coefficients <span class="co"># Model failed to converge</span></span>
<span id="cb14-328"><a href="#cb14-328"></a><span class="fu">summary</span>(resp_afex)<span class="sc">$</span>coefficients <span class="co"># Model failed to converge</span></span>
<span id="cb14-329"><a href="#cb14-329"></a><span class="fu">summary</span>(resp_gee3)<span class="sc">$</span>coefficients <span class="co"># Marginalized model</span></span>
<span id="cb14-330"><a href="#cb14-330"></a><span class="fu">summary</span>(resp_gee4)<span class="sc">$</span>coefficients <span class="co"># Marginalized model</span></span>
<span id="cb14-331"><a href="#cb14-331"></a><span class="in">```</span></span>
<span id="cb14-332"><a href="#cb14-332"></a></span>
<span id="cb14-333"><a href="#cb14-333"></a>The significance of variables are similar in both variables, but the estimated coefficients are larger in generalized mixed effect model. However, it does not mean the estimated coefficients are inconsistent. Instead, two models are estimating different parameters. Remember, the mixed effect model is conditional on random effects, while the GEE is a marginalized model.</span>
<span id="cb14-334"><a href="#cb14-334"></a></span>
<span id="cb14-335"><a href="#cb14-335"></a><span class="fu">### Video content (optional)</span></span>
<span id="cb14-336"><a href="#cb14-336"></a></span>
<span id="cb14-337"><a href="#cb14-337"></a>::: callout-tip</span>
<span id="cb14-338"><a href="#cb14-338"></a>For those who prefer a video walkthrough, feel free to watch the video below, which offers a description of an earlier version of the above content.</span>
<span id="cb14-339"><a href="#cb14-339"></a>:::</span>
<span id="cb14-340"><a href="#cb14-340"></a></span>
<span id="cb14-341"><a href="#cb14-341"></a>::: {style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;"}</span>
<span id="cb14-342"><a href="#cb14-342"></a><span class="kw">&lt;iframe</span> <span class="er">src</span><span class="ot">=</span><span class="st">"https://www.youtube.com/embed/qoqhPq_VILc"</span> <span class="er">style</span><span class="ot">=</span><span class="st">"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;"</span> <span class="er">allowfullscreen</span><span class="kw">&gt;</span></span>
<span id="cb14-343"><a href="#cb14-343"></a></span>
<span id="cb14-344"><a href="#cb14-344"></a><span class="kw">&lt;/iframe&gt;</span></span>
<span id="cb14-345"><a href="#cb14-345"></a>:::</span>
<span id="cb14-346"><a href="#cb14-346"></a></span>
<span id="cb14-347"><a href="#cb14-347"></a><span class="fu">### Reference</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>