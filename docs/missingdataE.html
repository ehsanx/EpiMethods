<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>OER: Advanced Epidemiological Methods - Exercise (M)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./propensityscore.html" rel="next">
<link href="./missingdataQ.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CVBPG0RQMY"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-CVBPG0RQMY', { 'anonymize_ip': true});
</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta name="twitter:title" content="OER: Advanced Epidemiological Methods - Exercise (M)">
<meta name="twitter:description" content="We will use the article by Williams AR, Wilson-Genderson M, Thomson MD. (2021)">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-sidebar docked">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Exercise (M)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">OER: Advanced Epidemiological Methods</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">The Project</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./wrangling.html" class="sidebar-item-text sidebar-link">Data wrangling</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1a.html" class="sidebar-item-text sidebar-link">R basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1b.html" class="sidebar-item-text sidebar-link">Data types</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1c.html" class="sidebar-item-text sidebar-link">Automating tasks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling2.html" class="sidebar-item-text sidebar-link">Importing dataset</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling3.html" class="sidebar-item-text sidebar-link">Data manipulation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling4.html" class="sidebar-item-text sidebar-link">Import external data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling5.html" class="sidebar-item-text sidebar-link">Summary tables</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling6.html" class="sidebar-item-text sidebar-link">R Markdown</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingF.html" class="sidebar-item-text sidebar-link">R Functions (W)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingQ.html" class="sidebar-item-text sidebar-link">Quiz (W)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingE.html" class="sidebar-item-text sidebar-link">Exercise (W)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./accessing.html" class="sidebar-item-text sidebar-link">Data accessing</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing1.html" class="sidebar-item-text sidebar-link">Survey data sources</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing2.html" class="sidebar-item-text sidebar-link">Importing CCHS to R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing3.html" class="sidebar-item-text sidebar-link">Importing NHANES to R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing4.html" class="sidebar-item-text sidebar-link">Reproducing results</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingF.html" class="sidebar-item-text sidebar-link">R Functions (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingQ.html" class="sidebar-item-text sidebar-link">Quiz (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingE.html" class="sidebar-item-text sidebar-link">Exercise (A)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./researchquestion.html" class="sidebar-item-text sidebar-link">Research questions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion1.html" class="sidebar-item-text sidebar-link">Predictive question-1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion2a.html" class="sidebar-item-text sidebar-link">Predictive question-2a</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion2b.html" class="sidebar-item-text sidebar-link">Predictive question-2b</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion3.html" class="sidebar-item-text sidebar-link">Causal question-1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion4.html" class="sidebar-item-text sidebar-link">Causal question-2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestionF.html" class="sidebar-item-text sidebar-link">R functions (Q)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestionQ.html" class="sidebar-item-text sidebar-link">Quiz (Q)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./confounding.html" class="sidebar-item-text sidebar-link">Causal roles</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding1.html" class="sidebar-item-text sidebar-link">Confounding</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding2.html" class="sidebar-item-text sidebar-link">Mediator</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding3.html" class="sidebar-item-text sidebar-link">Collider</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding4.html" class="sidebar-item-text sidebar-link">Z-bias</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding5.html" class="sidebar-item-text sidebar-link">Collapsibility</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding6.html" class="sidebar-item-text sidebar-link">Change-in-estimate</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confoundingF.html" class="sidebar-item-text sidebar-link">R functions (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confoundingQ.html" class="sidebar-item-text sidebar-link">Quiz (R)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./predictivefactors.html" class="sidebar-item-text sidebar-link">Prediction ideas</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors1.html" class="sidebar-item-text sidebar-link">Collinear predictors</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors2.html" class="sidebar-item-text sidebar-link">Continuous outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors3.html" class="sidebar-item-text sidebar-link">Binary outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors4.html" class="sidebar-item-text sidebar-link">Overfitting and performance</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors5.html" class="sidebar-item-text sidebar-link">Data spliting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors6.html" class="sidebar-item-text sidebar-link">Cross-validation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors7.html" class="sidebar-item-text sidebar-link">Bootstrap</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactorsF.html" class="sidebar-item-text sidebar-link">R functions (P)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactorsQ.html" class="sidebar-item-text sidebar-link">Quiz (P)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./surveydata.html" class="sidebar-item-text sidebar-link">Survey data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata1.html" class="sidebar-item-text sidebar-link">CCHS: Revisiting PICOT</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata2.html" class="sidebar-item-text sidebar-link">CCHS: Assessing data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata3.html" class="sidebar-item-text sidebar-link">CCHS: Bivariate analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata4.html" class="sidebar-item-text sidebar-link">CCHS: Regression</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata5.html" class="sidebar-item-text sidebar-link">CCHS: Performance</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata6.html" class="sidebar-item-text sidebar-link">NHANES: Blood Pressure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata7.html" class="sidebar-item-text sidebar-link">NHANES: Cholesterol</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata8.html" class="sidebar-item-text sidebar-link">NHANES: Subsetting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataF.html" class="sidebar-item-text sidebar-link">R functions (D)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataQ.html" class="sidebar-item-text sidebar-link">Quiz (D)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataE.html" class="sidebar-item-text sidebar-link">Exercise (D)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./missingdata.html" class="sidebar-item-text sidebar-link">Missing data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata1.html" class="sidebar-item-text sidebar-link">Imputation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata2.html" class="sidebar-item-text sidebar-link">Imputation in NHANES</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata3.html" class="sidebar-item-text sidebar-link">Missing in outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata4.html" class="sidebar-item-text sidebar-link">Performance with NA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata5.html" class="sidebar-item-text sidebar-link">Subpopulations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata6.html" class="sidebar-item-text sidebar-link">MCAR tests</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata7.html" class="sidebar-item-text sidebar-link">Effect modification</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataF.html" class="sidebar-item-text sidebar-link">R functions (M)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataQ.html" class="sidebar-item-text sidebar-link">Quiz (M)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataE.html" class="sidebar-item-text sidebar-link active">Exercise (M)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./propensityscore.html" class="sidebar-item-text sidebar-link">Propensity score</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore1.html" class="sidebar-item-text sidebar-link">Exact Matching (CCHS)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore2.html" class="sidebar-item-text sidebar-link">PSM in OA-CVD (CCHS)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore3.html" class="sidebar-item-text sidebar-link">PSM in OA-CVD (US)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore4.html" class="sidebar-item-text sidebar-link">PSM in BMI-diabetes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore5.html" class="sidebar-item-text sidebar-link">PSM with MI</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreF.html" class="sidebar-item-text sidebar-link">R functions (S)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreQ.html" class="sidebar-item-text sidebar-link">Quiz (S)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreE.html" class="sidebar-item-text sidebar-link">Exercise (S)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./machinelearning.html" class="sidebar-item-text sidebar-link">Machine learning</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning1.html" class="sidebar-item-text sidebar-link">Continuous outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning2.html" class="sidebar-item-text sidebar-link">Data spliting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning3.html" class="sidebar-item-text sidebar-link">Cross-validation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning4.html" class="sidebar-item-text sidebar-link">Binary outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning5.html" class="sidebar-item-text sidebar-link">Supervised learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning6.html" class="sidebar-item-text sidebar-link">Unsupervised learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningF.html" class="sidebar-item-text sidebar-link">R functions (L)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./machinelearningCausal.html" class="sidebar-item-text sidebar-link">ML in causal inference</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausalF.html" class="sidebar-item-text sidebar-link">R functions (C)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./reporting.html" class="sidebar-item-text sidebar-link">Writing Tools</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reporting1.html" class="sidebar-item-text sidebar-link">Collaborative Writing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reporting2.html" class="sidebar-item-text sidebar-link">Formatting Tools</a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#problem-statement" id="toc-problem-statement" class="nav-link active" data-scroll-target="#problem-statement">Problem Statement</a></li>
  <li>
<a href="#question-1-analytic-dataset" id="toc-question-1-analytic-dataset" class="nav-link" data-scroll-target="#question-1-analytic-dataset">Question 1: Analytic dataset</a>
  <ul class="collapse">
<li><a href="#a-importing-dataset" id="toc-a-importing-dataset" class="nav-link" data-scroll-target="#a-importing-dataset">1(a) Importing dataset</a></li>
  <li><a href="#b-subsetting-according-to-eligibility" id="toc-b-subsetting-according-to-eligibility" class="nav-link" data-scroll-target="#b-subsetting-according-to-eligibility">1(b) Subsetting according to eligibility</a></li>
  <li><a href="#c-dataset-with-missing-values-only-in-confounders" id="toc-c-dataset-with-missing-values-only-in-confounders" class="nav-link" data-scroll-target="#c-dataset-with-missing-values-only-in-confounders">1(c) Dataset with missing values only in confounders</a></li>
  <li><a href="#d-reproduce-table-1" id="toc-d-reproduce-table-1" class="nav-link" data-scroll-target="#d-reproduce-table-1">1(d) Reproduce Table 1</a></li>
  </ul>
</li>
  <li>
<a href="#question-2-dealing-with-missing-values-in-confoudners-100-grade" id="toc-question-2-dealing-with-missing-values-in-confoudners-100-grade" class="nav-link" data-scroll-target="#question-2-dealing-with-missing-values-in-confoudners-100-grade">Question 2: Dealing with missing values in confoudners [100% grade]</a>
  <ul class="collapse">
<li><a href="#a-check-missingness-using-a-plot" id="toc-a-check-missingness-using-a-plot" class="nav-link" data-scroll-target="#a-check-missingness-using-a-plot">2(a) Check missingness using a plot</a></li>
  <li><a href="#b-reproduce-table-3-multiple-imputation" id="toc-b-reproduce-table-3-multiple-imputation" class="nav-link" data-scroll-target="#b-reproduce-table-3-multiple-imputation">2(b) Reproduce Table 3: Multiple imputation</a></li>
  </ul>
</li>
  <li><a href="#question-3-dealing-with-missing-values-in-outcome-predictor-and-confoudners-optional" id="toc-question-3-dealing-with-missing-values-in-outcome-predictor-and-confoudners-optional" class="nav-link" data-scroll-target="#question-3-dealing-with-missing-values-in-outcome-predictor-and-confoudners-optional">Question 3: Dealing with missing values in outcome, predictor, and confoudners [optional]</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Exercise (M)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i></button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can download all of the related files in a zip file <strong>missingdataEx.zip</strong> from <a href="https://github.com/ehsanx/EpiMethods/tree/main/LabExercises/">Github folder</a>, or just by clicking this link <a href="https://github.com/ehsanx/EpiMethods/raw/main/LabExercises/missingdataEx.zip">directly</a>.</p>
<ul>
<li>Navigate to the GitHub folder (above link) where the ZIP file is located.</li>
<li>Click on the file name (above zip file) to open its preview window.</li>
<li>Click on the Download button to download the file. If you can’t see the Download button, click on “Download Raw File” link that should appear on the page.</li>
</ul>
</div>
</div>
<section id="problem-statement" class="level2"><h2 class="anchored" data-anchor-id="problem-statement">Problem Statement</h2>
<p>We will use the article by <a href="https://doi.org/10.1016/j.ypmed.2021.106426">Williams AR, Wilson-Genderson M, Thomson MD. (2021)</a></p>
<p>We will reproduce some results from the article. The authors used NHANES 2015-16 and 2017-18 datasets to create their analytic dataset. The combined dataset contains 19,225 subjects with 20 relevant variables for this exercise:</p>
<p><strong>Survey information</strong></p>
<ul>
<li>id: Respondent sequence number</li>
<li>survey.weight: Full sample 4 year interview weight</li>
<li>psu: Masked pseudo PSU</li>
<li>strata: Masked pseudo strata (strata is nested within PSU)</li>
</ul>
<p><strong>4 Outcome variables</strong></p>
<ul>
<li>weight.loss.behavior: doing lifestyle behavior changes - controlling or losing weight</li>
<li>exercise.behavior: doing lifestyle behavior changes - increasing exercise</li>
<li>salt.behavior: doing lifestyle behavior changes - reducing salt in diet</li>
<li>fat.behavior: doing lifestyle behavior changes - reducing fat in diet</li>
</ul>
<p><strong>4 predictors (i.e., exposure variables)</strong></p>
<ul>
<li>weight.loss.advice: told by a doctor or health professional - to control/lose weight</li>
<li>exercise.advice: told by a doctor or health professional - to exercise</li>
<li>salt.advice: told by a doctor or health professional - to reduce salt in diet</li>
<li>fat.advice: told by a doctor or health professional - to reduce fat/calories</li>
</ul>
<p><strong>Confounders and other variables</strong></p>
<ul>
<li>gender: Gender</li>
<li>age: Age in years at screening</li>
<li>income: The ratio of family income to federal poverty level</li>
<li>race: Race/Ethnicity</li>
<li>bmi: Body Mass Index in kg/m<span class="math inline">\(^2\)</span>
</li>
<li>comorbidity: Comorbidity index</li>
<li>DIQ010: Self-report to have been informed by a provider to have diabetes</li>
<li>BPQ020: Self-report to have been informed by a provider to have hypertension</li>
</ul></section><section id="question-1-analytic-dataset" class="level2"><h2 class="anchored" data-anchor-id="question-1-analytic-dataset">Question 1: Analytic dataset</h2>
<section id="a-importing-dataset" class="level3"><h3 class="anchored" data-anchor-id="a-importing-dataset">1(a) Importing dataset</h3>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># download the data in the same folder</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">load</span>(<span class="st">"Data/missingdata/Williams2021.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="b-subsetting-according-to-eligibility" class="level3"><h3 class="anchored" data-anchor-id="b-subsetting-according-to-eligibility">1(b) Subsetting according to eligibility</h3>
<p>Create a dataset with missing values in outcomes, predictors, and confounders. As shown in Figure 1, the sample size should be 4,746.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Drop &lt; 18 years</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>dat <span class="ot">&lt;-</span> dat.full</span>
<span id="cb2-3"><a href="#cb2-3"></a>dat <span class="ot">&lt;-</span> dat[dat<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">18</span>,] </span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># Eligibility</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>dat <span class="ot">&lt;-</span> dat[dat<span class="sc">$</span>DIQ010<span class="sc">==</span><span class="st">"Yes"</span> <span class="sc">|</span> dat<span class="sc">$</span>BPQ020<span class="sc">==</span><span class="st">"Yes"</span>,] </span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># Dataset with missing values in outcomes, predictors, and confounders</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>dat.with.miss <span class="ot">&lt;-</span> dat</span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="fu">nrow</span>(dat.with.miss) <span class="co"># N = 4,746</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; [1] 4746</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="c-dataset-with-missing-values-only-in-confounders" class="level3"><h3 class="anchored" data-anchor-id="c-dataset-with-missing-values-only-in-confounders">1(c) Dataset with missing values only in confounders</h3>
<p>Create a dataset with missing values in only in confounders. There should not be any missing values in the outcomes or predictors. As shown in Figure 1, the sample size should be 4,716.</p>
<ul>
<li>Hint: there are four outcome variables and four predictors in this paper. Read the “Self-reported behavior change and receipt of advice” paragraph.</li>
</ul>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>dat <span class="ot">&lt;-</span> dat.with.miss</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># Drop missing or don't know outcomes </span></span>
<span id="cb3-4"><a href="#cb3-4"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>weight.loss.behavior),]</span>
<span id="cb3-5"><a href="#cb3-5"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>exercise.behavior),]</span>
<span id="cb3-6"><a href="#cb3-6"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>salt.behavior),]</span>
<span id="cb3-7"><a href="#cb3-7"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>fat.behavior),]</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co"># Drop missing or don't know predictors</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>weight.loss.advice),]</span>
<span id="cb3-11"><a href="#cb3-11"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>exercise.advice),]</span>
<span id="cb3-12"><a href="#cb3-12"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>salt.advice),]</span>
<span id="cb3-13"><a href="#cb3-13"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>fat.advice),] </span>
<span id="cb3-14"><a href="#cb3-14"></a></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co"># Dataset without missing in outcomes and predictors but missing in confounders </span></span>
<span id="cb3-16"><a href="#cb3-16"></a>dat.with.miss2 <span class="ot">&lt;-</span> dat</span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="fu">nrow</span>(dat.with.miss2) <span class="co"># N = 4,716</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">#&gt; [1] 4716</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="d-reproduce-table-1" class="level3"><h3 class="anchored" data-anchor-id="d-reproduce-table-1">1(d) Reproduce Table 1</h3>
<p>Create the first column of Table 1 of the article.</p>
<ul>
<li><p>Hint 1: The authors reported unweighted frequencies, and thus, survey features should not be utilized to answer this question. Use <code>tableone</code> package.</p></li>
<li><p>Hint 2: You may need to generate the <code>Condition</code> variable.</p></li>
<li><p>Hint 3: <code>age</code> and <code>comorbidity</code> are numerical variables. <code>tableone</code> package gives mean (SD) for numerical variables by default. For this exercise, instead of reporting the frequency, you could report the mean (SD) for <code>age</code> and <code>comorbidity</code>.</p></li>
</ul>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>dat <span class="ot">&lt;-</span> dat.with.miss2</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># Create the condition variable</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>dat<span class="sc">$</span>condition <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>dat<span class="sc">$</span>condition[dat<span class="sc">$</span>BPQ020 <span class="sc">==</span> <span class="st">"Yes"</span>] <span class="ot">&lt;-</span> <span class="st">"Hypertension Only"</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>dat<span class="sc">$</span>condition[dat<span class="sc">$</span>DIQ010 <span class="sc">==</span> <span class="st">"Yes"</span>] <span class="ot">&lt;-</span> <span class="st">"Diabetes Only"</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>dat<span class="sc">$</span>condition[dat<span class="sc">$</span>BPQ020 <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> dat<span class="sc">$</span>DIQ010 <span class="sc">==</span> <span class="st">"Yes"</span>] <span class="ot">&lt;-</span> <span class="st">"Both"</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>dat<span class="sc">$</span>condition <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>condition, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Hypertension Only"</span>, <span class="st">"Diabetes Only"</span>,</span>
<span id="cb4-9"><a href="#cb4-9"></a>                                                <span class="st">"Both"</span>))</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="fu">table</span>(dat<span class="sc">$</span>condition, <span class="at">useNA =</span> <span class="st">"always"</span>)</span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt; </span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt; Hypertension Only     Diabetes Only              Both              &lt;NA&gt; </span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt;              3004               533              1179                 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># First column of Table 1</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gender"</span>, <span class="st">"age"</span>, <span class="st">"income"</span>, <span class="st">"race"</span>, <span class="st">"bmi"</span>, <span class="st">"condition"</span>, <span class="st">"comorbidity"</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>tab1 <span class="ot">&lt;-</span> <span class="fu">CreateTableOne</span>(<span class="at">vars =</span> vars, <span class="at">data =</span> dat, <span class="at">includeNA =</span> F)</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="fu">print</span>(tab1, <span class="at">format =</span> <span class="st">"f"</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt;                          </span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt;                           Overall      </span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt;   n                        4716        </span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt;   gender = Male            2332        </span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt;   age (mean (SD))         59.94 (14.96)</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt;   income                               </span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt;      &lt;100%                  881        </span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">#&gt;      100-199%              1193        </span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt;      200-299%               672        </span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#&gt;      300-399%               424        </span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">#&gt;      400+%                  930        </span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">#&gt;   race                                 </span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">#&gt;      Hispanic              1161        </span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co">#&gt;      Non-Hispanic white    1630        </span></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="co">#&gt;      Non-Hispanic black    1239        </span></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">#&gt;      Others                 686        </span></span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="co">#&gt;   bmi                                  </span></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="co">#&gt;      Reference              753        </span></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="co">#&gt;      Overweight            1372        </span></span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="co">#&gt;      Obese                 2287        </span></span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="co">#&gt;   condition                            </span></span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="co">#&gt;      Hypertension Only     3004        </span></span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="co">#&gt;      Diabetes Only          533        </span></span>
<span id="cb5-28"><a href="#cb5-28"></a><span class="co">#&gt;      Both                  1179        </span></span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="co">#&gt;   comorbidity (mean (SD))  1.29 (1.45)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="question-2-dealing-with-missing-values-in-confoudners-100-grade" class="level2"><h2 class="anchored" data-anchor-id="question-2-dealing-with-missing-values-in-confoudners-100-grade">Question 2: Dealing with missing values in confoudners [100% grade]</h2>
<section id="a-check-missingness-using-a-plot" class="level3"><h3 class="anchored" data-anchor-id="a-check-missingness-using-a-plot">2(a) Check missingness using a plot</h3>
<p>In the dataset created in 1(c), use a plot to check missingness. In the plot, include only the outcome variables, predictors, and confounders.</p>
<ul>
<li>Hint 1: There are four outcome variables and four predictor variables used in the study.</li>
<li>Hint 2: The authors considered the following confounders: gender, age, income, race, bmi, condition, and comorbidity.</li>
</ul>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Create the condition variable in the analytic dataset</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>dat.with.miss2<span class="sc">$</span>condition[dat.with.miss2<span class="sc">$</span>BPQ020 <span class="sc">==</span> <span class="st">"Yes"</span>] <span class="ot">&lt;-</span> <span class="st">"Hypertension Only"</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>dat.with.miss2<span class="sc">$</span>condition[dat.with.miss2<span class="sc">$</span>DIQ010 <span class="sc">==</span> <span class="st">"Yes"</span>] <span class="ot">&lt;-</span> <span class="st">"Diabetes Only"</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>dat.with.miss2<span class="sc">$</span>condition[dat.with.miss2<span class="sc">$</span>BPQ020 <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> </span>
<span id="cb6-5"><a href="#cb6-5"></a>                          dat.with.miss2<span class="sc">$</span>DIQ010 <span class="sc">==</span> <span class="st">"Yes"</span>] <span class="ot">&lt;-</span> <span class="st">"Both"</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>dat.with.miss2<span class="sc">$</span>condition <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat.with.miss2<span class="sc">$</span>condition, </span>
<span id="cb6-7"><a href="#cb6-7"></a>                                  <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Hypertension Only"</span>, <span class="st">"Diabetes Only"</span>, <span class="st">"Both"</span>))</span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co"># Variables of interest</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="co"># Outcome</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="st">"weight.loss.behavior"</span>, <span class="st">"exercise.behavior"</span>, <span class="st">"salt.behavior"</span>, <span class="st">"fat.behavior"</span>,</span>
<span id="cb6-13"><a href="#cb6-13"></a>  </span>
<span id="cb6-14"><a href="#cb6-14"></a>  <span class="co">#Predictors</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>  <span class="st">"weight.loss.advice"</span>, <span class="st">"exercise.advice"</span>, <span class="st">"salt.advice"</span>, <span class="st">"fat.advice"</span>,</span>
<span id="cb6-16"><a href="#cb6-16"></a>   </span>
<span id="cb6-17"><a href="#cb6-17"></a>  <span class="co"># Confounders       </span></span>
<span id="cb6-18"><a href="#cb6-18"></a>  <span class="st">"gender"</span>, <span class="st">"age"</span>, <span class="st">"income"</span>, <span class="st">"race"</span>, <span class="st">"bmi"</span>, <span class="st">"condition"</span>, <span class="st">"comorbidity"</span>)</span>
<span id="cb6-19"><a href="#cb6-19"></a></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co"># Plot missing values using DataExplorer</span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="fu">plot_missing</span>(dat.with.miss2[,vars])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="missingdataE_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="b-reproduce-table-3-multiple-imputation" class="level3"><h3 class="anchored" data-anchor-id="b-reproduce-table-3-multiple-imputation">2(b) Reproduce Table 3: Multiple imputation</h3>
<p>Perform multiple imputations to deal with missing values only in confounders. Use the dataset created in Dataset with missing values only in confounders (<code>dat.with.miss2</code>). Consider 5 imputed datasets, 5 iterations, and fit the design-adjusted logistic regression in all of the 5 imputed datasets. Obtain the pooled adjusted odds ratio with the 95% confidence intervals. In this case, consider only one outcome and one predictor that are related to lose weights, i.e., create only the <strong>first column of Table 3</strong>.</p>
<ul>
<li>Hint 1: Setup the data such that the variables are of appropriate types. <code>lapply</code> function could be helpful.</li>
<li>Hint 2: Relevel the confounders as shown in Table 3.</li>
<li>Hint 3: Use the strata variable as an auxiliary variable in the imputation model, but not the survey weight or PSU variable.</li>
<li>Hint 4: Consider predictive mean matching method for bmi and comorbidity variable in the imputation model.</li>
<li>Hint 5: Set your seed to 123.</li>
<li>Hint 6: Remove any subject ID variable from the imputation model, if created in an intermediate step.</li>
<li>Hint 7: The point and interval estimates could be slightly different than shown in Table 3. But they should very close.</li>
<li>Hint 8: Remember to keep count of the ineligible subjects from the full data, and consider adding them back in the imputed datasets (so that all the weight, strata and cluster information are available in the design).</li>
</ul>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="do">## Setup the data such that the variables are of appropriate types</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>factor.names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"weight.loss.behavior"</span>, <span class="st">"exercise.behavior"</span>, <span class="st">"salt.behavior"</span>, </span>
<span id="cb7-3"><a href="#cb7-3"></a>                  <span class="st">"fat.behavior"</span>, <span class="st">"weight.loss.advice"</span>, <span class="st">"exercise.advice"</span>, </span>
<span id="cb7-4"><a href="#cb7-4"></a>                  <span class="st">"salt.advice"</span>, <span class="st">"fat.advice"</span>, <span class="st">"gender"</span>, <span class="st">"income"</span>, <span class="st">"race"</span>, <span class="st">"bmi"</span>, </span>
<span id="cb7-5"><a href="#cb7-5"></a>                  <span class="st">"condition"</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co"># your codes </span></span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="do">## Change the reference categories</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co"># your codes</span></span>
<span id="cb7-11"><a href="#cb7-11"></a></span>
<span id="cb7-12"><a href="#cb7-12"></a></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="do">## Imputation model set up</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co"># your codes</span></span>
<span id="cb7-15"><a href="#cb7-15"></a></span>
<span id="cb7-16"><a href="#cb7-16"></a></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="do">## Regression analysis</span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co"># your codes</span></span>
<span id="cb7-19"><a href="#cb7-19"></a></span>
<span id="cb7-20"><a href="#cb7-20"></a></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="do">## Pooled estimates</span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co"># your codes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="question-3-dealing-with-missing-values-in-outcome-predictor-and-confoudners-optional" class="level2"><h2 class="anchored" data-anchor-id="question-3-dealing-with-missing-values-in-outcome-predictor-and-confoudners-optional">Question 3: Dealing with missing values in outcome, predictor, and confoudners [optional]</h2>
<p>Perform multiple imputations to deal with missing values only in outcome, predictor, confounders. Use the Multiple Imputation then deletion (MID) approach. Use the dataset created in Subsetting according to eligibility (<code>dat.with.miss</code>). Consider 5 imputed datasets, 5 iterations, and fit the design-adjusted logistic regression in all of the 5 imputed datasets. Obtain the pooled adjusted odds ratio with the 95% confidence intervals. In this case, consider only one outcome and one predictor that are related to reduce fat/calories, i.e., create only the <strong>fourth column of Table 3</strong>.</p>
<ul>
<li>Hint 1: Setup the data such that the variables are of appropriate types.</li>
<li>Hint 2: Relevel the confounders as shown in Table 3.</li>
<li>Hint 3: Use the strata variable as an auxiliary variable in the imputation model, but not the survey weight or PSU variable.</li>
<li>Hint 4: Include all 4 outcomes and 4 predictors in your imputation model.</li>
<li>Hint 5: Consider predictive mean matching method for bmi and comorbidity variable in the imputation model.</li>
<li>Hint 6: Set your seed to 123.</li>
<li>Hint 7: Remove any subject ID variable from the imputation model, if created in an intermediate step.</li>
<li>Hint 8: The point and interval estimates could be slightly different than shown in Table 3. But they should very close.</li>
<li>Hint 9: Remember to keep count of the ineligible subjects from the full data, and consider adding them back in the imputed datasets (so that all the weight, strata and cluster information are available in the design).</li>
</ul>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="do">## Create a missing indicator so that MID can be applied</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co"># your codes here</span></span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="do">## MID</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co"># your codes here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./missingdataQ.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Quiz (M)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./propensityscore.html" class="pagination-link">
        <span class="nav-page-text">Propensity score</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb9" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">## Exercise (M) {.unnumbered}</span></span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="in">```{r chunkSetup, include=FALSE}</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="fu">library</span>(tableone)</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="fu">library</span>(survey)</span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="fu">library</span>(Publish)</span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="fu">library</span>(DataExplorer)</span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="fu">library</span>(mice)</span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="fu">library</span>(mitools)</span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="in">```</span></span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a>::: callout-tip</span>
<span id="cb9-15"><a href="#cb9-15"></a>You can download all of the related files in a zip file **missingdataEx.zip** from <span class="co">[</span><span class="ot">Github folder</span><span class="co">](https://github.com/ehsanx/EpiMethods/tree/main/LabExercises/)</span>, or just by clicking this link <span class="co">[</span><span class="ot">directly</span><span class="co">](https://github.com/ehsanx/EpiMethods/raw/main/LabExercises/missingdataEx.zip)</span>.</span>
<span id="cb9-16"><a href="#cb9-16"></a></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="ss">-   </span>Navigate to the GitHub folder (above link) where the ZIP file is located.</span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="ss">-   </span>Click on the file name (above zip file) to open its preview window.</span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="ss">-   </span>Click on the Download button to download the file. If you can't see the Download button, click on "Download Raw File" link that should appear on the page.</span>
<span id="cb9-20"><a href="#cb9-20"></a>:::</span>
<span id="cb9-21"><a href="#cb9-21"></a></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="fu">## Problem Statement</span></span>
<span id="cb9-23"><a href="#cb9-23"></a></span>
<span id="cb9-24"><a href="#cb9-24"></a>We will use the article by <span class="co">[</span><span class="ot">Williams AR, Wilson-Genderson M, Thomson MD. (2021)</span><span class="co">](https://doi.org/10.1016/j.ypmed.2021.106426)</span></span>
<span id="cb9-25"><a href="#cb9-25"></a></span>
<span id="cb9-26"><a href="#cb9-26"></a>We will reproduce some results from the article. The authors used NHANES 2015-16 and 2017-18 datasets to create their analytic dataset. The combined dataset contains 19,225 subjects with 20 relevant variables for this exercise:</span>
<span id="cb9-27"><a href="#cb9-27"></a></span>
<span id="cb9-28"><a href="#cb9-28"></a>**Survey information**</span>
<span id="cb9-29"><a href="#cb9-29"></a></span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="ss">-   </span>id: Respondent sequence number</span>
<span id="cb9-31"><a href="#cb9-31"></a><span class="ss">-   </span>survey.weight: Full sample 4 year interview weight</span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="ss">-   </span>psu: Masked pseudo PSU</span>
<span id="cb9-33"><a href="#cb9-33"></a><span class="ss">-   </span>strata: Masked pseudo strata (strata is nested within PSU)</span>
<span id="cb9-34"><a href="#cb9-34"></a></span>
<span id="cb9-35"><a href="#cb9-35"></a>**4 Outcome variables**</span>
<span id="cb9-36"><a href="#cb9-36"></a></span>
<span id="cb9-37"><a href="#cb9-37"></a><span class="ss">-   </span>weight.loss.behavior: doing lifestyle behavior changes - controlling or losing weight</span>
<span id="cb9-38"><a href="#cb9-38"></a><span class="ss">-   </span>exercise.behavior: doing lifestyle behavior changes - increasing exercise</span>
<span id="cb9-39"><a href="#cb9-39"></a><span class="ss">-   </span>salt.behavior: doing lifestyle behavior changes - reducing salt in diet</span>
<span id="cb9-40"><a href="#cb9-40"></a><span class="ss">-   </span>fat.behavior: doing lifestyle behavior changes - reducing fat in diet</span>
<span id="cb9-41"><a href="#cb9-41"></a></span>
<span id="cb9-42"><a href="#cb9-42"></a>**4 predictors (i.e., exposure variables)**</span>
<span id="cb9-43"><a href="#cb9-43"></a></span>
<span id="cb9-44"><a href="#cb9-44"></a><span class="ss">-   </span>weight.loss.advice: told by a doctor or health professional - to control/lose weight</span>
<span id="cb9-45"><a href="#cb9-45"></a><span class="ss">-   </span>exercise.advice: told by a doctor or health professional - to exercise</span>
<span id="cb9-46"><a href="#cb9-46"></a><span class="ss">-   </span>salt.advice: told by a doctor or health professional - to reduce salt in diet</span>
<span id="cb9-47"><a href="#cb9-47"></a><span class="ss">-   </span>fat.advice: told by a doctor or health professional - to reduce fat/calories</span>
<span id="cb9-48"><a href="#cb9-48"></a></span>
<span id="cb9-49"><a href="#cb9-49"></a>**Confounders and other variables**</span>
<span id="cb9-50"><a href="#cb9-50"></a></span>
<span id="cb9-51"><a href="#cb9-51"></a><span class="ss">-   </span>gender: Gender</span>
<span id="cb9-52"><a href="#cb9-52"></a><span class="ss">-   </span>age: Age in years at screening</span>
<span id="cb9-53"><a href="#cb9-53"></a><span class="ss">-   </span>income: The ratio of family income to federal poverty level</span>
<span id="cb9-54"><a href="#cb9-54"></a><span class="ss">-   </span>race: Race/Ethnicity</span>
<span id="cb9-55"><a href="#cb9-55"></a><span class="ss">-   </span>bmi: Body Mass Index in kg/m$^2$</span>
<span id="cb9-56"><a href="#cb9-56"></a><span class="ss">-   </span>comorbidity: Comorbidity index</span>
<span id="cb9-57"><a href="#cb9-57"></a><span class="ss">-   </span>DIQ010: Self-report to have been informed by a provider to have diabetes</span>
<span id="cb9-58"><a href="#cb9-58"></a><span class="ss">-   </span>BPQ020: Self-report to have been informed by a provider to have hypertension</span>
<span id="cb9-59"><a href="#cb9-59"></a></span>
<span id="cb9-60"><a href="#cb9-60"></a><span class="fu">## Question 1: Analytic dataset</span></span>
<span id="cb9-61"><a href="#cb9-61"></a></span>
<span id="cb9-62"><a href="#cb9-62"></a><span class="fu">### 1(a) Importing dataset</span></span>
<span id="cb9-63"><a href="#cb9-63"></a></span>
<span id="cb9-66"><a href="#cb9-66"></a><span class="in">```{r}</span></span>
<span id="cb9-67"><a href="#cb9-67"></a><span class="co"># download the data in the same folder</span></span>
<span id="cb9-68"><a href="#cb9-68"></a><span class="fu">load</span>(<span class="st">"Data/missingdata/Williams2021.RData"</span>)</span>
<span id="cb9-69"><a href="#cb9-69"></a><span class="in">```</span></span>
<span id="cb9-70"><a href="#cb9-70"></a></span>
<span id="cb9-71"><a href="#cb9-71"></a><span class="fu">### 1(b) Subsetting according to eligibility</span></span>
<span id="cb9-72"><a href="#cb9-72"></a></span>
<span id="cb9-73"><a href="#cb9-73"></a>Create a dataset with missing values in outcomes, predictors, and confounders. As shown in Figure 1, the sample size should be 4,746.</span>
<span id="cb9-74"><a href="#cb9-74"></a></span>
<span id="cb9-77"><a href="#cb9-77"></a><span class="in">```{r}</span></span>
<span id="cb9-78"><a href="#cb9-78"></a><span class="co"># Drop &lt; 18 years</span></span>
<span id="cb9-79"><a href="#cb9-79"></a>dat <span class="ot">&lt;-</span> dat.full</span>
<span id="cb9-80"><a href="#cb9-80"></a>dat <span class="ot">&lt;-</span> dat[dat<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">18</span>,] </span>
<span id="cb9-81"><a href="#cb9-81"></a></span>
<span id="cb9-82"><a href="#cb9-82"></a><span class="co"># Eligibility</span></span>
<span id="cb9-83"><a href="#cb9-83"></a>dat <span class="ot">&lt;-</span> dat[dat<span class="sc">$</span>DIQ010<span class="sc">==</span><span class="st">"Yes"</span> <span class="sc">|</span> dat<span class="sc">$</span>BPQ020<span class="sc">==</span><span class="st">"Yes"</span>,] </span>
<span id="cb9-84"><a href="#cb9-84"></a></span>
<span id="cb9-85"><a href="#cb9-85"></a><span class="co"># Dataset with missing values in outcomes, predictors, and confounders</span></span>
<span id="cb9-86"><a href="#cb9-86"></a>dat.with.miss <span class="ot">&lt;-</span> dat</span>
<span id="cb9-87"><a href="#cb9-87"></a><span class="fu">nrow</span>(dat.with.miss) <span class="co"># N = 4,746</span></span>
<span id="cb9-88"><a href="#cb9-88"></a><span class="in">```</span></span>
<span id="cb9-89"><a href="#cb9-89"></a></span>
<span id="cb9-90"><a href="#cb9-90"></a><span class="fu">### 1(c) Dataset with missing values only in confounders</span></span>
<span id="cb9-91"><a href="#cb9-91"></a></span>
<span id="cb9-92"><a href="#cb9-92"></a>Create a dataset with missing values in only in confounders. There should not be any missing values in the outcomes or predictors. As shown in Figure 1, the sample size should be 4,716.</span>
<span id="cb9-93"><a href="#cb9-93"></a></span>
<span id="cb9-94"><a href="#cb9-94"></a><span class="ss">-   </span>Hint: there are four outcome variables and four predictors in this paper. Read the "Self-reported behavior change and receipt of advice" paragraph.</span>
<span id="cb9-95"><a href="#cb9-95"></a></span>
<span id="cb9-98"><a href="#cb9-98"></a><span class="in">```{r}</span></span>
<span id="cb9-99"><a href="#cb9-99"></a>dat <span class="ot">&lt;-</span> dat.with.miss</span>
<span id="cb9-100"><a href="#cb9-100"></a></span>
<span id="cb9-101"><a href="#cb9-101"></a><span class="co"># Drop missing or don't know outcomes </span></span>
<span id="cb9-102"><a href="#cb9-102"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>weight.loss.behavior),]</span>
<span id="cb9-103"><a href="#cb9-103"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>exercise.behavior),]</span>
<span id="cb9-104"><a href="#cb9-104"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>salt.behavior),]</span>
<span id="cb9-105"><a href="#cb9-105"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>fat.behavior),]</span>
<span id="cb9-106"><a href="#cb9-106"></a></span>
<span id="cb9-107"><a href="#cb9-107"></a><span class="co"># Drop missing or don't know predictors</span></span>
<span id="cb9-108"><a href="#cb9-108"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>weight.loss.advice),]</span>
<span id="cb9-109"><a href="#cb9-109"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>exercise.advice),]</span>
<span id="cb9-110"><a href="#cb9-110"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>salt.advice),]</span>
<span id="cb9-111"><a href="#cb9-111"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat<span class="sc">$</span>fat.advice),] </span>
<span id="cb9-112"><a href="#cb9-112"></a></span>
<span id="cb9-113"><a href="#cb9-113"></a><span class="co"># Dataset without missing in outcomes and predictors but missing in confounders </span></span>
<span id="cb9-114"><a href="#cb9-114"></a>dat.with.miss2 <span class="ot">&lt;-</span> dat</span>
<span id="cb9-115"><a href="#cb9-115"></a><span class="fu">nrow</span>(dat.with.miss2) <span class="co"># N = 4,716</span></span>
<span id="cb9-116"><a href="#cb9-116"></a><span class="in">```</span></span>
<span id="cb9-117"><a href="#cb9-117"></a></span>
<span id="cb9-118"><a href="#cb9-118"></a><span class="fu">### 1(d) Reproduce Table 1</span></span>
<span id="cb9-119"><a href="#cb9-119"></a></span>
<span id="cb9-120"><a href="#cb9-120"></a>Create the first column of Table 1 of the article.</span>
<span id="cb9-121"><a href="#cb9-121"></a></span>
<span id="cb9-122"><a href="#cb9-122"></a><span class="ss">-   </span>Hint 1: The authors reported unweighted frequencies, and thus, survey features should not be utilized to answer this question. Use <span class="in">`tableone`</span> package.</span>
<span id="cb9-123"><a href="#cb9-123"></a></span>
<span id="cb9-124"><a href="#cb9-124"></a><span class="ss">-   </span>Hint 2: You may need to generate the <span class="in">`Condition`</span> variable.</span>
<span id="cb9-125"><a href="#cb9-125"></a></span>
<span id="cb9-126"><a href="#cb9-126"></a><span class="ss">-   </span>Hint 3: <span class="in">`age`</span> and <span class="in">`comorbidity`</span> are numerical variables. <span class="in">`tableone`</span> package gives mean (SD) for numerical variables by default. For this exercise, instead of reporting the frequency, you could report the mean (SD) for <span class="in">`age`</span> and <span class="in">`comorbidity`</span>.</span>
<span id="cb9-127"><a href="#cb9-127"></a></span>
<span id="cb9-128"><a href="#cb9-128"></a><span class="in">```{r, message=F, warning=F}</span></span>
<span id="cb9-129"><a href="#cb9-129"></a>dat <span class="ot">&lt;-</span> dat.with.miss2</span>
<span id="cb9-130"><a href="#cb9-130"></a></span>
<span id="cb9-131"><a href="#cb9-131"></a><span class="co"># Create the condition variable</span></span>
<span id="cb9-132"><a href="#cb9-132"></a>dat<span class="sc">$</span>condition <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb9-133"><a href="#cb9-133"></a>dat<span class="sc">$</span>condition[dat<span class="sc">$</span>BPQ020 <span class="sc">==</span> <span class="st">"Yes"</span>] <span class="ot">&lt;-</span> <span class="st">"Hypertension Only"</span></span>
<span id="cb9-134"><a href="#cb9-134"></a>dat<span class="sc">$</span>condition[dat<span class="sc">$</span>DIQ010 <span class="sc">==</span> <span class="st">"Yes"</span>] <span class="ot">&lt;-</span> <span class="st">"Diabetes Only"</span></span>
<span id="cb9-135"><a href="#cb9-135"></a>dat<span class="sc">$</span>condition[dat<span class="sc">$</span>BPQ020 <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> dat<span class="sc">$</span>DIQ010 <span class="sc">==</span> <span class="st">"Yes"</span>] <span class="ot">&lt;-</span> <span class="st">"Both"</span></span>
<span id="cb9-136"><a href="#cb9-136"></a>dat<span class="sc">$</span>condition <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>condition, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Hypertension Only"</span>, <span class="st">"Diabetes Only"</span>,</span>
<span id="cb9-137"><a href="#cb9-137"></a>                                                <span class="st">"Both"</span>))</span>
<span id="cb9-138"><a href="#cb9-138"></a><span class="fu">table</span>(dat<span class="sc">$</span>condition, <span class="at">useNA =</span> <span class="st">"always"</span>)</span>
<span id="cb9-139"><a href="#cb9-139"></a><span class="in">```</span></span>
<span id="cb9-140"><a href="#cb9-140"></a></span>
<span id="cb9-141"><a href="#cb9-141"></a><span class="in">```{r, message=F, warning=F}</span></span>
<span id="cb9-142"><a href="#cb9-142"></a><span class="co"># First column of Table 1</span></span>
<span id="cb9-143"><a href="#cb9-143"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gender"</span>, <span class="st">"age"</span>, <span class="st">"income"</span>, <span class="st">"race"</span>, <span class="st">"bmi"</span>, <span class="st">"condition"</span>, <span class="st">"comorbidity"</span>)</span>
<span id="cb9-144"><a href="#cb9-144"></a>tab1 <span class="ot">&lt;-</span> <span class="fu">CreateTableOne</span>(<span class="at">vars =</span> vars, <span class="at">data =</span> dat, <span class="at">includeNA =</span> F)</span>
<span id="cb9-145"><a href="#cb9-145"></a><span class="fu">print</span>(tab1, <span class="at">format =</span> <span class="st">"f"</span>)</span>
<span id="cb9-146"><a href="#cb9-146"></a><span class="in">```</span></span>
<span id="cb9-147"><a href="#cb9-147"></a></span>
<span id="cb9-148"><a href="#cb9-148"></a><span class="fu">## Question 2: Dealing with missing values in confoudners \[100% grade\]</span></span>
<span id="cb9-149"><a href="#cb9-149"></a></span>
<span id="cb9-150"><a href="#cb9-150"></a><span class="fu">### 2(a) Check missingness using a plot</span></span>
<span id="cb9-151"><a href="#cb9-151"></a></span>
<span id="cb9-152"><a href="#cb9-152"></a>In the dataset created in 1(c), use a plot to check missingness. In the plot, include only the outcome variables, predictors, and confounders.</span>
<span id="cb9-153"><a href="#cb9-153"></a></span>
<span id="cb9-154"><a href="#cb9-154"></a><span class="ss">-   </span>Hint 1: There are four outcome variables and four predictor variables used in the study.</span>
<span id="cb9-155"><a href="#cb9-155"></a><span class="ss">-   </span>Hint 2: The authors considered the following confounders: gender, age, income, race, bmi, condition, and comorbidity.</span>
<span id="cb9-156"><a href="#cb9-156"></a></span>
<span id="cb9-157"><a href="#cb9-157"></a><span class="in">```{r, message=F, warning=F}</span></span>
<span id="cb9-158"><a href="#cb9-158"></a><span class="co"># Create the condition variable in the analytic dataset</span></span>
<span id="cb9-159"><a href="#cb9-159"></a>dat.with.miss2<span class="sc">$</span>condition[dat.with.miss2<span class="sc">$</span>BPQ020 <span class="sc">==</span> <span class="st">"Yes"</span>] <span class="ot">&lt;-</span> <span class="st">"Hypertension Only"</span></span>
<span id="cb9-160"><a href="#cb9-160"></a>dat.with.miss2<span class="sc">$</span>condition[dat.with.miss2<span class="sc">$</span>DIQ010 <span class="sc">==</span> <span class="st">"Yes"</span>] <span class="ot">&lt;-</span> <span class="st">"Diabetes Only"</span></span>
<span id="cb9-161"><a href="#cb9-161"></a>dat.with.miss2<span class="sc">$</span>condition[dat.with.miss2<span class="sc">$</span>BPQ020 <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> </span>
<span id="cb9-162"><a href="#cb9-162"></a>                          dat.with.miss2<span class="sc">$</span>DIQ010 <span class="sc">==</span> <span class="st">"Yes"</span>] <span class="ot">&lt;-</span> <span class="st">"Both"</span></span>
<span id="cb9-163"><a href="#cb9-163"></a>dat.with.miss2<span class="sc">$</span>condition <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat.with.miss2<span class="sc">$</span>condition, </span>
<span id="cb9-164"><a href="#cb9-164"></a>                                  <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Hypertension Only"</span>, <span class="st">"Diabetes Only"</span>, <span class="st">"Both"</span>))</span>
<span id="cb9-165"><a href="#cb9-165"></a></span>
<span id="cb9-166"><a href="#cb9-166"></a><span class="co"># Variables of interest</span></span>
<span id="cb9-167"><a href="#cb9-167"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb9-168"><a href="#cb9-168"></a>  <span class="co"># Outcome</span></span>
<span id="cb9-169"><a href="#cb9-169"></a>  <span class="st">"weight.loss.behavior"</span>, <span class="st">"exercise.behavior"</span>, <span class="st">"salt.behavior"</span>, <span class="st">"fat.behavior"</span>,</span>
<span id="cb9-170"><a href="#cb9-170"></a>  </span>
<span id="cb9-171"><a href="#cb9-171"></a>  <span class="co">#Predictors</span></span>
<span id="cb9-172"><a href="#cb9-172"></a>  <span class="st">"weight.loss.advice"</span>, <span class="st">"exercise.advice"</span>, <span class="st">"salt.advice"</span>, <span class="st">"fat.advice"</span>,</span>
<span id="cb9-173"><a href="#cb9-173"></a>   </span>
<span id="cb9-174"><a href="#cb9-174"></a>  <span class="co"># Confounders       </span></span>
<span id="cb9-175"><a href="#cb9-175"></a>  <span class="st">"gender"</span>, <span class="st">"age"</span>, <span class="st">"income"</span>, <span class="st">"race"</span>, <span class="st">"bmi"</span>, <span class="st">"condition"</span>, <span class="st">"comorbidity"</span>)</span>
<span id="cb9-176"><a href="#cb9-176"></a></span>
<span id="cb9-177"><a href="#cb9-177"></a><span class="co"># Plot missing values using DataExplorer</span></span>
<span id="cb9-178"><a href="#cb9-178"></a><span class="fu">plot_missing</span>(dat.with.miss2[,vars])</span>
<span id="cb9-179"><a href="#cb9-179"></a><span class="in">```</span></span>
<span id="cb9-180"><a href="#cb9-180"></a></span>
<span id="cb9-181"><a href="#cb9-181"></a><span class="fu">### 2(b) Reproduce Table 3: Multiple imputation</span></span>
<span id="cb9-182"><a href="#cb9-182"></a></span>
<span id="cb9-183"><a href="#cb9-183"></a>Perform multiple imputations to deal with missing values only in confounders. Use the dataset created in Dataset with missing values only in confounders (<span class="in">`dat.with.miss2`</span>). Consider 5 imputed datasets, 5 iterations, and fit the design-adjusted logistic regression in all of the 5 imputed datasets. Obtain the pooled adjusted odds ratio with the 95% confidence intervals. In this case, consider only one outcome and one predictor that are related to lose weights, i.e., create only the **first column of Table 3**.</span>
<span id="cb9-184"><a href="#cb9-184"></a></span>
<span id="cb9-185"><a href="#cb9-185"></a><span class="ss">-   </span>Hint 1: Setup the data such that the variables are of appropriate types. <span class="in">`lapply`</span> function could be helpful.</span>
<span id="cb9-186"><a href="#cb9-186"></a><span class="ss">-   </span>Hint 2: Relevel the confounders as shown in Table 3.</span>
<span id="cb9-187"><a href="#cb9-187"></a><span class="ss">-   </span>Hint 3: Use the strata variable as an auxiliary variable in the imputation model, but not the survey weight or PSU variable.</span>
<span id="cb9-188"><a href="#cb9-188"></a><span class="ss">-   </span>Hint 4: Consider predictive mean matching method for bmi and comorbidity variable in the imputation model.</span>
<span id="cb9-189"><a href="#cb9-189"></a><span class="ss">-   </span>Hint 5: Set your seed to 123.</span>
<span id="cb9-190"><a href="#cb9-190"></a><span class="ss">-   </span>Hint 6: Remove any subject ID variable from the imputation model, if created in an intermediate step.</span>
<span id="cb9-191"><a href="#cb9-191"></a><span class="ss">-   </span>Hint 7: The point and interval estimates could be slightly different than shown in Table 3. But they should very close.</span>
<span id="cb9-192"><a href="#cb9-192"></a><span class="ss">-   </span>Hint 8: Remember to keep count of the ineligible subjects from the full data, and consider adding them back in the imputed datasets (so that all the weight, strata and cluster information are available in the design).</span>
<span id="cb9-193"><a href="#cb9-193"></a></span>
<span id="cb9-194"><a href="#cb9-194"></a><span class="in">```{r, message=F, warning=F}</span></span>
<span id="cb9-195"><a href="#cb9-195"></a><span class="do">## Setup the data such that the variables are of appropriate types</span></span>
<span id="cb9-196"><a href="#cb9-196"></a>factor.names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"weight.loss.behavior"</span>, <span class="st">"exercise.behavior"</span>, <span class="st">"salt.behavior"</span>, </span>
<span id="cb9-197"><a href="#cb9-197"></a>                  <span class="st">"fat.behavior"</span>, <span class="st">"weight.loss.advice"</span>, <span class="st">"exercise.advice"</span>, </span>
<span id="cb9-198"><a href="#cb9-198"></a>                  <span class="st">"salt.advice"</span>, <span class="st">"fat.advice"</span>, <span class="st">"gender"</span>, <span class="st">"income"</span>, <span class="st">"race"</span>, <span class="st">"bmi"</span>, </span>
<span id="cb9-199"><a href="#cb9-199"></a>                  <span class="st">"condition"</span>)</span>
<span id="cb9-200"><a href="#cb9-200"></a><span class="co"># your codes </span></span>
<span id="cb9-201"><a href="#cb9-201"></a></span>
<span id="cb9-202"><a href="#cb9-202"></a></span>
<span id="cb9-203"><a href="#cb9-203"></a><span class="do">## Change the reference categories</span></span>
<span id="cb9-204"><a href="#cb9-204"></a><span class="co"># your codes</span></span>
<span id="cb9-205"><a href="#cb9-205"></a></span>
<span id="cb9-206"><a href="#cb9-206"></a></span>
<span id="cb9-207"><a href="#cb9-207"></a><span class="do">## Imputation model set up</span></span>
<span id="cb9-208"><a href="#cb9-208"></a><span class="co"># your codes</span></span>
<span id="cb9-209"><a href="#cb9-209"></a></span>
<span id="cb9-210"><a href="#cb9-210"></a></span>
<span id="cb9-211"><a href="#cb9-211"></a><span class="do">## Regression analysis</span></span>
<span id="cb9-212"><a href="#cb9-212"></a><span class="co"># your codes</span></span>
<span id="cb9-213"><a href="#cb9-213"></a></span>
<span id="cb9-214"><a href="#cb9-214"></a></span>
<span id="cb9-215"><a href="#cb9-215"></a><span class="do">## Pooled estimates</span></span>
<span id="cb9-216"><a href="#cb9-216"></a><span class="co"># your codes</span></span>
<span id="cb9-217"><a href="#cb9-217"></a></span>
<span id="cb9-218"><a href="#cb9-218"></a><span class="in">```</span></span>
<span id="cb9-219"><a href="#cb9-219"></a></span>
<span id="cb9-220"><a href="#cb9-220"></a><span class="fu">## Question 3: Dealing with missing values in outcome, predictor, and confoudners \[optional\]</span></span>
<span id="cb9-221"><a href="#cb9-221"></a></span>
<span id="cb9-222"><a href="#cb9-222"></a>Perform multiple imputations to deal with missing values only in outcome, predictor, confounders. Use the Multiple Imputation then deletion (MID) approach. Use the dataset created in Subsetting according to eligibility (<span class="in">`dat.with.miss`</span>). Consider 5 imputed datasets, 5 iterations, and fit the design-adjusted logistic regression in all of the 5 imputed datasets. Obtain the pooled adjusted odds ratio with the 95% confidence intervals. In this case, consider only one outcome and one predictor that are related to reduce fat/calories, i.e., create only the **fourth column of Table 3**.</span>
<span id="cb9-223"><a href="#cb9-223"></a></span>
<span id="cb9-224"><a href="#cb9-224"></a><span class="ss">-   </span>Hint 1: Setup the data such that the variables are of appropriate types.</span>
<span id="cb9-225"><a href="#cb9-225"></a><span class="ss">-   </span>Hint 2: Relevel the confounders as shown in Table 3.</span>
<span id="cb9-226"><a href="#cb9-226"></a><span class="ss">-   </span>Hint 3: Use the strata variable as an auxiliary variable in the imputation model, but not the survey weight or PSU variable.</span>
<span id="cb9-227"><a href="#cb9-227"></a><span class="ss">-   </span>Hint 4: Include all 4 outcomes and 4 predictors in your imputation model.</span>
<span id="cb9-228"><a href="#cb9-228"></a><span class="ss">-   </span>Hint 5: Consider predictive mean matching method for bmi and comorbidity variable in the imputation model.</span>
<span id="cb9-229"><a href="#cb9-229"></a><span class="ss">-   </span>Hint 6: Set your seed to 123.</span>
<span id="cb9-230"><a href="#cb9-230"></a><span class="ss">-   </span>Hint 7: Remove any subject ID variable from the imputation model, if created in an intermediate step.</span>
<span id="cb9-231"><a href="#cb9-231"></a><span class="ss">-   </span>Hint 8: The point and interval estimates could be slightly different than shown in Table 3. But they should very close.</span>
<span id="cb9-232"><a href="#cb9-232"></a><span class="ss">-   </span>Hint 9: Remember to keep count of the ineligible subjects from the full data, and consider adding them back in the imputed datasets (so that all the weight, strata and cluster information are available in the design).</span>
<span id="cb9-233"><a href="#cb9-233"></a></span>
<span id="cb9-234"><a href="#cb9-234"></a><span class="in">```{r, message=F, warning=F}</span></span>
<span id="cb9-235"><a href="#cb9-235"></a><span class="do">## Create a missing indicator so that MID can be applied</span></span>
<span id="cb9-236"><a href="#cb9-236"></a><span class="co"># your codes here</span></span>
<span id="cb9-237"><a href="#cb9-237"></a></span>
<span id="cb9-238"><a href="#cb9-238"></a><span class="do">## MID</span></span>
<span id="cb9-239"><a href="#cb9-239"></a><span class="co"># your codes here</span></span>
<span id="cb9-240"><a href="#cb9-240"></a></span>
<span id="cb9-241"><a href="#cb9-241"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>