<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>OER: Advanced Epidemiological Methods - Exact Matching (CCHS)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./propensityscore2.html" rel="next">
<link href="./propensityscore.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CVBPG0RQMY"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-CVBPG0RQMY', { 'anonymize_ip': true});
</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<meta name="twitter:title" content="OER: Advanced Epidemiological Methods - Exact Matching (CCHS)">
<meta name="twitter:description" content="In the following code chunk, we load the necessary R libraries for our analysis.">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-sidebar docked">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Exact Matching (CCHS)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">OER: Advanced Epidemiological Methods</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">The Project</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./wrangling.html" class="sidebar-item-text sidebar-link">Data wrangling</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1a.html" class="sidebar-item-text sidebar-link">R basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1b.html" class="sidebar-item-text sidebar-link">Data types</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling1c.html" class="sidebar-item-text sidebar-link">Automating tasks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling2.html" class="sidebar-item-text sidebar-link">Importing dataset</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling3.html" class="sidebar-item-text sidebar-link">Data manipulation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling4.html" class="sidebar-item-text sidebar-link">Import external data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling5.html" class="sidebar-item-text sidebar-link">Summary tables</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling6.html" class="sidebar-item-text sidebar-link">R Markdown</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingF.html" class="sidebar-item-text sidebar-link">R Functions (W)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingQ.html" class="sidebar-item-text sidebar-link">Quiz (W)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wranglingE.html" class="sidebar-item-text sidebar-link">Exercise (W)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./accessing.html" class="sidebar-item-text sidebar-link">Data accessing</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing1.html" class="sidebar-item-text sidebar-link">Survey data sources</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing2.html" class="sidebar-item-text sidebar-link">Importing CCHS to R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing3.html" class="sidebar-item-text sidebar-link">Importing NHANES to R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing4.html" class="sidebar-item-text sidebar-link">Reproducing results</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingF.html" class="sidebar-item-text sidebar-link">R Functions (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingQ.html" class="sidebar-item-text sidebar-link">Quiz (A)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessingE.html" class="sidebar-item-text sidebar-link">Exercise (A)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./researchquestion.html" class="sidebar-item-text sidebar-link">Research questions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion1.html" class="sidebar-item-text sidebar-link">Predictive question-1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion2a.html" class="sidebar-item-text sidebar-link">Predictive question-2a</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion2b.html" class="sidebar-item-text sidebar-link">Predictive question-2b</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion3.html" class="sidebar-item-text sidebar-link">Causal question-1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestion4.html" class="sidebar-item-text sidebar-link">Causal question-2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestionF.html" class="sidebar-item-text sidebar-link">R functions (Q)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./researchquestionQ.html" class="sidebar-item-text sidebar-link">Quiz (Q)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./confounding.html" class="sidebar-item-text sidebar-link">Causal roles</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding1.html" class="sidebar-item-text sidebar-link">Confounding</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding2.html" class="sidebar-item-text sidebar-link">Mediator</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding3.html" class="sidebar-item-text sidebar-link">Collider</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding4.html" class="sidebar-item-text sidebar-link">Z-bias</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding5.html" class="sidebar-item-text sidebar-link">Collapsibility</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confounding6.html" class="sidebar-item-text sidebar-link">Change-in-estimate</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confoundingF.html" class="sidebar-item-text sidebar-link">R functions (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confoundingQ.html" class="sidebar-item-text sidebar-link">Quiz (R)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./predictivefactors.html" class="sidebar-item-text sidebar-link">Prediction ideas</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors1.html" class="sidebar-item-text sidebar-link">Collinear predictors</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors2.html" class="sidebar-item-text sidebar-link">Continuous outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors3.html" class="sidebar-item-text sidebar-link">Binary outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors4.html" class="sidebar-item-text sidebar-link">Overfitting and performance</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors5.html" class="sidebar-item-text sidebar-link">Data spliting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors6.html" class="sidebar-item-text sidebar-link">Cross-vaildation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactors7.html" class="sidebar-item-text sidebar-link">Bootstrap</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactorsF.html" class="sidebar-item-text sidebar-link">R functions (P)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictivefactorsQ.html" class="sidebar-item-text sidebar-link">Quiz (P)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./surveydata.html" class="sidebar-item-text sidebar-link">Survey data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata1.html" class="sidebar-item-text sidebar-link">CCHS: Revisiting PICOT</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata2.html" class="sidebar-item-text sidebar-link">CCHS: Assessing data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata3.html" class="sidebar-item-text sidebar-link">CCHS: Bivariate analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata4.html" class="sidebar-item-text sidebar-link">CCHS: Regression</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata5.html" class="sidebar-item-text sidebar-link">CCHS: Performance</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata6.html" class="sidebar-item-text sidebar-link">NHANES: Blood Pressure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata7.html" class="sidebar-item-text sidebar-link">NHANES: Cholesterol</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydata8.html" class="sidebar-item-text sidebar-link">NHANES: Subsetting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataF.html" class="sidebar-item-text sidebar-link">R functions (D)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataQ.html" class="sidebar-item-text sidebar-link">Quiz (D)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surveydataE.html" class="sidebar-item-text sidebar-link">Exercise (D)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./missingdata.html" class="sidebar-item-text sidebar-link">Missing data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata1.html" class="sidebar-item-text sidebar-link">Imputation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata2.html" class="sidebar-item-text sidebar-link">Imputation in NHANES</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata3.html" class="sidebar-item-text sidebar-link">Missing in outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata4.html" class="sidebar-item-text sidebar-link">Performance with NA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata5.html" class="sidebar-item-text sidebar-link">Subpopulations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata6.html" class="sidebar-item-text sidebar-link">MCAR tests</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdata7.html" class="sidebar-item-text sidebar-link">Effect modification</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataF.html" class="sidebar-item-text sidebar-link">R functions (M)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataQ.html" class="sidebar-item-text sidebar-link">Quiz (M)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missingdataE.html" class="sidebar-item-text sidebar-link">Exercise (M)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./propensityscore.html" class="sidebar-item-text sidebar-link">Propensity score</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore1.html" class="sidebar-item-text sidebar-link active">Exact Matching (CCHS)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore2.html" class="sidebar-item-text sidebar-link">PSM in OA-CVD (CCHS)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore3.html" class="sidebar-item-text sidebar-link">PSM in OA-CVD (US)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore4.html" class="sidebar-item-text sidebar-link">PSM in BMI-diabetes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscore5.html" class="sidebar-item-text sidebar-link">PSM with MI</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreF.html" class="sidebar-item-text sidebar-link">R functions (S)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreQ.html" class="sidebar-item-text sidebar-link">Quiz (S)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscoreE.html" class="sidebar-item-text sidebar-link">Exercise (S)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./machinelearning.html" class="sidebar-item-text sidebar-link">Machine learning</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning1.html" class="sidebar-item-text sidebar-link">Continuous outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning2.html" class="sidebar-item-text sidebar-link">Data spliting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning3.html" class="sidebar-item-text sidebar-link">Cross-validation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning4.html" class="sidebar-item-text sidebar-link">Binary outcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning5.html" class="sidebar-item-text sidebar-link">Supervised learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearning6.html" class="sidebar-item-text sidebar-link">Unsupervised learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningF.html" class="sidebar-item-text sidebar-link">R functions (L)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./machinelearningCausal.html" class="sidebar-item-text sidebar-link">ML in causal inference</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machinelearningCausalF.html" class="sidebar-item-text sidebar-link">R functions (C)</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./reporting.html" class="sidebar-item-text sidebar-link">Writing Tools</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reporting1.html" class="sidebar-item-text sidebar-link">Collaborative Writing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reporting2.html" class="sidebar-item-text sidebar-link">Formatting Tools</a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#load-data" id="toc-load-data" class="nav-link active" data-scroll-target="#load-data">Load data</a></li>
  <li><a href="#data-pre-pocessing" id="toc-data-pre-pocessing" class="nav-link" data-scroll-target="#data-pre-pocessing">Data pre-pocessing</a></li>
  <li><a href="#identify-subjects-with-missing" id="toc-identify-subjects-with-missing" class="nav-link" data-scroll-target="#identify-subjects-with-missing">Identify subjects with missing</a></li>
  <li><a href="#setting-design" id="toc-setting-design" class="nav-link" data-scroll-target="#setting-design">Setting Design</a></li>
  <li><a href="#priliminary-analysis" id="toc-priliminary-analysis" class="nav-link" data-scroll-target="#priliminary-analysis">Priliminary analysis</a></li>
  <li><a href="#matching-estimating-treatment-effect" id="toc-matching-estimating-treatment-effect" class="nav-link" data-scroll-target="#matching-estimating-treatment-effect">Matching: Estimating treatment effect</a></li>
  <li><a href="#treatment-effect-1" id="toc-treatment-effect-1" class="nav-link" data-scroll-target="#treatment-effect-1">Treatment effect</a></li>
  <li><a href="#matching-by-a-lot-of-variables" id="toc-matching-by-a-lot-of-variables" class="nav-link" data-scroll-target="#matching-by-a-lot-of-variables">Matching by a lot of variables</a></li>
  <li><a href="#save-data-for-later-use" id="toc-save-data-for-later-use" class="nav-link" data-scroll-target="#save-data-for-later-use">Save data for later use</a></li>
  <li><a href="#video-content-optional" id="toc-video-content-optional" class="nav-link" data-scroll-target="#video-content-optional">Video content (optional)</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Exact Matching (CCHS)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i></button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>In the following code chunk, we load the necessary R libraries for our analysis. <code>MatchIt</code> is used for matching methods to find comparable control units, <code>tableone</code> for creating Table 1 to describe baseline characteristics, <code>Publish</code> for generating readable output of regression analysis, and <code>survey</code> for analyzing complex survey samples.</p>
<div class="cell" data-hash="propensityscore1_cache/html/setup_df0d5ee873ad789a282145dfc7d9bdeb">
<details><summary>Show the code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://kosukeimai.github.io/MatchIt/">MatchIt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaz-yos/tableone">tableone</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">Publish</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://r-survey.r-forge.r-project.org/survey/">survey</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="load-data" class="level3"><h3 class="anchored" data-anchor-id="load-data">Load data</h3>
<p>In the following code chunk, we load the CCHS dataset which is related to the Canadian Community Health Survey (CCHS). We then use <code><a href="https://rdrr.io/r/base/ls.html">ls()</a></code> to list all objects in the workspace and <code>str</code> to display the structure of the data frame, providing a quick overview of the data and checking for any character variables.</p>
<div class="cell" data-hash="propensityscore1_cache/html/data_2f3265dabae24957fcf4e263921fa70c">
<details><summary>Show the code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"Data/propensityscore/cchs123b.RData"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "analytic.miss" "analytic2"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">)</span> <span class="co"># is there any character variable?</span></span>
<span><span class="co">#&gt; 'data.frame':    397173 obs. of  22 variables:</span></span>
<span><span class="co">#&gt;  $ CVD      : chr  "event" "no event" "no event" "no event" ...</span></span>
<span><span class="co">#&gt;  $ age      : chr  "65 years and over" "65 years and over" "30-39 years" "65 years and over" ...</span></span>
<span><span class="co">#&gt;  $ sex      : chr  "Female" "Female" "Male" "Female" ...</span></span>
<span><span class="co">#&gt;  $ married  : chr  "single" "single" "not single" "single" ...</span></span>
<span><span class="co">#&gt;  $ race     : chr  "White" "White" "White" "White" ...</span></span>
<span><span class="co">#&gt;  $ edu      : chr  "2nd grad." "Post-2nd grad." "Post-2nd grad." "Post-2nd grad." ...</span></span>
<span><span class="co">#&gt;  $ income   : chr  "$29,999 or less" "$29,999 or less" "$80,000 or more" "$29,999 or less" ...</span></span>
<span><span class="co">#&gt;  $ bmi      : Factor w/ 3 levels "Underweight",..: NA NA 2 NA 2 NA 3 NA 2 3 ...</span></span>
<span><span class="co">#&gt;  $ phyact   : chr  "Inactive" "Inactive" "Inactive" "Inactive" ...</span></span>
<span><span class="co">#&gt;  $ doctor   : chr  "Yes" "Yes" "Yes" "Yes" ...</span></span>
<span><span class="co">#&gt;  $ stress   : chr  "Not too stressed" "Not too stressed" "stressed" "Not too stressed" ...</span></span>
<span><span class="co">#&gt;  $ smoke    : Factor w/ 3 levels "Never smoker",..: 3 1 3 3 2 2 3 1 2 2 ...</span></span>
<span><span class="co">#&gt;  $ drink    : Factor w/ 3 levels "Never drank",..: 2 1 2 2 2 2 3 1 2 2 ...</span></span>
<span><span class="co">#&gt;  $ fruit    : Factor w/ 3 levels "0-3 daily serving",..: 2 2 2 3 3 3 2 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ bp       : chr  "No" "No" "No" "No" ...</span></span>
<span><span class="co">#&gt;  $ diab     : chr  "No" "No" "No" "No" ...</span></span>
<span><span class="co">#&gt;  $ province : Factor w/ 2 levels "South","North": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ weight   : num  142.8 71.4 168.3 71.4 196.1 ...</span></span>
<span><span class="co">#&gt;  $ cycle    : Factor w/ 3 levels "11","21","31": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ ID       : int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ OA       : chr  "Control" "Control" "Control" "Control" ...</span></span>
<span><span class="co">#&gt;  $ immigrate: Factor w/ 3 levels "not immigrant",..: 1 1 3 1 1 1 1 1 1 1 ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="data-pre-pocessing" class="level3"><h3 class="anchored" data-anchor-id="data-pre-pocessing">Data pre-pocessing</h3>
<p>In the following code chunk, we define a vector containing the names of variables of interest that needs to be converted to factor variables. We then convert these variables to factors, ensuring they are treated as categorical in subsequent analyses. We also <code>recode</code> the Osteoarthritis (OA) variable into a numeric binary format and display the frequency table of OA before and after the transformation.</p>
<div class="cell" data-hash="propensityscore1_cache/html/data2_397f20189832d0eac6dc85859927503c">
<details><summary>Show the code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">var.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"stress"</span>, <span class="st">"married"</span>, <span class="st">"income"</span>, <span class="st">"race"</span>, </span>
<span>               <span class="st">"bmi"</span>, <span class="st">"phyact"</span>, <span class="st">"smoke"</span>, <span class="st">"doctor"</span>, <span class="st">"drink"</span>, <span class="st">"bp"</span>, <span class="st">"province"</span>,</span>
<span>               <span class="st">"immigrate"</span>, <span class="st">"fruit"</span>, <span class="st">"diab"</span>, <span class="st">"edu"</span>, <span class="st">"CVD"</span>, <span class="st">"OA"</span><span class="op">)</span></span>
<span><span class="va">analytic.miss</span><span class="op">[</span><span class="va">var.names</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">[</span><span class="va">var.names</span><span class="op">]</span> , <span class="va">factor</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">OA</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Control      OA </span></span>
<span><span class="co">#&gt;  314542   40943</span></span>
<span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">OA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">OA</span><span class="op">==</span><span class="st">"OA"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">OA</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      0      1 </span></span>
<span><span class="co">#&gt; 314542  40943</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="identify-subjects-with-missing" class="level3"><h3 class="anchored" data-anchor-id="identify-subjects-with-missing">Identify subjects with missing</h3>
<p>In the following code chunk, we create a new variable <code>miss</code> and initially assign all its values to 1 in the full dataset (that contains some missing observations). We then adjust this assignment by setting miss to 0 for observations that are also present in another complete case dataset. That means any row with <code>miss</code> equal to 0 means that row has no missing observations. Finally, we display the frequency table of the miss variable to check the number of missing and non-missing observations.</p>
<div class="cell" data-hash="propensityscore1_cache/html/miss_608e153b0f191e91dfe7a55ed1ad2094">
<details><summary>Show the code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">miss</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span> <span class="co"># full data</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4 5 6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">analytic2</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span> <span class="co"># complete case</span></span>
<span><span class="co">#&gt; [1]  3  5  7 10 11 13</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">analytic2</span><span class="op">$</span><span class="va">ID</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  3  5  7 10 11 13</span></span>
<span><span class="co"># if associated with complete case, assign miss &lt;- 0</span></span>
<span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">miss</span><span class="op">[</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">analytic2</span><span class="op">$</span><span class="va">ID</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">miss</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      0      1 </span></span>
<span><span class="co">#&gt; 185613 211560</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="setting-design" class="level3"><h3 class="anchored" data-anchor-id="setting-design">Setting Design</h3>
<section id="unconditional-design" class="level4"><h4 class="anchored" data-anchor-id="unconditional-design">Unconditional design</h4>
<p>In the following code chunk, we explore the summary of the weight variable and establish an unconditional survey design object <code>w.design0</code> using the <code>svydesign</code> function, which will be used for subsequent survey-weighted analyses. We then explore the summary, standard deviation, and sum of the weights within our design object.</p>
<div class="cell" data-hash="propensityscore1_cache/html/design_813cb09071fb6848b16930223ca76af8">
<details><summary>Show the code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    1.17   65.28  126.63  200.09  243.21 7154.95</span></span>
<span><span class="va">w.design0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html">svydesign</a></span><span class="op">(</span>id<span class="op">=</span><span class="op">~</span><span class="fl">1</span>, weights<span class="op">=</span><span class="op">~</span><span class="va">weight</span>, </span>
<span>                      data<span class="op">=</span><span class="va">analytic.miss</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/weights.html">weights</a></span><span class="op">(</span><span class="va">w.design0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    1.17   65.28  126.63  200.09  243.21 7154.95</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/weights.html">weights</a></span><span class="op">(</span><span class="va">w.design0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 241.0279</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/weights.html">weights</a></span><span class="op">(</span><span class="va">w.design0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 79468929</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="conditioning-the-design" class="level4"><h4 class="anchored" data-anchor-id="conditioning-the-design">Conditioning the design</h4>
<p>In the following code chunk, we create a new survey design object <code>w.design</code> by subsetting <code>w.design0</code> to only include observations without missing data <code>(miss == 0)</code>. We then explore the summary, standard deviation, and sum of the weights within this new design object.</p>
<div class="cell" data-hash="propensityscore1_cache/html/design2_7830b45d3407880454463b6b77559763">
<details><summary>Show the code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">w.design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">w.design0</span>, <span class="va">miss</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/weights.html">weights</a></span><span class="op">(</span><span class="va">w.design</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    1.17   71.56  137.95  214.61  261.91 7154.95</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/weights.html">weights</a></span><span class="op">(</span><span class="va">w.design</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 254.9346</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/weights.html">weights</a></span><span class="op">(</span><span class="va">w.design</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 39835061</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="subset-data-more" class="level4"><h4 class="anchored" data-anchor-id="subset-data-more">Subset data (more!)</h4>
<p>We subset the data for fast results (less computation). We will only work with cycle 1.1, and the people from Northern provinces in Canada.</p>
<div class="cell" data-hash="propensityscore1_cache/html/design3_980c34b0d0bff3f43bc6b23398c1af74">
<details><summary>Show the code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">w.design1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">w.design</span>, <span class="va">cycle</span> <span class="op">==</span> <span class="fl">11</span> <span class="op">&amp;</span> <span class="va">province</span> <span class="op">==</span> <span class="st">"North"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/weights.html">weights</a></span><span class="op">(</span><span class="va">w.design1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 42786.28</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="priliminary-analysis" class="level3"><h3 class="anchored" data-anchor-id="priliminary-analysis">Priliminary analysis</h3>
<section id="table-1" class="level4"><h4 class="anchored" data-anchor-id="table-1">Table 1</h4>
<p>In the following code chunk, we define a new variable vector <code>var.names</code> and create a categorical table using <code>svyCreateCatTable</code> to explore the distribution of <code>age</code> and <code>sex</code> across strata of <code>OA</code> within our subsetted design object <code>w.design1</code>. We then print the table with standardized mean differences (SMD) to assess the balance of these variables across strata.</p>
<div class="cell" data-hash="propensityscore1_cache/html/tab_e885172eba00a6918ace32db5a2dd1df">
<details><summary>Show the code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">var.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"sex"</span><span class="op">)</span></span>
<span><span class="va">tab0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tableone/man/svyCreateCatTable.html">svyCreateCatTable</a></span><span class="op">(</span>var <span class="op">=</span> <span class="va">var.names</span>, strata<span class="op">=</span> <span class="st">"OA"</span>, data<span class="op">=</span><span class="va">w.design1</span>,test<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tab0</span>, smd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;                       Stratified by OA</span></span>
<span><span class="co">#&gt;                        0               1              SMD   </span></span>
<span><span class="co">#&gt;   n                    40691.2         2095.1               </span></span>
<span><span class="co">#&gt;   age (%)                                              1.084</span></span>
<span><span class="co">#&gt;      20-29 years       10889.4 (26.8)   120.9 ( 5.8)        </span></span>
<span><span class="co">#&gt;      30-39 years       12251.7 (30.1)   237.8 (11.3)        </span></span>
<span><span class="co">#&gt;      40-49 years       11094.0 (27.3)   572.7 (27.3)        </span></span>
<span><span class="co">#&gt;      50-59 years        5346.6 (13.1)  1092.4 (52.1)        </span></span>
<span><span class="co">#&gt;      60-64 years        1109.4 ( 2.7)    71.4 ( 3.4)        </span></span>
<span><span class="co">#&gt;      65 years and over     0.0 ( 0.0)     0.0 ( 0.0)        </span></span>
<span><span class="co">#&gt;      teen                  0.0 ( 0.0)     0.0 ( 0.0)        </span></span>
<span><span class="co">#&gt;   sex = Male (%)       20824.6 (51.2)  1050.8 (50.2)   0.020</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="treatment-effect" class="level4"><h4 class="anchored" data-anchor-id="treatment-effect">Treatment effect</h4>
<p>In the following code chunk, we fit a logistic regression model using <code>svyglm</code> to estimate the effect of <code>OA</code> and other covariates on the binary outcome <code>CVD</code> (cardiovascular disease). We then use <code>publish</code> to display the results in a readable format.</p>
<div class="cell" data-hash="propensityscore1_cache/html/tx_559d24cb0d0b05de6941ea4aef07de54">
<details><summary>Show the code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit.outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svyglm.html">svyglm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">CVD</span><span class="op">==</span><span class="st">"event"</span><span class="op">)</span> <span class="op">~</span> <span class="va">OA</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">stress</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> </span>
<span>                         <span class="va">income</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">bmi</span> <span class="op">+</span> <span class="va">phyact</span> <span class="op">+</span> <span class="va">smoke</span> <span class="op">+</span></span>
<span>                         <span class="va">immigrate</span> <span class="op">+</span> <span class="va">fruit</span> <span class="op">+</span> <span class="va">diab</span> <span class="op">+</span> <span class="va">edu</span>,</span>
<span>                   design <span class="op">=</span> <span class="va">w.design1</span>,</span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in eval(family$initialize): non-integer #successes in a binomial glm!</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Publish/man/publish.html">publish</a></span><span class="op">(</span><span class="va">fit.outcome</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Variable             Units OddsRatio         CI.95    p-value </span></span>
<span><span class="co">#&gt;         OA                        0.89   [0.17;4.59]   0.887411 </span></span>
<span><span class="co">#&gt;        age       20-29 years       Ref                          </span></span>
<span><span class="co">#&gt;                  30-39 years      2.62  [0.29;23.43]   0.389521 </span></span>
<span><span class="co">#&gt;                  40-49 years      4.89  [0.59;40.73]   0.142280 </span></span>
<span><span class="co">#&gt;                  50-59 years     17.95 [2.59;124.68]   0.003550 </span></span>
<span><span class="co">#&gt;                  60-64 years     23.95 [3.41;168.27]   0.001439 </span></span>
<span><span class="co">#&gt;        sex            Female       Ref                          </span></span>
<span><span class="co">#&gt;                         Male      1.32   [0.64;2.71]   0.456222 </span></span>
<span><span class="co">#&gt;     stress  Not too stressed       Ref                          </span></span>
<span><span class="co">#&gt;                     stressed      0.54   [0.21;1.39]   0.198815 </span></span>
<span><span class="co">#&gt;    married        not single       Ref                          </span></span>
<span><span class="co">#&gt;                       single      0.75   [0.31;1.80]   0.513807 </span></span>
<span><span class="co">#&gt;     income   $29,999 or less       Ref                          </span></span>
<span><span class="co">#&gt;              $30,000-$49,999      0.72   [0.24;2.16]   0.556703 </span></span>
<span><span class="co">#&gt;              $50,000-$79,999      0.95   [0.27;3.40]   0.939104 </span></span>
<span><span class="co">#&gt;              $80,000 or more      0.47   [0.10;2.15]   0.332557 </span></span>
<span><span class="co">#&gt;       race         Non-white       Ref                          </span></span>
<span><span class="co">#&gt;                        White      0.33   [0.11;0.94]   0.038131 </span></span>
<span><span class="co">#&gt;        bmi       Underweight       Ref                          </span></span>
<span><span class="co">#&gt;               healthy weight      0.29   [0.03;3.20]   0.310237 </span></span>
<span><span class="co">#&gt;                   Overweight      0.44   [0.04;4.77]   0.503130 </span></span>
<span><span class="co">#&gt;     phyact            Active       Ref                          </span></span>
<span><span class="co">#&gt;                     Inactive      0.84   [0.30;2.40]   0.751345 </span></span>
<span><span class="co">#&gt;                     Moderate      1.02   [0.32;3.27]   0.979528 </span></span>
<span><span class="co">#&gt;      smoke      Never smoker       Ref                          </span></span>
<span><span class="co">#&gt;               Current smoker      0.98   [0.26;3.76]   0.981454 </span></span>
<span><span class="co">#&gt;                Former smoker      0.71   [0.18;2.71]   0.612518 </span></span>
<span><span class="co">#&gt;  immigrate     not immigrant       Ref                          </span></span>
<span><span class="co">#&gt;                   &gt; 10 years      0.14   [0.03;0.78]   0.025010 </span></span>
<span><span class="co">#&gt;                       recent      0.00   [0.00;0.00]    &lt; 1e-04 </span></span>
<span><span class="co">#&gt;      fruit 0-3 daily serving       Ref                          </span></span>
<span><span class="co">#&gt;            4-6 daily serving      1.15   [0.52;2.56]   0.725722 </span></span>
<span><span class="co">#&gt;             6+ daily serving      0.68   [0.17;2.71]   0.583752 </span></span>
<span><span class="co">#&gt;       diab                No       Ref                          </span></span>
<span><span class="co">#&gt;                          Yes      3.08  [0.93;10.23]   0.066677 </span></span>
<span><span class="co">#&gt;        edu          &lt; 2ndary       Ref                          </span></span>
<span><span class="co">#&gt;                    2nd grad.      4.12  [0.87;19.43]   0.074178 </span></span>
<span><span class="co">#&gt;              Other 2nd grad.      3.04  [0.63;14.67]   0.167135 </span></span>
<span><span class="co">#&gt;               Post-2nd grad.      3.00  [0.82;10.98]   0.096939</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="matching-estimating-treatment-effect" class="level3"><h3 class="anchored" data-anchor-id="matching-estimating-treatment-effect">Matching: Estimating treatment effect</h3>
<p>Going back to the data (<strong>not working on design here while matching</strong>)</p>
<p>In the following code chunk, we create a new dataset by omitting <code>NA</code> values from <code>analytic.miss</code> and converting it to a data frame. We then create a subset <code>analytic11n</code> which includes only observations from cycle 1.1 and the Northern provinces. We display the dimensions of this subset, as well as frequency tables of <code>OA</code> and a cross-tabulation of <code>OA</code> and <code>age</code> to understand the distribution of our target variable and a key covariate.</p>
<div class="cell" data-hash="propensityscore1_cache/html/effect_59d69004eb4eb0d7359600938e9778aa">
<details><summary>Show the code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create the dataset without design features</span></span>
<span><span class="va">analytic2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">analytic11n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">analytic2</span>, <span class="va">cycle</span> <span class="op">==</span> <span class="fl">11</span> <span class="op">&amp;</span> <span class="va">province</span> <span class="op">==</span> <span class="st">"North"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">analytic11n</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1424   23</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">analytic11n</span><span class="op">$</span><span class="va">OA</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    0    1 </span></span>
<span><span class="co">#&gt; 1357   67</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">analytic11n</span><span class="op">$</span><span class="va">OA</span>,<span class="va">analytic11n</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="co">#&gt;    </span></span>
<span><span class="co">#&gt;     20-29 years 30-39 years 40-49 years 50-59 years 60-64 years</span></span>
<span><span class="co">#&gt;   0         345         432         358         177          45</span></span>
<span><span class="co">#&gt;   1           4          11          18          31           3</span></span>
<span><span class="co">#&gt;    </span></span>
<span><span class="co">#&gt;     65 years and over teen</span></span>
<span><span class="co">#&gt;   0                 0    0</span></span>
<span><span class="co">#&gt;   1                 0    0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="matching-by-1-matching-variable" class="level4"><h4 class="anchored" data-anchor-id="matching-by-1-matching-variable">Matching by 1 matching variable</h4>
<p>In the following code chunk, we perform exact matching using a single variable, <code>age</code>. We define the matching formula and apply the <code>matchit</code> function to create matched sets of treated and control units. The resulting <code>matching.obj</code> object is displayed to summarize the matching results.</p>
<div class="cell" data-hash="propensityscore1_cache/html/match1_5fb9183c8d8a53f44264acef418bddba">
<details><summary>Show the code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">match.formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="st">"OA ~ age"</span><span class="op">)</span></span>
<span><span class="va">matching.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">match.formula</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">analytic11n</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span>
<span><span class="va">matching.obj</span></span>
<span><span class="co">#&gt; A matchit object</span></span>
<span><span class="co">#&gt;  - method: Exact matching</span></span>
<span><span class="co">#&gt;  - number of obs.: 1424 (original), 1424 (matched)</span></span>
<span><span class="co">#&gt;  - target estimand: ATT</span></span>
<span><span class="co">#&gt;  - covariates: age</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="matching-by-2-matching-variables" class="level4"><h4 class="anchored" data-anchor-id="matching-by-2-matching-variables">Matching by 2 matching variables</h4>
<p>In the following code chunk, we extend the matching to include two variables, <code>age</code> and <code>sex</code>. We create a new variable <code>var.comb</code> that concatenates these two variables and display its frequency table and the number of unique combinations. We then perform exact matching using both variables and display the resulting object.</p>
<div class="cell" data-hash="propensityscore1_cache/html/match2_9fa5130a27031c155448496cb3a3c2aa">
<details><summary>Show the code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">var.comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">'paste0'</span>, </span>
<span>                    <span class="va">analytic11n</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'age'</span>, <span class="st">'sex'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">var.comb</span><span class="op">)</span></span>
<span><span class="co">#&gt; var.comb</span></span>
<span><span class="co">#&gt; 20-29 yearsFemale   20-29 yearsMale 30-39 yearsFemale   30-39 yearsMale </span></span>
<span><span class="co">#&gt;               184               165               220               223 </span></span>
<span><span class="co">#&gt; 40-49 yearsFemale   40-49 yearsMale 50-59 yearsFemale   50-59 yearsMale </span></span>
<span><span class="co">#&gt;               187               189               101               107 </span></span>
<span><span class="co">#&gt; 60-64 yearsFemale   60-64 yearsMale </span></span>
<span><span class="co">#&gt;                24                24</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">var.comb</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="va">match.formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="st">"OA ~ age + sex"</span><span class="op">)</span></span>
<span><span class="va">matching.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">match.formula</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">analytic11n</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span>
<span><span class="va">matching.obj</span></span>
<span><span class="co">#&gt; A matchit object</span></span>
<span><span class="co">#&gt;  - method: Exact matching</span></span>
<span><span class="co">#&gt;  - number of obs.: 1424 (original), 1424 (matched)</span></span>
<span><span class="co">#&gt;  - target estimand: ATT</span></span>
<span><span class="co">#&gt;  - covariates: age, sex</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="matching-by-3-matching-variables" class="level4"><h4 class="anchored" data-anchor-id="matching-by-3-matching-variables">Matching by 3 matching variables</h4>
<p>In the following code chunk, we further extend the matching to include three variables: <code>age</code>, <code>sex</code>, and <code>stress</code>. We explore the unique combinations of these variables and their distribution across levels of <code>OA</code>. We then perform exact matching using these three variables and display the resulting object.</p>
<div class="cell" data-hash="propensityscore1_cache/html/match3_ed738329016a914d9c6dd2ff7befc4a7">
<details><summary>Show the code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">var.comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">'paste0'</span>, </span>
<span>                    <span class="va">analytic11n</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'age'</span>, <span class="st">'sex'</span>, <span class="st">'stress'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">var.comb</span><span class="op">)</span></span>
<span><span class="co">#&gt; var.comb</span></span>
<span><span class="co">#&gt; 20-29 yearsFemaleNot too stressed         20-29 yearsFemalestressed </span></span>
<span><span class="co">#&gt;                               157                                27 </span></span>
<span><span class="co">#&gt;   20-29 yearsMaleNot too stressed           20-29 yearsMalestressed </span></span>
<span><span class="co">#&gt;                               147                                18 </span></span>
<span><span class="co">#&gt; 30-39 yearsFemaleNot too stressed         30-39 yearsFemalestressed </span></span>
<span><span class="co">#&gt;                               170                                50 </span></span>
<span><span class="co">#&gt;   30-39 yearsMaleNot too stressed           30-39 yearsMalestressed </span></span>
<span><span class="co">#&gt;                               183                                40 </span></span>
<span><span class="co">#&gt; 40-49 yearsFemaleNot too stressed         40-49 yearsFemalestressed </span></span>
<span><span class="co">#&gt;                               142                                45 </span></span>
<span><span class="co">#&gt;   40-49 yearsMaleNot too stressed           40-49 yearsMalestressed </span></span>
<span><span class="co">#&gt;                               141                                48 </span></span>
<span><span class="co">#&gt; 50-59 yearsFemaleNot too stressed         50-59 yearsFemalestressed </span></span>
<span><span class="co">#&gt;                                72                                29 </span></span>
<span><span class="co">#&gt;   50-59 yearsMaleNot too stressed           50-59 yearsMalestressed </span></span>
<span><span class="co">#&gt;                                78                                29 </span></span>
<span><span class="co">#&gt; 60-64 yearsFemaleNot too stressed         60-64 yearsFemalestressed </span></span>
<span><span class="co">#&gt;                                18                                 6 </span></span>
<span><span class="co">#&gt;   60-64 yearsMaleNot too stressed           60-64 yearsMalestressed </span></span>
<span><span class="co">#&gt;                                20                                 4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">var.comb</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 20</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">var.comb</span>,<span class="va">analytic11n</span><span class="op">$</span><span class="va">OA</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                    </span></span>
<span><span class="co">#&gt; var.comb                              0   1</span></span>
<span><span class="co">#&gt;   20-29 yearsFemaleNot too stressed 156   1</span></span>
<span><span class="co">#&gt;   20-29 yearsFemalestressed          27   0</span></span>
<span><span class="co">#&gt;   20-29 yearsMaleNot too stressed   144   3</span></span>
<span><span class="co">#&gt;   20-29 yearsMalestressed            18   0</span></span>
<span><span class="co">#&gt;   30-39 yearsFemaleNot too stressed 168   2</span></span>
<span><span class="co">#&gt;   30-39 yearsFemalestressed          49   1</span></span>
<span><span class="co">#&gt;   30-39 yearsMaleNot too stressed   178   5</span></span>
<span><span class="co">#&gt;   30-39 yearsMalestressed            37   3</span></span>
<span><span class="co">#&gt;   40-49 yearsFemaleNot too stressed 130  12</span></span>
<span><span class="co">#&gt;   40-49 yearsFemalestressed          42   3</span></span>
<span><span class="co">#&gt;   40-49 yearsMaleNot too stressed   138   3</span></span>
<span><span class="co">#&gt;   40-49 yearsMalestressed            48   0</span></span>
<span><span class="co">#&gt;   50-59 yearsFemaleNot too stressed  65   7</span></span>
<span><span class="co">#&gt;   50-59 yearsFemalestressed          22   7</span></span>
<span><span class="co">#&gt;   50-59 yearsMaleNot too stressed    67  11</span></span>
<span><span class="co">#&gt;   50-59 yearsMalestressed            23   6</span></span>
<span><span class="co">#&gt;   60-64 yearsFemaleNot too stressed  17   1</span></span>
<span><span class="co">#&gt;   60-64 yearsFemalestressed           5   1</span></span>
<span><span class="co">#&gt;   60-64 yearsMaleNot too stressed    19   1</span></span>
<span><span class="co">#&gt;   60-64 yearsMalestressed             4   0</span></span>
<span><span class="va">match.formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="st">"OA ~ age + sex + stress"</span><span class="op">)</span></span>
<span><span class="va">matching.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">match.formula</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">analytic11n</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span>
<span><span class="va">matching.obj</span></span>
<span><span class="co">#&gt; A matchit object</span></span>
<span><span class="co">#&gt;  - method: Exact matching</span></span>
<span><span class="co">#&gt;  - number of obs.: 1424 (original), 1327 (matched)</span></span>
<span><span class="co">#&gt;  - target estimand: ATT</span></span>
<span><span class="co">#&gt;  - covariates: age, sex, stress</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="matching-by-4-matching-variables" class="level4"><h4 class="anchored" data-anchor-id="matching-by-4-matching-variables">Matching by 4 matching variables</h4>
<p>The process of matching by 4 variables involves creating combinations of the 4 variables, exploring their distributions, and performing exact matching.</p>
<div class="cell" data-hash="propensityscore1_cache/html/match4_6ee976f16baa1a58831f4814575fcb02">
<details><summary>Show the code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">var.comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">'paste0'</span>, </span>
<span>                    <span class="va">analytic11n</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'age'</span>, <span class="st">'sex'</span>,</span>
<span>                                    <span class="st">'stress'</span>,<span class="st">'income'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#table(var.comb)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">var.comb</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 76</span></span>
<span><span class="va">match.formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="st">"OA ~ age + sex + stress + income"</span><span class="op">)</span></span>
<span><span class="va">matching.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">match.formula</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">analytic11n</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span>
<span><span class="va">matching.obj</span></span>
<span><span class="co">#&gt; A matchit object</span></span>
<span><span class="co">#&gt;  - method: Exact matching</span></span>
<span><span class="co">#&gt;  - number of obs.: 1424 (original), 900 (matched)</span></span>
<span><span class="co">#&gt;  - target estimand: ATT</span></span>
<span><span class="co">#&gt;  - covariates: age, sex, stress, income</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="matching-by-5-matching-variables" class="level4"><h4 class="anchored" data-anchor-id="matching-by-5-matching-variables">Matching by 5 matching variables</h4>
<div class="cell" data-hash="propensityscore1_cache/html/match5_3f05bf35952317ab2854010d14979ff6">
<details><summary>Show the code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">var.comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">'paste0'</span>, </span>
<span>                    <span class="va">analytic11n</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'age'</span>, <span class="st">'sex'</span>,</span>
<span>                                    <span class="st">'stress'</span>,<span class="st">'income'</span>,<span class="st">'race'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">var.comb</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 146</span></span>
<span><span class="va">match.formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="st">"OA ~ age + sex + stress + income + race"</span><span class="op">)</span></span>
<span><span class="va">matching.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">match.formula</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">analytic11n</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span>
<span><span class="va">matching.obj</span></span>
<span><span class="co">#&gt; A matchit object</span></span>
<span><span class="co">#&gt;  - method: Exact matching</span></span>
<span><span class="co">#&gt;  - number of obs.: 1424 (original), 616 (matched)</span></span>
<span><span class="co">#&gt;  - target estimand: ATT</span></span>
<span><span class="co">#&gt;  - covariates: age, sex, stress, income, race</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="matching-by-6-matching-variables" class="level4"><h4 class="anchored" data-anchor-id="matching-by-6-matching-variables">Matching by 6 matching variables</h4>
<div class="cell" data-hash="propensityscore1_cache/html/match6_65bff1c37d0f774c64737710368a1a57">
<details><summary>Show the code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">var.comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">'paste0'</span>, </span>
<span>                    <span class="va">analytic11n</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'age'</span>, <span class="st">'sex'</span>,</span>
<span>                                    <span class="st">'stress'</span>,<span class="st">'income'</span>,<span class="st">'race'</span>,<span class="st">'edu'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">var.comb</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 354</span></span>
<span><span class="va">match.formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="st">"OA ~ age + sex + stress + income + race + edu"</span><span class="op">)</span></span>
<span><span class="va">matching.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">match.formula</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">analytic11n</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span>
<span><span class="va">matching.obj</span></span>
<span><span class="co">#&gt; A matchit object</span></span>
<span><span class="co">#&gt;  - method: Exact matching</span></span>
<span><span class="co">#&gt;  - number of obs.: 1424 (original), 399 (matched)</span></span>
<span><span class="co">#&gt;  - target estimand: ATT</span></span>
<span><span class="co">#&gt;  - covariates: age, sex, stress, income, race, edu</span></span>
<span><span class="va">OACVD.match.11n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/match.data.html">match.data</a></span><span class="op">(</span><span class="va">matching.obj</span><span class="op">)</span></span>
<span><span class="va">var.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"stress"</span>, <span class="st">"income"</span>, <span class="st">"race"</span>, <span class="st">"edu"</span><span class="op">)</span></span>
<span><span class="va">tab1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateCatTable.html">CreateCatTable</a></span><span class="op">(</span>var <span class="op">=</span> <span class="va">var.names</span>, strata<span class="op">=</span> <span class="st">"OA"</span>, data<span class="op">=</span><span class="va">OACVD.match.11n</span>,test<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tab1</span>, smd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        Stratified by OA</span></span>
<span><span class="co">#&gt;                         0           1          SMD   </span></span>
<span><span class="co">#&gt;   n                     337         62               </span></span>
<span><span class="co">#&gt;   age (%)                                       0.565</span></span>
<span><span class="co">#&gt;      20-29 years         63 (18.7)   4 ( 6.5)        </span></span>
<span><span class="co">#&gt;      30-39 years         61 (18.1)  11 (17.7)        </span></span>
<span><span class="co">#&gt;      40-49 years        127 (37.7)  17 (27.4)        </span></span>
<span><span class="co">#&gt;      50-59 years         82 (24.3)  28 (45.2)        </span></span>
<span><span class="co">#&gt;      60-64 years          4 ( 1.2)   2 ( 3.2)        </span></span>
<span><span class="co">#&gt;      65 years and over    0 ( 0.0)   0 ( 0.0)        </span></span>
<span><span class="co">#&gt;      teen                 0 ( 0.0)   0 ( 0.0)        </span></span>
<span><span class="co">#&gt;   sex = Male (%)        211 (62.6)  29 (46.8)   0.322</span></span>
<span><span class="co">#&gt;   stress = stressed (%)  42 (12.5)  17 (27.4)   0.381</span></span>
<span><span class="co">#&gt;   income (%)                                    0.115</span></span>
<span><span class="co">#&gt;      $29,999 or less     69 (20.5)  11 (17.7)        </span></span>
<span><span class="co">#&gt;      $30,000-$49,999     57 (16.9)  13 (21.0)        </span></span>
<span><span class="co">#&gt;      $50,000-$79,999     69 (20.5)  12 (19.4)        </span></span>
<span><span class="co">#&gt;      $80,000 or more    142 (42.1)  26 (41.9)        </span></span>
<span><span class="co">#&gt;   race = White (%)      242 (71.8)  43 (69.4)   0.054</span></span>
<span><span class="co">#&gt;   edu (%)                                       0.146</span></span>
<span><span class="co">#&gt;      &lt; 2ndary            73 (21.7)  11 (17.7)        </span></span>
<span><span class="co">#&gt;      2nd grad.            5 ( 1.5)   2 ( 3.2)        </span></span>
<span><span class="co">#&gt;      Other 2nd grad.      0 ( 0.0)   0 ( 0.0)        </span></span>
<span><span class="co">#&gt;      Post-2nd grad.     259 (76.9)  49 (79.0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="treatment-effect-1" class="level3"><h3 class="anchored" data-anchor-id="treatment-effect-1">Treatment effect</h3>
<section id="convert-data-to-design" class="level4"><h4 class="anchored" data-anchor-id="convert-data-to-design">Convert data to design</h4>
<p>In the following code chunk, we create a new variable matched in the <code>analytic.miss</code> dataset to indicate whether an observation was included in the matched dataset <code>OACVD.match.11n</code>. We then create a new survey design object <code>w.design.m</code> that includes only the matched observations for subsequent analyses.</p>
<div class="cell" data-hash="propensityscore1_cache/html/tx2_83bb869468bccb3c367dd8be3bb1c6f9">
<details><summary>Show the code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">matched</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span> <span class="co"># full data</span></span>
<span><span class="co">#&gt; [1] 397173</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">OACVD.match.11n</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span> <span class="co"># matched data</span></span>
<span><span class="co">#&gt; [1] 399</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">OACVD.match.11n</span><span class="op">$</span><span class="va">ID</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 399</span></span>
<span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">matched</span><span class="op">[</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">OACVD.match.11n</span><span class="op">$</span><span class="va">ID</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">matched</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      0      1 </span></span>
<span><span class="co">#&gt; 396774    399</span></span>
<span><span class="va">w.design0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html">svydesign</a></span><span class="op">(</span>id<span class="op">=</span><span class="op">~</span><span class="fl">1</span>, weights<span class="op">=</span><span class="op">~</span><span class="va">weight</span>, </span>
<span>                      data<span class="op">=</span><span class="va">analytic.miss</span><span class="op">)</span></span>
<span><span class="va">w.design.m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">w.design0</span>, <span class="va">matched</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="outcome-analysis" class="level4"><h4 class="anchored" data-anchor-id="outcome-analysis">Outcome analysis</h4>
<p>The subsequent code chunks involve fitting logistic regression models to estimate the treatment effect, both in a crude and adjusted manner, respectively. The models are fitted using the matched survey design object and the results are displayed in a readable format.</p>
<section id="crude" class="level5"><h5 class="anchored" data-anchor-id="crude">Crude</h5>
<div class="cell" data-hash="propensityscore1_cache/html/est2_b1a5f25b225daeac210ebaf35e39f90a">
<details><summary>Show the code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit.outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svyglm.html">svyglm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">CVD</span><span class="op">==</span><span class="st">"event"</span><span class="op">)</span> <span class="op">~</span> <span class="va">OA</span>,</span>
<span>                   design <span class="op">=</span> <span class="va">w.design.m</span>,</span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in eval(family$initialize): non-integer #successes in a binomial glm!</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Publish/man/publish.html">publish</a></span><span class="op">(</span><span class="va">fit.outcome</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Variable Units OddsRatio        CI.95  p-value </span></span>
<span><span class="co">#&gt;        OA            3.14 [0.80;12.40]   0.1025</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="adjusted" class="level5"><h5 class="anchored" data-anchor-id="adjusted">Adjusted</h5>
<div class="cell" data-hash="propensityscore1_cache/html/est3_40fada88847b233f19f36a59bda5b3a5">
<details><summary>Show the code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit.outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svyglm.html">svyglm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">CVD</span><span class="op">==</span><span class="st">"event"</span><span class="op">)</span> <span class="op">~</span> <span class="va">OA</span> <span class="op">+</span> </span>
<span>                        <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">stress</span> <span class="op">+</span> <span class="va">income</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">edu</span>,</span>
<span>                   design <span class="op">=</span> <span class="va">w.design.m</span>,</span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in eval(family$initialize): non-integer #successes in a binomial glm!</span></span>
<span><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Publish/man/publish.html">publish</a></span><span class="op">(</span><span class="va">fit.outcome</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Variable            Units    OddsRatio                        CI.95   p-value </span></span>
<span><span class="co">#&gt;        OA                          2.04                 [0.34;12.16]   0.43593 </span></span>
<span><span class="co">#&gt;       age      20-29 years          Ref                                        </span></span>
<span><span class="co">#&gt;                30-39 years         0.54                  [0.08;3.51]   0.51962 </span></span>
<span><span class="co">#&gt;                40-49 years  30148597.85    [7758796.44;117149349.12]   &lt; 1e-04 </span></span>
<span><span class="co">#&gt;                50-59 years  63290825.96   [12589873.89;318170673.23]   &lt; 1e-04 </span></span>
<span><span class="co">#&gt;                60-64 years         0.31                  [0.01;9.33]   0.49735 </span></span>
<span><span class="co">#&gt;       sex           Female          Ref                                        </span></span>
<span><span class="co">#&gt;                       Male         1.58                  [0.29;8.62]   0.59729 </span></span>
<span><span class="co">#&gt;    stress Not too stressed          Ref                                        </span></span>
<span><span class="co">#&gt;                   stressed         0.15                  [0.01;1.80]   0.13666 </span></span>
<span><span class="co">#&gt;    income  $29,999 or less          Ref                                        </span></span>
<span><span class="co">#&gt;            $30,000-$49,999         0.20                  [0.01;3.84]   0.28640 </span></span>
<span><span class="co">#&gt;            $50,000-$79,999         0.20                  [0.02;1.95]   0.16543 </span></span>
<span><span class="co">#&gt;            $80,000 or more         0.08                  [0.01;0.68]   0.02122 </span></span>
<span><span class="co">#&gt;      race        Non-white          Ref                                        </span></span>
<span><span class="co">#&gt;                      White         1.02                  [0.11;9.45]   0.98723 </span></span>
<span><span class="co">#&gt;       edu         &lt; 2ndary          Ref                                        </span></span>
<span><span class="co">#&gt;                  2nd grad. 845233466.89 [44642865.50;16002996347.89]   &lt; 1e-04 </span></span>
<span><span class="co">#&gt;             Post-2nd grad.  69867459.42    [9660579.88;505296985.12]   &lt; 1e-04</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="questions-for-the-students" class="level4"><h4 class="anchored" data-anchor-id="questions-for-the-students">Questions for the students</h4>
<ul>
<li>Look at all the ORs. Some of them are VERY high. Why?</li>
<li>Look at the CI in the above table. Some of them are Inf. Why?</li>
<li>Should we match matching variables in the regression?</li>
</ul></section></section><section id="matching-by-a-lot-of-variables" class="level3"><h3 class="anchored" data-anchor-id="matching-by-a-lot-of-variables">Matching by a lot of variables</h3>
<p>The code chunks involve performing matching using a large number of variables and estimating the treatment effect using the matched data. The process involves creating matched datasets, converting them to survey design objects, and fitting logistic regression models.</p>
<section id="matching-part-in-data" class="level4"><h4 class="anchored" data-anchor-id="matching-part-in-data">Matching part in data</h4>
<div class="cell" data-hash="propensityscore1_cache/html/match10_0329a794dbd3fd1812abc7a0894173a7">
<details><summary>Show the code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">match.formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="st">"OA ~ age + sex + stress + married + </span></span>
<span><span class="st">                         income + race + bmi + phyact + smoke +</span></span>
<span><span class="st">                         immigrate + fruit + diab + edu"</span><span class="op">)</span></span>
<span><span class="va">matching.obj2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">match.formula</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">analytic11n</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span>
<span><span class="va">matching.obj2</span></span>
<span><span class="co">#&gt; A matchit object</span></span>
<span><span class="co">#&gt;  - method: Exact matching</span></span>
<span><span class="co">#&gt;  - number of obs.: 1424 (original), 22 (matched)</span></span>
<span><span class="co">#&gt;  - target estimand: ATT</span></span>
<span><span class="co">#&gt;  - covariates: age, sex, stress, married, income, race, bmi, phyact, smoke, immigrate, fruit, diab, edu</span></span>
<span><span class="va">OACVD.match.11n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/match.data.html">match.data</a></span><span class="op">(</span><span class="va">matching.obj2</span><span class="op">)</span></span>
<span><span class="va">var.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"stress"</span>, <span class="st">"married"</span>, <span class="st">"income"</span>, <span class="st">"race"</span>, </span>
<span>               <span class="st">"bmi"</span>, <span class="st">"phyact"</span>, <span class="st">"smoke"</span>, <span class="st">"immigrate"</span>, <span class="st">"fruit"</span>, <span class="st">"diab"</span>, <span class="st">"edu"</span><span class="op">)</span></span>
<span><span class="va">tab2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateCatTable.html">CreateCatTable</a></span><span class="op">(</span>var <span class="op">=</span> <span class="va">var.names</span>, strata<span class="op">=</span> <span class="st">"OA"</span>, data<span class="op">=</span><span class="va">OACVD.match.11n2</span>,test<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tab2</span>, smd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        Stratified by OA</span></span>
<span><span class="co">#&gt;                         0          1          SMD   </span></span>
<span><span class="co">#&gt;   n                     11         11               </span></span>
<span><span class="co">#&gt;   age (%)                                     &lt;0.001</span></span>
<span><span class="co">#&gt;      20-29 years         3 (27.3)   3 (27.3)        </span></span>
<span><span class="co">#&gt;      30-39 years         1 ( 9.1)   1 ( 9.1)        </span></span>
<span><span class="co">#&gt;      40-49 years         4 (36.4)   4 (36.4)        </span></span>
<span><span class="co">#&gt;      50-59 years         3 (27.3)   3 (27.3)        </span></span>
<span><span class="co">#&gt;      60-64 years         0 ( 0.0)   0 ( 0.0)        </span></span>
<span><span class="co">#&gt;      65 years and over   0 ( 0.0)   0 ( 0.0)        </span></span>
<span><span class="co">#&gt;      teen                0 ( 0.0)   0 ( 0.0)        </span></span>
<span><span class="co">#&gt;   sex = Male (%)         6 (54.5)   6 (54.5)  &lt;0.001</span></span>
<span><span class="co">#&gt;   stress = stressed (%)  1 ( 9.1)   1 ( 9.1)  &lt;0.001</span></span>
<span><span class="co">#&gt;   married = single (%)   3 (27.3)   3 (27.3)  &lt;0.001</span></span>
<span><span class="co">#&gt;   income (%)                                  &lt;0.001</span></span>
<span><span class="co">#&gt;      $29,999 or less     1 ( 9.1)   1 ( 9.1)        </span></span>
<span><span class="co">#&gt;      $30,000-$49,999     2 (18.2)   2 (18.2)        </span></span>
<span><span class="co">#&gt;      $50,000-$79,999     2 (18.2)   2 (18.2)        </span></span>
<span><span class="co">#&gt;      $80,000 or more     6 (54.5)   6 (54.5)        </span></span>
<span><span class="co">#&gt;   race = White (%)      10 (90.9)  10 (90.9)  &lt;0.001</span></span>
<span><span class="co">#&gt;   bmi (%)                                     &lt;0.001</span></span>
<span><span class="co">#&gt;      Underweight         0 ( 0.0)   0 ( 0.0)        </span></span>
<span><span class="co">#&gt;      healthy weight      4 (36.4)   4 (36.4)        </span></span>
<span><span class="co">#&gt;      Overweight          7 (63.6)   7 (63.6)        </span></span>
<span><span class="co">#&gt;   phyact (%)                                  &lt;0.001</span></span>
<span><span class="co">#&gt;      Active              3 (27.3)   3 (27.3)        </span></span>
<span><span class="co">#&gt;      Inactive            5 (45.5)   5 (45.5)        </span></span>
<span><span class="co">#&gt;      Moderate            3 (27.3)   3 (27.3)        </span></span>
<span><span class="co">#&gt;   smoke (%)                                   &lt;0.001</span></span>
<span><span class="co">#&gt;      Never smoker        3 (27.3)   3 (27.3)        </span></span>
<span><span class="co">#&gt;      Current smoker      2 (18.2)   2 (18.2)        </span></span>
<span><span class="co">#&gt;      Former smoker       6 (54.5)   6 (54.5)        </span></span>
<span><span class="co">#&gt;   immigrate (%)                               &lt;0.001</span></span>
<span><span class="co">#&gt;      not immigrant      10 (90.9)  10 (90.9)        </span></span>
<span><span class="co">#&gt;      &gt; 10 years          1 ( 9.1)   1 ( 9.1)        </span></span>
<span><span class="co">#&gt;      recent              0 ( 0.0)   0 ( 0.0)        </span></span>
<span><span class="co">#&gt;   fruit (%)                                   &lt;0.001</span></span>
<span><span class="co">#&gt;      0-3 daily serving   3 (27.3)   3 (27.3)        </span></span>
<span><span class="co">#&gt;      4-6 daily serving   6 (54.5)   6 (54.5)        </span></span>
<span><span class="co">#&gt;      6+ daily serving    2 (18.2)   2 (18.2)        </span></span>
<span><span class="co">#&gt;   diab = Yes (%)         0 ( 0.0)   0 ( 0.0)  &lt;0.001</span></span>
<span><span class="co">#&gt;   edu (%)                                     &lt;0.001</span></span>
<span><span class="co">#&gt;      &lt; 2ndary            1 ( 9.1)   1 ( 9.1)        </span></span>
<span><span class="co">#&gt;      2nd grad.           0 ( 0.0)   0 ( 0.0)        </span></span>
<span><span class="co">#&gt;      Other 2nd grad.     0 ( 0.0)   0 ( 0.0)        </span></span>
<span><span class="co">#&gt;      Post-2nd grad.     10 (90.9)  10 (90.9)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="treatment-effect-estimation-in-design" class="level4"><h4 class="anchored" data-anchor-id="treatment-effect-estimation-in-design">Treatment effect estimation in design</h4>
<section id="create-design" class="level5"><h5 class="anchored" data-anchor-id="create-design">Create design</h5>
<div class="cell" data-hash="propensityscore1_cache/html/match11_3daea38eb3066e128daf9fb25e9c2547">
<details><summary>Show the code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">matched2</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span> <span class="co"># full data</span></span>
<span><span class="co">#&gt; [1] 397173</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">OACVD.match.11n2</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span> <span class="co"># matched data</span></span>
<span><span class="co">#&gt; [1] 22</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">OACVD.match.11n2</span><span class="op">$</span><span class="va">ID</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 22</span></span>
<span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">matched2</span><span class="op">[</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">OACVD.match.11n2</span><span class="op">$</span><span class="va">ID</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">analytic.miss</span><span class="op">$</span><span class="va">matched2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      0      1 </span></span>
<span><span class="co">#&gt; 397151     22</span></span>
<span><span class="va">w.design0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html">svydesign</a></span><span class="op">(</span>id<span class="op">=</span><span class="op">~</span><span class="fl">1</span>, weights<span class="op">=</span><span class="op">~</span><span class="va">weight</span>, </span>
<span>                      data<span class="op">=</span><span class="va">analytic.miss</span><span class="op">)</span></span>
<span><span class="va">w.design.m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">w.design0</span>, <span class="va">matched2</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="outcome-analysis-1" class="level5"><h5 class="anchored" data-anchor-id="outcome-analysis-1">outcome analysis</h5>
<div class="cell" data-hash="propensityscore1_cache/html/match12_d4d04aa2cc26d919a8e15edad8d669df">
<details><summary>Show the code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit.outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svyglm.html">svyglm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">CVD</span><span class="op">==</span><span class="st">"event"</span><span class="op">)</span> <span class="op">~</span> <span class="va">OA</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">stress</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span></span>
<span>                         <span class="va">income</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">bmi</span> <span class="op">+</span> <span class="va">phyact</span> <span class="op">+</span> <span class="va">smoke</span> <span class="op">+</span></span>
<span>                         <span class="va">immigrate</span> <span class="op">+</span> <span class="va">fruit</span> <span class="op">+</span> <span class="va">diab</span> <span class="op">+</span> <span class="va">edu</span>,</span>
<span>                   design <span class="op">=</span> <span class="va">w.design.m2</span>,</span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Publish/man/publish.html">publish</a></span><span class="op">(</span><span class="va">fit.outcome</span><span class="op">)</span></span>
<span><span class="co"># Error in `contrasts&lt;-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) : </span></span>
<span><span class="co">#   contrasts can be applied only to factors with 2 or more levels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="questions-for-the-students-1" class="level5"><h5 class="anchored" data-anchor-id="questions-for-the-students-1">Questions for the students</h5>
<ul>
<li>Why the above model not fitting?</li>
</ul></section></section></section><section id="save-data-for-later-use" class="level3"><h3 class="anchored" data-anchor-id="save-data-for-later-use">Save data for later use</h3>
<div class="cell" data-hash="propensityscore1_cache/html/savedata_5c1885d9bb90b99236ce1456c698ffac">
<details><summary>Show the code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">analytic11n</span>, <span class="va">analytic2</span>, <span class="va">analytic.miss</span>, file<span class="op">=</span><span class="st">"Data/propensityscore/cchs123c.RData"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="video-content-optional" class="level3"><h3 class="anchored" data-anchor-id="video-content-optional">Video content (optional)</h3>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For those who prefer a video walkthrough, feel free to watch the video below, which offers a description of an earlier version of the above content.</p>
</div>
</div>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
<iframe src="https://www.youtube.com/embed/jC8g_n6RqK0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen="">
</iframe>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./propensityscore.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Propensity score</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./propensityscore2.html" class="pagination-link">
        <span class="nav-page-text">PSM in OA-CVD (CCHS)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>