{
  "hash": "2243938874772c089672152d1184dc59",
  "result": {
    "markdown": "## Data manipulation {.unnumbered}\n\nData manipulation is a foundational skill for data analysis. This guide introduces common methods for subsetting datasets, handling variable types, creating summary tables, and dealing with missing values using R.\n\n\n\n\n\n### Load dataset\n\nUnderstanding the dataset's structure is the first step in data manipulation. Here, we're using the `mpg` dataset, which provides information on various car models:\n\n\n::: {.cell hash='wrangling3_cache/html/load1_e4430f52967b82c62a41339247cb54ff'}\n\n```{.r .cell-code}\nmpg <- read.csv(\"Data/wrangling/mpg.csv\", header = TRUE)\n```\n:::\n\n\n### Subset\n\nOften, you'll need to subset your data for analysis. Here, we'll explore different methods to both drop unwanted variables and keep desired observations.\n\n#### Drop variables\n\nSometimes, only part of the variables will be used in your analysis. Therefore, you may want to drop the variables you do not need. There are multiple ways to drop variables from a dataset. Below are two examples without using any package and using the `dplyr` package.\n\n::: callout-tip\n**Option 1: No package needed**\n\ndataset.name\\[, c(columns_names_you_want_to_KEEP)\\]\n:::\n\nSay, we want to keep only three variables in the mpg dataset: manufacturer, model and cyl. For Option 1 (without package), we can use the following R codes to keep these three variables:\n\n\n::: {.cell hash='wrangling3_cache/html/load2_c7731e2e3fc70c3322f5e3c802e7411e'}\n\n```{.r .cell-code}\nmpg1 <- mpg[, c(\"manufacturer\", \"model\", \"cyl\")]\nhead(mpg1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"manufacturer\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"model\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"cyl\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"4\",\"_rn_\":\"1\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"4\",\"_rn_\":\"2\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"4\",\"_rn_\":\"3\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"4\",\"_rn_\":\"4\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"6\",\"_rn_\":\"5\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"6\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nHere `mpg1` is a new dataset containing only three variables (manufacturer, model and cyl).\n\n::: callout-tip\n**Option 2: use select in dplyr**\n\nselect(dataset.name, c(columns_names_you_want_to_KEEP))\n:::\n\nFor Option 2, the `dplyr` package offers the `select` function, which provides a more intuitive way to subset data.\n\n\n::: {.cell hash='wrangling3_cache/html/load3_287f8a3b59afc394a2588d5388d08151'}\n\n```{.r .cell-code}\nmpg2 <- select(mpg, c(\"manufacturer\", \"model\", \"cyl\"))\nhead(mpg2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"manufacturer\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"model\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"cyl\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"4\",\"_rn_\":\"1\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"4\",\"_rn_\":\"2\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"4\",\"_rn_\":\"3\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"4\",\"_rn_\":\"4\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"6\",\"_rn_\":\"5\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"6\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nWe can also exclude any variables from the dataset by using the minus (-) sign with the `select` function. For example, we we want to drop `trans`, `drv`, and `cty` from the `mpg` dataset, we can use the following codes:\n\n\n::: {.cell hash='wrangling3_cache/html/load4_bbc59257f0c26604fc4a528d433501a7'}\n\n```{.r .cell-code}\nmpg3 <- select(mpg, -c(\"trans\", \"drv\", \"cty\"))\nhead(mpg3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"manufacturer\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"model\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"displ\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"year\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"cyl\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"hwy\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"fl\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"class\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"1.8\",\"4\":\"1999\",\"5\":\"4\",\"6\":\"29\",\"7\":\"p\",\"8\":\"compact\",\"_rn_\":\"1\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"1.8\",\"4\":\"1999\",\"5\":\"4\",\"6\":\"29\",\"7\":\"p\",\"8\":\"compact\",\"_rn_\":\"2\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"2.0\",\"4\":\"2008\",\"5\":\"4\",\"6\":\"31\",\"7\":\"p\",\"8\":\"compact\",\"_rn_\":\"3\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"2.0\",\"4\":\"2008\",\"5\":\"4\",\"6\":\"30\",\"7\":\"p\",\"8\":\"compact\",\"_rn_\":\"4\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"2.8\",\"4\":\"1999\",\"5\":\"6\",\"6\":\"26\",\"7\":\"p\",\"8\":\"compact\",\"_rn_\":\"5\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"2.8\",\"4\":\"1999\",\"5\":\"6\",\"6\":\"26\",\"7\":\"p\",\"8\":\"compact\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nThis `mpg3` is a new dataset from `mpg` after dropping three variables (trans, drv, and cty).\n\n#### Keep observations\n\nIt often happens that we only want to investigate a subset of a population which only requires a subset of our dataset. In this case, we need to subset the dataset to meet certain requirements. Again, there are multiple ways to do this task. Below is an example without a package and with the `dplyr` package:\n\n::: callout-tip\n**Option 1: No package needed**\n\ndataset.name\\[rows_you_want_to_KEEP, \\]\n:::\n\n::: callout-tip\n**Option 2: No package needed**\n\nsubset(dataset.name, rows_you_want_to_KEEP)\n:::\n\n::: callout-tip\n**Option 3: use filter in dplyr**\n\nfilter(dataset.name, rows_you_want_to_KEEP)\n:::\n\nWe can use the logical tests for the rows you want to keep or drop.\n\n::: callout-tip\nCommon logical tests are:\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Syntax </th>\n   <th style=\"text-align:left;\"> Meaning </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> X &lt;(=) Y </td>\n   <td style=\"text-align:left;\"> Smaller (equal) than </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> X &gt;(=) Y </td>\n   <td style=\"text-align:left;\"> Larger (equal) than </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> X == Y </td>\n   <td style=\"text-align:left;\"> Equal to </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> X != Y </td>\n   <td style=\"text-align:left;\"> Not equal to </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> is.na(X) </td>\n   <td style=\"text-align:left;\"> is NA/missing? </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n:::\n\nSay, we want to keep the observations for which cars are manufactured in 2008. We can use the following R codes to do it:\n\n\n::: {.cell hash='wrangling3_cache/html/keep1_f679e8e7e9c24fe5f08233e5758dee01'}\n\n```{.r .cell-code}\n# Option 1\nmpg4 <- mpg[mpg$year == \"2008\",]\nhead(mpg4)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"manufacturer\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"model\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"displ\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"year\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"cyl\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"trans\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"drv\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"cty\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"hwy\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"fl\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"class\"],\"name\":[11],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"2.0\",\"4\":\"2008\",\"5\":\"4\",\"6\":\"manual(m6)\",\"7\":\"f\",\"8\":\"20\",\"9\":\"31\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"3\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"2.0\",\"4\":\"2008\",\"5\":\"4\",\"6\":\"auto(av)\",\"7\":\"f\",\"8\":\"21\",\"9\":\"30\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"4\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"3.1\",\"4\":\"2008\",\"5\":\"6\",\"6\":\"auto(av)\",\"7\":\"f\",\"8\":\"18\",\"9\":\"27\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"7\"},{\"1\":\"audi\",\"2\":\"a4 quattro\",\"3\":\"2.0\",\"4\":\"2008\",\"5\":\"4\",\"6\":\"manual(m6)\",\"7\":\"4\",\"8\":\"20\",\"9\":\"28\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"10\"},{\"1\":\"audi\",\"2\":\"a4 quattro\",\"3\":\"2.0\",\"4\":\"2008\",\"5\":\"4\",\"6\":\"auto(s6)\",\"7\":\"4\",\"8\":\"19\",\"9\":\"27\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"11\"},{\"1\":\"audi\",\"2\":\"a4 quattro\",\"3\":\"3.1\",\"4\":\"2008\",\"5\":\"6\",\"6\":\"auto(s6)\",\"7\":\"4\",\"8\":\"17\",\"9\":\"25\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"14\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nThe following codes with the `subset` and `filter` function will do the same:\n\n\n::: {.cell hash='wrangling3_cache/html/keep2_4e9addad71738ee065855c4038ff38bb'}\n\n```{.r .cell-code}\n# Option 2\nmpg5 <- subset(mpg, year == \"2008\")\nhead(mpg5)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"manufacturer\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"model\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"displ\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"year\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"cyl\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"trans\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"drv\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"cty\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"hwy\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"fl\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"class\"],\"name\":[11],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"2.0\",\"4\":\"2008\",\"5\":\"4\",\"6\":\"manual(m6)\",\"7\":\"f\",\"8\":\"20\",\"9\":\"31\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"3\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"2.0\",\"4\":\"2008\",\"5\":\"4\",\"6\":\"auto(av)\",\"7\":\"f\",\"8\":\"21\",\"9\":\"30\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"4\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"3.1\",\"4\":\"2008\",\"5\":\"6\",\"6\":\"auto(av)\",\"7\":\"f\",\"8\":\"18\",\"9\":\"27\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"7\"},{\"1\":\"audi\",\"2\":\"a4 quattro\",\"3\":\"2.0\",\"4\":\"2008\",\"5\":\"4\",\"6\":\"manual(m6)\",\"7\":\"4\",\"8\":\"20\",\"9\":\"28\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"10\"},{\"1\":\"audi\",\"2\":\"a4 quattro\",\"3\":\"2.0\",\"4\":\"2008\",\"5\":\"4\",\"6\":\"auto(s6)\",\"7\":\"4\",\"8\":\"19\",\"9\":\"27\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"11\"},{\"1\":\"audi\",\"2\":\"a4 quattro\",\"3\":\"3.1\",\"4\":\"2008\",\"5\":\"6\",\"6\":\"auto(s6)\",\"7\":\"4\",\"8\":\"17\",\"9\":\"25\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"14\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell hash='wrangling3_cache/html/keep3_6a6d62d823e700a2a6f9f72a8c580613'}\n\n```{.r .cell-code}\n# Option 3\nmpg6 <- filter(mpg, year == \"2008\") \nhead(mpg6)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"manufacturer\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"model\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"displ\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"year\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"cyl\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"trans\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"drv\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"cty\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"hwy\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"fl\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"class\"],\"name\":[11],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"2.0\",\"4\":\"2008\",\"5\":\"4\",\"6\":\"manual(m6)\",\"7\":\"f\",\"8\":\"20\",\"9\":\"31\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"1\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"2.0\",\"4\":\"2008\",\"5\":\"4\",\"6\":\"auto(av)\",\"7\":\"f\",\"8\":\"21\",\"9\":\"30\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"2\"},{\"1\":\"audi\",\"2\":\"a4\",\"3\":\"3.1\",\"4\":\"2008\",\"5\":\"6\",\"6\":\"auto(av)\",\"7\":\"f\",\"8\":\"18\",\"9\":\"27\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"3\"},{\"1\":\"audi\",\"2\":\"a4 quattro\",\"3\":\"2.0\",\"4\":\"2008\",\"5\":\"4\",\"6\":\"manual(m6)\",\"7\":\"4\",\"8\":\"20\",\"9\":\"28\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"4\"},{\"1\":\"audi\",\"2\":\"a4 quattro\",\"3\":\"2.0\",\"4\":\"2008\",\"5\":\"4\",\"6\":\"auto(s6)\",\"7\":\"4\",\"8\":\"19\",\"9\":\"27\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"5\"},{\"1\":\"audi\",\"2\":\"a4 quattro\",\"3\":\"3.1\",\"4\":\"2008\",\"5\":\"6\",\"6\":\"auto(s6)\",\"7\":\"4\",\"8\":\"17\",\"9\":\"25\",\"10\":\"p\",\"11\":\"compact\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nThe filter function can also work when you have multiple criteria (i.e., multiple logical tests) to satisfy. Here, we need Boolean operators to connect different logical tests.\n\n::: callout-tip\nCommon boolean operators are:\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Syntax </th>\n   <th style=\"text-align:left;\"> Meaning </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> &amp; </td>\n   <td style=\"text-align:left;\"> and </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> | </td>\n   <td style=\"text-align:left;\"> or </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ! </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> == </td>\n   <td style=\"text-align:left;\"> equals to </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> != </td>\n   <td style=\"text-align:left;\"> not equal to </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> &gt; </td>\n   <td style=\"text-align:left;\"> greater than </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> &lt; </td>\n   <td style=\"text-align:left;\"> less than </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> &gt;= </td>\n   <td style=\"text-align:left;\"> greater than or equal to </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> &lt;= </td>\n   <td style=\"text-align:left;\"> less than or equal to </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n:::\n\nSay, we want to keep the observations for 6 and 8 cylinders (cyl) and engine displacement (displ) greater than or equal to 4 litres. We can use the following codes to do the task:\n\n\n::: {.cell hash='wrangling3_cache/html/keep4_eca795741cb62e47beccaa35a31a5a66'}\n\n```{.r .cell-code}\nmpg7 <- filter(mpg, cyl %in% c(\"6\",\"8\") & displ >= 4)\nhead(mpg7)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"manufacturer\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"model\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"displ\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"year\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"cyl\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"trans\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"drv\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"cty\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"hwy\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"fl\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"class\"],\"name\":[11],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"audi\",\"2\":\"a6 quattro\",\"3\":\"4.2\",\"4\":\"2008\",\"5\":\"8\",\"6\":\"auto(s6)\",\"7\":\"4\",\"8\":\"16\",\"9\":\"23\",\"10\":\"p\",\"11\":\"midsize\",\"_rn_\":\"1\"},{\"1\":\"chevrolet\",\"2\":\"c1500 suburban 2wd\",\"3\":\"5.3\",\"4\":\"2008\",\"5\":\"8\",\"6\":\"auto(l4)\",\"7\":\"r\",\"8\":\"14\",\"9\":\"20\",\"10\":\"r\",\"11\":\"suv\",\"_rn_\":\"2\"},{\"1\":\"chevrolet\",\"2\":\"c1500 suburban 2wd\",\"3\":\"5.3\",\"4\":\"2008\",\"5\":\"8\",\"6\":\"auto(l4)\",\"7\":\"r\",\"8\":\"11\",\"9\":\"15\",\"10\":\"e\",\"11\":\"suv\",\"_rn_\":\"3\"},{\"1\":\"chevrolet\",\"2\":\"c1500 suburban 2wd\",\"3\":\"5.3\",\"4\":\"2008\",\"5\":\"8\",\"6\":\"auto(l4)\",\"7\":\"r\",\"8\":\"14\",\"9\":\"20\",\"10\":\"r\",\"11\":\"suv\",\"_rn_\":\"4\"},{\"1\":\"chevrolet\",\"2\":\"c1500 suburban 2wd\",\"3\":\"5.7\",\"4\":\"1999\",\"5\":\"8\",\"6\":\"auto(l4)\",\"7\":\"r\",\"8\":\"13\",\"9\":\"17\",\"10\":\"r\",\"11\":\"suv\",\"_rn_\":\"5\"},{\"1\":\"chevrolet\",\"2\":\"c1500 suburban 2wd\",\"3\":\"6.0\",\"4\":\"2008\",\"5\":\"8\",\"6\":\"auto(l4)\",\"7\":\"r\",\"8\":\"12\",\"9\":\"17\",\"10\":\"r\",\"11\":\"suv\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n::: column-margin\nThe `%in%` operator is used to determine whether the values of the first argument are present in the second argument.\n:::\n\n#### Handling Variable Types\n\n::: callout-tip\nMost common types of variable in R are\n\n-   numbers,\n-   factors and\n-   strings(or character).\n\nUnderstanding and manipulating these types are crucial for data analysis.\n:::\n\n1.  Identifying Variable Type\n\nWhen we analyze the data, we usually just deal with numbers and factors. If there are variables are strings, we could convert them to factors using **as.factors(variable.name)**\n\n\n::: {.cell hash='wrangling3_cache/html/keep5_16381e098fab98c0b2512bb627d591df'}\n\n```{.r .cell-code}\nmode(mpg$trans)\n#> [1] \"character\"\n```\n:::\n\n::: {.cell hash='wrangling3_cache/html/keep6_29c5ceeb0780344a010ba27d1cb36fe5'}\n\n```{.r .cell-code}\nstr(mpg$trans)\n#>  chr [1:234] \"auto(l5)\" \"manual(m5)\" \"manual(m6)\" \"auto(av)\" \"auto(l5)\" ...\n```\n:::\n\n\n2.  Converting Characters to Factors\n\nSometimes, it's necessary to treat text data as categorical by converting them into factors. **as.numeric()** converts other types of variables to numbers. For a factor variable, we usually we want to access the categories (or levels) it has. We can use a build-in function to explore: **levels(variable.name)**\n\n\n::: {.cell hash='wrangling3_cache/html/keep7_566e54ffb8740362b0eeb2f7af2d268d'}\n\n```{.r .cell-code}\n# no levels for character\nlevels(mpg$trans)\n#> NULL\n```\n:::\n\n::: {.cell hash='wrangling3_cache/html/keep8_6d3495f240ee402567560dce18bccadb'}\n\n```{.r .cell-code}\n## Ex check how many different trans the dataset has\nmpg$trans <- as.factor(mpg$trans)\nlevels(mpg$trans)\n#>  [1] \"auto(av)\"   \"auto(l3)\"   \"auto(l4)\"   \"auto(l5)\"   \"auto(l6)\"  \n#>  [6] \"auto(s4)\"   \"auto(s5)\"   \"auto(s6)\"   \"manual(m5)\" \"manual(m6)\"\n```\n:::\n\n\nThe levels usually will be ordered alphabetically. The first level is called \"baseline\". However, the users may/may not want to keep this baseline and want to relevel/change the reference group. We can do it using the `relevel` function:\n\n**relevel(variable.name, ref=)**\n\n\n::: {.cell hash='wrangling3_cache/html/keep9_30b9a18a6105bf88248a7690688fa455'}\n\n```{.r .cell-code}\nmpg$trans <- relevel(mpg$trans, ref = \"auto(s6)\")\nlevels(mpg$trans)\n#>  [1] \"auto(s6)\"   \"auto(av)\"   \"auto(l3)\"   \"auto(l4)\"   \"auto(l5)\"  \n#>  [6] \"auto(l6)\"   \"auto(s4)\"   \"auto(s5)\"   \"manual(m5)\" \"manual(m6)\"\nnlevels(mpg$trans)\n#> [1] 10\n```\n:::\n\n\nThe `factor` function can also be used to combine multiple factors into one factor. \n\n\n::: {.cell hash='wrangling3_cache/html/keep10_ca4103b59cd5ab34bcb7f7e615af5ea0'}\n\n```{.r .cell-code}\n## EX re-group trans to \"auto\" and \"manual\"\nlevels(mpg$trans) <- list(auto = c(\"auto(av)\", \"auto(l3)\", \"auto(l4)\", \"auto(l5)\", \"auto(l6)\", \n                                   \"auto(s4)\", \"auto(s5)\", \"auto(s6)\"), \n                          manual = c(\"manual(m5)\", \"manual(m6)\"))\nlevels(mpg$trans)\n#> [1] \"auto\"   \"manual\"\n```\n:::\n\n\nYou can also change the order of all factors using the following code: **factor(variable.name, levels = c(\"new order\"))**\n\n\n::: {.cell hash='wrangling3_cache/html/keep11_4ab8581d2ae55f8571b716e007b5b6ea'}\n\n```{.r .cell-code}\n## EX. Change the order of trans to manual\nmpg$trans <- factor(mpg$trans, levels = c(\"manual\", \"auto\"))\nlevels(mpg$trans)\n#> [1] \"manual\" \"auto\"\n```\n:::\n\n\n::: column-margin\nIn R, the use of factors with multiple levels is primarily a memory optimization strategy. While users may not directly see this, R assigns internal numerical identifiers to each level, which is a more memory-efficient way of handling such data. Unlike some other software packages that generate multiple dummy variables to represent a single variable, R's approach is generally more resource-efficient.\n:::\n\n3.  Converting back from Factors Characters\n\nYou can also convert factor back to character using the **as.character** function.\n\n\n::: {.cell hash='wrangling3_cache/html/convertback_938f9483f336dea6137a5ac76f23b8fb'}\n\n```{.r .cell-code}\n# Convert factor back to character\nmpg$trans <- as.character(mpg$trans)\nlevels(mpg$trans) # no levels for character\n#> NULL\n```\n:::\n\n\n#### Convert continuous variables to categorical variables\n\n::: callout-tip\n`ifelse`, `cut`, `recode` all are helpful functions to convert numerical variables to categorical variables.\n:::\n\nLet's see the summary of the cty variable first.\n\n\n::: {.cell hash='wrangling3_cache/html/convert1_ac52fcb4554925ac8104d5871eb9fae1'}\n\n```{.r .cell-code}\nsummary(mpg$cty)\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n#>    9.00   14.00   17.00   16.86   19.00   35.00\n```\n:::\n\n\nsay, we may want to change continuous 'cty' into groups 0-14, 15-18, and 18-40. Below is an example with the `cut` function.\n\n\n::: {.cell hash='wrangling3_cache/html/convert2_1fe9ec03e78a7468528b8b7454cf5226'}\n\n```{.r .cell-code}\n## EX. change the cty into two categories (0,14], (14,18] and (18,40]\nmpg$cty.num <- cut(mpg$cty, c(0, 14, 18, 40), right = TRUE)\ntable(mpg$cty.num)\n#> \n#>  (0,14] (14,18] (18,40] \n#>      73      85      76\n```\n:::\n\n::: {.cell hash='wrangling3_cache/html/convert3_113f9b6bbb12afedc4d7ce982e6c95d4'}\n\n```{.r .cell-code}\n## Try this: do you see a difference?: [0,14), [14,18) and [18,40)\nmpg$cty.num2 <- cut(mpg$cty, c(0, 14, 18, 40), right = FALSE)\ntable(mpg$cty.num2)\n#> \n#>  [0,14) [14,18) [18,40) \n#>      54      78     102\n```\n:::\n\n\n::: column-margin\n`]` stands for closed interval, i.e., right = TRUE. On the other hand, `)` means open interval. Hence, there will be a huge difference when setting right = TRUE vs. right = FALSE\n:::\n\n### Missing value\n\n::: callout-tip\nIncomplete datasets can distort analysis. Identifying and managing these missing values is thus crucial.\n:::\n\nWe can check how many missing values we have by: **table(is.na(variable.name))**\n\nLet's us check whether the cty variable contains any missing values:\n\n\n::: {.cell hash='wrangling3_cache/html/missval_a749a25ffce9b82a30bc64a2cabaf0ab'}\n\n```{.r .cell-code}\ntable(is.na(mpg$cty))\n#> \n#> FALSE \n#>   234\n```\n:::\n\n\nIf you want to return all non-missing values, i.e., complete case values: **na.omit(variable.name)**. For more extensive methods on handling missing values, see subsequent tutorials.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}