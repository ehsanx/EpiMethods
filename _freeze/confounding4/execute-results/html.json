{
  "hash": "74085ef2abb7f7f1f1456e1cda6364eb",
  "result": {
    "engine": "knitr",
    "markdown": "## Z-bias {.unnumbered}\n\nZ-bias occurs in the context of causal inference, specifically when using instrumental variables to estimate causal effects. Instrumental variables (IVs) are used to isolate the variation in the treatment variable that is unrelated to the confounding factors, thus providing a pathway to estimate causal effects. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(simcausal)\n```\n:::\n\n\n### Continuous Y\n\n-   U is unmeasured continuous variable\n-   Z is an instrumental variable\n-   A is binary treatment\n-   Y is continuous outcome\n\n#### Non-null effect\n\n-   True treatment effect = 1.3\n\n##### Data generating process\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(simcausal)\nD <- DAG.empty()\nD <- D + \n  node(\"U\", distr = \"rnorm\", mean = 2, sd = 1) + \n  node(\"Z\", distr = \"rnorm\", mean = 2, sd = 1) + \n  node(\"A\", distr = \"rbern\", prob = plogis(-1 + 2*U + 2*Z)) +\n  node(\"Y\", distr = \"rnorm\", mean = -1 + 3 * U + 1.3 * A, sd = 0.1)\nDset <- set.DAG(D)\n```\n:::\n\n\n##### Generate DAG\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplotDAG(Dset, xjitter = 0.1, yjitter = .9,\n        edge_attrs = list(width = 0.5, arrow.width = 0.4, arrow.size = 0.7),\n        vertex_attrs = list(size = 12, label.cex = 0.8))\n```\n\n::: {.cell-output-display}\n![](confounding4_files/figure-html/dag10-1.png){width=672}\n:::\n:::\n\n\n##### Generate Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(simcausal)\nObs.Data <- sim(DAG = Dset, n = 1000000, rndseed = 123)\nhead(Obs.Data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"ID\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"U\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Z\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"A\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Y\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"1.439524\",\"3\":\"0.9919293\",\"4\":\"1\",\"5\":\"4.667744\",\"_rn_\":\"1\"},{\"1\":\"2\",\"2\":\"1.769823\",\"3\":\"3.3549394\",\"4\":\"1\",\"5\":\"5.491603\",\"_rn_\":\"2\"},{\"1\":\"3\",\"2\":\"3.558708\",\"3\":\"1.5310251\",\"4\":\"1\",\"5\":\"11.063519\",\"_rn_\":\"3\"},{\"1\":\"4\",\"2\":\"2.070508\",\"3\":\"3.4681936\",\"4\":\"1\",\"5\":\"6.501764\",\"_rn_\":\"4\"},{\"1\":\"5\",\"2\":\"2.129288\",\"3\":\"2.4425564\",\"4\":\"1\",\"5\":\"6.834678\",\"_rn_\":\"5\"},{\"1\":\"6\",\"2\":\"3.715065\",\"3\":\"2.1462031\",\"4\":\"1\",\"5\":\"11.340150\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n##### Estimate effect\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# True data generating mechanism (unattainable as U is unmeasured)\nfit0 <- glm(Y ~ A + U, family=\"gaussian\", data=Obs.Data)\nround(coef(fit0),2)\n#> (Intercept)           A           U \n#>        -1.0         1.3         3.0\n\n# Unadjusted effect (Z not controlled)\nfit1 <- glm(Y ~ A, family=\"gaussian\", data=Obs.Data)\nround(coef(fit1),2)\n#> (Intercept)           A \n#>        0.79        5.59\n\n# Bias fit 1\ncoef(fit1)[\"A\"] - 1.3\n#>      A \n#> 4.2935\n\n# Adjusted effect (Z  controlled)\nfit2 <- glm(Y ~ A + Z, family=\"gaussian\", data=Obs.Data)\nround(coef(fit2),2)\n#> (Intercept)           A           Z \n#>        0.86        5.77       -0.12\n\n# Bias from fit 2\ncoef(fit2)[\"A\"] - 1.3\n#>        A \n#> 4.465787\n```\n:::\n\n\n### Binary Y\n\n-   U is unmeasured continuous variable\n-   Z is an instrumental variable\n-   A is binary treatment\n-   Y is binary outcome\n\n#### Non-null effect\n\n-   True treatment effect = 1.3\n\n##### Data generating process\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(simcausal)\nD <- DAG.empty()\nD <- D + \n  node(\"U\", distr = \"rnorm\", mean = 2, sd = 1) + \n  node(\"Z\", distr = \"rnorm\", mean = 2, sd = 1) + \n  node(\"A\", distr = \"rbern\", prob = plogis(-1 + 2*U + 2*Z)) +\n  node(\"Y\", distr = \"rbern\", prob = plogis(-1 + 3 * U + 1.3 * A))\nDset <- set.DAG(D)\n```\n:::\n\n\n##### Generate DAG\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplotDAG(Dset, xjitter = 0.1, yjitter = .9,\n        edge_attrs = list(width = 0.5, arrow.width = 0.4, arrow.size = 0.7),\n        vertex_attrs = list(size = 12, label.cex = 0.8))\n```\n\n::: {.cell-output-display}\n![](confounding4_files/figure-html/dag11-1.png){width=672}\n:::\n:::\n\n\n##### Generate Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(simcausal)\nObs.Data <- sim(DAG = Dset, n = 1000000, rndseed = 123)\nhead(Obs.Data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"ID\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"U\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Z\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"A\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Y\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"1.439524\",\"3\":\"0.9919293\",\"4\":\"1\",\"5\":\"1\",\"_rn_\":\"1\"},{\"1\":\"2\",\"2\":\"1.769823\",\"3\":\"3.3549394\",\"4\":\"1\",\"5\":\"1\",\"_rn_\":\"2\"},{\"1\":\"3\",\"2\":\"3.558708\",\"3\":\"1.5310251\",\"4\":\"1\",\"5\":\"1\",\"_rn_\":\"3\"},{\"1\":\"4\",\"2\":\"2.070508\",\"3\":\"3.4681936\",\"4\":\"1\",\"5\":\"1\",\"_rn_\":\"4\"},{\"1\":\"5\",\"2\":\"2.129288\",\"3\":\"2.4425564\",\"4\":\"1\",\"5\":\"1\",\"_rn_\":\"5\"},{\"1\":\"6\",\"2\":\"3.715065\",\"3\":\"2.1462031\",\"4\":\"1\",\"5\":\"1\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n##### Estimate effect\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# True data generating mechanism (unattainable as U is unmeasured)\nfit0 <- glm(Y ~ A + U, family=\"binomial\", data=Obs.Data)\nround(coef(fit0),2)\n#> (Intercept)           A           U \n#>       -0.99        1.30        3.01\n\n# Unadjusted effect (Z not controlled)\nfit1 <- glm(Y ~ A, family=\"binomial\", data=Obs.Data)\nround(coef(fit1),2)\n#> (Intercept)           A \n#>        0.40        3.02\n\n# Bias fit 1\ncoef(fit1)[\"A\"] - 1.3\n#>        A \n#> 1.716482\n\n# Adjusted effect (Z  controlled)\nfit2 <- glm(Y ~ A + Z, family=\"binomial\", data=Obs.Data)\nround(coef(fit2),2)\n#> (Intercept)           A           Z \n#>        0.51        3.29       -0.18\n\n# Bias from fit 2\ncoef(fit2)[\"A\"] - 1.3\n#>        A \n#> 1.991396\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}