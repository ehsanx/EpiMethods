{
  "hash": "eae91a1131ab4c5c2b3a58172378fe83",
  "result": {
    "markdown": "## Collider {.unnumbered}\n\nIn causal inference, understanding the role of colliders is crucial. A collider is a variable that is a common effect of two or more variables. Adjusting for a collider can introduce bias into your estimates. \n\n\n\n::: {.cell hash='confounding3_cache/html/setup_a6e2f504b83c5e28cf009d597e8baf4a'}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(simcausal)\n```\n:::\n\n\nIn a DAG, a collider is a variable influenced by two or more other variables. In our case, L is a collider because it is affected by both A (the treatment) and Y (the outcome). When you adjust for a collider like L, you could introduce bias into your estimates, as demonstrated in the examples below.\n\nLet us consider\n\n-   L is continuous variable\n-   A is binary treatment/exposure\n-   Y is continuous outcome\n\nAn example of A could be a genetic variable (e.g., skin color), Y could be an environmental variable (e.g., indoor air pollution), and L could be disease conditions (e.g., number of comorbidities) ([detailed expamles here](https://doi.org/10.1093/ije/dyp334)).  \n\n### Non-null effect\n\n-   True treatment effect = 1.3\n\n#### Data generating process\n\n\n::: {.cell hash='confounding3_cache/html/dgm3_31210f8f75040507d08d6258c2399e07'}\n\n```{.r .cell-code}\nD <- DAG.empty()\nD <- D + \n  node(\"A\", distr = \"rbern\", prob = plogis(-10)) +\n  node(\"Y\", distr = \"rnorm\", mean = 1.3 * A, sd = .1) +\n  node(\"L\", distr = \"rnorm\", mean = 10 * Y + 1.3 * A, sd = 1)\nDset <- set.DAG(D)\n```\n:::\n\n\n#### Generate DAG\n\n\n::: {.cell hash='confounding3_cache/html/dag3_7647c1e852710ccbf0aeae86b415d7ad'}\n\n```{.r .cell-code}\nplotDAG(Dset, xjitter = 0.1, yjitter = .9,\n        edge_attrs = list(width = 0.5, arrow.width = 0.4, arrow.size = 0.7),\n        vertex_attrs = list(size = 12, label.cex = 0.8))\n```\n\n::: {.cell-output-display}\n![](confounding3_files/figure-html/dag3-1.png){width=672}\n:::\n:::\n\n\n#### Generate data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(simcausal)\nObs.Data <- sim(DAG = Dset, n = 1000000, rndseed = 123)\nhead(Obs.Data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"ID\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"A\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Y\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"L\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"0\",\"3\":\"0.02620001\",\"4\":\"1.7153509\",\"_rn_\":\"1\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"-0.15209594\",\"4\":\"-2.9689005\",\"_rn_\":\"2\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"0.02366280\",\"4\":\"0.6548666\",\"_rn_\":\"3\"},{\"1\":\"4\",\"2\":\"0\",\"3\":\"0.06603038\",\"4\":\"-0.2591076\",\"_rn_\":\"4\"},{\"1\":\"5\",\"2\":\"0\",\"3\":\"-0.02140063\",\"4\":\"0.5220096\",\"_rn_\":\"5\"},{\"1\":\"6\",\"2\":\"0\",\"3\":\"0.01928270\",\"4\":\"-0.6426011\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n#### Estimate effect\n\n\n::: {.cell hash='confounding3_cache/html/est3_f1248015a6d288b50dceeb7c67648ac1'}\n\n```{.r .cell-code}\n# Not adjusted for L\nfit0 <- glm(Y ~ A, family=\"gaussian\", data=Obs.Data)\nround(coef(fit0),2)\n#> (Intercept)           A \n#>        0.00        1.29\n\n# Adjusted for L\nfit <- glm(Y ~ A + L, family=\"gaussian\", data=Obs.Data)\nround(coef(fit),2)\n#> (Intercept)           A           L \n#>        0.00        0.58        0.05\n```\n:::\n\n\n::: callout-important\nWhen not adjusting for L, we recover the true effect close to 1.3. Adjusting for L introduces bias, making the estimate unreliable.\n::: \n\n\n### Null effect\n\n-   True treatment effect = 0\n\n#### Data generating process\n\n\n::: {.cell hash='confounding3_cache/html/dgm4_d47e1178f77b2f7be690cc4dd877c5d9'}\n\n```{.r .cell-code}\nD <- DAG.empty()\nD <- D + \n  node(\"A\", distr = \"rbern\", prob = plogis(-10)) +\n  node(\"Y\", distr = \"rnorm\", mean = 0, sd = .1) +\n  node(\"L\", distr = \"rnorm\", mean = 10 * Y + 1.3 * A, sd = 1)\nDset <- set.DAG(D)\n```\n:::\n\n\n#### Generate DAG\n\n\n::: {.cell hash='confounding3_cache/html/dag4_cc3c7a52f33df1395e513cda6e2e8918'}\n\n```{.r .cell-code}\nplotDAG(Dset, xjitter = 0.1, yjitter = .9,\n        edge_attrs = list(width = 0.5, arrow.width = 0.4, arrow.size = 0.7),\n        vertex_attrs = list(size = 12, label.cex = 0.8))\n```\n\n::: {.cell-output-display}\n![](confounding3_files/figure-html/dag4-1.png){width=672}\n:::\n:::\n\n\n#### Generate data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(simcausal)\nObs.Data <- sim(DAG = Dset, n = 1000000, rndseed = 123)\nhead(Obs.Data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"ID\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"A\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Y\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"L\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"0\",\"3\":\"0.02620001\",\"4\":\"1.7153509\",\"_rn_\":\"1\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"-0.15209594\",\"4\":\"-2.9689005\",\"_rn_\":\"2\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"0.02366280\",\"4\":\"0.6548666\",\"_rn_\":\"3\"},{\"1\":\"4\",\"2\":\"0\",\"3\":\"0.06603038\",\"4\":\"-0.2591076\",\"_rn_\":\"4\"},{\"1\":\"5\",\"2\":\"0\",\"3\":\"-0.02140063\",\"4\":\"0.5220096\",\"_rn_\":\"5\"},{\"1\":\"6\",\"2\":\"0\",\"3\":\"0.01928270\",\"4\":\"-0.6426011\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n#### Estimate effect\n\n\n::: {.cell hash='confounding3_cache/html/est4_aeec6b8f84fea87f08f9af28cc9ebaf6'}\n\n```{.r .cell-code}\n# Not adjusted for L\nfit0 <- glm(Y ~ A, family=\"gaussian\", data=Obs.Data)\nround(coef(fit0),2)\n#> (Intercept)           A \n#>        0.00       -0.01\n\n# Adjusted for L\nfit <- glm(Y ~ A + L, family=\"gaussian\", data=Obs.Data)\nround(coef(fit),2)\n#> (Intercept)           A           L \n#>        0.00       -0.07        0.05\n```\n:::\n\n\n::: callout-important\nWhen the true effect is null, not adjusting for L shows an estimate close to zero. Adjusting for L moves the estimate away from the null value, introducing bias.\n::: \n\nEven 1,000,000 observations were not enough to recover true treatment effect! But we are close enough.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}