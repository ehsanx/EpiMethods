{
  "hash": "8932b9dc84b22731840b4dfc8a505201",
  "result": {
    "markdown": "## CCHS: Revisiting PICOT {.unnumbered}\n\nWelcome to this tutorial where we will examine the same research question presented in the [Causal question-1](researchquestion3.html) tutorial. Our approach will be enriched this time by working with a more comprehensive set of covariates. We will follow the guidelines from the research article by @rahman2013relationship [DOI:10.1136/bmjopen-2013-002624](https://bmjopen.bmj.com/content/3/5/e002624). We will also will work properly with survey feature variables (e.g., sampling weights).\n\n::: column-margin\n[@rahman2013relationship]\n:::\n\n### Remembering PICOT\n\nBefore diving into the data, let's clarify and remember the research parameters using the PICOT framework:\n\n(1) **Target population**: Canadian adults (CCHS data)\n\n(2) **Outcome** ($Y$): CVD (Heart disease/Cardiovascular Disease)\n\n(3) **Exposure group** ($A$): Osteoarthritis (OA)\n\n(4) **Control group**: People without OA\n\n(5) **Timeline**: Data collected from 2001 to 2005\n\nIn addition, we'll identify potential confounders based on literature to better understand the relationship between exposure and outcome.\n\n### Creating dataset {.unnumbered}\n\nTo start, we'll load the required R packages:\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/setup_59b21245f917ae529c8af0429abd399e'}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(survey)\nlibrary(knitr)\nlibrary(car)\n```\n:::\n\n\n\n### Load data\n\nWe'll be using CCHS data from various cycles. Use the following code to load this data into your R environment:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# CCHS 1.1\nload(\"Data/surveydata/cchsc1.RData\")\n\n# CCHS 2.1\nload(\"Data/surveydata/cchsc2.RData\")\n\n# CCHS 3.1\nload(\"Data/surveydata/cchsc3.RData\")\n\n# objects loaded\nls()\n#> [1] \"c1\"              \"c2\"              \"c3\"              \"has_annotations\"\n```\n:::\n\n\n\nTo check the dimensions of each data set:\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/dim_c3386a25c7980b7da382ad6d2b03a316'}\n\n```{.r .cell-code}\n# Dimensions\ndim(c1)\n#> [1] 130880    117\ndim(c2)\n#> [1] 134072    112\ndim(c3)\n#> [1] 132221    112\n```\n:::\n\n\n\n### Subset the data (subset variables)\n\n#### Understand variable coding\n\nBefore subsetting the data, we need to comprehend the variables used in CCHS 3.1, which are described in detail in the official reference:\n\n-   page 60 in CCHS 3.1 guide [@statistics2005canadian]\n\n-   link for variable list: [@varlist]\n\nA table mapping variable concepts across different CCHS cycles can be found below.\n\n| **Variable Concept**                                              | **CCHS 1.1** | **CCHS 2.1** | **CCHS 3.1** |\n|---------------------|-----------------|-----------------|-----------------|\n| **Has heart disease**                                             | CCCA_121     | CCCC_121     | CCCE_121     |\n| **Has arthritis or rheumatism**                                   | CCCA_051     | CCCC_051     | CCCE_051     |\n| **Kind of arthritis**                                             | CCCA_05A     | CCCC_05A     | CCCE_05A     |\n| **Age**                                                           | DHHAGAGE     | DHHCGAGE     | DHHEGAGE     |\n| **Sex**                                                           | DHHA_SEX     | DHHC_SEX     | DHHE_SEX     |\n| **Marital Status**                                                | DHHAGMS      | DHHCGMS      | DHHEGMS      |\n| **Cultural / racial origin**                                      | SDCAGRAC     | SDCCGRAC     | SDCEGCGT     |\n| **Immigrant status**                                              | SDCAFIMM     | SDCCFIMM     | SDCEFIMM     |\n| **Length of time in Canada since immigration**                    | SDCAGRES     | SDCCGRES     | SDCEGRES     |\n| **Highest level of education - respondent**                       | EDUADR04     | EDUCDR04     | EDUEDR04     |\n| **Total household income from all sources**                       | INCAGHH      | INCCGHH      | INCEGHH      |\n| **Body mass index**                                               | HWTAGBMI     | HWTCGBMI     | HWTEGBMI     |\n| **Physical activity index**                                       | PACADPAI     | PACCDPAI     | PACEDPAI     |\n| **Has a regular medical doctor**                                  | TWDA_5       | HCUC_1AA     | HCUE_1AA     |\n| **Self-perceived stress**                                         | GENA_07      | GENC_07      | GENE_07      |\n| **Type of smoker**                                                | SMKADSTY     | SMKCDSTY     | SMKEDSTY     |\n| **Type of drinker**                                               | ALCADTYP     | ALCCDTYP     | ALCEDTYP     |\n| **Daily consumption - total fruits and vegetables**               | FVCADTOT     | FVCCDTOT     | FVCEDTOT     |\n| **Has high blood pressure**                                       | CCCA_071     | CCCC_071     | CCCE_071     |\n| **Has emphysema or chronic obstructive pulmonary disease (COPD)** | CCCA_91B     | CCCC_91B     | CCCE_91F     |\n| **Has diabetes**                                                  | CCCA_101     | CCCC_101     | CCCE_101     |\n| **Province**                                                      | GEOAGPRV     | GEOCGPRV     | GEOEGPRV     |\n| **Sampling weight - master weight**                               | WTSAM        | WTSC_M       | WTSE_M       |\n\nWhile most variables in CCHS 3.1 are universally applicable to 'All respondents,' there are some exceptions. For example:\n\n-   CCCE_05A universe: (Kind of arthritis / rheumatism)\n\n-   Respondents who answered CCCE_051 = (1, 7 or 8) or CCCE_011 = 8\n\n-   CCCE_051: All respondents\n\n-   CCCE_011: All respondents\n\n-   SDCEGRES universe: (Length of time in Canada since immigration)\n\n    -   Respondents who answered SDCE_2 = (2, 7 or 8) or SDCE_1 = (97 or 98)\n    -   SDCE_2 doesn't exist!\n    -   (master file variable; not available in PUMF)\n    -   Public Use Microdata File (PUMF)\n    -   SDCE_1 doesn't exist!\n    -   (master file variable; not available in PUMF)\n\n-   HWTEGBMI universe: (Body Mass Index (BMI) / self-report)\n\n    -   All respondents excluding pregnant women (MAME_037 = 1)\n        -   MAME_037 doesn't exist!\n        -   (master file variable; not available in PUMF)\n\n-   GENE_07 universe: (Self-perceived stress)\n\n    -   Respondents aged 15 and over\n\n-   CCCE_91F universe: (Has chronic obstructive pulmonary disease)\n\n    -   Respondents aged 30 and over\n\n-   FVCEDTOT universe: (Daily consumption - total fruits and vegetables)\n\n    -   Respondents with FVCEFOPT = 1\n        -   FVCEFOPT: Optional module: Fruit and vegetable consumption - (F)\n\nRef:\n\n-   page 66 in CCHS 3.1 guide [@statistics2005canadian]\n\n-   Potential problematic variables:\n\n    -   Self-perceived stress\n    -   Has chronic obstructive pulmonary disease / copd\n    -   Daily consumption - total fruits and vegetables\n\nWe will make decisions about these variables later: for now, let's keep them.\n\n#### Restrict the dataset with variables of interest only\n\n##### Cycle 1.1\n\n-   We define a vector of variable names `var.names1` that are of interest for the first cycle of the Canadian Community Health Survey (CCHS 1.1). These variables cover a range of topics such as heart disease, age, sex, etc.\n-   Then we creates a new data frame `cc11` by subsetting the original data frame `c1` to include only the columns specified in `var.names1`.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/data1_830e7a62281955b797a6cdd9f40366e8'}\n\n```{.r .cell-code}\nvar.names1 <- c(\"CCCA_121\", \n                \"CCCA_051\", \n                \"CCCA_05A\", \n                \"DHHAGAGE\", \n                \"DHHA_SEX\", \n                \"DHHAGMS\", \n                \"SDCAGRAC\", \n                \"SDCAFIMM\", \n                \"SDCAGRES\", \n                \"EDUADR04\", \n                \"INCAGHH\", \n                \"HWTAGBMI\", \n                \"PACADPAI\", \n                \"TWDA_5\", \n                \"GENA_07\", \n                \"SMKADSTY\", \n                \"ALCADTYP\", \n                \"FVCADTOT\", \n                \"CCCA_071\",\n                \"CCCA_91B\",\n                \"CCCA_101\",\n                \"GEOAGPRV\",\n                \"WTSAM\")\ncc11 <- c1[var.names1]\ndim(cc11)\n#> [1] 130880     23\ntable(cc11$CCCA_051)\n#> \n#>            YES             NO NOT APPLICABLE     DON'T KNOW        REFUSAL \n#>          24511         106231              0            110              3 \n#>     NOT STATED \n#>             25\n```\n:::\n\n\n\nThe subsequent two code chunks do the same for CCHS 2.1 and CCHS 3.1, respectively, resulting in new data frames `cc21` and `cc31`.\n\n##### Cycle 2.1\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/data2_9216f946f86de3d1dca9f1412195a09f'}\n\n```{.r .cell-code}\nvar.names2 <- c(\"CCCC_121\", \n                \"CCCC_051\", \n                \"CCCC_05A\", \n                \"DHHCGAGE\", \n                \"DHHC_SEX\", \n                \"DHHCGMS\", \n                \"SDCCGRAC\", \n                \"SDCCFIMM\", \n                \"SDCCGRES\", \n                \"EDUCDR04\", \n                \"INCCGHH\", \n                \"HWTCGBMI\", \n                \"PACCDPAI\", \n                \"HCUC_1AA\", \n                \"GENC_07\", \n                \"SMKCDSTY\", \n                \"ALCCDTYP\", \n                \"FVCCDTOT\", \n                \"CCCC_071\",\n                \"CCCC_91B\",\n                \"CCCC_101\",\n                \"GEOCGPRV\",\n                \"WTSC_M\")\ncc21 <- c2[var.names2]\ndim(cc21)\n#> [1] 134072     23\ntable(cc21$CCCC_051)\n#> \n#>            YES             NO NOT APPLICABLE     DON'T KNOW        REFUSAL \n#>          29293         104530              0            208             11 \n#>     NOT STATED \n#>             30\n```\n:::\n\n\n\n##### Cycle 3.1\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/data3_aee63c5967634df8d9c0c2acbe993ebd'}\n\n```{.r .cell-code}\nvar.names3 <- c(\"CCCE_121\", \n                \"CCCE_051\", \n                \"CCCE_05A\", \n                \"DHHEGAGE\", \n                \"DHHE_SEX\", \n                \"DHHEGMS\", \n                \"SDCEGCGT\", \n                \"SDCEFIMM\", \n                \"SDCEGRES\", \n                \"EDUEDR04\", \n                \"INCEGHH\", \n                \"HWTEGBMI\", \n                \"PACEDPAI\", \n                \"HCUE_1AA\", \n                \"GENE_07\", \n                \"SMKEDSTY\", \n                \"ALCEDTYP\", \n                \"FVCEDTOT\", \n                \"CCCE_071\", \n                \"CCCE_91F\", \n                \"CCCE_101\", \n                \"GEOEGPRV\", \n                \"WTSE_M\")\ncc31 <- c3[var.names3]\ndim(cc31)\n#> [1] 132221     23\ntable(cc31$CCCE_051)\n#> \n#>            YES             NO NOT APPLICABLE     DON'T KNOW        REFUSAL \n#>          28221         103781              0            191              4 \n#>     NOT STATED \n#>             24\n```\n:::\n\n\n\n### Making variable names the same\n\nWe now create a new set of more readable and consistent variable names.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/data4_2897f0c22cc43dda81a3de9ac7f171ca'}\n\n```{.r .cell-code}\nnew.var.names <- c(\"CVD\", \n                   \"arthritis\", \n                   \"arthritis.kind\", \n                   \"age\", \n                   \"sex\", \n                   \"married\", \n                   \"race\", \n                   \"immigration\", \n                   \"recent.immigrant\", \n                   \"edu\", \n                   \"income\", \n                   \"bmi\", \n                   \"phyact\", \n                   \"doctor\", \n                   \"stress\", \n                   \"smoke\", \n                   \"drink\", \n                   \"fruit\", \n                   \"bp\", \n                   \"copd\", \n                   \"diab\",  \n                   \"province\", \n                   \"weight\")\ncbind(new.var.names, var.names1, var.names2, var.names3)\n#>       new.var.names      var.names1 var.names2 var.names3\n#>  [1,] \"CVD\"              \"CCCA_121\" \"CCCC_121\" \"CCCE_121\"\n#>  [2,] \"arthritis\"        \"CCCA_051\" \"CCCC_051\" \"CCCE_051\"\n#>  [3,] \"arthritis.kind\"   \"CCCA_05A\" \"CCCC_05A\" \"CCCE_05A\"\n#>  [4,] \"age\"              \"DHHAGAGE\" \"DHHCGAGE\" \"DHHEGAGE\"\n#>  [5,] \"sex\"              \"DHHA_SEX\" \"DHHC_SEX\" \"DHHE_SEX\"\n#>  [6,] \"married\"          \"DHHAGMS\"  \"DHHCGMS\"  \"DHHEGMS\" \n#>  [7,] \"race\"             \"SDCAGRAC\" \"SDCCGRAC\" \"SDCEGCGT\"\n#>  [8,] \"immigration\"      \"SDCAFIMM\" \"SDCCFIMM\" \"SDCEFIMM\"\n#>  [9,] \"recent.immigrant\" \"SDCAGRES\" \"SDCCGRES\" \"SDCEGRES\"\n#> [10,] \"edu\"              \"EDUADR04\" \"EDUCDR04\" \"EDUEDR04\"\n#> [11,] \"income\"           \"INCAGHH\"  \"INCCGHH\"  \"INCEGHH\" \n#> [12,] \"bmi\"              \"HWTAGBMI\" \"HWTCGBMI\" \"HWTEGBMI\"\n#> [13,] \"phyact\"           \"PACADPAI\" \"PACCDPAI\" \"PACEDPAI\"\n#> [14,] \"doctor\"           \"TWDA_5\"   \"HCUC_1AA\" \"HCUE_1AA\"\n#> [15,] \"stress\"           \"GENA_07\"  \"GENC_07\"  \"GENE_07\" \n#> [16,] \"smoke\"            \"SMKADSTY\" \"SMKCDSTY\" \"SMKEDSTY\"\n#> [17,] \"drink\"            \"ALCADTYP\" \"ALCCDTYP\" \"ALCEDTYP\"\n#> [18,] \"fruit\"            \"FVCADTOT\" \"FVCCDTOT\" \"FVCEDTOT\"\n#> [19,] \"bp\"               \"CCCA_071\" \"CCCC_071\" \"CCCE_071\"\n#> [20,] \"copd\"             \"CCCA_91B\" \"CCCC_91B\" \"CCCE_91F\"\n#> [21,] \"diab\"             \"CCCA_101\" \"CCCC_101\" \"CCCE_101\"\n#> [22,] \"province\"         \"GEOAGPRV\" \"GEOCGPRV\" \"GEOEGPRV\"\n#> [23,] \"weight\"           \"WTSAM\"    \"WTSC_M\"   \"WTSE_M\"\nnames(cc11) <- names(cc21) <- names(cc31) <- new.var.names\n\ntable(cc11$arthritis)\n#> \n#>            YES             NO NOT APPLICABLE     DON'T KNOW        REFUSAL \n#>          24511         106231              0            110              3 \n#>     NOT STATED \n#>             25\ntable(cc21$arthritis)\n#> \n#>            YES             NO NOT APPLICABLE     DON'T KNOW        REFUSAL \n#>          29293         104530              0            208             11 \n#>     NOT STATED \n#>             30\ntable(cc31$arthritis)\n#> \n#>            YES             NO NOT APPLICABLE     DON'T KNOW        REFUSAL \n#>          28221         103781              0            191              4 \n#>     NOT STATED \n#>             24\n\ncc11$cycle <- 11\ncc21$cycle <- 21\ncc31$cycle <- 31\n```\n:::\n\n\n\n### Appending\n\nWe now combine the data frames `cc11`, `cc21`, and `cc31` by stacking them on top of each other.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/append_870b07ae3f6f67054b065b258e252056'}\n\n```{.r .cell-code}\ncc123a <- rbind(cc11,cc21,cc31)\ndim(cc123a)\n#> [1] 397173     24\nnames(cc123a)\n#>  [1] \"CVD\"              \"arthritis\"        \"arthritis.kind\"   \"age\"             \n#>  [5] \"sex\"              \"married\"          \"race\"             \"immigration\"     \n#>  [9] \"recent.immigrant\" \"edu\"              \"income\"           \"bmi\"             \n#> [13] \"phyact\"           \"doctor\"           \"stress\"           \"smoke\"           \n#> [17] \"drink\"            \"fruit\"            \"bp\"               \"copd\"            \n#> [21] \"diab\"             \"province\"         \"weight\"           \"cycle\"\ncc123a$ID <- 1:nrow(cc123a)\n```\n:::\n\n\n\n### Variables\n\n#### Sampling weight\n\nWe use the `summary` function to provide basic statistics (like mean, median, min, max, etc.) for the `weight` column in the data frame `cc123a`.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/summ_980c2045080b57e668392174fd94e859'}\n\n```{.r .cell-code}\nsummary(cc123a$weight)\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n#>    1.17   65.28  126.63  200.09  243.21 7154.95\n```\n:::\n\n\n\n#### Exposure\n\nThis following chunk creates frequency tables for the 'arthritis' and 'arthritis.kind' columns.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/tab0_a15726c815a2a9279683b552232c4f16'}\n\n```{.r .cell-code}\ntable(cc123a$arthritis)\n#> \n#>            YES             NO NOT APPLICABLE     DON'T KNOW        REFUSAL \n#>          82025         314542              0            509             18 \n#>     NOT STATED \n#>             79\ntable(cc123a$arthritis.kind)\n#> \n#> RHEUMATOID ARTH  OSTEOARTHRITIS           OTHER  NOT APPLICABLE      DON'T KNOW \n#>           19099           40943            7305          314542           12354 \n#>         REFUSAL      NOT STATED      RHEUMATISM \n#>             215             619            2096\nsum(cc123a$arthritis==\"NO\")\n#> [1] 314542\nsum(cc123a$arthritis.kind==\"NOT APPLICABLE\")\n#> [1] 314542\n```\n:::\n\n\n\nWe create the exposure variable with exposure status vs controls.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recodeOA_50754f647208ae275e34d176a4855c16'}\n\n```{.r .cell-code}\nc123sub1 <- cc123a\nc123sub1$arthritis.kind <- car::recode(c123sub1$arthritis.kind, \n                            \"'OSTEOARTHRITIS'='OSTEOARTHRITIS';\n                            'NOT APPLICABLE' = 'NOT APPLICABLE';\n                            else = NA\",  \n                            as.factor = FALSE)\ntable(c123sub1$arthritis.kind, useNA = \"always\")\n#> \n#> NOT APPLICABLE OSTEOARTHRITIS           <NA> \n#>         314542          40943          41688\n```\n:::\n\n::: {.cell hash='surveydata1_cache/pdf/recode1_ccbe1cc334e32eab94e07cbf67ab7922'}\n\n```{.r .cell-code}\n# c123sub1 <- subset(cc123a, arthritis.kind == \"OSTEOARTHRITIS\" | \n#                      arthritis.kind == \"NOT APPLICABLE\" )\n# dim(c123sub1)\ntable(c123sub1$arthritis.kind)\n#> \n#> NOT APPLICABLE OSTEOARTHRITIS \n#>         314542          40943\ntable(c123sub1$arthritis)\n#> \n#>            YES             NO NOT APPLICABLE     DON'T KNOW        REFUSAL \n#>          82025         314542              0            509             18 \n#>     NOT STATED \n#>             79\nrequire(car)\nc123sub1$arthritis.kind <- car::recode(c123sub1$arthritis.kind, \n                                  \"'OSTEOARTHRITIS'='OA';\n                         'NOT APPLICABLE'='Control';\n                         else=NA\", as.factor = FALSE)\ntable(c123sub1$arthritis.kind, useNA = \"always\")\n#> \n#> Control      OA    <NA> \n#>  314542   40943   41688\nc123sub1$OA <- c123sub1$arthritis.kind\nc123sub1$arthritis.kind <- NULL\nc123sub1$arthritis <- NULL\ndim(c123sub1)\n#> [1] 397173     24\ndim(c123sub1)[1]-dim(cc123a)[1]\n#> [1] 0\n```\n:::\n\n\n\n#### Outcome\n\nWe create the outcome variable.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recodecvd_6db8f8494ec574cf2219b7c47b5667a4'}\n\n```{.r .cell-code}\nc123sub2 <- c123sub1\ntable(c123sub2$CVD)\n#> \n#>            YES             NO NOT APPLICABLE     DON'T KNOW        REFUSAL \n#>          25524         371121              0            399             50 \n#>     NOT STATED \n#>             79\nc123sub2$CVD <- car::recode(c123sub2$CVD, \n                            \"'YES'='YES';\n                            'NO' = 'NO';\n                            else = NA\",  \n                            as.factor = FALSE)\n```\n:::\n\n::: {.cell hash='surveydata1_cache/pdf/recodecvd3_d05b5d8dadb9419c1085b7727ddc369d'}\n\n```{.r .cell-code}\n# table(c123sub1$CVD)\n# c123sub2 <- subset(c123sub1, CVD == \"YES\" | CVD == \"NO\")\n# table(c123sub2$CVD)\ndim(c123sub2)\n#> [1] 397173     24\nc123sub2$CVD <- car::recode(c123sub2$CVD, \n                       \"'YES'='event';\n                       'NO'='no event';\n                       else=NA\",\n                       as.factor = FALSE)\ntable(c123sub2$CVD, useNA = \"always\")\n#> \n#>    event no event     <NA> \n#>    25524   371121      528\ndim(c123sub2)\n#> [1] 397173     24\ndim(c123sub2)[1]-dim(c123sub1)[1]\n#> [1] 0\n```\n:::\n\n\n\n#### Covariates\n\n##### age\n\nRecodes the 'age' column into broader age categories.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode4_2699b6c17b3ad1f7ce817a4710330308'}\n\n```{.r .cell-code}\nc123sub2$age <- car::recode(c123sub2$age, \n                       \"c('12 TO 14 YEARS','15 TO 19 YEARS',\n                       '15 TO 17 YEARS', '18 TO 19 YEARS')='teen';\n                       c('20 TO 24 YEARS','25 TO 29 YEARS')='20-29 years';\n                       c('30 TO 34 YEARS','35 TO 39 YEARS')='30-39 years';\n                       c('40 TO 44 YEARS','45 TO 49 YEARS')='40-49 years';\n                       c('50 TO 54 YEARS','55 TO 59 YEARS')='50-59 years';\n                       c('60 TO 64 YEARS')='60-64 years';   \n                       else='65 years and over'\",\n                       as.factor = FALSE)\ntable(c123sub2$age)\n#> \n#>       20-29 years       30-39 years       40-49 years       50-59 years \n#>             48652             63810             65111             61035 \n#>       60-64 years 65 years and over              teen \n#>             25265             80913             52387\n```\n:::\n\n::: {.cell hash='surveydata1_cache/pdf/recode5_445aabf5b1eeffc54fe9e922ef31b561'}\n\n```{.r .cell-code}\nc123sub3 <- c123sub2\n# c123sub3$age[c123sub3$age == 'teen'] <- NA\n# c123sub3$age[c123sub3$age == '65 years and over'] <- NA\n```\n:::\n\n::: {.cell hash='surveydata1_cache/pdf/tabage_8a8aaaf3fbf5782fd4efa62e08ce3cee'}\n\n```{.r .cell-code}\n# dim(c123sub2)\n# c123sub3 <- subset(c123sub2, age != 'teen' & age != '65 years and over')\ntable(c123sub3$age, useNA = \"always\")\n#> \n#>       20-29 years       30-39 years       40-49 years       50-59 years \n#>             48652             63810             65111             61035 \n#>       60-64 years 65 years and over              teen              <NA> \n#>             25265             80913             52387                 0\ndim(c123sub3)\n#> [1] 397173     24\n```\n:::\n\n\n\n##### sex\n\nRecodes 'sex' to 'Male' or 'Female'.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode6_25d762265e79bc4582d7847f12a03656'}\n\n```{.r .cell-code}\ntable(c123sub3$sex)\n#> \n#>           MALE         FEMALE NOT APPLICABLE     NOT STATED     DON'T KNOW \n#>         182523         214650              0              0              0 \n#>        REFUSAL \n#>              0\nc123sub3$sex <- car::recode(c123sub3$sex, \n                            \"'MALE'='Male';\n                            'FEMALE' = 'Female';\n                            else = NA\",  \n                            as.factor = FALSE)\ntable(c123sub3$sex, useNA = \"always\")\n#> \n#> Female   Male   <NA> \n#> 214650 182523      0\n```\n:::\n\n\n\n##### marital status\n\nRecodes the 'married' column into two categories: 'not single' and 'single'.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode7_2a1a140b1e1cb616d97615ce7bea1719'}\n\n```{.r .cell-code}\ntable(c123sub3$married)\n#> \n#>          MARRIED       COMMON-LAW    WIDOW/SEP/DIV           SINGLE \n#>           171304            30909            75885            78261 \n#>          REFUSAL       NOT STATED   NOT APPLICABLE       DON'T KNOW \n#>                0              661                0                0 \n#> SINGLE/NEVER MAR \n#>            40153\nc123sub3$married <- car::recode(c123sub3$married, \n                             \"c('MARRIED', 'COMMON-LAW')='not single';\n                             c('WIDOW/SEP/DIV', 'SINGLE', 'SINGLE/NEVER MAR') = 'single';\n                             else = NA\",  \n                             as.factor = FALSE)\ntable(c123sub3$married, useNA = \"always\")\n#> \n#> not single     single       <NA> \n#>     202213     194299        661\n```\n:::\n\n\n\n##### race\n\nRecodes 'race' into 'White' and 'Non-white'.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode8_350ee9736e50d3dcc3fce943a722d6ec'}\n\n```{.r .cell-code}\ntable(c123sub3$race)\n#> \n#>            WHITE VISIBLE MINORITY   NOT APPLICABLE       NOT STATED \n#>           349222            38641                0             9310 \n#>       DON'T KNOW          REFUSAL \n#>                0                0\nc123sub3$race <- car::recode(c123sub3$race, \n                             \"'WHITE'='White';\n                             'VISIBLE MINORITY' = 'Non-white';\n                             else = NA\",  \n                             as.factor = FALSE)\ntable(c123sub3$race, useNA = \"always\")\n#> \n#> Non-white     White      <NA> \n#>     38641    349222      9310\n```\n:::\n\n\n\n##### immigration\n\nCreates a new column for immigration status based on the 'recent.immigrant' column, then removes the original column.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode9_321a2d6eabd0506951aebbc823194476'}\n\n```{.r .cell-code}\ntable(c123sub3$recent.immigrant)\n#> \n#>     0 TO 9 YEARS 10 YEARS OR MORE   NOT APPLICABLE       NOT STATED \n#>            10644            26746           338078             7975 \n#>       DON'T KNOW          REFUSAL 10 OR MORE YEARS \n#>                0                0            13730\nc123sub3$immigrate <- car::recode(c123sub3$recent.immigrant,\n                            \"'0 TO 9 YEARS'='recent';\n                            '10 YEARS OR MORE' = '> 10 years';\n                            'NOT APPLICABLE' = 'not immigrant';\n                            else = NA\",\n                            as.factor = FALSE)\ntable(c123sub3$immigrate, useNA = \"always\")\n#> \n#>    > 10 years not immigrant        recent          <NA> \n#>         26746        338078         10644         21705\nc123sub3$recent.immigrant <- NULL\nc123sub3$immigration <- NULL\n```\n:::\n\n\n\n##### education\n\nRecodes educational status into specified categories.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode10_57162dddca67bb94fcadcba11f537e22'}\n\n```{.r .cell-code}\ntable(c123sub3$edu)\n#> \n#> < THAN SECONDARY  SECONDARY GRAD.  OTHER POST-SEC.  POST-SEC. GRAD. \n#>           124425            64753            29000           171972 \n#>   NOT APPLICABLE       NOT STATED       DON'T KNOW          REFUSAL \n#>                0             7023                0                0\nc123sub3$edu <- car::recode(c123sub3$edu,\n                            \"'< THAN SECONDARY'='< 2ndary';\n                            'SECONDARY GRAD.' = '2nd grad.';\n                            'POST-SEC. GRAD.' = 'Post-2nd grad.';\n                            'OTHER POST-SEC.' = 'Other 2nd grad.';\n                            else = NA\",\n                            as.factor = FALSE)\ntable(c123sub3$edu, useNA = \"always\")\n#> \n#>        < 2ndary       2nd grad. Other 2nd grad.  Post-2nd grad.            <NA> \n#>          124425           64753           29000          171972            7023\n```\n:::\n\n\n\n##### income\n\nRecodes income levels into broader categories.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode11_141e0f5665c7a21f118397aab59125dd'}\n\n```{.r .cell-code}\ntable(c123sub3$income)\n#> \n#>        NO INCOME LESS THAN 15,000  $15,000-$29,999  $30,000-$49,999 \n#>            12636            14103            63766            77940 \n#>  $50,000-$79,999  $80,000 OR MORE   NOT APPLICABLE       NOT STATED \n#>            85108            75715                0            57079 \n#>       DON'T KNOW          REFUSAL   NO OR <$15,000 \n#>                0                0            10826\n# cycle 1.1 has: 'NO INCOME','LESS THAN 15,000'\n# Other cycles have: 'NO OR <$15,000'\nc123sub3$income <- car::recode(c123sub3$income, \n                               \"c('NO OR <$15,000', 'NO INCOME','LESS THAN 15,000',\n                               '$15,000-$29,999')='$29,999 or less';\n                               '$30,000-$49,999' = '$30,000-$49,999';\n                               '$50,000-$79,999' = '$50,000-$79,999';\n                               '$80,000 OR MORE' = '$80,000 or more';\n                               else = NA\",  \n                               as.factor = FALSE)\ntable(c123sub3$income, useNA = \"always\")\n#> \n#> $29,999 or less $30,000-$49,999 $50,000-$79,999 $80,000 or more            <NA> \n#>          101331           77940           85108           75715           57079\n```\n:::\n\n\n\n##### BMI\n\nConverts 'bmi' column values to numerical data and also categorizes it based on the BMI value.\n\nIf you want to reuse the continuous variable later (usually a good idea in statistical sense), keep a second copy of the variable.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode12_0fd7d304e81f1f1a3549c79d7ed87de7'}\n\n```{.r .cell-code}\n# table(c123sub3$bmi)\nsum(c123sub3$bmi==\"NOT APPLICABLE\")+\n  sum(c123sub3$bmi==\"REFUSAL\")+\n  sum(c123sub3$bmi==\"NOT STATED\")+\n  sum(c123sub3$bmi==\"DON'T KNOW\")\n#> [1] 72303\nc123sub3$bmi <- car::recode(c123sub3$bmi, \n                               'c(\"NOT APPLICABLE\", \"REFUSAL\", \"NOT STATED\", \"DON\\'T KNOW\")=NA',\n                               as.factor = FALSE)\n#table(c123sub3$bmi, useNA = \"always\")\nc123sub3$bmi <- as.numeric(as.character(c123sub3$bmi))\nsummary(c123sub3$bmi)\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n#>   11.91   22.47   25.30   25.86   28.50   57.90   72303\nc123sub3$bmi2 <- cut(c123sub3$bmi,\n                       breaks = c(0,18.5,25,Inf),\n                       right = TRUE,\n                       labels = c(\"Underweight\", \n                                  \"healthy weight\", \n                                  \"Overweight\"))\nc123sub3$bmi <- c123sub3$bmi2\nc123sub3$bmi2 <- NULL\ntable(c123sub3$bmi, useNA = \"always\")\n#> \n#>    Underweight healthy weight     Overweight           <NA> \n#>          10116         148533         166221          72303\n```\n:::\n\n\n\n##### physical activity\n\nRecodes physical activity levels.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode13_35dccefd23a7049b16a181d5a7ed7d35'}\n\n```{.r .cell-code}\ntable(c123sub3$phyact)\n#> \n#>         ACTIVE       MODERATE       INACTIVE NOT APPLICABLE     NOT STATED \n#>          98571          93507         190739              0          14356 \n#>     DON'T KNOW        REFUSAL \n#>              0              0\nc123sub3$phyact <- car::recode(c123sub3$phyact,\n                               \"'ACTIVE'='Active';\n                               'MODERATE' = 'Moderate';\n                               'INACTIVE' = 'Inactive';\n                               else = NA\",\n                               as.factor = FALSE)\ntable(c123sub3$phyact, useNA = \"always\")\n#> \n#>   Active Inactive Moderate     <NA> \n#>    98571   190739    93507    14356\n```\n:::\n\n\n\n##### doctor\n\nRecodes whether someone has access to a doctor into 'Yes' or 'No'.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode14_e10ed53b5e1b315e3b21739bfd544a32'}\n\n```{.r .cell-code}\ntable(c123sub3$doctor)\n#> \n#>            YES             NO NOT APPLICABLE     DON'T KNOW        REFUSAL \n#>         338105          58623              0            406             39 \n#>     NOT STATED \n#>              0\nc123sub3$doctor <- car::recode(c123sub3$doctor, \n                            \"'YES'='Yes';\n                            'NO' = 'No';\n                            else = NA\",  \n                            as.factor = FALSE)\ntable(c123sub3$doctor, useNA = \"always\")\n#> \n#>     No    Yes   <NA> \n#>  58623 338105    445\n```\n:::\n\n\n\n##### stress\n\nRecodes stress levels into 'Not too stressed' or 'stressed'.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode16_b87042c0185d32da3dc04aa68c84879d'}\n\n```{.r .cell-code}\ntable(c123sub3$stress)\n#> \n#>     NOT AT ALL       NOT VERY          A BIT    QUITE A BIT      EXTREMELY \n#>          51020          89612         146112          68203          14094 \n#> NOT APPLICABLE     DON'T KNOW        REFUSAL     NOT STATED \n#>          26737           1244            145              6\nc123sub3$stress <- car::recode(c123sub3$stress,\n                              \"c('NOT AT ALL','NOT VERY','A BIT')='Not too stressed';\n                              c('QUITE A BIT','EXTREMELY') = 'stressed';\n                              else = NA\",\n                              as.factor = FALSE)\ntable(c123sub3$stress, useNA = \"always\")\n#> \n#> Not too stressed         stressed             <NA> \n#>           286744            82297            28132\n```\n:::\n\n\n\n##### smoking\n\nRecodes smoking status into 'Current smoker', 'Former smoker', or 'Never smoker'.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode17_b98e6a7227b8305a186c2f897d9ab6f8'}\n\n```{.r .cell-code}\ntable(c123sub3$smoke)\n#> \n#>            DAILY       OCCASIONAL ALWAYS OCCASION.     FORMER DAILY \n#>            79878            10931             7043            99450 \n#> FORMER OCCASION.     NEVER SMOKED   NOT APPLICABLE       NOT STATED \n#>            58120           140017                0             1734 \n#>       DON'T KNOW          REFUSAL \n#>                0                0\nc123sub3$smoke <- car::recode(c123sub3$smoke,\n                              \"c('DAILY','OCCASIONAL',\n                              'ALWAYS OCCASION.')='Current smoker';\n                              c('FORMER DAILY','FORMER OCCASION.',\n                              'ALWAYS OCCASION.') = 'Former smoker';\n                              'NEVER SMOKED' = 'Never smoker';\n                              else = NA\",\n                              as.factor = FALSE)\ntable(c123sub3$smoke, useNA = \"always\")\n#> \n#> Current smoker  Former smoker   Never smoker           <NA> \n#>          97852         157570         140017           1734\n```\n:::\n\n\n\n##### alcohol\n\nRecodes drinking habits into 'Current drinker', 'Former driker', or 'Never drank'.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode18_2fecaaa38627016afac47a48ecbbfca7'}\n\n```{.r .cell-code}\ntable(c123sub3$drink)\n#> \n#> REGULAR DRINKER    OCC. DRINKER  FORMER DRINKER     NEVER DRANK  NOT APPLICABLE \n#>          219334           76399           55299           40670               0 \n#>      NOT STATED      DON'T KNOW         REFUSAL \n#>            5471               0               0\nc123sub3$drink <- car::recode(c123sub3$drink,\n                              \"c('REGULAR DRINKER',\n                              'OCC. DRINKER')='Current drinker';\n                              c('FORMER DRINKER') = 'Former driker';\n                              'NEVER DRANK' = 'Never drank';\n                              else = NA\",\n                              as.factor = FALSE)\ntable(c123sub3$drink, useNA = \"always\")\n#> \n#> Current drinker   Former driker     Never drank            <NA> \n#>          295733           55299           40670            5471\n```\n:::\n\n\n\n##### fruit and vegetable consumption\n\nConverts fruit and vegetable consumption to numerical values and then categorizes it.\n\nIf you want to reuse the continuous variable later (usually a good idea in statistical sense), keep a second copy of the variable.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode19_f0fa020bb9ba5759f103a16cffccc5a5'}\n\n```{.r .cell-code}\nstr(c123sub3$fruit)\n#>  Factor w/ 303 levels \"0\",\"0.1\",\"0.2\",..: 57 48 42 72 67 120 39 54 61 51 ...\n#c123sub3$fruit.cont <- c123sub3$fruit\nc123sub3$fruit2 <- as.numeric(as.character(c123sub3$fruit))\n# Note: do not use as.numeric(c123sub3$fruit)\nsummary(c123sub3$fruit2)\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n#>    0.00    3.00    4.30    4.75    6.00   80.00   75347\nc123sub3$fruit2 <- cut(c123sub3$fruit2,\n                       breaks = c(0,3,6,Inf),\n                       right = TRUE,\n                       labels = c(\"0-3 daily serving\",\n                                  \"4-6 daily serving\",\n                                  \"6+ daily serving\"))\ntable(c123sub3$fruit2, useNA = \"always\")\n#> \n#> 0-3 daily serving 4-6 daily serving  6+ daily serving              <NA> \n#>             83441            159380             78857             75495\nc123sub3$fruit <- c123sub3$fruit2\nc123sub3$fruit2 <- NULL\n```\n:::\n\n\n\n##### hypertension\n\nThe following chunk of code is concerned with recoding the blood pressure column. The code also shows the distribution of the values before and after recoding.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode20_763d0f52c5b65abfad142f72819d9fdb'}\n\n```{.r .cell-code}\ntable(c123sub3$bp)\n#> \n#>            YES             NO NOT APPLICABLE     DON'T KNOW        REFUSAL \n#>          68071         328164              0            793             66 \n#>     NOT STATED \n#>             79\nc123sub3$bp <- car::recode(c123sub3$bp,\n                           \"'YES'='Yes';\n                           'NO' = 'No';\n                           else = NA\",\n                           as.factor = FALSE)\ntable(c123sub3$bp, useNA = \"always\")\n#> \n#>     No    Yes   <NA> \n#> 328164  68071    938\n```\n:::\n\n\n\n##### COPD\n\nThe following chunk of code is concerned with recoding the COPD column.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode21_e8c72f9a290c6fadb267d7fd99720bc2'}\n\n```{.r .cell-code}\ntable(c123sub3$copd)\n#> \n#>            YES             NO NOT APPLICABLE     DON'T KNOW        REFUSAL \n#>           4508         291191         101039            329             26 \n#>     NOT STATED \n#>             80\nc123sub3$copd <- car::recode(c123sub3$copd,\n                             \"'YES'='Yes';\n                             'NO' = 'No';\n                             else = NA\",\n                             as.factor = FALSE)\ntable(c123sub3$copd, useNA = \"always\")\n#> \n#>     No    Yes   <NA> \n#> 291191   4508 101474\n```\n:::\n\n\n\n##### Diabetes\n\nThe following chunk of code is concerned with recoding the diabetes column.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode22_3ae92ea98caa71208fcbd158b48d521e'}\n\n```{.r .cell-code}\ntable(c123sub3$diab)\n#> \n#>            YES             NO NOT APPLICABLE     DON'T KNOW        REFUSAL \n#>          22231         374589              0            236             38 \n#>     NOT STATED \n#>             79\nc123sub3$diab <- car::recode(c123sub3$diab,\n                             \"'YES'='Yes';\n                             'NO' = 'No';\n                             else = NA\",\n                             as.factor = FALSE)\ntable(c123sub3$diab, useNA = \"always\")\n#> \n#>     No    Yes   <NA> \n#> 374589  22231    353\n```\n:::\n\n\n\n##### North\n\nThis section is concerned with recoding the province column. It groups provinces into \"North\" and \"South\" based on their names.\n\n-   Note that the category names might not exactly match with the data dictionary:\n    -   Particularly note two versions of `QUEBEC`\n    -   `PEI` was written in short\n    -   None in\n        -   DON'T KNOW\n        -   REFUSAL\n        -   NOT STATED\n        -   NOT APPLICABLE\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/recode23_65c55c33ce9be8563a463042b6b3b834'}\n\n```{.r .cell-code}\nc123sub3$province.check <- c123sub3$province\ntable(c123sub3$province)\n#> \n#>     NEWFOUNDLAND              PEI      NOVA SCOTIA    NEW BRUNSWICK \n#>             7924             7744            15341            15025 \n#>        QU\\xc9BEC          ONTARIO         MANITOBA     SASKATCHEWAN \n#>            22012           123821            23454            23361 \n#>          ALBERTA BRITISH COLUMBIA YUKON/NWT/NUNAVT   NOT APPLICABLE \n#>            40127            49767             5064                0 \n#>       DON'T KNOW          REFUSAL       NOT STATED           QUEBEC \n#>                0                0                0            56764 \n#>      NFLD & LAB.  YUKON/NWT/NUNA. \n#>             4111             2658\n# c123sub3$province <- car::recode(c123sub3$province,\n#                               \"c('YUKON/NWT/NUNAVT','YUKON/NWT/NUNA.')='North';\n#                               c('NEWFOUNDLAND', 'PEI', 'NOVA SCOTIA', 'NEW BRUNSWICK', \n# 'QU?BEC', 'ONTARIO', 'MANITOBA', 'SASKATCHEWAN', 'ALBERTA', \n# 'BRITISH COLUMBIA', 'QUEBEC', 'NFLD & LAB.') = 'South';\n#                               else = NA\",\n#                               as.factor = FALSE)\nc123sub3$province <- car::recode(c123sub3$province,\n                              \"c('YUKON/NWT/NUNAVT','YUKON/NWT/NUNA.')='North';\n                              else = 'South'\",\n                              as.factor = FALSE)\ntable(c123sub3$province, useNA = \"always\")\n#> \n#>  North  South   <NA> \n#>   7722 389451      0\n```\n:::\n\n\n\n##### Dimension testing\n\nThis chunk verifies the dimensions of the modified data frames and performs some other operations like setting factors.\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/dims2_3fde8728510a66114b8f34eff0847901'}\n\n```{.r .cell-code}\nsave.c123sub3 <- c123sub3\nnames(c123sub3)\n#>  [1] \"CVD\"            \"age\"            \"sex\"            \"married\"       \n#>  [5] \"race\"           \"edu\"            \"income\"         \"bmi\"           \n#>  [9] \"phyact\"         \"doctor\"         \"stress\"         \"smoke\"         \n#> [13] \"drink\"          \"fruit\"          \"bp\"             \"copd\"          \n#> [17] \"diab\"           \"province\"       \"weight\"         \"cycle\"         \n#> [21] \"ID\"             \"OA\"             \"immigrate\"      \"province.check\"\n# c123sub3$phyact <- NULL\n# c123sub3$stress <- NULL\n# c123sub3$fruit <- NULL\n# c123sub3$copd <- NULL\n# c123sub3$province.check <- NULL\ndim(c123sub3)\n#> [1] 397173     24\ndim(c123sub2)[1]-dim(c123sub3)[1]\n#> [1] 0\nanalytic <- c123sub3\ndim(analytic)\n#> [1] 397173     24\nanalytic$cycle <- as.factor(analytic$cycle)\nnames(analytic)\n#>  [1] \"CVD\"            \"age\"            \"sex\"            \"married\"       \n#>  [5] \"race\"           \"edu\"            \"income\"         \"bmi\"           \n#>  [9] \"phyact\"         \"doctor\"         \"stress\"         \"smoke\"         \n#> [13] \"drink\"          \"fruit\"          \"bp\"             \"copd\"          \n#> [17] \"diab\"           \"province\"       \"weight\"         \"cycle\"         \n#> [21] \"ID\"             \"OA\"             \"immigrate\"      \"province.check\"\n```\n:::\n\n\n\n### Saving data\n\nWe save the data for future use:\n\n\n\n::: {.cell hash='surveydata1_cache/pdf/save_3809f3edfb50889f116bcc435fc3d01c'}\n\n```{.r .cell-code}\nsave(cc123a, analytic, file = \"Data/surveydata/cchs123.RData\")\n```\n:::\n\n\n\n### Video content (optional)\n\n::: callout-tip\nFor those who prefer a video walkthrough, feel free to watch the video below, which offers a description of an earlier version of the above content.\n:::\n\n::: {style=\"position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;\"}\n<iframe src=\"https://www.youtube.com/embed/OWVV1O3iYmA\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;\" allowfullscreen>\n\n</iframe>\n:::\n\n## References\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}