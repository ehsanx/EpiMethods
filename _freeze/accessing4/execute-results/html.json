{
  "hash": "cb4045ccfbf4698200a844b3ba7fca16",
  "result": {
    "engine": "knitr",
    "markdown": "## Reproducing NHANES results {.unnumbered}\n\nThe section instructs on reproducing the results from a specific article, detailing the eligibility criteria and variables of interest, guiding the user through accessing, merging, and filtering relevant NHANES data, and then recoding and comparing the results to ensure they match with the original article's findings, all supported with visual aids and R code examples.\n\n### Example article\n\nLet us use the article by @flegal2016trends as our reference. [DOI:10.1001/jama.2016.6458](https://jamanetwork.com/journals/jama/fullarticle/2526639).\n\n::: column-margin\n@flegal2016trends\n:::\n\n#### Task\n\nObjectives are to\n\n(1) Learn how to download and select pertinent NHANES data\n(2) Understand the importance of cleaning and transforming the data\n(3) Reproduce findings from an existing research paper using NHANES data\n\nOur specific task in this tutorial is to **reproduce the numbers reported in Table 1** from this article.\n\n#### Eligibility criteria\n\nMethods section from this article says:\n\n-   \"For adults aged 20 years or older, obesity was defined according to clinical guidelines.\"\n-   \"Pregnant women were excluded from analysis.\"\n-   \"Participant age was grouped into categories of 20 to 39 years, 40 to 59 years, and 60 years and older.\"\n-   Table 1 title says NHANES 2013-2014 was used.\n\n#### Variables of interest\n\nBefore diving into NHANES, take some time to comprehend its structure. Detailed documentation provides crucial information about variables, age categories, and other specifics. \n\nVariables of interest:\n\n-   `age` (eligibility and stratifying variable)\n-   `sex` (stratifying variable)\n-   `race` (stratifying variable)\n-   `pregnancy status` (eligibility)\n-   `obesity/BMI status` (main variable of interest for the paper)\n\n#### Searching for necessary variables\n\nSearch these variables using the NHANES variable keyword search within the 2013-14 cycle: [cdc.gov/nchs/nhanes/search/](https://wwwn.cdc.gov/nchs/nhanes/search/default.aspx)\n\n-   Below is an example for BMI variable search:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Images/accessing/bmi.png){width=95%}\n:::\n:::\n\n\n-   Identifying the component: Note that H is the index for 2013-14 cycle as seen in the picture:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Images/accessing/bmi2.png){width=95%}\n:::\n:::\n\n\n-   Identifying the variable:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Images/accessing/bmi3.png){width=95%}\n:::\n:::\n\n\n-   Rest of the variables all coming from demographic component\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Images/accessing/demo.png){width=80%}\n:::\n:::\n\n\n### Downloading relevant variables\n\nYou can download NHANES data directly from their website or use a package that allows easy access to NHANES data sets. For this tutorial, we'll be downloading data specifically from the 2013-2014 cycle, focusing on demographics and BMI metrics.\n\nNHANES data often comes coded numerically for various categories, making it less straightforward to understand. Use the available translation functions to convert these codes into meaningful categories, easing the data interpretation process.\n\n#### Demographic data\n\nFor the demographic data, we will use the `DEMO_H` file, where the index `H` represents the 2013-14 cycle.\n\n::: column-margin\nIndex `H` represents NHANES 2013-14 cycle\n:::\n\n::: callout-tip\nWe use the `nhanes` function to download a NHANES datafile and `nhanesTranslate` function to encode the categorical variables to match with the CDC website.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(nhanesA)\ndemo13 <- nhanes('DEMO_H')\nDemo13 <- nhanesTranslate('DEMO_H', names(demo13), data=demo13)\n#> No translation table is available for SEQN\n#> Translated columns: RIDSTATR RIAGENDR RIDRETH1 RIDRETH3 RIDEXMON DMQMILIZ DMQADFC DMDBORN4 DMDCITZN DMDYRSUS DMDEDUC3 DMDEDUC2 DMDMARTL RIDEXPRG SIALANG SIAPROXY SIAINTRP FIALANG FIAPROXY FIAINTRP MIALANG MIAPROXY MIAINTRP AIALANGA DMDHHSIZ DMDFMSIZ DMDHHSZA DMDHHSZB DMDHHSZE DMDHRGND DMDHRBR4 DMDHREDU DMDHRMAR DMDHSEDU INDHHIN2 INDFMIN2\n```\n:::\n\n\n#### Examination data\n\nWe are using same H index for BMI.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam13 <- nhanes('BMX_H')\nExam13 <- nhanesTranslate('BMX_H', names(exam13), data=exam13)\n#> No translation table is available for SEQN\n#> Translated columns: BMDSTATS BMIWT BMIHT BMDBMIC BMDSADCM\n```\n:::\n\n\nSee all the column names in the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(Demo13)\n#>  [1] \"SEQN\"     \"SDDSRVYR\" \"RIDSTATR\" \"RIAGENDR\" \"RIDAGEYR\" \"RIDAGEMN\"\n#>  [7] \"RIDRETH1\" \"RIDRETH3\" \"RIDEXMON\" \"RIDEXAGM\" \"DMQMILIZ\" \"DMQADFC\" \n#> [13] \"DMDBORN4\" \"DMDCITZN\" \"DMDYRSUS\" \"DMDEDUC3\" \"DMDEDUC2\" \"DMDMARTL\"\n#> [19] \"RIDEXPRG\" \"SIALANG\"  \"SIAPROXY\" \"SIAINTRP\" \"FIALANG\"  \"FIAPROXY\"\n#> [25] \"FIAINTRP\" \"MIALANG\"  \"MIAPROXY\" \"MIAINTRP\" \"AIALANGA\" \"DMDHHSIZ\"\n#> [31] \"DMDFMSIZ\" \"DMDHHSZA\" \"DMDHHSZB\" \"DMDHHSZE\" \"DMDHRGND\" \"DMDHRAGE\"\n#> [37] \"DMDHRBR4\" \"DMDHREDU\" \"DMDHRMAR\" \"DMDHSEDU\" \"WTINT2YR\" \"WTMEC2YR\"\n#> [43] \"SDMVPSU\"  \"SDMVSTRA\" \"INDHHIN2\" \"INDFMIN2\" \"INDFMPIR\"\nnames(Exam13)\n#>  [1] \"SEQN\"     \"BMDSTATS\" \"BMXWT\"    \"BMIWT\"    \"BMXRECUM\" \"BMIRECUM\"\n#>  [7] \"BMXHEAD\"  \"BMIHEAD\"  \"BMXHT\"    \"BMIHT\"    \"BMXBMI\"   \"BMDBMIC\" \n#> [13] \"BMXLEG\"   \"BMILEG\"   \"BMXARML\"  \"BMIARML\"  \"BMXARMC\"  \"BMIARMC\" \n#> [19] \"BMXWAIST\" \"BMIWAIST\" \"BMXSAD1\"  \"BMXSAD2\"  \"BMXSAD3\"  \"BMXSAD4\" \n#> [25] \"BMDAVSAD\" \"BMDSADCM\"\n```\n:::\n\n\n### Retain only useful variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndemo13select <- Demo13[c(\"SEQN\", # Respondent sequence number\n                         \"RIDEXPRG\", # Pregnancy status at exam\n                         \"RIAGENDR\", # Gender\n                         \"RIDAGEYR\", # Age in years at screening\n                         \"RIDRETH3\")]  # Race/Ethnicity\nexam13select <- Exam13[c(\"SEQN\", # Respondent sequence number\n                         \"BMXBMI\")] # Body Mass Index (kg/m**2)\n```\n:::\n\n\n### Quick look at the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(demo13select)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"SEQN\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RIDEXPRG\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"RIAGENDR\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"RIDAGEYR\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RIDRETH3\"],\"name\":[5],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"73557\",\"2\":\"NA\",\"3\":\"Male\",\"4\":\"69\",\"5\":\"Non-Hispanic Black\",\"_rn_\":\"1\"},{\"1\":\"73558\",\"2\":\"NA\",\"3\":\"Male\",\"4\":\"54\",\"5\":\"Non-Hispanic White\",\"_rn_\":\"2\"},{\"1\":\"73559\",\"2\":\"NA\",\"3\":\"Male\",\"4\":\"72\",\"5\":\"Non-Hispanic White\",\"_rn_\":\"3\"},{\"1\":\"73560\",\"2\":\"NA\",\"3\":\"Male\",\"4\":\"9\",\"5\":\"Non-Hispanic White\",\"_rn_\":\"4\"},{\"1\":\"73561\",\"2\":\"NA\",\"3\":\"Female\",\"4\":\"73\",\"5\":\"Non-Hispanic White\",\"_rn_\":\"5\"},{\"1\":\"73562\",\"2\":\"NA\",\"3\":\"Male\",\"4\":\"56\",\"5\":\"Mexican American\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nhead(exam13select)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"SEQN\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BMXBMI\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"73557\",\"2\":\"26.7\",\"_rn_\":\"1\"},{\"1\":\"73558\",\"2\":\"28.6\",\"_rn_\":\"2\"},{\"1\":\"73559\",\"2\":\"28.9\",\"_rn_\":\"3\"},{\"1\":\"73560\",\"2\":\"17.1\",\"_rn_\":\"4\"},{\"1\":\"73561\",\"2\":\"19.7\",\"_rn_\":\"5\"},{\"1\":\"73562\",\"2\":\"41.7\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n### Merge data\n\nYou might find that the demographic data and BMI data are in separate files. In that case, you'll need to combine them using a common ID variable. Make sure the data aligns correctly during this process.\n\nUse the ID variable `SEQN` to merge both data:\n\n::: column-margin\nWithin NHANES datasets in a given cycle, each person has an unique identifier number (variable name `SEQN`). We can use this `SEQN` variable to merge their data.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged.data <- merge(demo13select, exam13select, by = c(\"SEQN\"), \n                     all=TRUE)\nhead(merged.data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"SEQN\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RIDEXPRG\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"RIAGENDR\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"RIDAGEYR\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RIDRETH3\"],\"name\":[5],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"BMXBMI\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"73557\",\"2\":\"NA\",\"3\":\"Male\",\"4\":\"69\",\"5\":\"Non-Hispanic Black\",\"6\":\"26.7\",\"_rn_\":\"1\"},{\"1\":\"73558\",\"2\":\"NA\",\"3\":\"Male\",\"4\":\"54\",\"5\":\"Non-Hispanic White\",\"6\":\"28.6\",\"_rn_\":\"2\"},{\"1\":\"73559\",\"2\":\"NA\",\"3\":\"Male\",\"4\":\"72\",\"5\":\"Non-Hispanic White\",\"6\":\"28.9\",\"_rn_\":\"3\"},{\"1\":\"73560\",\"2\":\"NA\",\"3\":\"Male\",\"4\":\"9\",\"5\":\"Non-Hispanic White\",\"6\":\"17.1\",\"_rn_\":\"4\"},{\"1\":\"73561\",\"2\":\"NA\",\"3\":\"Female\",\"4\":\"73\",\"5\":\"Non-Hispanic White\",\"6\":\"19.7\",\"_rn_\":\"5\"},{\"1\":\"73562\",\"2\":\"NA\",\"3\":\"Male\",\"4\":\"56\",\"5\":\"Mexican American\",\"6\":\"41.7\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ndim(merged.data)\n#> [1] 10175     6\nmerged.data$SEQN <- NULL\n```\n:::\n\n\n### Investigate merged data\n\nLet's check whether any missing data available.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(tableone)\ntab_nhanes <- CreateTableOne(data=merged.data, includeNA = TRUE)\nprint(tab_nhanes, showAllLevels = TRUE)\n#>                       \n#>                        level                            Overall      \n#>   n                                                     10175        \n#>   RIDEXPRG (%)         Yes, positive lab pregnancy test    65 ( 0.6) \n#>                        The participant was not pregnant  1150 (11.3) \n#>                        Cannot ascertain if the particip    94 ( 0.9) \n#>                        <NA>                              8866 (87.1) \n#>   RIAGENDR (%)         Male                              5003 (49.2) \n#>                        Female                            5172 (50.8) \n#>   RIDAGEYR (mean (SD))                                  31.48 (24.42)\n#>   RIDRETH3 (%)         Mexican American                  1730 (17.0) \n#>                        Other Hispanic                     960 ( 9.4) \n#>                        Non-Hispanic White                3674 (36.1) \n#>                        Non-Hispanic Black                2267 (22.3) \n#>                        Non-Hispanic Asian                1074 (10.6) \n#>                        Other Race - Including Multi-Rac   470 ( 4.6) \n#>   BMXBMI (mean (SD))                                    25.68 (7.96)\n```\n:::\n\n\nAs we can see, the `RIDEXPRG` variable contains a huge amount of missing information.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(merged.data$BMXBMI)\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n#>   12.10   19.70   24.70   25.68   30.20   82.90    1120\n```\n:::\n\n\nBMI also contains many missing values.\n\n### Applying eligibility criteria\n\nWe subset the data using criteria similar to the JAMA paper by @flegal2016trends (see above)\n\n::: column-margin\n@flegal2016trends\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# No missing BMI\nanalytic.data1 <- subset(merged.data, !is.na(BMXBMI)) \ndim(analytic.data1)\n#> [1] 9055    5\n\n# Age >= 20\nanalytic.data2 <- subset(analytic.data1, RIDAGEYR >= 20) \ndim(analytic.data2)\n#> [1] 5520    5\n\n\ntable(analytic.data2$RIDEXPRG,useNA = \"always\")\n#> \n#> Yes, positive lab pregnancy test The participant was not pregnant \n#>                               65                             1143 \n#> Cannot ascertain if the particip                             <NA> \n#>                               44                             4268\n# Pregnant women excluded\nanalytic.data3 <- \n  subset(analytic.data2, is.na(RIDEXPRG) | \n           RIDEXPRG != \"Yes, positive lab pregnancy test\")\ndim(analytic.data3)\n#> [1] 5455    5\n```\n:::\n\n\n### Recoding variables\n\nRecode similar to the JAMA paper by @flegal2016trends (see above)\n\n::: column-margin\n@flegal2016trends\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanalytic.data3$AgeCat <- cut(analytic.data3$RIDAGEYR, \n                           c(0,20,40,60,Inf), \n                           right = FALSE)\nanalytic.data3$Gender <- car::recode(analytic.data3$RIAGENDR, \n                                \"'1'='Male'; '2'='Female'\")\ntable(analytic.data3$Gender,useNA = \"always\")\n#> \n#> Female   Male   <NA> \n#>   2817   2638      0\nanalytic.data3$Race <- car::recode(analytic.data3$RIDRETH3,\n                                \"c('Mexican American',\n                                'Other Hispanic')='Hispanic';\n                                'Non-Hispanic White'='White';\n                                'Non-Hispanic Black'='Black';\n                                'Non-Hispanic Asian'='Asian';\n                                else=NA\")\nanalytic.data3$Race <- \n  factor(analytic.data3$Race, \n         levels = c('White', 'Black', 'Asian', 'Hispanic'))\n```\n:::\n\n\n### Reproducing Table 1\n\nCross-reference the variable names with the NHANES data dictionary to ensure they align with your research questions. \n\nLet's now compare our table with with the Table 1 in the article:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Dataset for males\nanalytic.data3m <- subset(analytic.data3, Gender == \"Male\")\n\n## Dataset for females\nanalytic.data3f <- subset(analytic.data3,  Gender == \"Female\")\n\n# Frequency table by age and gender\nwith(analytic.data3, table(AgeCat,Gender))\n#>           Gender\n#> AgeCat     Female Male\n#>   [0,20)        0    0\n#>   [20,40)     901  909\n#>   [40,60)     999  897\n#>   [60,Inf)    917  832\napply(with(analytic.data3, table(AgeCat,Gender)),1,sum)\n#>   [0,20)  [20,40)  [40,60) [60,Inf) \n#>        0     1810     1896     1749\n\n# Frequency table by age and race\nwith(analytic.data3, table(AgeCat,Race))\n#>           Race\n#> AgeCat     White Black Asian Hispanic\n#>   [0,20)       0     0     0        0\n#>   [20,40)    734   362   216      412\n#>   [40,60)    759   383   251      449\n#>   [60,Inf)   850   370   156      353\n\n# Frequency table by age and race for males\nwith(analytic.data3m, table(AgeCat,Race))\n#>           Race\n#> AgeCat     White Black Asian Hispanic\n#>   [0,20)       0     0     0        0\n#>   [20,40)    386   182   106      189\n#>   [40,60)    360   179   120      215\n#>   [60,Inf)   384   195    74      169\n\n# Frequency table by age and race for females\nwith(analytic.data3f, table(AgeCat,Race))\n#>           Race\n#> AgeCat     White Black Asian Hispanic\n#>   [0,20)       0     0     0        0\n#>   [20,40)    348   180   110      223\n#>   [40,60)    399   204   131      234\n#>   [60,Inf)   466   175    82      184\n```\n:::\n\n\nAs we can see, our frequencies exactly match with Table 1 in the article.\n\n::: column-margin\nAlso see [@ds] for a tidyverse solution\n:::\n\n::: callout-tip\nIf your research aims to make population-level inferences, ensure that you also download sampling weights, stratum and cluster variables. These aren't mandatory for basic analysis but are crucial for population-level conclusions. We will explore more about this in the [survey data analysis](surveydata.html) chapter.\n::: \n\n## References\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}