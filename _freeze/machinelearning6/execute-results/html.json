{
  "hash": "6bd8a6f5f0522bdb1fd78ccf8c92fe94",
  "result": {
    "markdown": "## Unsupervised learning {.unnumbered}\n\nIn this chapter, we will talk about unsupervised learning.\n\nIn the initial code chunk, we load a specific library that will be utilized for publishing-related functionality throughout the chapter.\n\n\n\n\n\n### Clustering\n\nClustering is an unsupervised learning algorithm. These algorithms can classify data into multiple groups. Such classification is based on similarity.\n\nGroup characteristics include (to the extent that is possible)\n\n-   low inter-class similarity: observation from different clusters would be dissimilar\n-   high intra-class similarity: observation from the same cluster would be similar\n\nWithin-cluster variation will be thus minimized by optimizing within-cluster sum of squares of Euclidean distances [@Cross-validation]\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Images/machinelearning/wcss.png){width=90%}\n:::\n:::\n\n\n### K-means\n\nK-means is a very popular clustering algorithm, that partitions the data into $k$ groups.\n\nAlgorithm:\n\n-   Determine a number $k$ (e.g., could be 3)\n-   randomly select $k$ subjects in a data. Use these points as staring points (centers or cluster mean) for each cluster.\n-   By Euclidean distance measure (from the initial centers), try to determine in which cluster the remaining points belong.\n-   compute new mean value for each cluster.\n-   based on this new mean, try to determine again in which cluster the data points belong.\n-   process continues until the data points do not change cluster membership.\n\n### Read previously saved data\n\nWe read a previously saved dataset from a specified file path.\n\n\n::: {.cell hash='machinelearning6_cache/html/data_254112c6fb833b5e27dd722a63f0de3d'}\n\n```{.r .cell-code}\nObsData <- readRDS(file = \"Data/machinelearning/rhcAnalytic.RDS\")\n```\n:::\n\n\nIn the next few code chunks, we implement k-means clustering on various subsets of the data, visualizing the results and displaying the cluster centers. The first example uses two variables, the second example uses three, and in the third example, a larger subset of variables is selected but not immediately utilized in the clustering. In the subsequent code chunk, we apply k-means clustering to the larger subset of variables, displaying various results and aggregating data by cluster to display mean and standard deviation values for each variable within each cluster.\n\n#### Example 1\n\n\n::: {.cell hash='machinelearning6_cache/html/ex1_3f3b64c457c7b850452c34e984e4a3e6'}\n\n```{.r .cell-code}\ndatax0 <- ObsData[c(\"Heart.rate\", \"edu\")]\nkres0 <- kmeans(datax0, centers = 2, nstart = 10)\nkres0$centers\n#>   Heart.rate      edu\n#> 1  134.96277 11.75466\n#> 2   54.55138 11.44494\nplot(datax0, col = kres0$cluster, main = kres0$tot.withinss)\n```\n\n::: {.cell-output-display}\n![](machinelearning6_files/figure-html/ex1-1.png){width=672}\n:::\n:::\n\n\n#### Example 2\n\n\n::: {.cell hash='machinelearning6_cache/html/ex2_b3c46369041dac3bad922d6ba5f9f86c'}\n\n```{.r .cell-code}\ndatax0 <- ObsData[c(\"blood.pressure\", \"Heart.rate\", \"Respiratory.rate\")]\nkres0 <- kmeans(datax0, centers = 2, nstart = 10)\nkres0$centers\n#>   blood.pressure Heart.rate Respiratory.rate\n#> 1       80.10812  135.08956         29.85267\n#> 2       73.71684   54.95789         22.76723\nplot(datax0, col = kres0$cluster, main = kres0$tot.withinss)\n```\n\n::: {.cell-output-display}\n![](machinelearning6_files/figure-html/ex2-1.png){width=672}\n:::\n:::\n\n\n#### Example with many variables\n\n\n::: {.cell hash='machinelearning6_cache/html/exmany_00dcb014de599c458a12d14703efcd67'}\n\n```{.r .cell-code}\ndatax <- ObsData[c(\"edu\", \"blood.pressure\", \"Heart.rate\", \n                   \"Respiratory.rate\" , \"Temperature\",\n                   \"PH\", \"Weight\", \"Length.of.Stay\")]\n```\n:::\n\n::: {.cell hash='machinelearning6_cache/html/kmeans_a0a635281c05671c1d0fbf968eddce7f'}\n\n```{.r .cell-code}\nkres <- kmeans(datax, centers = 3)\n#kres\nhead(kres$cluster)\n#> [1] 3 3 3 2 3 1\nkres$size\n#> [1] 1688 1254 2793\nkres$centers\n#>        edu blood.pressure Heart.rate Respiratory.rate Temperature       PH\n#> 1 11.54214      128.33886  126.12026         29.36611    37.68129 7.401027\n#> 2 11.46134       65.47249   53.24242         22.65973    37.01597 7.378482\n#> 3 11.85833       54.26924  136.37451         29.76119    37.85078 7.385249\n#>     Weight Length.of.Stay\n#> 1 66.68351       20.68128\n#> 2 67.57291       18.58931\n#> 3 68.63384       23.42356\naggregate(datax, by = list(cluster = kres$cluster), mean)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"cluster\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"edu\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"blood.pressure\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Heart.rate\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Respiratory.rate\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Temperature\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PH\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Weight\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Length.of.Stay\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"11.54214\",\"3\":\"128.33886\",\"4\":\"126.12026\",\"5\":\"29.36611\",\"6\":\"37.68129\",\"7\":\"7.401027\",\"8\":\"66.68351\",\"9\":\"20.68128\"},{\"1\":\"2\",\"2\":\"11.46134\",\"3\":\"65.47249\",\"4\":\"53.24242\",\"5\":\"22.65973\",\"6\":\"37.01597\",\"7\":\"7.378482\",\"8\":\"67.57291\",\"9\":\"18.58931\"},{\"1\":\"3\",\"2\":\"11.85833\",\"3\":\"54.26924\",\"4\":\"136.37451\",\"5\":\"29.76119\",\"6\":\"37.85078\",\"7\":\"7.385249\",\"8\":\"68.63384\",\"9\":\"23.42356\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\naggregate(datax, by = list(cluster = kres$cluster), sd)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"cluster\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"edu\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"blood.pressure\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Heart.rate\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Respiratory.rate\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Temperature\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PH\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Weight\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Length.of.Stay\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"3.091605\",\"3\":\"18.58070\",\"4\":\"27.68369\",\"5\":\"14.08169\",\"6\":\"1.610746\",\"7\":\"0.1009567\",\"8\":\"32.15078\",\"9\":\"23.37223\"},{\"1\":\"2\",\"2\":\"3.160538\",\"3\":\"31.89150\",\"4\":\"23.63993\",\"5\":\"13.60831\",\"6\":\"1.832389\",\"7\":\"0.1226041\",\"8\":\"26.87075\",\"9\":\"20.82024\"},{\"1\":\"3\",\"2\":\"3.162485\",\"3\":\"11.93763\",\"4\":\"23.13140\",\"5\":\"13.67791\",\"6\":\"1.781692\",\"7\":\"0.1082140\",\"8\":\"27.99506\",\"9\":\"29.01143\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n### Optimal number of clusters\n\nNext, we explore determining the optimal number of clusters, visualizing the total within-cluster sum of squares for different values of k and indicating a chosen value of k with a vertical line on the plot.\n\n\n::: {.cell hash='machinelearning6_cache/html/optk_7b547951e52e451bf6068274805d202f'}\n\n```{.r .cell-code}\nrequire(factoextra)\n#> Loading required package: factoextra\n#> Loading required package: ggplot2\n#> Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa\nfviz_nbclust(datax, kmeans, method = \"wss\")+\n  geom_vline(xintercept=3,linetype=3)\n```\n\n::: {.cell-output-display}\n![](machinelearning6_files/figure-html/optk-1.png){width=672}\n:::\n:::\n\n\nHere the vertical line is chosen based on elbow method [@clustering].\n\n### Discussion\n\n-   We need to supply a number, $k$: but we can test different $k$s to identify optimal value\n-   Clustering can be influenced by outliners, so median based clustering is possible\n-   mere ordering can influence clustering, hence we should choose different initial means (e.g., `nstart` should be greater than 1).\n\n### Video content (optional)\n\n::: callout-tip\nFor those who prefer a video walkthrough, feel free to watch the video below, which offers a description of an earlier version of the above content.\n:::\n\n::: {style=\"position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;\"}\n<iframe src=\"https://www.youtube.com/embed/xhjcfvWDZVk\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;\" allowfullscreen>\n\n</iframe>\n:::\n\n### References\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}