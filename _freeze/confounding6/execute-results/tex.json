{
  "hash": "41070fb5c6fc8984b63dd8fa6b1751ba",
  "result": {
    "markdown": "## Change-in-estimate {.unnumbered}\n\nThe change-in-estimate criterion is one of the purposeful variable selection criteria, where a relative change is used to determine whether a variable should be included in the model or omitted from the model. This change can be measured by using the relative change in the regression coefficient or relative change by adjusting the effect of the variance estimate. Eliminating a variable using this technique can bias the estimates. In particular, this method is not appropriate when the estimate is non-collapsible. In this chapter, we will see the use of change-in-estimate for various measures of effects (RD and OR, and impact of collapsibility vs non-collapsibility in absence of confounding).\n\nFor a collapsible measure (e.g., beta coefficient from a linear model with a continuous outcome, risk difference or risk ratio from a generalized linear model with a binary outcome), our estimate could be the same when we adjust our model or not for a variable that is not a confounder. However, a non-collapsible measure (e.g., odds ratio) could be different whether or not we adjust our model for a variable that is not a confounder. \n\n\n\n\n::: {.cell hash='confounding6_cache/pdf/setup_b6df3232042925d216b0ec3e295d2fc9'}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(simcausal)\n```\n:::\n\n\n\n## Adjusting for a variable that is a confounder\n\n### Continuous Outcome\n\n-   True treatment effect = 1.3\n\n#### Data generating process\n\n\n\n::: {.cell hash='confounding6_cache/pdf/dgm20_4d204f6a8f29b0fbe16e1b27535039b5'}\n\n```{.r .cell-code}\nrequire(simcausal)\nD <- DAG.empty()\nD <- D + \n  node(\"L\", distr = \"rnorm\", mean = 0, sd = 1) + \n  node(\"A\", distr = \"rnorm\", mean = 0 + L, sd = 1) + \n  node(\"P\", distr = \"rbern\", prob = plogis(-10)) + \n  node(\"Y\", distr = \"rnorm\", mean = 1.1 * L + 1.3 * A, sd = .1)\nDset <- set.DAG(D)\n```\n:::\n\n\n\n#### Generate DAG\n\n\n\n::: {.cell hash='confounding6_cache/pdf/dag20_e3566c0b5040c05a5d3360c297901a5d'}\n\n```{.r .cell-code}\nplotDAG(Dset, xjitter = 0.1, yjitter = .9,\n        edge_attrs = list(width = 0.5, arrow.width = 0.4, arrow.size = 0.7),\n        vertex_attrs = list(size = 12, label.cex = 0.8))\n```\n\n::: {.cell-output-display}\n![](confounding6_files/figure-pdf/dag20-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n#### Generate Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(simcausal)\nObs.Data <- sim(DAG = Dset, n = 1000000, rndseed = 123)\nhead(Obs.Data)\n#>   ID           L          A P         Y\n#> 1  1 -0.56047565 -1.5685464 0 -2.606463\n#> 2  2 -0.23017749  1.1247619 0  1.091131\n#> 3  3  1.55870831  1.0897334 0  3.218627\n#> 4  4  0.07050839  1.5387020 0  2.068111\n#> 5  5  0.12928774  0.5718442 0  1.032429\n#> 6  6  1.71506499  1.8612681 0  4.201175\n```\n:::\n\n\n\n#### Estimate effect (beta-coef)\n\n\n\n::: {.cell hash='confounding6_cache/pdf/est20_f02ebabd77ce2d228d4870dc191808db'}\n\n```{.r .cell-code}\nfit <- glm(Y ~ A, family=\"gaussian\", data=Obs.Data)\nround(coef(fit),2)\n#> (Intercept)           A \n#>        0.00        1.85\n\nfit2 <- glm(Y ~ A + L, family=\"gaussian\", data=Obs.Data)\nround(coef(fit2),2)\n#> (Intercept)           A           L \n#>         0.0         1.3         1.1\n```\n:::\n\n\n\nIncluding a variable that is a confounder (L) in the model changes effect estimate (1.3).\n\n### Binary Outcome\n\n-   True treatment effect = 1.3\n\n#### Data generating process\n\n\n\n::: {.cell hash='confounding6_cache/pdf/dgm21_23ff64a0a99553b1f59d5aee9db41d80'}\n\n```{.r .cell-code}\nrequire(simcausal)\nD <- DAG.empty()\nD <- D + \n  node(\"L\", distr = \"rnorm\", mean = 0, sd = 1) + \n  node(\"A\", distr = \"rnorm\", mean = 0 + L, sd = 1) + \n  node(\"P\", distr = \"rbern\", prob = plogis(-10)) + \n  # node(\"M\", distr = \"rnorm\", mean = P + 0.5 * A, sd = 1) + \n  node(\"Y\", distr = \"rbern\", prob = plogis( 1.1 * L + 1.3 * A)) \nDset <- set.DAG(D)\n#> ...automatically assigning order attribute to some nodes...\n#> node L, order:1\n#> node A, order:2\n#> node P, order:3\n#> node Y, order:4\n```\n:::\n\n\n\n#### Generate DAG\n\n\n\n::: {.cell hash='confounding6_cache/pdf/dag21_1a12256a044e6f024165879615791a57'}\n\n```{.r .cell-code}\nplotDAG(Dset, xjitter = 0.1, yjitter = .9,\n        edge_attrs = list(width = 0.5, arrow.width = 0.4, arrow.size = 0.7),\n        vertex_attrs = list(size = 12, label.cex = 0.8))\n#> using the following vertex attributes:\n#> 120.8NAdarkbluenone0\n#> using the following edge attributes:\n#> 0.50.40.7black1\n```\n\n::: {.cell-output-display}\n![](confounding6_files/figure-pdf/dag21-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n#### Generate Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(simcausal)\nObs.Data <- sim(DAG = Dset, n = 1000000, rndseed = 123)\nhead(Obs.Data)\n#>   ID           L          A P Y\n#> 1  1 -0.56047565 -1.5685464 0 0\n#> 2  2 -0.23017749  1.1247619 0 1\n#> 3  3  1.55870831  1.0897334 0 1\n#> 4  4  0.07050839  1.5387020 0 1\n#> 5  5  0.12928774  0.5718442 0 0\n#> 6  6  1.71506499  1.8612681 0 1\n```\n:::\n\n\n\n#### Estimate effect (OR)\n\n\n\n::: {.cell hash='confounding6_cache/pdf/est21_bd1320712e1a200851eb0adf61416835'}\n\n```{.r .cell-code}\nfit <- glm(Y ~ A, family=binomial(link = \"logit\"), data=Obs.Data)\nround(coef(fit),2)\n#> (Intercept)           A \n#>        0.00        1.68\n\nfit2 <- glm(Y ~ A + L, family=binomial(link = \"logit\"), data=Obs.Data)\nround(coef(fit2),2)\n#> (Intercept)           A           L \n#>         0.0         1.3         1.1\n```\n:::\n\n\n\nIncluding a variable that is a confounder (L) in the model changes effect estimate (1.3).\n\n## Adjusting for a variable that is not a confounder (simplified)\n\n### Continuous Outcome\n\n-   True treatment effect = 1.3\n\n#### Data generating process\n\n\n\n::: {.cell hash='confounding6_cache/pdf/dgm22_01f45a9d8833f6034548edb4d4c8fc88'}\n\n```{.r .cell-code}\nrequire(simcausal)\nD <- DAG.empty()\nD <- D + \n    node(\"A\", distr = \"rnorm\", mean = 0, sd = 1) + \n  node(\"P\", distr = \"rbern\", prob = plogis(-10)) + \n  # node(\"M\", distr = \"rnorm\", mean = P + 0.5 * A, sd = 1) + \n  node(\"R\", distr = \"rnorm\", mean = 0, sd = 1) + \n  node(\"Y\", distr = \"rnorm\", mean = 1.1 * R + 1.3 * A, sd = .1)\nDset <- set.DAG(D)\n#> ...automatically assigning order attribute to some nodes...\n#> node A, order:1\n#> node P, order:2\n#> node R, order:3\n#> node Y, order:4\n```\n:::\n\n\n\n#### Generate DAG\n\n\n\n::: {.cell hash='confounding6_cache/pdf/dag22_e1cbf9ed9007995af6bd220dbecdedb1'}\n\n```{.r .cell-code}\nplotDAG(Dset, xjitter = 0.1, yjitter = .9,\n        edge_attrs = list(width = 0.5, arrow.width = 0.4, arrow.size = 0.7),\n        vertex_attrs = list(size = 12, label.cex = 0.8))\n#> using the following vertex attributes:\n#> 120.8NAdarkbluenone0\n#> using the following edge attributes:\n#> 0.50.40.7black1\n```\n\n::: {.cell-output-display}\n![](confounding6_files/figure-pdf/dag22-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n#### Generate Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(simcausal)\nObs.Data <- sim(DAG = Dset, n = 1000000, rndseed = 123)\nhead(Obs.Data)\n#>   ID           A P          R          Y\n#> 1  1 -0.56047565 0  1.4533508  0.9192381\n#> 2  2 -0.23017749 0 -1.4479411 -2.0098302\n#> 3  3  1.55870831 0  0.4182387  2.5737773\n#> 4  4  0.07050839 0 -0.9194114 -0.9294528\n#> 5  5  0.12928774 0  0.7360159  1.1245064\n#> 6  6  1.71506499 0 -0.8354281  1.2055689\n```\n:::\n\n\n\n#### Estimate effect (beta-coef)\n\n\n\n::: {.cell hash='confounding6_cache/pdf/est22_5144d6f90942944ffcf59100e598823c'}\n\n```{.r .cell-code}\nfit <- glm(Y ~ A, family=\"gaussian\", data=Obs.Data)\nround(coef(fit),2)\n#> (Intercept)           A \n#>         0.0         1.3\n\nfit2 <- glm(Y ~ A + R, family=\"gaussian\", data=Obs.Data)\nround(coef(fit2),2)\n#> (Intercept)           A           R \n#>         0.0         1.3         1.1\n```\n:::\n\n\n\nIncluding a variable that is not a confounder (R is a pure risk factor for the outcome Y) in the model does not change effect estimate (1.3).\n\n### Binary Outcome\n\n-   True treatment effect = 1.3\n\n#### Data generating process\n\n\n\n::: {.cell hash='confounding6_cache/pdf/dgm23_faa87399c5e4ae01a0bbd1ae8366c7c8'}\n\n```{.r .cell-code}\nrequire(simcausal)\nD <- DAG.empty()\nD <- D + \n  node(\"A\", distr = \"rnorm\", mean = 0, sd = 1) + \n  node(\"P\", distr = \"rbern\", prob = plogis(-10)) + \n  # node(\"M\", distr = \"rnorm\", mean = P + 0.5 * A, sd = 1) + \n  node(\"R\", distr = \"rnorm\", mean = 0, sd = 1) + \n  node(\"Y\", distr = \"rbern\", prob = plogis(1.1 * R + 1.3 * A)) \nDset <- set.DAG(D)\n#> ...automatically assigning order attribute to some nodes...\n#> node A, order:1\n#> node P, order:2\n#> node R, order:3\n#> node Y, order:4\n```\n:::\n\n\n\n#### Generate DAG\n\n\n\n::: {.cell hash='confounding6_cache/pdf/dag23_2e4b518a177eda3dacd0ceb3bb72995a'}\n\n```{.r .cell-code}\nplotDAG(Dset, xjitter = 0.1, yjitter = .9,\n        edge_attrs = list(width = 0.5, arrow.width = 0.4, arrow.size = 0.7),\n        vertex_attrs = list(size = 12, label.cex = 0.8))\n#> using the following vertex attributes:\n#> 120.8NAdarkbluenone0\n#> using the following edge attributes:\n#> 0.50.40.7black1\n```\n\n::: {.cell-output-display}\n![](confounding6_files/figure-pdf/dag23-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n#### Generate Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(simcausal)\nObs.Data <- sim(DAG = Dset, n = 1000000, rndseed = 123)\nhead(Obs.Data)\n#>   ID           A P          R Y\n#> 1  1 -0.56047565 0  1.4533508 1\n#> 2  2 -0.23017749 0 -1.4479411 0\n#> 3  3  1.55870831 0  0.4182387 1\n#> 4  4  0.07050839 0 -0.9194114 1\n#> 5  5  0.12928774 0  0.7360159 0\n#> 6  6  1.71506499 0 -0.8354281 0\n```\n:::\n\n\n\n#### Estimate effect (OR)\n\n\n\n::: {.cell hash='confounding6_cache/pdf/est23_7420f537c9088190d23e69ac627a5a1e'}\n\n```{.r .cell-code}\nfit <- glm(Y ~ A, family=binomial(link = \"logit\"), data=Obs.Data)\nround(coef(fit),2)\n#> (Intercept)           A \n#>        0.00        1.06\n\nfit2 <- glm(Y ~ A + R, family=binomial(link = \"logit\"), data=Obs.Data)\nround(coef(fit2),2)\n#> (Intercept)           A           R \n#>         0.0         1.3         1.1\n```\n:::\n\n\n\nIncluding a variable that is not a confounder (R is a pure risk factor for the outcome Y) in the model changes effect estimate (1.3).\n\n## Adjusting for a variable that is not a confounder (Complex)\n\n### Continuous Outcome\n\n-   True treatment effect = 1.3\n\n#### Data generating process\n\n\n\n::: {.cell hash='confounding6_cache/pdf/dgm24_cd8659967039d3bc65a9e36248148561'}\n\n```{.r .cell-code}\nrequire(simcausal)\nD <- DAG.empty()\nD <- D + \n    node(\"A\", distr = \"rnorm\", mean = 0, sd = 1) + \n  node(\"P\", distr = \"rbern\", prob = plogis(-10)) + \n  node(\"M\", distr = \"rnorm\", mean = P + 0.5 * A, sd = 1) + \n  node(\"R\", distr = \"rnorm\", mean = 0, sd = 1) + \n  node(\"Y\", distr = \"rnorm\", mean = 0.5 * M + 1.1 * R + 1.3 * A, sd = .1)\nDset <- set.DAG(D)\n#> ...automatically assigning order attribute to some nodes...\n#> node A, order:1\n#> node P, order:2\n#> node M, order:3\n#> node R, order:4\n#> node Y, order:5\n```\n:::\n\n\n\n#### Generate DAG\n\n\n\n::: {.cell hash='confounding6_cache/pdf/dag24_b73e7a8bbb8845bdafc53ce5729b008b'}\n\n```{.r .cell-code}\nplotDAG(Dset, xjitter = 0.1, yjitter = .9,\n        edge_attrs = list(width = 0.5, arrow.width = 0.4, arrow.size = 0.7),\n        vertex_attrs = list(size = 12, label.cex = 0.8))\n#> using the following vertex attributes:\n#> 120.8NAdarkbluenone0\n#> using the following edge attributes:\n#> 0.50.40.7black1\n```\n\n::: {.cell-output-display}\n![](confounding6_files/figure-pdf/dag24-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n#### Generate Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(simcausal)\nObs.Data <- sim(DAG = Dset, n = 1000000, rndseed = 123)\nhead(Obs.Data)\n#>   ID           A P           M           R          Y\n#> 1  1 -0.56047565 0  1.17311294  0.49170637  0.4103007\n#> 2  2 -0.23017749 0 -1.56302981 -1.17864299 -2.3797737\n#> 3  3  1.55870831 0  1.19759283  0.87393920  3.5823197\n#> 4  4  0.07050839 0 -0.88415718 -0.09761158 -0.5322484\n#> 5  5  0.12928774 0  0.80065978  1.46814830  2.2160066\n#> 6  6  1.71506499 0  0.02210438 -1.05044636  1.1270274\n```\n:::\n\n\n\n#### Estimate effect (beta-coef)\n\n\n\n::: {.cell hash='confounding6_cache/pdf/est24_58915055c5afb438000dcc199f1133a3'}\n\n```{.r .cell-code}\nfit <- glm(Y ~ A + M, family=\"gaussian\", data=Obs.Data)\nround(coef(fit),2)\n#> (Intercept)           A           M \n#>         0.0         1.3         0.5\n\nfit2 <- glm(Y ~ A + M + R, family=\"gaussian\", data=Obs.Data)\nround(coef(fit2),2)\n#> (Intercept)           A           M           R \n#>         0.0         1.3         0.5         1.1\n```\n:::\n\n\n\nIncluding a variable that is not a confounder (R is a pure risk factor for the outcome Y) in the model does not change effect estimate (1.3).\n\n### Binary Outcome\n\n-   True treatment effect = 1.3\n\n#### Data generating process\n\n\n\n::: {.cell hash='confounding6_cache/pdf/dgm25_49ecd77857a43d8d927fee59d869e6be'}\n\n```{.r .cell-code}\nrequire(simcausal)\nD <- DAG.empty()\nD <- D + \n  node(\"A\", distr = \"rnorm\", mean = 0, sd = 1) + \n  node(\"P\", distr = \"rbern\", prob = plogis(-10)) + \n  node(\"M\", distr = \"rnorm\", mean = P + 0.5 * A, sd = 1) + \n  node(\"R\", distr = \"rnorm\", mean = 0, sd = 1) + \n  node(\"Y\", distr = \"rbern\", prob = plogis(0.5 * M + 1.1 * R + 1.3 * A)) \nDset <- set.DAG(D)\n#> ...automatically assigning order attribute to some nodes...\n#> node A, order:1\n#> node P, order:2\n#> node M, order:3\n#> node R, order:4\n#> node Y, order:5\n```\n:::\n\n\n\n#### Generate DAG\n\n\n\n::: {.cell hash='confounding6_cache/pdf/dag25_9011f31af89c65b71b40ad34c4004e79'}\n\n```{.r .cell-code}\nplotDAG(Dset, xjitter = 0.1, yjitter = .9,\n        edge_attrs = list(width = 0.5, arrow.width = 0.4, arrow.size = 0.7),\n        vertex_attrs = list(size = 12, label.cex = 0.8))\n#> using the following vertex attributes:\n#> 120.8NAdarkbluenone0\n#> using the following edge attributes:\n#> 0.50.40.7black1\n```\n\n::: {.cell-output-display}\n![](confounding6_files/figure-pdf/dag25-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n#### Generate Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(simcausal)\nObs.Data <- sim(DAG = Dset, n = 1000000, rndseed = 123)\nhead(Obs.Data)\n#>   ID           A P           M           R Y\n#> 1  1 -0.56047565 0  1.17311294  0.49170637 1\n#> 2  2 -0.23017749 0 -1.56302981 -1.17864299 1\n#> 3  3  1.55870831 0  1.19759283  0.87393920 1\n#> 4  4  0.07050839 0 -0.88415718 -0.09761158 1\n#> 5  5  0.12928774 0  0.80065978  1.46814830 1\n#> 6  6  1.71506499 0  0.02210438 -1.05044636 1\n```\n:::\n\n\n\n#### Estimate effect (OR)\n\n\n\n::: {.cell hash='confounding6_cache/pdf/est25_e596677592a46769c0744d01b4d00e11'}\n\n```{.r .cell-code}\nfit <- glm(Y ~ A + M, family=binomial(link = \"logit\"), data=Obs.Data)\nround(coef(fit),2)\n#> (Intercept)           A           M \n#>        0.00        1.06        0.41\n\nfit2 <- glm(Y ~ A + M + R, family=binomial(link = \"logit\"), data=Obs.Data)\nround(coef(fit2),2)\n#> (Intercept)           A           M           R \n#>        0.00        1.29        0.50        1.10\n```\n:::\n\n\n\nIncluding a variable that is not a confounder (R is a pure risk factor for the outcome Y) in the model changes effect estimate (1.3).\n\n### Video content (optional)\n\n::: callout-tip\nFor those who prefer a video walkthrough, feel free to watch the video below, which offers a description of an earlier version of the above content.\n:::\n\n::: {style=\"position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;\"}\n<iframe src=\"https://www.youtube.com/embed/AzQ1g5HgCrs\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;\" allowfullscreen>\n\n</iframe>\n:::\n\n::: {style=\"position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;\"}\n<iframe src=\"https://www.youtube.com/embed/9buinIJ91xg\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;\" allowfullscreen>\n\n</iframe>\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}