{
  "hash": "f78384711f54b47bae9c81657ec1138a",
  "result": {
    "engine": "knitr",
    "markdown": "## Binary outcome {.unnumbered}\n\nWe focus on statistical analysis and modeling of a binary outcome (cholesterol level) that is categorized as either \"healthy\" or \"unhealthy.\" \n\n### Explore relationships for binary outcome variable\n\n\n::: {.cell}\n\n```\n#> Loading required package: Hmisc\n#> \n#> Attaching package: 'Hmisc'\n#> The following objects are masked from 'package:base':\n#> \n#>     format.pval, units\n#> Loading required package: prodlim\n#> Loading required package: carData\n#> \n#> Attaching package: 'car'\n#> The following objects are masked from 'package:rms':\n#> \n#>     Predict, vif\n#> Type 'citation(\"pROC\")' for a citation.\n#> \n#> Attaching package: 'pROC'\n#> The following objects are masked from 'package:stats':\n#> \n#>     cov, smooth, var\n```\n:::\n\n\n#### Load data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(file = \"Data/predictivefactors/cholesterolNHANES15part1.RData\")\n```\n:::\n\n\n#### Creating binary variable\n\n**Binary categorization**: The cholesterol variable is converted into a binary outcome (\"healthy\" or \"unhealthy\") using the `ifelse` function based on a threshold value of 200. \n\n**Re-leveling**: The reference category for the binary variable is changed to \"unhealthy.\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Binary variable\nanalytic3$cholesterol.bin <- ifelse(analytic3$cholesterol < 200, \"healthy\", \"unhealthy\")\ntable(analytic3$cholesterol.bin)\n#> \n#>   healthy unhealthy \n#>      1586      1046\n\n# Changing the reference category\nanalytic3$cholesterol.bin <- as.factor(analytic3$cholesterol.bin)\nanalytic3$cholesterol.bin <- relevel(analytic3$cholesterol.bin, ref = \"unhealthy\")\ntable(analytic3$cholesterol.bin)\n#> \n#> unhealthy   healthy \n#>      1046      1586\n```\n:::\n\n\n#### Modelling data\n\nA logistic regression is fitted to predict the binary cholesterol outcome from multiple predictor variables.\n\n::: callout-tip\nWe use the `glm` function to run generalized linear models. The default family is gaussian with identity link. Setting binomial family with logit link (logit link is default for binomial family) means fitting logistic regression.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Regression model\nformula5x <- as.formula(\"cholesterol.bin~gender + age + born + \n             race + education + married + \n             income + diastolicBP + systolicBP + \n             bmi + bodyweight + bodyheight + waist +  \n             triglycerides + uric.acid + \n             protein + bilirubin + phosphorus + sodium + potassium + \n             globulin + calcium + physical.work + physical.recreational + \n             diabetes\")\n\n# Summary\nfit5x <- glm(formula5x, family = binomial(), data = analytic3)\npublish(fit5x)\n#>               Variable                            Units OddsRatio       CI.95    p-value \n#>                 gender                           Female       Ref                        \n#>                                                    Male      1.68 [1.27;2.23]   0.000313 \n#>                    age                                       0.97 [0.97;0.98]    < 1e-04 \n#>                   born Born in 50 US states or Washingt       Ref                        \n#>                                                  Others      0.69 [0.54;0.88]   0.002636 \n#>                   race                            Black       Ref                        \n#>                                                Hispanic      1.29 [0.95;1.75]   0.107104 \n#>                                                   Other      1.24 [0.87;1.79]   0.234062 \n#>                                                   White      1.10 [0.83;1.44]   0.505147 \n#>              education                          College       Ref                        \n#>                                             High.School      0.84 [0.68;1.02]   0.082168 \n#>                                                  School      1.23 [0.84;1.82]   0.292070 \n#>                married                          Married       Ref                        \n#>                                           Never.married      1.29 [1.00;1.67]   0.052969 \n#>                                      Previously.married      0.89 [0.70;1.13]   0.345688 \n#>                 income                             <25k       Ref                        \n#>                                        Between.25kto54k      1.01 [0.78;1.29]   0.957537 \n#>                                        Between.55kto99k      0.90 [0.69;1.19]   0.462854 \n#>                                                Over100k      0.90 [0.66;1.21]   0.472137 \n#>            diastolicBP                                       0.98 [0.97;0.98]    < 1e-04 \n#>             systolicBP                                       1.01 [1.00;1.01]   0.029513 \n#>                    bmi                                       1.11 [0.99;1.24]   0.065627 \n#>             bodyweight                                       0.96 [0.92;1.00]   0.045338 \n#>             bodyheight                                       1.05 [1.00;1.09]   0.030995 \n#>                  waist                                       1.01 [0.99;1.02]   0.464825 \n#>          triglycerides                                       0.99 [0.99;0.99]    < 1e-04 \n#>              uric.acid                                       0.96 [0.89;1.03]   0.273792 \n#>                protein                                       0.61 [0.42;0.89]   0.009192 \n#>              bilirubin                                       1.19 [0.86;1.66]   0.292632 \n#>             phosphorus                                       0.96 [0.81;1.13]   0.610931 \n#>                 sodium                                       1.06 [1.02;1.11]   0.007980 \n#>              potassium                                       0.95 [0.71;1.26]   0.729218 \n#>               globulin                                       1.38 [0.94;2.01]   0.101667 \n#>                calcium                                       0.64 [0.47;0.89]   0.007026 \n#>          physical.work                               No       Ref                        \n#>                                                     Yes      0.91 [0.74;1.12]   0.392539 \n#>  physical.recreational                               No       Ref                        \n#>                                                     Yes      1.05 [0.85;1.29]   0.681388 \n#>               diabetes                               No       Ref                        \n#>                                                     Yes      2.68 [2.02;3.56]    < 1e-04\n\n# VIF\ncar::vif(fit5x)\n#>                             GVIF Df GVIF^(1/(2*Df))\n#> gender                  2.735258  1        1.653862\n#> age                     2.121098  1        1.456399\n#> born                    1.664094  1        1.289998\n#> race                    2.585539  3        1.171544\n#> education               1.458430  2        1.098933\n#> married                 1.432595  2        1.094034\n#> income                  1.426911  3        1.061043\n#> diastolicBP             1.297308  1        1.138994\n#> systolicBP              1.614374  1        1.270580\n#> bmi                    81.928815  1        9.051454\n#> bodyweight            103.125772  1       10.155086\n#> bodyheight             22.647853  1        4.758976\n#> waist                  11.493710  1        3.390237\n#> triglycerides           1.258340  1        1.121758\n#> uric.acid               1.636512  1        1.279262\n#> protein                 3.684816  1        1.919587\n#> bilirubin               1.186181  1        1.089119\n#> phosphorus              1.117915  1        1.057315\n#> sodium                  1.123193  1        1.059808\n#> potassium               1.181358  1        1.086903\n#> globulin                3.427401  1        1.851324\n#> calcium                 1.543019  1        1.242183\n#> physical.work           1.090958  1        1.044490\n#> physical.recreational   1.218558  1        1.103883\n#> diabetes                1.212365  1        1.101074\n```\n:::\n\n\n#### AUC\n\nThe [Area Under the Receiver Operating Characteristic (ROC) Curve (AUC)](https://en.wikipedia.org/wiki/Receiver_operating_characteristic) is calculated to assess the model's predictive performance in terms of discrimination. The AUC would tell how much the model is capable of distinguishing between healthy and unhealthy levels.\n\nLet us measure the accuracy for classification models `fit5x`.\n\n::: callout-tip\nWe can use the `roc` function to build a ROC curve and `auc` function to calculate the AUC (are under the ROC curve) value.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(pROC)\npred.y <- predict(fit5x, type = \"response\")\nrocobj <- roc(analytic3$cholesterol.bin, pred.y)\n#> Setting levels: control = unhealthy, case = healthy\n#> Setting direction: controls < cases\nrocobj\n#> \n#> Call:\n#> roc.default(response = analytic3$cholesterol.bin, predictor = pred.y)\n#> \n#> Data: pred.y in 1046 controls (analytic3$cholesterol.bin unhealthy) < 1586 cases (analytic3$cholesterol.bin healthy).\n#> Area under the curve: 0.7411\n\nauc(rocobj)\n#> Area under the curve: 0.7411\n```\n:::\n\n\n#### Re-modelling\n\nLet us re-fit the model and measure the AUC. VIF is calculated again for this new model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformula5 <- as.formula(\"cholesterol.bin~gender + age + born + \n             race + education + married + \n             income + diastolicBP + systolicBP + \n             bmi +\n             triglycerides + uric.acid + \n             protein + bilirubin + phosphorus + sodium + potassium + \n             globulin + calcium + physical.work + physical.recreational + \n             diabetes\")\nfit5 <- glm(formula5, family = binomial(), data = analytic3)\npublish(fit5)\n#>               Variable                            Units OddsRatio       CI.95    p-value \n#>                 gender                           Female       Ref                        \n#>                                                    Male      1.86 [1.48;2.33]    < 1e-04 \n#>                    age                                       0.97 [0.97;0.98]    < 1e-04 \n#>                   born Born in 50 US states or Washingt       Ref                        \n#>                                                  Others      0.67 [0.52;0.85]   0.001233 \n#>                   race                            Black       Ref                        \n#>                                                Hispanic      1.26 [0.94;1.69]   0.128165 \n#>                                                   Other      1.21 [0.85;1.73]   0.284083 \n#>                                                   White      1.11 [0.85;1.45]   0.460652 \n#>              education                          College       Ref                        \n#>                                             High.School      0.84 [0.68;1.02]   0.083806 \n#>                                                  School      1.22 [0.83;1.80]   0.305514 \n#>                married                          Married       Ref                        \n#>                                           Never.married      1.29 [1.00;1.68]   0.049983 \n#>                                      Previously.married      0.89 [0.70;1.13]   0.339401 \n#>                 income                             <25k       Ref                        \n#>                                        Between.25kto54k      1.00 [0.78;1.28]   0.999445 \n#>                                        Between.55kto99k      0.90 [0.68;1.17]   0.425427 \n#>                                                Over100k      0.89 [0.66;1.20]   0.447012 \n#>            diastolicBP                                       0.98 [0.97;0.99]    < 1e-04 \n#>             systolicBP                                       1.01 [1.00;1.01]   0.042769 \n#>                    bmi                                       1.01 [0.99;1.02]   0.496430 \n#>          triglycerides                                       0.99 [0.99;0.99]    < 1e-04 \n#>              uric.acid                                       0.96 [0.89;1.03]   0.242942 \n#>                protein                                       0.62 [0.43;0.89]   0.010343 \n#>              bilirubin                                       1.24 [0.89;1.72]   0.203993 \n#>             phosphorus                                       0.95 [0.80;1.12]   0.539847 \n#>                 sodium                                       1.06 [1.02;1.11]   0.006777 \n#>              potassium                                       0.96 [0.72;1.28]   0.790080 \n#>               globulin                                       1.37 [0.94;2.00]   0.102430 \n#>                calcium                                       0.64 [0.46;0.88]   0.005772 \n#>          physical.work                               No       Ref                        \n#>                                                     Yes      0.91 [0.74;1.12]   0.382281 \n#>  physical.recreational                               No       Ref                        \n#>                                                     Yes      1.04 [0.85;1.29]   0.682962 \n#>               diabetes                               No       Ref                        \n#>                                                     Yes      2.69 [2.03;3.57]    < 1e-04\n\n# VIF\ncar::vif(fit5)\n#>                           GVIF Df GVIF^(1/(2*Df))\n#> gender                1.749947  1        1.322856\n#> age                   1.850160  1        1.360206\n#> born                  1.640947  1        1.280994\n#> race                  2.345460  3        1.152669\n#> education             1.430721  2        1.093676\n#> married               1.432015  2        1.093923\n#> income                1.409064  3        1.058819\n#> diastolicBP           1.289411  1        1.135523\n#> systolicBP            1.605248  1        1.266984\n#> bmi                   1.477795  1        1.215646\n#> triglycerides         1.246395  1        1.116421\n#> uric.acid             1.624039  1        1.274378\n#> protein               3.648367  1        1.910070\n#> bilirubin             1.177643  1        1.085193\n#> phosphorus            1.114298  1        1.055603\n#> sodium                1.117463  1        1.057101\n#> potassium             1.176914  1        1.084857\n#> globulin              3.395946  1        1.842809\n#> calcium               1.542486  1        1.241969\n#> physical.work         1.089742  1        1.043907\n#> physical.recreational 1.197719  1        1.094404\n#> diabetes              1.200402  1        1.095629\n```\n:::\n\n\nThe AUC for this new model is also calculated.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#### AUC\npred.y <- predict(fit5, type = \"response\")\nrocobj <- roc(analytic3$cholesterol.bin, pred.y)\n#> Setting levels: control = unhealthy, case = healthy\n#> Setting direction: controls < cases\nrocobj\n#> \n#> Call:\n#> roc.default(response = analytic3$cholesterol.bin, predictor = pred.y)\n#> \n#> Data: pred.y in 1046 controls (analytic3$cholesterol.bin unhealthy) < 1586 cases (analytic3$cholesterol.bin healthy).\n#> Area under the curve: 0.7406\nauc(rocobj)\n#> Area under the curve: 0.7406\n```\n:::\n\n\n### Save data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsave.image(file = \"Data/predictivefactors/cholesterolNHANES15part2.RData\")\n```\n:::\n\n\n### References\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}