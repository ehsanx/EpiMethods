{
  "hash": "667a1489d94a7371910b6eac046fdd1c",
  "result": {
    "markdown": "## Mixed effects models {.unnumbered}\n\nIn this section, we will learn about mixed effects models. Mixed effects models are popular choices for modeling repeated measurements, such as longitudinal or clustered data. Examples of longitudinal data include blood pressure measurements taken over time from the same individuals and CD4 count over time from the same individuals. Examples of clustered data include students within schools and patients within hospitals. There are two components in a mixed effects model: fixed effects and random effects:\n\n-   Fixed effects refer to general trends that are applicable to all subjects/clusters. This implies that we might want to investigate how students perform (on average) in different subjects such as math and history. These effects are commonly observed, i.e., fixed, across all schools.\n\n-   Random Effects capture the unique characteristics of each subject/cluster that differentiate them from one another. For instance, some schools may have better resources, more experienced teachers, or a more supportive learning environment. These differences are specific to each school, and we use random effects to capture them.\n\n\n::: {.cell hash='longitudinal1_cache/html/setup_58725617b16b2963e015093a96c937a7'}\n\n```{.r .cell-code}\n# Load required packages\nknitr::opts_chunk$set(echo = TRUE)\nrequire(kableExtra)\nrequire(Matrix)\nrequire(jtools)\n```\n:::\n\n\n### Repeated measures\n\n::: column-margin\nA useful reference on repeated measures is Section 9.2 of @faraway2016extending.\n:::\n\nIn repeated measurement design, the response variable are measured multiple times for each individuals.\n\n### Linear Mixed Effects Models for Repeated Measures Data\n\n::: column-margin\nA useful reference on linear mixed effects models is Section 12.4 of @hothorn2014handbook.\n:::\n\n::: callout-important\n-   The linear mixed effect models are based on the idea that the correlation of an individual's responses depends on some unobserved individual characteristics.\n\n-   In linear mixed effect models, we treat these unobserved characteristics as random effects in our model. If we could conditional on the random effects, then the repeated measurements can be assumed to be independent.\n:::\n\n#### Data\n\nWe are going to use the `BtheB` dataset from the `HSAUR2` package to explain the linear mixed effect model:\n\n\n::: {.cell hash='longitudinal1_cache/html/load_0562535e592778473f771abfa11844ee'}\n\n```{.r .cell-code}\nlibrary(HSAUR2)\n#> Loading required package: tools\ndata(\"BtheB\")\nkable(head(BtheB))%>%\n  kable_styling(bootstrap_options = \"striped\", full_width = F, \n                position = \"left\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; \">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> drug </th>\n   <th style=\"text-align:left;\"> length </th>\n   <th style=\"text-align:left;\"> treatment </th>\n   <th style=\"text-align:right;\"> bdi.pre </th>\n   <th style=\"text-align:right;\"> bdi.2m </th>\n   <th style=\"text-align:right;\"> bdi.3m </th>\n   <th style=\"text-align:right;\"> bdi.5m </th>\n   <th style=\"text-align:right;\"> bdi.8m </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:left;\"> &gt;6m </td>\n   <td style=\"text-align:left;\"> TAU </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:left;\"> &gt;6m </td>\n   <td style=\"text-align:left;\"> BtheB </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:left;\"> &lt;6m </td>\n   <td style=\"text-align:left;\"> TAU </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:left;\"> &gt;6m </td>\n   <td style=\"text-align:left;\"> BtheB </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:left;\"> &gt;6m </td>\n   <td style=\"text-align:left;\"> BtheB </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:left;\"> &lt;6m </td>\n   <td style=\"text-align:left;\"> BtheB </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n-   A typical form of repeated measurement data from a clinical trial data.\n\n-   The individuals are allocated to different treatments then the response Beck Depression Inventory II were taken at baseline, 2, 3, 5, and 8 months\n\n\n::: {.cell hash='longitudinal1_cache/html/data1_6bc259bccfadb6f1ac4dcc298c7af6d1'}\n\n```{.r .cell-code}\n## Box-plot of responses at different time points in treatment and control groups\ndata(\"BtheB\", package = \"HSAUR2\")\nlayout(matrix(1:2, nrow = 1))\nylim <- range(BtheB[,grep(\"bdi\", names(BtheB))],na.rm = TRUE)\ntau <- subset(BtheB, treatment == \"TAU\")[, grep(\"bdi\", names(BtheB))]\nboxplot(tau, main = \"Treated as Usual\", ylab = \"BDI\",\n        xlab = \"Time (in months)\", \n        names = c(0, 2, 3, 5, 8),ylim = ylim)\nbtheb <- subset(BtheB, treatment == \"BtheB\")[, grep(\"bdi\", names(BtheB))]\nboxplot(btheb, main = \"Beat the Blues\", ylab = \"BDI\",\n        xlab = \"Time (in months)\", \n        names = c(0, 2, 3, 5, 8),ylim = ylim)\n```\n\n::: {.cell-output-display}\n![](longitudinal1_files/figure-html/data1-1.png){width=672}\n:::\n:::\n\n\n-   The side-by-side box plots show the distributions of BDI overtime between control (Treated as Usual) and intervention (Beat the Blues) groups.\n\n-   As time goes, drops in BDI are more obvious in intervention which may indicate the intervention is effective.\n\n#### Regular model fixed intercept and slope\n\nTo compare, we start with fixed effect linear model, i.e., a regular linear model without any random effect:\n\n\n::: {.cell hash='longitudinal1_cache/html/fixed_27129be5f2fdfc1f382af1d1c2b29d96'}\n\n```{.r .cell-code}\n## To analyze the data, we first need to convert the dataset to a analysis-ready form\nBtheB$subject <- factor(rownames(BtheB))\nnobs <- nrow(BtheB)\nBtheB_long <- reshape(BtheB, idvar = \"subject\", \n                      varying = c(\"bdi.2m\", \"bdi.3m\", \"bdi.5m\", \n                                  \"bdi.8m\"), \n                      direction = \"long\")\nBtheB_long$time <- rep(c(2, 3, 5, 8), rep(nobs, 4))\nkable(head(BtheB_long))%>%\n  kable_styling(bootstrap_options = \"striped\", full_width = F, \n                position = \"left\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; \">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:left;\"> drug </th>\n   <th style=\"text-align:left;\"> length </th>\n   <th style=\"text-align:left;\"> treatment </th>\n   <th style=\"text-align:right;\"> bdi.pre </th>\n   <th style=\"text-align:left;\"> subject </th>\n   <th style=\"text-align:right;\"> time </th>\n   <th style=\"text-align:right;\"> bdi </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1.2m </td>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:left;\"> &gt;6m </td>\n   <td style=\"text-align:left;\"> TAU </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2.2m </td>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:left;\"> &gt;6m </td>\n   <td style=\"text-align:left;\"> BtheB </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3.2m </td>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:left;\"> &lt;6m </td>\n   <td style=\"text-align:left;\"> TAU </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4.2m </td>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:left;\"> &gt;6m </td>\n   <td style=\"text-align:left;\"> BtheB </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5.2m </td>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:left;\"> &gt;6m </td>\n   <td style=\"text-align:left;\"> BtheB </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 6.2m </td>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:left;\"> &lt;6m </td>\n   <td style=\"text-align:left;\"> BtheB </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:left;\"> 6 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nunique(BtheB_long$subject)\n#>   [1] 1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16  17  18 \n#>  [19] 19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36 \n#>  [37] 37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54 \n#>  [55] 55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72 \n#>  [73] 73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90 \n#>  [91] 91  92  93  94  95  96  97  98  99  100\n#> 100 Levels: 1 10 100 11 12 13 14 15 16 17 18 19 2 20 21 22 23 24 25 26 27 ... 99\nkable(subset(BtheB_long,  subject == 2))%>%\n  kable_styling(bootstrap_options = \"striped\", full_width = F, \n                position = \"left\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; \">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:left;\"> drug </th>\n   <th style=\"text-align:left;\"> length </th>\n   <th style=\"text-align:left;\"> treatment </th>\n   <th style=\"text-align:right;\"> bdi.pre </th>\n   <th style=\"text-align:left;\"> subject </th>\n   <th style=\"text-align:right;\"> time </th>\n   <th style=\"text-align:right;\"> bdi </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 2.2m </td>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:left;\"> &gt;6m </td>\n   <td style=\"text-align:left;\"> BtheB </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2.3m </td>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:left;\"> &gt;6m </td>\n   <td style=\"text-align:left;\"> BtheB </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2.5m </td>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:left;\"> &gt;6m </td>\n   <td style=\"text-align:left;\"> BtheB </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2.8m </td>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:left;\"> &gt;6m </td>\n   <td style=\"text-align:left;\"> BtheB </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nkable(subset(BtheB_long,  subject == 99))%>%\n  kable_styling(bootstrap_options = \"striped\", full_width = F, \n                position = \"left\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; \">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:left;\"> drug </th>\n   <th style=\"text-align:left;\"> length </th>\n   <th style=\"text-align:left;\"> treatment </th>\n   <th style=\"text-align:right;\"> bdi.pre </th>\n   <th style=\"text-align:left;\"> subject </th>\n   <th style=\"text-align:right;\"> time </th>\n   <th style=\"text-align:right;\"> bdi </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 99.2m </td>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:left;\"> &lt;6m </td>\n   <td style=\"text-align:left;\"> TAU </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:left;\"> 99 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 99.3m </td>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:left;\"> &lt;6m </td>\n   <td style=\"text-align:left;\"> TAU </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:left;\"> 99 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 99.5m </td>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:left;\"> &lt;6m </td>\n   <td style=\"text-align:left;\"> TAU </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:left;\"> 99 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 99.8m </td>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:left;\"> &lt;6m </td>\n   <td style=\"text-align:left;\"> TAU </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:left;\"> 99 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n\n\nlmfit <- lm(bdi ~ bdi.pre + time + treatment + drug +length, \n            data = BtheB_long, na.action = na.omit)\nrequire(jtools)\nsumm(lmfit)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 280 (120 missing obs. deleted) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> bdi </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> OLS linear regression </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> F(5,274) </td>\n   <td style=\"text-align:right;\"> 35.78 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> R² </td>\n   <td style=\"text-align:right;\"> 0.40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Adj. R² </td>\n   <td style=\"text-align:right;\"> 0.38 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Est. </th>\n   <th style=\"text-align:right;\"> S.E. </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 7.32 </td>\n   <td style=\"text-align:right;\"> 1.73 </td>\n   <td style=\"text-align:right;\"> 4.24 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> bdi.pre </td>\n   <td style=\"text-align:right;\"> 0.57 </td>\n   <td style=\"text-align:right;\"> 0.05 </td>\n   <td style=\"text-align:right;\"> 10.44 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> time </td>\n   <td style=\"text-align:right;\"> -0.94 </td>\n   <td style=\"text-align:right;\"> 0.24 </td>\n   <td style=\"text-align:right;\"> -3.97 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> treatmentBtheB </td>\n   <td style=\"text-align:right;\"> -3.32 </td>\n   <td style=\"text-align:right;\"> 1.10 </td>\n   <td style=\"text-align:right;\"> -3.02 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> drugYes </td>\n   <td style=\"text-align:right;\"> -3.57 </td>\n   <td style=\"text-align:right;\"> 1.15 </td>\n   <td style=\"text-align:right;\"> -3.11 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> length&gt;6m </td>\n   <td style=\"text-align:right;\"> 1.71 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.54 </td>\n   <td style=\"text-align:right;\"> 0.12 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: OLS</td></tr></tfoot>\n</table>\n`````\n:::\n:::\n\n\n#### Random intercept but fixed slope\n\nLet us start with a model with a random intercept but fixed slope. In this case, the resulting regression line for each individual is parallel (for fixed slope) but have different intercepts (for random intercept).\n\n\n::: {.cell hash='longitudinal1_cache/html/random_76a4541fbfdfd38e369eb754646159d6'}\n\n```{.r .cell-code}\n## Fit a random intercept model with lme4 package\nlibrary(\"lme4\")\nBtheB_lmer1 <- lmer(bdi ~ bdi.pre + time + treatment + drug +length \n                    + (1 | subject), data = BtheB_long, \n                    REML = FALSE, na.action = na.omit)\n\nsummary(BtheB_lmer1)\n#> Linear mixed model fit by maximum likelihood  ['lmerMod']\n#> Formula: bdi ~ bdi.pre + time + treatment + drug + length + (1 | subject)\n#>    Data: BtheB_long\n#> \n#>       AIC       BIC    logLik -2*log(L)  df.resid \n#>    1887.5    1916.6    -935.7    1871.5       272 \n#> \n#> Scaled residuals: \n#>     Min      1Q  Median      3Q     Max \n#> -2.6975 -0.5026 -0.0638  0.4124  3.8203 \n#> \n#> Random effects:\n#>  Groups   Name        Variance Std.Dev.\n#>  subject  (Intercept) 48.78    6.984   \n#>  Residual             25.14    5.014   \n#> Number of obs: 280, groups:  subject, 97\n#> \n#> Fixed effects:\n#>                Estimate Std. Error t value\n#> (Intercept)     5.59239    2.24244   2.494\n#> bdi.pre         0.63968    0.07789   8.212\n#> time           -0.70476    0.14639  -4.814\n#> treatmentBtheB -2.32908    1.67036  -1.394\n#> drugYes        -2.82495    1.72684  -1.636\n#> length>6m       0.19708    1.63832   0.120\n#> \n#> Correlation of Fixed Effects:\n#>             (Intr) bdi.pr time   trtmBB drugYs\n#> bdi.pre     -0.682                            \n#> time        -0.238  0.020                     \n#> tretmntBthB -0.390  0.121  0.018              \n#> drugYes     -0.073 -0.237 -0.022 -0.323       \n#> length>6m   -0.243 -0.242 -0.036  0.002  0.157\nsumm(BtheB_lmer1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 280 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> bdi </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> Mixed effects linear regression </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> AIC </td>\n   <td style=\"text-align:right;\"> 1887.49 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> BIC </td>\n   <td style=\"text-align:right;\"> 1916.57 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (fixed effects) </td>\n   <td style=\"text-align:right;\"> 0.39 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (total) </td>\n   <td style=\"text-align:right;\"> 0.79 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n<tr><th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"6\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Fixed Effects</div></th></tr>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Est. </th>\n   <th style=\"text-align:right;\"> S.E. </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> d.f. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 5.59 </td>\n   <td style=\"text-align:right;\"> 2.24 </td>\n   <td style=\"text-align:right;\"> 2.49 </td>\n   <td style=\"text-align:right;\"> 108.98 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> bdi.pre </td>\n   <td style=\"text-align:right;\"> 0.64 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n   <td style=\"text-align:right;\"> 8.21 </td>\n   <td style=\"text-align:right;\"> 104.08 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> time </td>\n   <td style=\"text-align:right;\"> -0.70 </td>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> -4.81 </td>\n   <td style=\"text-align:right;\"> 199.32 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> treatmentBtheB </td>\n   <td style=\"text-align:right;\"> -2.33 </td>\n   <td style=\"text-align:right;\"> 1.67 </td>\n   <td style=\"text-align:right;\"> -1.39 </td>\n   <td style=\"text-align:right;\"> 97.12 </td>\n   <td style=\"text-align:right;\"> 0.17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> drugYes </td>\n   <td style=\"text-align:right;\"> -2.82 </td>\n   <td style=\"text-align:right;\"> 1.73 </td>\n   <td style=\"text-align:right;\"> -1.64 </td>\n   <td style=\"text-align:right;\"> 98.20 </td>\n   <td style=\"text-align:right;\"> 0.11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> length&gt;6m </td>\n   <td style=\"text-align:right;\"> 0.20 </td>\n   <td style=\"text-align:right;\"> 1.64 </td>\n   <td style=\"text-align:right;\"> 0.12 </td>\n   <td style=\"text-align:right;\"> 100.26 </td>\n   <td style=\"text-align:right;\"> 0.90 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup>  p values calculated using Satterthwaite d.f. </td></tr></tfoot>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n<tr><th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Random Effects</div></th></tr>\n  <tr>\n   <th> Group </th>\n   <th> Parameter </th>\n   <th> Std. Dev. </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td> subject </td>\n   <td> (Intercept) </td>\n   <td> 6.98 </td>\n  </tr>\n  <tr>\n   <td> Residual </td>\n   <td>  </td>\n   <td> 5.01 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n<tr><th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Grouping Variables</div></th></tr>\n  <tr>\n   <th> Group </th>\n   <th> # groups </th>\n   <th> ICC </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td> subject </td>\n   <td> 97 </td>\n   <td> 0.66 </td>\n  </tr>\n</tbody>\n</table>\n`````\n:::\n:::\n\n\n::: callout-important\n-   AIC, BIC, and -loglik etc are goodness-of-fit statistics, which tells you how well the model fits your data. Since there is no standard to tell what values of these statistics are good, without comparison with other models, they have little information to tell.\n\n-   Fixed effects: this is the standard output we will have in any fixed-effect model. The interpretation of estimated coefficients will be similar to a regular linear model.\n\n-   You may compare the outputs with the regular linear model, then you will find that **lm** tends to **underestimate** the SE for estimated coefficients.\n:::\n\n\n::: {.cell hash='longitudinal1_cache/html/random2_217ae8cee45db2c04c675c6d73b0faea'}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nBtheB_longna <- na.omit(BtheB_long)\ndat <- data.frame(time=BtheB_longna$time,pred=fitted(BtheB_lmer1),\n                  Subject= BtheB_longna$subject)\nggplot(data=dat,aes(x=time, y=pred, group=Subject, \n                    color=Subject)) + theme_classic() +\n    geom_line() \n```\n\n::: {.cell-output-display}\n![](longitudinal1_files/figure-html/random2-1.png){width=672}\n:::\n:::\n\n\nAs we can see, for each individual, we have different intercepts but the slope over follow-up time is the same. Next, we will fit the model with random intercept and random slope.\n\n#### Random intercept and random slope\n\nIn the codes below, we fitted a mixed effects model with both random intercept and random slope:\n\n\n::: {.cell hash='longitudinal1_cache/html/random3_6050327661a81a02013ab346f1a3081f'}\n\n```{.r .cell-code}\n## We can fit a random slope and intercept model using lme4 package and treat variable time as random slope. \nlibrary(\"lme4\")\nBtheB_lmer2 <- lmer(bdi ~ bdi.pre + time + treatment + drug +length + \n                   (time | subject), data = BtheB_long, REML = FALSE, \n                   na.action = na.omit)\n\nsumm(BtheB_lmer2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 280 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> bdi </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> Mixed effects linear regression </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> AIC </td>\n   <td style=\"text-align:right;\"> 1891.04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> BIC </td>\n   <td style=\"text-align:right;\"> 1927.39 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (fixed effects) </td>\n   <td style=\"text-align:right;\"> 0.39 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (total) </td>\n   <td style=\"text-align:right;\"> 0.80 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n<tr><th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"6\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Fixed Effects</div></th></tr>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Est. </th>\n   <th style=\"text-align:right;\"> S.E. </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> d.f. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 5.61 </td>\n   <td style=\"text-align:right;\"> 2.25 </td>\n   <td style=\"text-align:right;\"> 2.50 </td>\n   <td style=\"text-align:right;\"> 106.79 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> bdi.pre </td>\n   <td style=\"text-align:right;\"> 0.64 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n   <td style=\"text-align:right;\"> 8.25 </td>\n   <td style=\"text-align:right;\"> 102.78 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> time </td>\n   <td style=\"text-align:right;\"> -0.70 </td>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> -4.56 </td>\n   <td style=\"text-align:right;\"> 57.69 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> treatmentBtheB </td>\n   <td style=\"text-align:right;\"> -2.38 </td>\n   <td style=\"text-align:right;\"> 1.67 </td>\n   <td style=\"text-align:right;\"> -1.42 </td>\n   <td style=\"text-align:right;\"> 97.12 </td>\n   <td style=\"text-align:right;\"> 0.16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> drugYes </td>\n   <td style=\"text-align:right;\"> -2.87 </td>\n   <td style=\"text-align:right;\"> 1.73 </td>\n   <td style=\"text-align:right;\"> -1.66 </td>\n   <td style=\"text-align:right;\"> 98.18 </td>\n   <td style=\"text-align:right;\"> 0.10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> length&gt;6m </td>\n   <td style=\"text-align:right;\"> 0.14 </td>\n   <td style=\"text-align:right;\"> 1.64 </td>\n   <td style=\"text-align:right;\"> 0.09 </td>\n   <td style=\"text-align:right;\"> 100.04 </td>\n   <td style=\"text-align:right;\"> 0.93 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup>  p values calculated using Satterthwaite d.f. </td></tr></tfoot>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n<tr><th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Random Effects</div></th></tr>\n  <tr>\n   <th> Group </th>\n   <th> Parameter </th>\n   <th> Std. Dev. </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td> subject </td>\n   <td> (Intercept) </td>\n   <td> 7.12 </td>\n  </tr>\n  <tr>\n   <td> subject </td>\n   <td> time </td>\n   <td> 0.43 </td>\n  </tr>\n  <tr>\n   <td> Residual </td>\n   <td>  </td>\n   <td> 4.90 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n<tr><th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Grouping Variables</div></th></tr>\n  <tr>\n   <th> Group </th>\n   <th> # groups </th>\n   <th> ICC </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td> subject </td>\n   <td> 97 </td>\n   <td> 0.68 </td>\n  </tr>\n</tbody>\n</table>\n`````\n:::\n:::\n\n\nThe interpretation of the model outputs will be similar to the model with only random intercepts. Let us plot the data:\n\n\n::: {.cell hash='longitudinal1_cache/html/random5_cc87e90d75a3734b7bd9200210498a02'}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nBtheB_longna <- na.omit(BtheB_long)\ndat <- data.frame(time=BtheB_longna$time,pred=fitted(BtheB_lmer2),\n                  Subject= BtheB_longna$subject)\nggplot(data=dat,aes(x=time, y=pred, group=Subject, color=Subject)) + \n  theme_classic() +\n    geom_line() \n```\n\n::: {.cell-output-display}\n![](longitudinal1_files/figure-html/random5-1.png){width=672}\n:::\n:::\n\n\nFrom the figure, we can see, we have different intercepts and different slopes over follow-up time for each individual.\n\n#### Choice among models\n\nA common question is to ask should I add random slope to our model or random intercept is good enough. We may want to compare the models in terms of AIC and BIC. Smaller values indicate a better model.\n\n-   **lm** usually will not be considered as a competitor of **lme** as they basically apply to different types of data.\n\n-   When choosing between random intercept and random slope, a quick solution is to fit all possible models then do likelihood ratio tests.\n\n-   For example, I am not sure whether I should use random intercept only or random intercept + random slope. I could fit both model, then do a likelihood ratio test:\n\n\n::: {.cell hash='longitudinal1_cache/html/model_22ffdd3681dfb4ca3f24273ae2a0b7d9'}\n\n```{.r .cell-code}\nanova(BtheB_lmer1, BtheB_lmer2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"npar\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"AIC\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BIC\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"logLik\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"-2*log(L)\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Chisq\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Df\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>Chisq)\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"8\",\"2\":\"1887.492\",\"3\":\"1916.570\",\"4\":\"-935.7460\",\"5\":\"1871.492\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"_rn_\":\"BtheB_lmer1\"},{\"1\":\"10\",\"2\":\"1891.038\",\"3\":\"1927.386\",\"4\":\"-935.5189\",\"5\":\"1871.038\",\"6\":\"0.4541645\",\"7\":\"2\",\"8\":\"0.7968552\",\"_rn_\":\"BtheB_lmer2\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n## The non-significant p-value shows that the second model is not \n## statistically different from the first model. Therefore, adding a \n## random slope is not necessary\n```\n:::\n\n\nThe p-value is greater than 0.05, which indicate that adding a random slope does not make the fitting significantly better. To keep the model simple, we may just use random intercept.\n\n### Prediction of Random Effects\n\n-   Ref: [@hothorn2014handbook] Section 12.5\n\nIf you have noticed in the R output of linear mixed effect model. Random effects are not estimated in the model.\n\n-   We could use the fitted model to predict random effects.\n\n-   Also, the predicted random effects can be used to examine the assumptions we have for linear mixed effect model.\n\nThe **ranef** function is used to predict the random effect in R\n\n\n::: {.cell hash='longitudinal1_cache/html/pred_956223a1a2a1dfcb862fdf962734b5a4'}\n\n```{.r .cell-code}\nqint <- ranef(BtheB_lmer1)$subject[[\"(Intercept)\"]]\nqint\n#>  [1] -16.36173411  -2.44276827  -3.81655251   3.05333928   3.45142248\n#>  [6]   7.76598376   2.72263773  -7.22484569   6.84680617  -1.02552084\n#> [11]   2.40417048   1.16611114  -8.55346533  -6.25844483  -2.26117896\n#> [16]  -5.23031336   2.52509381  -1.64263857  -1.07523649   3.93689163\n#> [21]   7.66903473 -16.38156595   1.74883174  -1.31871410  -9.02883854\n#> [26]  -2.75150756   2.38884151   2.72740404  -3.41918542   6.27519245\n#> [31]  -4.52154811  -8.67437225  -0.34470208  -0.63972054  -0.08927194\n#> [36]   7.61914282   2.91050412  -2.58455318   4.24637616 -16.01664364\n#> [41]   5.90993779   3.21014012  -7.04631398   3.09608824   4.71327710\n#> [46]  16.70161338   2.26241522   2.26584476  15.77002952   1.75410838\n#> [51]   6.18741474   1.99791717   0.56774362   4.04107968  10.72891321\n#> [56]  -1.54551028  -5.28330207   2.04552526   2.36472056  -1.56879952\n#> [61]   6.63565636   5.45929329  -4.19695096  -6.39632488  -2.21496288\n#> [66]  -0.95956136  -3.96021851   7.17628719  -1.41644518  -4.99763144\n#> [71]  -2.83374092  -1.28015494   8.79345988  -0.33213428   1.43146353\n#> [76]  -3.13316295  -6.52989461   2.51445573   5.93415004   3.42003755\n#> [81]   4.49954804   3.75178702  -6.44832897  12.88173218  -9.36110814\n#> [86]   2.02028152 -18.09960241  -6.53428535   5.06613705  -3.31816912\n#> [91]   7.26187445   0.03103101  -8.14350181  -4.89326763   2.92437698\n#> [96]   5.24835927  -5.96778945\n## predict random effects using the fitted model\n```\n:::\n\n\n### Check assumptions\n\nRemember, we have two assumptions in the linear mixed effect model with random intercept:\n\n-   error term follows normal distribution\n-   beta for subject $i$ follows normal distribution\n\nWe have predict the values of random effect and we could extract residuals from the fitted model. Therefore, we can use QQ-plot to check their normality\n\n\n::: {.cell hash='longitudinal1_cache/html/assumption_b868c68417cf5c5992f4d3fde7aa6b0f'}\n\n```{.r .cell-code}\n# Assumption 1\nqres <- residuals(BtheB_lmer1)\nqqnorm(qres, xlim = c(-3, 3), ylim = c(-20, 20), \n       ylab = \"Estimated residuals\",\n       main = \"Residuals\")\nqqline(qres)\n```\n\n::: {.cell-output-display}\n![](longitudinal1_files/figure-html/assumption-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\n# Assumption 2\nqint <- ranef(BtheB_lmer1)$subject[[\"(Intercept)\"]]\nqqnorm(qint, ylab = \"Estimated random intercepts\", \n       xlim = c(-3, 3), ylim = c(-20, 20),\n       main = \"Random intercepts\")\nqqline(qint)\n```\n\n::: {.cell-output-display}\n![](longitudinal1_files/figure-html/assumption-2.png){width=672}\n:::\n:::\n\n\nSince points are almost on the lines, we can say that the normality assumption is met.\n\n### Video content (optional)\n\n::: callout-tip\nFor those who prefer a video walkthrough, feel free to watch the video below, which offers a description of an earlier version of the above content.\n:::\n\n::: {style=\"position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;\"}\n<iframe src=\"https://www.youtube.com/embed/kocX69kMX0s\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;\" allowfullscreen>\n\n</iframe>\n:::\n\n### Reference\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}