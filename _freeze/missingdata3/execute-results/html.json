{
  "hash": "087dabe4a0ce506b90528f934fb7a238",
  "result": {
    "markdown": "## Missing in outcome {.unnumbered}\n\nThis section provides a theoretical background on the concept of Multiple Imputation and then Deletion (MID). It highlights the challenges of imputing dependent and exposure variables and introduces the idea of using auxiliary variables to aid imputation. The section also contrasts the results of traditional MI with MID, especially when the number of imputed datasets is high.\n\n-   Often researchers are reluctant to impute values in the **dependent variable** (and exposure variable). Particularly, for dependent variable, imputation might not help too much.\n-   However, if you have a good **auxiliary variable** (e.g., strongly correlated predictor, that are not used in the main analysis), often multiple imputation method can help. Use of auxiliary variables is one of the greatest strengths of MI methods.\n-   MI algorithm generally do not have any special treatment for dependent variable in its original form, and hence **ignoring dependent variable completely** may not be a good idea in many scenarios.\n-   Multiple imputation followed by deletion of imputed outcomes is known as **MID**. This is very popular, especially when you have high percentage missing values in the outcome variable (e.g., 20%-50%). For low missing % in outcome, the advantage can be minimal.\n-   We are extending this idea to deletion of **imputed exposures** as well (researchers are often reluctant to impute primary exposure of interest).\n-   Original MI and MID may result in similar results when m (**number of imputed datasets**) is higher.\n\n### Data\n\nIn the initial chunk, we load several packages that provide functions and tools necessary for the subsequent analysis. These packages facilitate multiple imputation, data visualization, and statistical modeling among other tasks.\n\n\n::: {.cell hash='missingdata3_cache/html/setup_08227ac9e9caef05eceb71c00b267c49'}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(mice)\nlibrary(DataExplorer)\nlibrary(VIM)\nlibrary(jtools)\nlibrary(survey)\nlibrary(mitools)\n```\n:::\n\n\nWe load the necessary data:\n\n\n::: {.cell hash='missingdata3_cache/html/load_5bb85f1ec1fffb3034338072cc99ed19'}\n\n```{.r .cell-code}\nload(\"Data/missingdata/NHANES17.RData\")\n```\n:::\n\n\nThe data is briefly inspected to understand its structure. An identifier column is added to uniquely identify each row or observation in the dataset.\n\n\n::: {.cell hash='missingdata3_cache/html/data1_5d62dfd9ad6e4bc02895a27cee0e07b9'}\n\n```{.r .cell-code}\nrequire(mice)\nnhanes2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"age\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"bmi\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"hyp\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"chl\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"20-39\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"_rn_\":\"1\"},{\"1\":\"40-59\",\"2\":\"22.7\",\"3\":\"no\",\"4\":\"187\",\"_rn_\":\"2\"},{\"1\":\"20-39\",\"2\":\"NA\",\"3\":\"no\",\"4\":\"187\",\"_rn_\":\"3\"},{\"1\":\"60-99\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"_rn_\":\"4\"},{\"1\":\"20-39\",\"2\":\"20.4\",\"3\":\"no\",\"4\":\"113\",\"_rn_\":\"5\"},{\"1\":\"60-99\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"184\",\"_rn_\":\"6\"},{\"1\":\"20-39\",\"2\":\"22.5\",\"3\":\"no\",\"4\":\"118\",\"_rn_\":\"7\"},{\"1\":\"20-39\",\"2\":\"30.1\",\"3\":\"no\",\"4\":\"187\",\"_rn_\":\"8\"},{\"1\":\"40-59\",\"2\":\"22.0\",\"3\":\"no\",\"4\":\"238\",\"_rn_\":\"9\"},{\"1\":\"40-59\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"_rn_\":\"10\"},{\"1\":\"20-39\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"_rn_\":\"11\"},{\"1\":\"40-59\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"_rn_\":\"12\"},{\"1\":\"60-99\",\"2\":\"21.7\",\"3\":\"no\",\"4\":\"206\",\"_rn_\":\"13\"},{\"1\":\"40-59\",\"2\":\"28.7\",\"3\":\"yes\",\"4\":\"204\",\"_rn_\":\"14\"},{\"1\":\"20-39\",\"2\":\"29.6\",\"3\":\"no\",\"4\":\"NA\",\"_rn_\":\"15\"},{\"1\":\"20-39\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"_rn_\":\"16\"},{\"1\":\"60-99\",\"2\":\"27.2\",\"3\":\"yes\",\"4\":\"284\",\"_rn_\":\"17\"},{\"1\":\"40-59\",\"2\":\"26.3\",\"3\":\"yes\",\"4\":\"199\",\"_rn_\":\"18\"},{\"1\":\"20-39\",\"2\":\"35.3\",\"3\":\"no\",\"4\":\"218\",\"_rn_\":\"19\"},{\"1\":\"60-99\",\"2\":\"25.5\",\"3\":\"yes\",\"4\":\"NA\",\"_rn_\":\"20\"},{\"1\":\"20-39\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"_rn_\":\"21\"},{\"1\":\"20-39\",\"2\":\"33.2\",\"3\":\"no\",\"4\":\"229\",\"_rn_\":\"22\"},{\"1\":\"20-39\",\"2\":\"27.5\",\"3\":\"no\",\"4\":\"131\",\"_rn_\":\"23\"},{\"1\":\"60-99\",\"2\":\"24.9\",\"3\":\"no\",\"4\":\"NA\",\"_rn_\":\"24\"},{\"1\":\"40-59\",\"2\":\"27.4\",\"3\":\"no\",\"4\":\"186\",\"_rn_\":\"25\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nnhanes2$id <- 1:nrow(nhanes2)\nnhanes2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"age\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"bmi\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"hyp\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"chl\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"id\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"20-39\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"1\",\"_rn_\":\"1\"},{\"1\":\"40-59\",\"2\":\"22.7\",\"3\":\"no\",\"4\":\"187\",\"5\":\"2\",\"_rn_\":\"2\"},{\"1\":\"20-39\",\"2\":\"NA\",\"3\":\"no\",\"4\":\"187\",\"5\":\"3\",\"_rn_\":\"3\"},{\"1\":\"60-99\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"4\",\"_rn_\":\"4\"},{\"1\":\"20-39\",\"2\":\"20.4\",\"3\":\"no\",\"4\":\"113\",\"5\":\"5\",\"_rn_\":\"5\"},{\"1\":\"60-99\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"184\",\"5\":\"6\",\"_rn_\":\"6\"},{\"1\":\"20-39\",\"2\":\"22.5\",\"3\":\"no\",\"4\":\"118\",\"5\":\"7\",\"_rn_\":\"7\"},{\"1\":\"20-39\",\"2\":\"30.1\",\"3\":\"no\",\"4\":\"187\",\"5\":\"8\",\"_rn_\":\"8\"},{\"1\":\"40-59\",\"2\":\"22.0\",\"3\":\"no\",\"4\":\"238\",\"5\":\"9\",\"_rn_\":\"9\"},{\"1\":\"40-59\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"10\",\"_rn_\":\"10\"},{\"1\":\"20-39\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"11\",\"_rn_\":\"11\"},{\"1\":\"40-59\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"12\",\"_rn_\":\"12\"},{\"1\":\"60-99\",\"2\":\"21.7\",\"3\":\"no\",\"4\":\"206\",\"5\":\"13\",\"_rn_\":\"13\"},{\"1\":\"40-59\",\"2\":\"28.7\",\"3\":\"yes\",\"4\":\"204\",\"5\":\"14\",\"_rn_\":\"14\"},{\"1\":\"20-39\",\"2\":\"29.6\",\"3\":\"no\",\"4\":\"NA\",\"5\":\"15\",\"_rn_\":\"15\"},{\"1\":\"20-39\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"16\",\"_rn_\":\"16\"},{\"1\":\"60-99\",\"2\":\"27.2\",\"3\":\"yes\",\"4\":\"284\",\"5\":\"17\",\"_rn_\":\"17\"},{\"1\":\"40-59\",\"2\":\"26.3\",\"3\":\"yes\",\"4\":\"199\",\"5\":\"18\",\"_rn_\":\"18\"},{\"1\":\"20-39\",\"2\":\"35.3\",\"3\":\"no\",\"4\":\"218\",\"5\":\"19\",\"_rn_\":\"19\"},{\"1\":\"60-99\",\"2\":\"25.5\",\"3\":\"yes\",\"4\":\"NA\",\"5\":\"20\",\"_rn_\":\"20\"},{\"1\":\"20-39\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"21\",\"_rn_\":\"21\"},{\"1\":\"20-39\",\"2\":\"33.2\",\"3\":\"no\",\"4\":\"229\",\"5\":\"22\",\"_rn_\":\"22\"},{\"1\":\"20-39\",\"2\":\"27.5\",\"3\":\"no\",\"4\":\"131\",\"5\":\"23\",\"_rn_\":\"23\"},{\"1\":\"60-99\",\"2\":\"24.9\",\"3\":\"no\",\"4\":\"NA\",\"5\":\"24\",\"_rn_\":\"24\"},{\"1\":\"40-59\",\"2\":\"27.4\",\"3\":\"no\",\"4\":\"186\",\"5\":\"25\",\"_rn_\":\"25\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n### Outcome and exposure has missing\n\nThis chunk focuses on identifying which rows have missing values in both the outcome and exposure variables. The outcome and exposure variables are crucial for the analysis, so understanding where they are missing is essential.\n\n\n::: {.cell hash='missingdata3_cache/html/miss0_49197055dc4e7e8643ea92fdf3c79987'}\n\n```{.r .cell-code}\n# assume outcome = bmi and exposure = chl \nnhanes2.excludingYA <- subset(nhanes2, !is.na(bmi) & !is.na(chl) )\nnhanes2.excludingYA # data without missing A and Y\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"age\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"bmi\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"hyp\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"chl\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"id\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"40-59\",\"2\":\"22.7\",\"3\":\"no\",\"4\":\"187\",\"5\":\"2\",\"_rn_\":\"2\"},{\"1\":\"20-39\",\"2\":\"20.4\",\"3\":\"no\",\"4\":\"113\",\"5\":\"5\",\"_rn_\":\"5\"},{\"1\":\"20-39\",\"2\":\"22.5\",\"3\":\"no\",\"4\":\"118\",\"5\":\"7\",\"_rn_\":\"7\"},{\"1\":\"20-39\",\"2\":\"30.1\",\"3\":\"no\",\"4\":\"187\",\"5\":\"8\",\"_rn_\":\"8\"},{\"1\":\"40-59\",\"2\":\"22.0\",\"3\":\"no\",\"4\":\"238\",\"5\":\"9\",\"_rn_\":\"9\"},{\"1\":\"60-99\",\"2\":\"21.7\",\"3\":\"no\",\"4\":\"206\",\"5\":\"13\",\"_rn_\":\"13\"},{\"1\":\"40-59\",\"2\":\"28.7\",\"3\":\"yes\",\"4\":\"204\",\"5\":\"14\",\"_rn_\":\"14\"},{\"1\":\"60-99\",\"2\":\"27.2\",\"3\":\"yes\",\"4\":\"284\",\"5\":\"17\",\"_rn_\":\"17\"},{\"1\":\"40-59\",\"2\":\"26.3\",\"3\":\"yes\",\"4\":\"199\",\"5\":\"18\",\"_rn_\":\"18\"},{\"1\":\"20-39\",\"2\":\"35.3\",\"3\":\"no\",\"4\":\"218\",\"5\":\"19\",\"_rn_\":\"19\"},{\"1\":\"20-39\",\"2\":\"33.2\",\"3\":\"no\",\"4\":\"229\",\"5\":\"22\",\"_rn_\":\"22\"},{\"1\":\"20-39\",\"2\":\"27.5\",\"3\":\"no\",\"4\":\"131\",\"5\":\"23\",\"_rn_\":\"23\"},{\"1\":\"40-59\",\"2\":\"27.4\",\"3\":\"no\",\"4\":\"186\",\"5\":\"25\",\"_rn_\":\"25\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# identify ids of subjects with missing A & Y \nnhanes2.excludingYA$id\n#>  [1]  2  5  7  8  9 13 14 17 18 19 22 23 25\n```\n:::\n\n\n### Impute as usual\n\nUsing the entire dataset, missing values are imputed. This is done by first initializing an imputation model and then performing the imputation to create multiple datasets where missing values are filled in. The result is a list of datasets with imputed values. That means, we impute Y and A for now, as well as other covariates with missing values.\n\n\n::: {.cell hash='missingdata3_cache/html/imp0_a3a306d4c82f322b52356c15e284d832'}\n\n```{.r .cell-code}\n# use full data to impute \nini <- mice(nhanes2, pri = FALSE)\nini$method\n#>      age      bmi      hyp      chl       id \n#>       \"\"    \"pmm\" \"logreg\"    \"pmm\"       \"\"\npred <- ini$predictorMatrix\npred\n#>     age bmi hyp chl id\n#> age   0   1   1   1  1\n#> bmi   1   0   1   1  1\n#> hyp   1   1   0   1  1\n#> chl   1   1   1   0  1\n#> id    1   1   1   1  0\npred[,\"id\"] <- 0 # as this is not a predictor\nm <- 5\nimp <- mice(data=nhanes2, m=m, maxit=3, seed=504007)\n#> \n#>  iter imp variable\n#>   1   1  bmi  hyp  chl\n#>   1   2  bmi  hyp  chl\n#>   1   3  bmi  hyp  chl\n#>   1   4  bmi  hyp  chl\n#>   1   5  bmi  hyp  chl\n#>   2   1  bmi  hyp  chl\n#>   2   2  bmi  hyp  chl\n#>   2   3  bmi  hyp  chl\n#>   2   4  bmi  hyp  chl\n#>   2   5  bmi  hyp  chl\n#>   3   1  bmi  hyp  chl\n#>   3   2  bmi  hyp  chl\n#>   3   3  bmi  hyp  chl\n#>   3   4  bmi  hyp  chl\n#>   3   5  bmi  hyp  chl\n# list format in m data\nimpdata <- mice::complete(imp, action = \"all\")\nimpdata # all IDs are present\n#> $`1`\n#>      age  bmi hyp chl id\n#> 1  20-39 20.4  no 187  1\n#> 2  40-59 22.7  no 187  2\n#> 3  20-39 27.4  no 187  3\n#> 4  60-99 25.5 yes 204  4\n#> 5  20-39 20.4  no 113  5\n#> 6  60-99 22.5 yes 184  6\n#> 7  20-39 22.5  no 118  7\n#> 8  20-39 30.1  no 187  8\n#> 9  40-59 22.0  no 238  9\n#> 10 40-59 20.4  no 199 10\n#> 11 20-39 27.5  no 199 11\n#> 12 40-59 26.3  no 284 12\n#> 13 60-99 21.7  no 206 13\n#> 14 40-59 28.7 yes 204 14\n#> 15 20-39 29.6  no 187 15\n#> 16 20-39 35.3 yes 204 16\n#> 17 60-99 27.2 yes 284 17\n#> 18 40-59 26.3 yes 199 18\n#> 19 20-39 35.3  no 218 19\n#> 20 60-99 25.5 yes 284 20\n#> 21 20-39 35.3 yes 184 21\n#> 22 20-39 33.2  no 229 22\n#> 23 20-39 27.5  no 131 23\n#> 24 60-99 24.9  no 218 24\n#> 25 40-59 27.4  no 186 25\n#> \n#> $`2`\n#>      age  bmi hyp chl id\n#> 1  20-39 28.7 yes 238  1\n#> 2  40-59 22.7  no 187  2\n#> 3  20-39 30.1  no 187  3\n#> 4  60-99 22.5 yes 218  4\n#> 5  20-39 20.4  no 113  5\n#> 6  60-99 20.4 yes 184  6\n#> 7  20-39 22.5  no 118  7\n#> 8  20-39 30.1  no 187  8\n#> 9  40-59 22.0  no 238  9\n#> 10 40-59 22.5 yes 238 10\n#> 11 20-39 26.3 yes 118 11\n#> 12 40-59 20.4  no 199 12\n#> 13 60-99 21.7  no 206 13\n#> 14 40-59 28.7 yes 204 14\n#> 15 20-39 29.6  no 187 15\n#> 16 20-39 24.9  no 238 16\n#> 17 60-99 27.2 yes 284 17\n#> 18 40-59 26.3 yes 199 18\n#> 19 20-39 35.3  no 218 19\n#> 20 60-99 25.5 yes 218 20\n#> 21 20-39 27.5  no 187 21\n#> 22 20-39 33.2  no 229 22\n#> 23 20-39 27.5  no 131 23\n#> 24 60-99 24.9  no 218 24\n#> 25 40-59 27.4  no 186 25\n#> \n#> $`3`\n#>      age  bmi hyp chl id\n#> 1  20-39 25.5  no 229  1\n#> 2  40-59 22.7  no 187  2\n#> 3  20-39 22.0  no 187  3\n#> 4  60-99 20.4  no 199  4\n#> 5  20-39 20.4  no 113  5\n#> 6  60-99 22.7  no 184  6\n#> 7  20-39 22.5  no 118  7\n#> 8  20-39 30.1  no 187  8\n#> 9  40-59 22.0  no 238  9\n#> 10 40-59 27.4  no 184 10\n#> 11 20-39 30.1  no 238 11\n#> 12 40-59 22.0  no 186 12\n#> 13 60-99 21.7  no 206 13\n#> 14 40-59 28.7 yes 204 14\n#> 15 20-39 29.6  no 229 15\n#> 16 20-39 22.0  no 118 16\n#> 17 60-99 27.2 yes 284 17\n#> 18 40-59 26.3 yes 199 18\n#> 19 20-39 35.3  no 218 19\n#> 20 60-99 25.5 yes 218 20\n#> 21 20-39 29.6  no 131 21\n#> 22 20-39 33.2  no 229 22\n#> 23 20-39 27.5  no 131 23\n#> 24 60-99 24.9  no 218 24\n#> 25 40-59 27.4  no 186 25\n#> \n#> $`4`\n#>      age  bmi hyp chl id\n#> 1  20-39 24.9  no 187  1\n#> 2  40-59 22.7  no 187  2\n#> 3  20-39 27.4  no 187  3\n#> 4  60-99 24.9 yes 206  4\n#> 5  20-39 20.4  no 113  5\n#> 6  60-99 22.5  no 184  6\n#> 7  20-39 22.5  no 118  7\n#> 8  20-39 30.1  no 187  8\n#> 9  40-59 22.0  no 238  9\n#> 10 40-59 26.3 yes 187 10\n#> 11 20-39 29.6  no 229 11\n#> 12 40-59 27.4  no 204 12\n#> 13 60-99 21.7  no 206 13\n#> 14 40-59 28.7 yes 204 14\n#> 15 20-39 29.6  no 186 15\n#> 16 20-39 35.3  no 184 16\n#> 17 60-99 27.2 yes 284 17\n#> 18 40-59 26.3 yes 199 18\n#> 19 20-39 35.3  no 218 19\n#> 20 60-99 25.5 yes 199 20\n#> 21 20-39 27.5  no 187 21\n#> 22 20-39 33.2  no 229 22\n#> 23 20-39 27.5  no 131 23\n#> 24 60-99 24.9  no 284 24\n#> 25 40-59 27.4  no 186 25\n#> \n#> $`5`\n#>      age  bmi hyp chl id\n#> 1  20-39 27.2  no 238  1\n#> 2  40-59 22.7  no 187  2\n#> 3  20-39 24.9  no 187  3\n#> 4  60-99 20.4  no 229  4\n#> 5  20-39 20.4  no 113  5\n#> 6  60-99 21.7  no 184  6\n#> 7  20-39 22.5  no 118  7\n#> 8  20-39 30.1  no 187  8\n#> 9  40-59 22.0  no 238  9\n#> 10 40-59 20.4 yes 187 10\n#> 11 20-39 25.5  no 118 11\n#> 12 40-59 21.7  no 187 12\n#> 13 60-99 21.7  no 206 13\n#> 14 40-59 28.7 yes 204 14\n#> 15 20-39 29.6  no 199 15\n#> 16 20-39 27.5  no 187 16\n#> 17 60-99 27.2 yes 284 17\n#> 18 40-59 26.3 yes 199 18\n#> 19 20-39 35.3  no 218 19\n#> 20 60-99 25.5 yes 206 20\n#> 21 20-39 33.2  no 206 21\n#> 22 20-39 33.2  no 229 22\n#> 23 20-39 27.5  no 131 23\n#> 24 60-99 24.9  no 204 24\n#> 25 40-59 27.4  no 186 25\n#> \n#> attr(,\"class\")\n#> [1] \"mild\" \"list\"\n```\n:::\n\n\n### Include a missing indicator (Y & A)\n\nFor each imputed dataset, a new column is added to indicate whether the outcome and exposure variables were originally missing. This \"missing indicator\" column will be used later to subset the data.\n\n\n::: {.cell hash='missingdata3_cache/html/imp1_afc1700e5506d36b9a424b599cce728e'}\n\n```{.r .cell-code}\n# Define formula (making binary Y)\nformula <- as.formula(\"I(bmi>25) ~ chl + hyp\")\ndata.list <- vector(\"list\", m)\n# subset the data without Y and A's that had missing values\n# and record those subset data\nfor (i in 1:m) {\n  analytic.i <- impdata[[i]]\n  analytic.i$miss <- 1\n  analytic.i$miss[analytic.i$id %in% nhanes2.excludingYA$id] <- 0\n  data.list[[i]] <- analytic.i\n}\ndata.list  # only relevant IDs are present\n#> [[1]]\n#>      age  bmi hyp chl id miss\n#> 1  20-39 20.4  no 187  1    1\n#> 2  40-59 22.7  no 187  2    0\n#> 3  20-39 27.4  no 187  3    1\n#> 4  60-99 25.5 yes 204  4    1\n#> 5  20-39 20.4  no 113  5    0\n#> 6  60-99 22.5 yes 184  6    1\n#> 7  20-39 22.5  no 118  7    0\n#> 8  20-39 30.1  no 187  8    0\n#> 9  40-59 22.0  no 238  9    0\n#> 10 40-59 20.4  no 199 10    1\n#> 11 20-39 27.5  no 199 11    1\n#> 12 40-59 26.3  no 284 12    1\n#> 13 60-99 21.7  no 206 13    0\n#> 14 40-59 28.7 yes 204 14    0\n#> 15 20-39 29.6  no 187 15    1\n#> 16 20-39 35.3 yes 204 16    1\n#> 17 60-99 27.2 yes 284 17    0\n#> 18 40-59 26.3 yes 199 18    0\n#> 19 20-39 35.3  no 218 19    0\n#> 20 60-99 25.5 yes 284 20    1\n#> 21 20-39 35.3 yes 184 21    1\n#> 22 20-39 33.2  no 229 22    0\n#> 23 20-39 27.5  no 131 23    0\n#> 24 60-99 24.9  no 218 24    1\n#> 25 40-59 27.4  no 186 25    0\n#> \n#> [[2]]\n#>      age  bmi hyp chl id miss\n#> 1  20-39 28.7 yes 238  1    1\n#> 2  40-59 22.7  no 187  2    0\n#> 3  20-39 30.1  no 187  3    1\n#> 4  60-99 22.5 yes 218  4    1\n#> 5  20-39 20.4  no 113  5    0\n#> 6  60-99 20.4 yes 184  6    1\n#> 7  20-39 22.5  no 118  7    0\n#> 8  20-39 30.1  no 187  8    0\n#> 9  40-59 22.0  no 238  9    0\n#> 10 40-59 22.5 yes 238 10    1\n#> 11 20-39 26.3 yes 118 11    1\n#> 12 40-59 20.4  no 199 12    1\n#> 13 60-99 21.7  no 206 13    0\n#> 14 40-59 28.7 yes 204 14    0\n#> 15 20-39 29.6  no 187 15    1\n#> 16 20-39 24.9  no 238 16    1\n#> 17 60-99 27.2 yes 284 17    0\n#> 18 40-59 26.3 yes 199 18    0\n#> 19 20-39 35.3  no 218 19    0\n#> 20 60-99 25.5 yes 218 20    1\n#> 21 20-39 27.5  no 187 21    1\n#> 22 20-39 33.2  no 229 22    0\n#> 23 20-39 27.5  no 131 23    0\n#> 24 60-99 24.9  no 218 24    1\n#> 25 40-59 27.4  no 186 25    0\n#> \n#> [[3]]\n#>      age  bmi hyp chl id miss\n#> 1  20-39 25.5  no 229  1    1\n#> 2  40-59 22.7  no 187  2    0\n#> 3  20-39 22.0  no 187  3    1\n#> 4  60-99 20.4  no 199  4    1\n#> 5  20-39 20.4  no 113  5    0\n#> 6  60-99 22.7  no 184  6    1\n#> 7  20-39 22.5  no 118  7    0\n#> 8  20-39 30.1  no 187  8    0\n#> 9  40-59 22.0  no 238  9    0\n#> 10 40-59 27.4  no 184 10    1\n#> 11 20-39 30.1  no 238 11    1\n#> 12 40-59 22.0  no 186 12    1\n#> 13 60-99 21.7  no 206 13    0\n#> 14 40-59 28.7 yes 204 14    0\n#> 15 20-39 29.6  no 229 15    1\n#> 16 20-39 22.0  no 118 16    1\n#> 17 60-99 27.2 yes 284 17    0\n#> 18 40-59 26.3 yes 199 18    0\n#> 19 20-39 35.3  no 218 19    0\n#> 20 60-99 25.5 yes 218 20    1\n#> 21 20-39 29.6  no 131 21    1\n#> 22 20-39 33.2  no 229 22    0\n#> 23 20-39 27.5  no 131 23    0\n#> 24 60-99 24.9  no 218 24    1\n#> 25 40-59 27.4  no 186 25    0\n#> \n#> [[4]]\n#>      age  bmi hyp chl id miss\n#> 1  20-39 24.9  no 187  1    1\n#> 2  40-59 22.7  no 187  2    0\n#> 3  20-39 27.4  no 187  3    1\n#> 4  60-99 24.9 yes 206  4    1\n#> 5  20-39 20.4  no 113  5    0\n#> 6  60-99 22.5  no 184  6    1\n#> 7  20-39 22.5  no 118  7    0\n#> 8  20-39 30.1  no 187  8    0\n#> 9  40-59 22.0  no 238  9    0\n#> 10 40-59 26.3 yes 187 10    1\n#> 11 20-39 29.6  no 229 11    1\n#> 12 40-59 27.4  no 204 12    1\n#> 13 60-99 21.7  no 206 13    0\n#> 14 40-59 28.7 yes 204 14    0\n#> 15 20-39 29.6  no 186 15    1\n#> 16 20-39 35.3  no 184 16    1\n#> 17 60-99 27.2 yes 284 17    0\n#> 18 40-59 26.3 yes 199 18    0\n#> 19 20-39 35.3  no 218 19    0\n#> 20 60-99 25.5 yes 199 20    1\n#> 21 20-39 27.5  no 187 21    1\n#> 22 20-39 33.2  no 229 22    0\n#> 23 20-39 27.5  no 131 23    0\n#> 24 60-99 24.9  no 284 24    1\n#> 25 40-59 27.4  no 186 25    0\n#> \n#> [[5]]\n#>      age  bmi hyp chl id miss\n#> 1  20-39 27.2  no 238  1    1\n#> 2  40-59 22.7  no 187  2    0\n#> 3  20-39 24.9  no 187  3    1\n#> 4  60-99 20.4  no 229  4    1\n#> 5  20-39 20.4  no 113  5    0\n#> 6  60-99 21.7  no 184  6    1\n#> 7  20-39 22.5  no 118  7    0\n#> 8  20-39 30.1  no 187  8    0\n#> 9  40-59 22.0  no 238  9    0\n#> 10 40-59 20.4 yes 187 10    1\n#> 11 20-39 25.5  no 118 11    1\n#> 12 40-59 21.7  no 187 12    1\n#> 13 60-99 21.7  no 206 13    0\n#> 14 40-59 28.7 yes 204 14    0\n#> 15 20-39 29.6  no 199 15    1\n#> 16 20-39 27.5  no 187 16    1\n#> 17 60-99 27.2 yes 284 17    0\n#> 18 40-59 26.3 yes 199 18    0\n#> 19 20-39 35.3  no 218 19    0\n#> 20 60-99 25.5 yes 206 20    1\n#> 21 20-39 33.2  no 206 21    1\n#> 22 20-39 33.2  no 229 22    0\n#> 23 20-39 27.5  no 131 23    0\n#> 24 60-99 24.9  no 204 24    1\n#> 25 40-59 27.4  no 186 25    0\n# record the fits from each data\n```\n:::\n\n\n### Design, subset and fit\n\nFor each imputed dataset, a statistical model is fitted. Before fitting, the data is structured to account for survey design features. Only rows without originally missing outcome and exposure values are used for model fitting. The results of the model fitting for each dataset are stored for later analysis.\n\n\n\n::: {.cell hash='missingdata3_cache/html/imp2_cf9d2dc3e2e58af451bec9c3fde2cb2f'}\n\n```{.r .cell-code}\nrequire(survey)\nfit.list <- vector(\"list\", 5)\nfor (i in 1:m) {\n  analytic.i <- data.list[[i]]\n  # assigning survey features = 1\n  w.design0 <- svydesign(id=~1, weights=~1,\n                        data=analytic.i)\n  w.design <- subset(w.design0, miss == 0)\n  fit <- svyglm(formula, design=w.design, family=binomial)\n  fit.list[[i]] <-  fit\n}\n```\n:::\n\n\n### Pooled results\n\nAfter fitting models to each imputed dataset, the results are combined or \"pooled\". This pooled result provides a more robust estimate by considering the variability across the imputed datasets.\n\n\n\n::: {.cell hash='missingdata3_cache/html/imp3_b425475ecdc5ba3380b95b058d6de9d0'}\n\n```{.r .cell-code}\nrequire(mitools)\npooled.estimates <- MIcombine(fit.list)\npooled.estimates\n#> Multiple imputation results:\n#>       MIcombine.default(fit.list)\n#>                  results         se\n#> (Intercept) -1.769918773 2.73723080\n#> chl          0.009747869 0.01499608\n#> hypyes      18.128613035 1.05775401\n\n# or you can do it this way\nbetas<-MIextract(fit.list,fun=coef)\nvars<-MIextract(fit.list, fun=vcov)\nsummary(MIcombine(betas,vars))\n#> Multiple imputation results:\n#>       MIcombine.default(betas, vars)\n#>                  results         se      (lower      upper) missInfo\n#> (Intercept) -1.769918773 2.73723080 -7.13479255  3.59495501      0 %\n#> chl          0.009747869 0.01499608 -0.01964391  0.03913964      0 %\n#> hypyes      18.128613035 1.05775401 16.05545326 20.20177281      0 %\n\n# report beta coef\nsum.pooled <- summary(pooled.estimates, digits = 2)\n#> Multiple imputation results:\n#>       MIcombine.default(fit.list)\n#>             results    se (lower upper) missInfo\n#> (Intercept) -1.7699 2.737  -7.13  3.595      0 %\n#> chl          0.0097 0.015  -0.02  0.039      0 %\n#> hypyes      18.1286 1.058  16.06 20.202      0 %\nsum.pooled\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"results\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"se\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"(lower\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"upper)\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"missInfo\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"-1.769918773\",\"2\":\"2.73723080\",\"3\":\"-7.13479255\",\"4\":\"3.59495501\",\"5\":\"0 %\",\"_rn_\":\"(Intercept)\"},{\"1\":\"0.009747869\",\"2\":\"0.01499608\",\"3\":\"-0.01964391\",\"4\":\"0.03913964\",\"5\":\"0 %\",\"_rn_\":\"chl\"},{\"1\":\"18.128613035\",\"2\":\"1.05775401\",\"3\":\"16.05545326\",\"4\":\"20.20177281\",\"5\":\"0 %\",\"_rn_\":\"hypyes\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n### Report OR\n\nThe pooled results are further processed to calculate and report odds ratios, which provide insights into the relationships between variables in the context of logistic regression.\n\n\n::: {.cell hash='missingdata3_cache/html/imp4_257fa3400e3e6b461af84a167f52f080'}\n\n```{.r .cell-code}\nsum.pooled.OR <- summary(pooled.estimates, logeffect=TRUE, digits = 2)\n#> Multiple imputation results:\n#>       MIcombine.default(fit.list)\n#>             results      se  (lower  upper) missInfo\n#> (Intercept) 1.7e-01 4.7e-01 8.0e-04 3.6e+01      0 %\n#> chl         1.0e+00 1.5e-02 9.8e-01 1.0e+00      0 %\n#> hypyes      7.5e+07 7.9e+07 9.4e+06 5.9e+08      0 %\nsum.pooled.OR\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"results\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"se\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"(lower\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"upper)\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"missInfo\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1.703468e-01\",\"2\":\"4.662786e-01\",\"3\":\"7.968911e-04\",\"4\":\"3.641406e+01\",\"5\":\"0 %\",\"_rn_\":\"(Intercept)\"},{\"1\":\"1.009796e+00\",\"2\":\"1.514297e-02\",\"3\":\"9.805478e-01\",\"4\":\"1.039916e+00\",\"5\":\"0 %\",\"_rn_\":\"chl\"},{\"1\":\"7.467180e+07\",\"2\":\"7.898439e+07\",\"3\":\"9.392793e+06\",\"4\":\"5.936336e+08\",\"5\":\"0 %\",\"_rn_\":\"hypyes\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nUsing publish package may be possible, but requires complicated process. Look for `publish.MIresult` (but this can be complicated).\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}