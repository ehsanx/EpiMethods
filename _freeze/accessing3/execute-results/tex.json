{
  "hash": "b373fec4ea15f330f6b3dacda17833e4",
  "result": {
    "markdown": "## Importing NHANES to R {.unnumbered}\n\nThis tutorial provides comprehensive instructions on accessing the National Health and Nutrition Examination Survey (NHANES) dataset from the US Centers for Disease Control and Prevention (CDC) website and importing it into the RStudio environment. It covers accessing NHANES Data:\n\n-   Directly from the CDC website: A step-by-step guide with accompanying images, illustrating how to navigate the CDC website, download the data, and interpret the accompanying codebook.\n-   Using R packages, specifically the nhanesA package: A concise guide on how to download and get summaries of the NHANES data using this R package.\n\n\n\n::: {.cell hash='accessing3_cache/pdf/setup_5063eb8e16657c645dd131d7206ed250'}\n\n```{.r .cell-code}\n# Load required packages\n#devtools::install_github(\"warnes/SASxport\")\nlibrary(SASxport)\nlibrary(foreign)\nlibrary(nhanesA)\nlibrary(knitr)\nrequire(DiagrammeR)\nrequire(DiagrammeRsvg)\nrequire(rsvg)\nlibrary(magrittr)\nlibrary(svglite)\nlibrary(png)\nuse.saved.chche <- TRUE\n```\n:::\n\n\n\n::: column-margin\nBefore installing a package from GitHub, it's better to check whether you installed the right version of [Rtools](https://cran.r-project.org/bin/windows/Rtools/)\n:::\n\n### Accessing NHANES Data Directly from the CDC website\n\nIn the following example, we will see how to download 'Demographics' data, and check associated variable in that dataset.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Images/accessing/n15.png){width=65%}\n:::\n:::\n\n\n\n::: column-margin\nNHANES 1999-2000 and onward survey datasets are publicly available at [wwwn.cdc.gov/nchs/nhanes/](https://wwwn.cdc.gov/nchs/nhanes/)\n:::\n\n-   **Step 1**: Say, for example, we are interested about the NHANES 2015-2016 survey. Clicking the associated link in the above Figure gets us to the page for the corresponding cycle (see below).\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Images/accessing/n15demo.png){width=65%}\n:::\n:::\n\n\n\n-   **Step 2**: There are various types of data available for this survey. Let's explore the demographic information from this cycle. These data are mostly available in the form of SAS `XPT` format (see below).\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Images/accessing/xptsasdata.png){width=65%}\n:::\n:::\n\n\n\n-   **Step 3**: We can download the XPT data in the local PC folder and read the data into R as as follows:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDEMO <- read.xport(\"Data/accessing/DEMO_I.XPT\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n\n-   **Step 4**: Once data is imported in RStudio, we will see the `DEMO` object listed under data window (see below):\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Images/accessing/rdata.png){width=65%}\n:::\n:::\n\n\n\n-   **Step 5**: We can also check the variable names in this `DEMO` dataset as follows:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(DEMO)\n#>  [1] \"SEQN\"     \"SDDSRVYR\" \"RIDSTATR\" \"RIAGENDR\" \"RIDAGEYR\" \"RIDAGEMN\"\n#>  [7] \"RIDRETH1\" \"RIDRETH3\" \"RIDEXMON\" \"RIDEXAGM\" \"DMQMILIZ\" \"DMQADFC\" \n#> [13] \"DMDBORN4\" \"DMDCITZN\" \"DMDYRSUS\" \"DMDEDUC3\" \"DMDEDUC2\" \"DMDMARTL\"\n#> [19] \"RIDEXPRG\" \"SIALANG\"  \"SIAPROXY\" \"SIAINTRP\" \"FIALANG\"  \"FIAPROXY\"\n#> [25] \"FIAINTRP\" \"MIALANG\"  \"MIAPROXY\" \"MIAINTRP\" \"AIALANGA\" \"DMDHHSIZ\"\n#> [31] \"DMDFMSIZ\" \"DMDHHSZA\" \"DMDHHSZB\" \"DMDHHSZE\" \"DMDHRGND\" \"DMDHRAGE\"\n#> [37] \"DMDHRBR4\" \"DMDHREDU\" \"DMDHRMAR\" \"DMDHSEDU\" \"WTINT2YR\" \"WTMEC2YR\"\n#> [43] \"SDMVPSU\"  \"SDMVSTRA\" \"INDHHIN2\" \"INDFMIN2\" \"INDFMPIR\"\n```\n:::\n\n\n\n-   **Step 6**: We can open the data in RStudio in the dataview window (by clicking the `DEMO` data from the data window). The next Figure shows only a few columns and rows from this large dataset. Note that there are some values marked as \"NA\", which represents missing values.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Images/accessing/dataview.png){width=99%}\n:::\n:::\n\n\n\n-   **Step 7**: There is a column name associated with each column, e.g., `DMDHSEDU` in the first column in the above Figure. To understand what the column names mean in this Figure, we need to take a look at the codebook. To access codebook, click the `'DEMO|Doc'` link (in step 2). This will show the data documentation and associated codebook (see the next Figure).\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Images/accessing/toc.png){width=65%}\n:::\n:::\n\n\n\n-   **Step 8**: We can see a link for the column or variable `DMDHSEDU` in the table of content (in the above Figure). Clicking that link will provide us further information about what this variable means (see the next Figure).\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Images/accessing/DMDHSEDU.png){width=85%}\n:::\n:::\n\n\n\n-   **Step 9**: We can assess if the numbers reported under count and cumulative (from the above Figure) matches with what we get from the `DEMO` data we just imported (particularly, for the `DMDHSEDU` variable):\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(DEMO$DMDHSEDU) # Frequency table\n#> \n#>    1    2    3    4    5    7    9 \n#>  619  511  980 1462 1629    2   23\ncumsum(table(DEMO$DMDHSEDU)) # Cumulative frequency table\n#>    1    2    3    4    5    7    9 \n#>  619 1130 2110 3572 5201 5203 5226\nlength(is.na(DEMO$DMDHSEDU)) # Number of non-NA observations\n#> [1] 9971\n```\n:::\n\n\n\n### Accessing NHANES Data Using R Packages\n\n#### nhanesA package\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(nhanesA)\n```\n:::\n\n\n\n::: callout-tip\nR package `nhanesA` provides a convenient way to download and analyze NHANES survey data.\n:::\n\n::: column-margin\nRNHANES [@RNHANES] is another packages for downloading the NHANES data easily.\n:::\n\n-   **Step 1**: Witin the CDC website, NHANES data are available in 5 categories\n    -   Demographics (`DEMO`)\n    -   Dietary (`DIET`)\n    -   Examination (`EXAM`)\n    -   Laboratory (`LAB`)\n    -   Questionnaire (`Q`)\n\nTo get a list of available variables within a data file, we run the following command (e.g., we check variable names within `DEMO` data):\n\n\n\n::: {.cell hash='accessing3_cache/pdf/search_fec05958b7d1a8f09fe6845f51bf8874'}\n\n```{.r .cell-code}\nnhanesTables(data_group='DEMO', year=2015)\n#>   Data.File.Name                    Data.File.Description\n#> 1         DEMO_I Demographic Variables and Sample Weights\n```\n:::\n\n\n\n-   **Step 2**: We can obtain the summaries of the downloaded data as follows (see below):\n\n\n\n::: {.cell hash='accessing3_cache/pdf/search3_64508caa6f9933ffe9c4db9ad2137fe1'}\n\n```{.r .cell-code}\ndemo <- nhanes('DEMO_I')\nnames(demo)\n#>  [1] \"SEQN\"     \"SDDSRVYR\" \"RIDSTATR\" \"RIAGENDR\" \"RIDAGEYR\" \"RIDAGEMN\"\n#>  [7] \"RIDRETH1\" \"RIDRETH3\" \"RIDEXMON\" \"RIDEXAGM\" \"DMQMILIZ\" \"DMQADFC\" \n#> [13] \"DMDBORN4\" \"DMDCITZN\" \"DMDYRSUS\" \"DMDEDUC3\" \"DMDEDUC2\" \"DMDMARTL\"\n#> [19] \"RIDEXPRG\" \"SIALANG\"  \"SIAPROXY\" \"SIAINTRP\" \"FIALANG\"  \"FIAPROXY\"\n#> [25] \"FIAINTRP\" \"MIALANG\"  \"MIAPROXY\" \"MIAINTRP\" \"AIALANGA\" \"DMDHHSIZ\"\n#> [31] \"DMDFMSIZ\" \"DMDHHSZA\" \"DMDHHSZB\" \"DMDHHSZE\" \"DMDHRGND\" \"DMDHRAGE\"\n#> [37] \"DMDHRBR4\" \"DMDHREDU\" \"DMDHRMAR\" \"DMDHSEDU\" \"WTINT2YR\" \"WTMEC2YR\"\n#> [43] \"SDMVPSU\"  \"SDMVSTRA\" \"INDHHIN2\" \"INDFMIN2\" \"INDFMPIR\"\ntable(demo$DMDHSEDU) # Frequency table\n#> \n#>    1    2    3    4    5    7    9 \n#>  619  511  980 1462 1629    2   23\ncumsum(table(demo$DMDHSEDU)) # Cumulative frequency table\n#>    1    2    3    4    5    7    9 \n#>  619 1130 2110 3572 5201 5203 5226\nlength(is.na(demo$DMDHSEDU)) # Number of non-NA observations\n#> [1] 9971\n```\n:::\n\n\n\n### Import data issue\nSometimes, you might see a warning message when downloading NHANES data using an R package. For example, simpleWarning in download.file(url, tf, mode = \"wb\", quiet = TRUE): cannot open URL, or 404 data Not Found.\n\nThe possible reason could be the NHANES server was down when you tried to connect. In that case, try later with the same codes. Also, check the name of the variables carefully. The name of the same variable could be different in different survey cycles. It is also possible that some variables are not available in all cycles.  \n\n### References\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}