{
  "hash": "fba0954745e3a432ca3085a47e68be7e",
  "result": {
    "engine": "knitr",
    "markdown": "## PSM in BMI-diabetes {.unnumbered}\n\n\n\n### Propensity analysis problem\n\n-   Perform a **propensity score matching** (pair matching, without replacement, using SMD cut-point 0.2, may adjust for imbalanced and/or all covariates in the outcome model, if any) analysis as per the following recommendations\n    -   @zanutto2006comparison\n    -   @dugoff2014generalizing\n    -   @austin2018propensity\n\nSee explained in the previous chapter on [PSM in OA-CVD (US)](propensityscore3.html), there are four steps of the propensity score matching:\n\n-   Step 1: PS model specification\n-   Step 2: Matching based on the estimated propensity scores\n-   Step 3: Balance checking\n-   Step 4: Outcome modelling\n\nOnly Step 1 is different for Zanutto (2006), DuGoff et al. (2014), and Austin et al. (2018) approaches.\n\n#### Dataset\n\n-   The following modified NHANES dataset\n    -   NHANES15lab5.RData\n-   use the data set \"analytic.with.miss\" within this file.\n    -   for obtaining the final treatment effect estimates, you can omit missing values, but only after creating the design (e.g., subset the design, not the data itself directly).\n\n#### Variables\n\n-   Outcome: diabetes\n    -   'No' as the reference category\n-   Exposure: bmi\n    -   convert to binary with \\>25 vs. \\<= 25,\n    -   with \\> 25 as the reference category\n-   Confounder list:\n    -   gender\n    -   age\n        -   assume continuous\n    -   race\n    -   income\n    -   education\n    -   married\n    -   cholesterol\n    -   diastolicBP\n    -   systolicBP\n-   Mediator:\n    -   physical.work\n        -   'No' as the reference category\n-   Survey features\n    -   psu\n    -   strata\n    -   weight\n\n### Pre-processing\n\n#### Load data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(file=\"Data/propensityscore/NHANES15lab5.RData\")\n```\n:::\n\n\n#### Variable summary\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Exposure\nanalytic.with.miss$bmi <- with(analytic.with.miss, \n                                   ifelse(bmi>25, \"Overweight\", \n                                          ifelse(bmi<=25, \"Not overweight\", NA)))\nanalytic.with.miss$bmi <- as.factor(analytic.with.miss$bmi)\nanalytic.with.miss$bmi <- relevel(analytic.with.miss$bmi, ref = \"Overweight\")\n\n# Drop unnecessary variables \nanalytic.with.miss$born <- NULL\nanalytic.with.miss$physical.work <- NULL\n\n# Rename the weight variable into interview.weight\nnames(analytic.with.miss)[names(analytic.with.miss) == \"weight\"] <- \"interview.weight\"\n```\n:::\n\n\n#### Reproducibility\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(504)\n```\n:::\n\n\n### Approach by Zanutto (2006)\n\n#### Step 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Specify the PS model to estimate propensity scores\nps.formula <- as.formula(I(bmi==\"Not overweight\") ~ gender + age + race + income + education + \n                           married + cholesterol + diastolicBP + systolicBP)\n```\n:::\n\n\n#### Step 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(MatchIt)\n# Complete data for matching\nanalytic.data <- analytic.with.miss[complete.cases(analytic.with.miss),]\n\n# Create a missing variable in the original dataset\nanalytic.with.miss$miss <- 1\nanalytic.with.miss$miss[analytic.with.miss$ID %in% analytic.data$ID] <- 0\n\n# Propensity scores\nps.fit <- glm(ps.formula, data = analytic.data, family = binomial(\"logit\"))\nanalytic.data$PS <- predict(ps.fit, type = \"response\", newdata = analytic.data)\n\n# Caliper fixing to 0.2*sd(logit of PS)\ncaliper <- 0.2*sd(log(analytic.data$PS/(1-analytic.data$PS)))\n\n# Match exposed and unexposed subjects \nmatch.obj <- matchit(ps.formula, data = analytic.data,\n                     distance = analytic.data$PS, \n                     method = \"nearest\", \n                     replace = FALSE,\n                     caliper = caliper, \n                     ratio = 1)\nanalytic.data$PS <- match.obj$distance\n\n# Extract matched data\nmatched.data <- match.data(match.obj) \n```\n:::\n\n\n#### Step 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Balance checking\ncov <- c(\"gender\", \"age\", \"race\", \"income\", \n         \"education\", \"married\", \"cholesterol\", \n         \"diastolicBP\", \"systolicBP\")\n\ntab1m <- CreateTableOne(strata = \"bmi\", vars = cov, data = matched.data, test = F)\nprint(tab1m, smd = TRUE)\n#>                          Stratified by bmi\n#>                           Overweight     Not overweight SMD   \n#>   n                         2047           2047               \n#>   gender = Male (%)          987 (48.2)     993 (48.5)   0.006\n#>   age (mean (SD))          46.96 (17.55)  46.35 (17.64)  0.035\n#>   race (%)                                               0.041\n#>      Black                   452 (22.1)     424 (20.7)        \n#>      Hispanic                558 (27.3)     584 (28.5)        \n#>      Other                   328 (16.0)     338 (16.5)        \n#>      White                   709 (34.6)     701 (34.2)        \n#>   income (%)                                             0.042\n#>      <25k                    537 (26.2)     509 (24.9)        \n#>      Between.25kto54k        670 (32.7)     661 (32.3)        \n#>      Between.55kto99k        472 (23.1)     484 (23.6)        \n#>      Over100k                368 (18.0)     393 (19.2)        \n#>   education (%)                                          0.023\n#>      College                1199 (58.6)    1202 (58.7)        \n#>      High.School             667 (32.6)     652 (31.9)        \n#>      School                  181 ( 8.8)     193 ( 9.4)        \n#>   married (%)                                            0.036\n#>      Married                1215 (59.4)    1243 (60.7)        \n#>      Never.married           402 (19.6)     374 (18.3)        \n#>      Previously.married      430 (21.0)     430 (21.0)        \n#>   cholesterol (mean (SD)) 176.45 (39.57) 174.62 (38.70)  0.047\n#>   diastolicBP (mean (SD))  64.97 (13.65)  64.19 (13.47)  0.057\n#>   systolicBP (mean (SD))  118.07 (15.23) 116.19 (17.60)  0.114\n```\n:::\n\n\nAll SMDs are less than your specified cut-point? If yes, that indicates that there is good covariate balancing.\n\n#### Step 4\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(survey)\n# Setup the design with survey features\nanalytic.with.miss$matched <- 0\nanalytic.with.miss$matched[analytic.with.miss$ID %in% matched.data$ID] <- 1\n\n# Survey setup for full data\nw.design0 <- svydesign(strata = ~strata, id = ~psu, weights = ~interview.weight, \n                      data = analytic.with.miss, nest = TRUE)\n\n# Subset matched data\nw.design.m <- subset(w.design0, matched == 1)\n\n# Outcome model\nout.formula <- as.formula(I(diabetes == \"Yes\") ~ bmi)\nfit <- svyglm(out.formula, design = w.design.m, family = binomial(\"logit\"))\nrequire(jtools)\nsumm(fit, exp = TRUE, confint = TRUE, digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 4094 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> I(diabetes == \"Yes\") </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> Survey-weighted generalized linear model </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Family </td>\n   <td style=\"text-align:right;\"> binomial </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Link </td>\n   <td style=\"text-align:right;\"> logit </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (Cragg-Uhler) </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (McFadden) </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> AIC </td>\n   <td style=\"text-align:right;\"> 2336.725 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> exp(Est.) </th>\n   <th style=\"text-align:right;\"> 2.5% </th>\n   <th style=\"text-align:right;\"> 97.5% </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 0.165 </td>\n   <td style=\"text-align:right;\"> 0.141 </td>\n   <td style=\"text-align:right;\"> 0.195 </td>\n   <td style=\"text-align:right;\"> -21.678 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> bmiNot overweight </td>\n   <td style=\"text-align:right;\"> 0.245 </td>\n   <td style=\"text-align:right;\"> 0.173 </td>\n   <td style=\"text-align:right;\"> 0.346 </td>\n   <td style=\"text-align:right;\"> -7.980 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: Robust</td></tr></tfoot>\n</table>\n`````\n:::\n:::\n\n\n#### Double adjustment\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(survey)\n# Outcome model with covariates adjustment\nfit.DA <- svyglm(I(diabetes == \"Yes\") ~ bmi + gender + age + race + income + \n                 education + married + cholesterol + diastolicBP + systolicBP, \n               design = w.design.m, family = binomial(\"logit\"))\nsumm(fit.DA, exp = TRUE, confint = TRUE, digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 4094 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> I(diabetes == \"Yes\") </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> Survey-weighted generalized linear model </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Family </td>\n   <td style=\"text-align:right;\"> binomial </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Link </td>\n   <td style=\"text-align:right;\"> logit </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (Cragg-Uhler) </td>\n   <td style=\"text-align:right;\"> 0.212 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (McFadden) </td>\n   <td style=\"text-align:right;\"> 0.166 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> AIC </td>\n   <td style=\"text-align:right;\"> 2063.466 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> exp(Est.) </th>\n   <th style=\"text-align:right;\"> 2.5% </th>\n   <th style=\"text-align:right;\"> 97.5% </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.199 </td>\n   <td style=\"text-align:right;\"> -4.101 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> bmiNot overweight </td>\n   <td style=\"text-align:right;\"> 0.235 </td>\n   <td style=\"text-align:right;\"> 0.159 </td>\n   <td style=\"text-align:right;\"> 0.348 </td>\n   <td style=\"text-align:right;\"> -7.219 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> genderMale </td>\n   <td style=\"text-align:right;\"> 1.317 </td>\n   <td style=\"text-align:right;\"> 1.082 </td>\n   <td style=\"text-align:right;\"> 1.604 </td>\n   <td style=\"text-align:right;\"> 2.740 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> age </td>\n   <td style=\"text-align:right;\"> 1.051 </td>\n   <td style=\"text-align:right;\"> 1.044 </td>\n   <td style=\"text-align:right;\"> 1.059 </td>\n   <td style=\"text-align:right;\"> 13.280 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> raceHispanic </td>\n   <td style=\"text-align:right;\"> 0.896 </td>\n   <td style=\"text-align:right;\"> 0.649 </td>\n   <td style=\"text-align:right;\"> 1.237 </td>\n   <td style=\"text-align:right;\"> -0.665 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> raceOther </td>\n   <td style=\"text-align:right;\"> 1.158 </td>\n   <td style=\"text-align:right;\"> 0.565 </td>\n   <td style=\"text-align:right;\"> 2.374 </td>\n   <td style=\"text-align:right;\"> 0.401 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> raceWhite </td>\n   <td style=\"text-align:right;\"> 0.778 </td>\n   <td style=\"text-align:right;\"> 0.507 </td>\n   <td style=\"text-align:right;\"> 1.193 </td>\n   <td style=\"text-align:right;\"> -1.152 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> incomeBetween.25kto54k </td>\n   <td style=\"text-align:right;\"> 0.830 </td>\n   <td style=\"text-align:right;\"> 0.551 </td>\n   <td style=\"text-align:right;\"> 1.251 </td>\n   <td style=\"text-align:right;\"> -0.889 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> incomeBetween.55kto99k </td>\n   <td style=\"text-align:right;\"> 0.872 </td>\n   <td style=\"text-align:right;\"> 0.621 </td>\n   <td style=\"text-align:right;\"> 1.224 </td>\n   <td style=\"text-align:right;\"> -0.794 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> incomeOver100k </td>\n   <td style=\"text-align:right;\"> 0.669 </td>\n   <td style=\"text-align:right;\"> 0.418 </td>\n   <td style=\"text-align:right;\"> 1.072 </td>\n   <td style=\"text-align:right;\"> -1.669 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> educationHigh.School </td>\n   <td style=\"text-align:right;\"> 0.948 </td>\n   <td style=\"text-align:right;\"> 0.733 </td>\n   <td style=\"text-align:right;\"> 1.225 </td>\n   <td style=\"text-align:right;\"> -0.408 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> educationSchool </td>\n   <td style=\"text-align:right;\"> 0.872 </td>\n   <td style=\"text-align:right;\"> 0.448 </td>\n   <td style=\"text-align:right;\"> 1.695 </td>\n   <td style=\"text-align:right;\"> -0.405 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> marriedNever.married </td>\n   <td style=\"text-align:right;\"> 1.055 </td>\n   <td style=\"text-align:right;\"> 0.677 </td>\n   <td style=\"text-align:right;\"> 1.646 </td>\n   <td style=\"text-align:right;\"> 0.237 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> marriedPreviously.married </td>\n   <td style=\"text-align:right;\"> 0.849 </td>\n   <td style=\"text-align:right;\"> 0.534 </td>\n   <td style=\"text-align:right;\"> 1.348 </td>\n   <td style=\"text-align:right;\"> -0.694 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> cholesterol </td>\n   <td style=\"text-align:right;\"> 0.991 </td>\n   <td style=\"text-align:right;\"> 0.986 </td>\n   <td style=\"text-align:right;\"> 0.995 </td>\n   <td style=\"text-align:right;\"> -3.810 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> diastolicBP </td>\n   <td style=\"text-align:right;\"> 1.005 </td>\n   <td style=\"text-align:right;\"> 0.992 </td>\n   <td style=\"text-align:right;\"> 1.018 </td>\n   <td style=\"text-align:right;\"> 0.749 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> systolicBP </td>\n   <td style=\"text-align:right;\"> 1.003 </td>\n   <td style=\"text-align:right;\"> 0.993 </td>\n   <td style=\"text-align:right;\"> 1.012 </td>\n   <td style=\"text-align:right;\"> 0.559 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: Robust</td></tr></tfoot>\n</table>\n`````\n:::\n:::\n\n\n### Approach by DuGoff et al. (2014)\n\n#### Step 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Specify the PS model to estimate propensity scores\nps.formula2 <- as.formula(I(bmi == \"Not overweight\") ~ gender + age + race + income + education + \n                           married + cholesterol + diastolicBP + systolicBP + \n                           psu + strata + interview.weight)\n```\n:::\n\n\n#### Step 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Propensity scores\nps.fit2 <- glm(ps.formula2, data = analytic.data, family = binomial(\"logit\"))\nanalytic.data$PS2 <- fitted(ps.fit2)\n\n# Caliper fixing to 0.2*sd(logit of PS)\ncaliper2 <- 0.2*sd(log(analytic.data$PS2/(1-analytic.data$PS2)))\n\n# Match exposed and unexposed subjects \nset.seed(504)\nmatch.obj2 <- matchit(ps.formula2, data = analytic.data,\n                     distance = analytic.data$PS2, \n                     method = \"nearest\", \n                     replace = FALSE,\n                     caliper = caliper2, \n                     ratio = 1)\nanalytic.data$PS2 <- match.obj2$distance\n\n# Extract matched data\nmatched.data2 <- match.data(match.obj2) \n```\n:::\n\n\n#### Step 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Balance checking\ncov2 <- c(\"gender\", \"age\", \"race\", \"income\", \n          \"education\", \"married\", \"cholesterol\", \n         \"diastolicBP\", \"systolicBP\", \n         \"psu\", \"strata\", \"interview.weight\")\n\ntab1m2 <- CreateTableOne(strata = \"bmi\", vars = cov2, data = matched.data2, test = F)\nprint(tab1m2, smd = TRUE)\n#>                               Stratified by bmi\n#>                                Overweight          Not overweight      SMD   \n#>   n                                2037                2037                  \n#>   gender = Male (%)                 991 (48.6)          985 (48.4)      0.006\n#>   age (mean (SD))                 47.10 (17.50)       46.41 (17.72)     0.039\n#>   race (%)                                                              0.044\n#>      Black                          453 (22.2)          438 (21.5)           \n#>      Hispanic                       553 (27.1)          579 (28.4)           \n#>      Other                          324 (15.9)          342 (16.8)           \n#>      White                          707 (34.7)          678 (33.3)           \n#>   income (%)                                                            0.023\n#>      <25k                           522 (25.6)          522 (25.6)           \n#>      Between.25kto54k               679 (33.3)          662 (32.5)           \n#>      Between.55kto99k               471 (23.1)          473 (23.2)           \n#>      Over100k                       365 (17.9)          380 (18.7)           \n#>   education (%)                                                         0.007\n#>      College                       1199 (58.9)         1192 (58.5)           \n#>      High.School                    644 (31.6)          648 (31.8)           \n#>      School                         194 ( 9.5)          197 ( 9.7)           \n#>   married (%)                                                           0.018\n#>      Married                       1209 (59.4)         1224 (60.1)           \n#>      Never.married                  395 (19.4)          394 (19.3)           \n#>      Previously.married             433 (21.3)          419 (20.6)           \n#>   cholesterol (mean (SD))        176.73 (39.68)      174.82 (38.77)     0.049\n#>   diastolicBP (mean (SD))         65.16 (13.49)       64.39 (13.22)     0.057\n#>   systolicBP (mean (SD))         118.27 (15.07)      116.33 (17.57)     0.119\n#>   psu (mean (SD))                  1.49 (0.50)         1.49 (0.50)      0.008\n#>   strata (mean (SD))             126.39 (4.16)       126.27 (4.29)      0.029\n#>   interview.weight (mean (SD)) 38621.02 (34640.92) 37195.99 (36180.33)  0.040\n```\n:::\n\n\nAll SMDs are less than your specified cut-point? If yes, that indicates that there is good covariate balancing.\n\n#### Step 4\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Setup the design with survey features\nanalytic.with.miss$matched2 <- 0\nanalytic.with.miss$matched2[analytic.with.miss$ID %in% matched.data2$ID] <- 1\n\n# Survey setup for full data\nw.design02 <- svydesign(strata = ~strata, id = ~psu, weights = ~interview.weight, \n                       data = analytic.with.miss, nest = TRUE)\n\n# Subset matched data\nw.design.m2 <- subset(w.design02, matched2 == 1)\n\n# Outcome model\nout.formula <- as.formula(I(diabetes == \"Yes\") ~ bmi)\nfit2 <- svyglm(out.formula, design = w.design.m2, family = binomial(\"logit\"))\nsumm(fit2, exp = TRUE, confint = TRUE, digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 4074 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> I(diabetes == \"Yes\") </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> Survey-weighted generalized linear model </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Family </td>\n   <td style=\"text-align:right;\"> binomial </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Link </td>\n   <td style=\"text-align:right;\"> logit </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (Cragg-Uhler) </td>\n   <td style=\"text-align:right;\"> 0.083 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (McFadden) </td>\n   <td style=\"text-align:right;\"> 0.063 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> AIC </td>\n   <td style=\"text-align:right;\"> 2322.836 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> exp(Est.) </th>\n   <th style=\"text-align:right;\"> 2.5% </th>\n   <th style=\"text-align:right;\"> 97.5% </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 0.174 </td>\n   <td style=\"text-align:right;\"> 0.149 </td>\n   <td style=\"text-align:right;\"> 0.202 </td>\n   <td style=\"text-align:right;\"> -22.325 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> bmiNot overweight </td>\n   <td style=\"text-align:right;\"> 0.221 </td>\n   <td style=\"text-align:right;\"> 0.163 </td>\n   <td style=\"text-align:right;\"> 0.299 </td>\n   <td style=\"text-align:right;\"> -9.749 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: Robust</td></tr></tfoot>\n</table>\n`````\n:::\n:::\n\n\n#### Double adjustment\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Outcome model with covariates adjustment\nfit2.DA <- svyglm(I(diabetes == \"Yes\") ~ bmi + gender + age + race + income + \n                 education + married + cholesterol + diastolicBP + systolicBP, \n               design = w.design.m, family = binomial(\"logit\"))\nsumm(fit2.DA, exp = TRUE, confint = TRUE, digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 4094 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> I(diabetes == \"Yes\") </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> Survey-weighted generalized linear model </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Family </td>\n   <td style=\"text-align:right;\"> binomial </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Link </td>\n   <td style=\"text-align:right;\"> logit </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (Cragg-Uhler) </td>\n   <td style=\"text-align:right;\"> 0.212 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (McFadden) </td>\n   <td style=\"text-align:right;\"> 0.166 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> AIC </td>\n   <td style=\"text-align:right;\"> 2063.466 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> exp(Est.) </th>\n   <th style=\"text-align:right;\"> 2.5% </th>\n   <th style=\"text-align:right;\"> 97.5% </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.199 </td>\n   <td style=\"text-align:right;\"> -4.101 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> bmiNot overweight </td>\n   <td style=\"text-align:right;\"> 0.235 </td>\n   <td style=\"text-align:right;\"> 0.159 </td>\n   <td style=\"text-align:right;\"> 0.348 </td>\n   <td style=\"text-align:right;\"> -7.219 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> genderMale </td>\n   <td style=\"text-align:right;\"> 1.317 </td>\n   <td style=\"text-align:right;\"> 1.082 </td>\n   <td style=\"text-align:right;\"> 1.604 </td>\n   <td style=\"text-align:right;\"> 2.740 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> age </td>\n   <td style=\"text-align:right;\"> 1.051 </td>\n   <td style=\"text-align:right;\"> 1.044 </td>\n   <td style=\"text-align:right;\"> 1.059 </td>\n   <td style=\"text-align:right;\"> 13.280 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> raceHispanic </td>\n   <td style=\"text-align:right;\"> 0.896 </td>\n   <td style=\"text-align:right;\"> 0.649 </td>\n   <td style=\"text-align:right;\"> 1.237 </td>\n   <td style=\"text-align:right;\"> -0.665 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> raceOther </td>\n   <td style=\"text-align:right;\"> 1.158 </td>\n   <td style=\"text-align:right;\"> 0.565 </td>\n   <td style=\"text-align:right;\"> 2.374 </td>\n   <td style=\"text-align:right;\"> 0.401 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> raceWhite </td>\n   <td style=\"text-align:right;\"> 0.778 </td>\n   <td style=\"text-align:right;\"> 0.507 </td>\n   <td style=\"text-align:right;\"> 1.193 </td>\n   <td style=\"text-align:right;\"> -1.152 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> incomeBetween.25kto54k </td>\n   <td style=\"text-align:right;\"> 0.830 </td>\n   <td style=\"text-align:right;\"> 0.551 </td>\n   <td style=\"text-align:right;\"> 1.251 </td>\n   <td style=\"text-align:right;\"> -0.889 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> incomeBetween.55kto99k </td>\n   <td style=\"text-align:right;\"> 0.872 </td>\n   <td style=\"text-align:right;\"> 0.621 </td>\n   <td style=\"text-align:right;\"> 1.224 </td>\n   <td style=\"text-align:right;\"> -0.794 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> incomeOver100k </td>\n   <td style=\"text-align:right;\"> 0.669 </td>\n   <td style=\"text-align:right;\"> 0.418 </td>\n   <td style=\"text-align:right;\"> 1.072 </td>\n   <td style=\"text-align:right;\"> -1.669 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> educationHigh.School </td>\n   <td style=\"text-align:right;\"> 0.948 </td>\n   <td style=\"text-align:right;\"> 0.733 </td>\n   <td style=\"text-align:right;\"> 1.225 </td>\n   <td style=\"text-align:right;\"> -0.408 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> educationSchool </td>\n   <td style=\"text-align:right;\"> 0.872 </td>\n   <td style=\"text-align:right;\"> 0.448 </td>\n   <td style=\"text-align:right;\"> 1.695 </td>\n   <td style=\"text-align:right;\"> -0.405 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> marriedNever.married </td>\n   <td style=\"text-align:right;\"> 1.055 </td>\n   <td style=\"text-align:right;\"> 0.677 </td>\n   <td style=\"text-align:right;\"> 1.646 </td>\n   <td style=\"text-align:right;\"> 0.237 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> marriedPreviously.married </td>\n   <td style=\"text-align:right;\"> 0.849 </td>\n   <td style=\"text-align:right;\"> 0.534 </td>\n   <td style=\"text-align:right;\"> 1.348 </td>\n   <td style=\"text-align:right;\"> -0.694 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> cholesterol </td>\n   <td style=\"text-align:right;\"> 0.991 </td>\n   <td style=\"text-align:right;\"> 0.986 </td>\n   <td style=\"text-align:right;\"> 0.995 </td>\n   <td style=\"text-align:right;\"> -3.810 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> diastolicBP </td>\n   <td style=\"text-align:right;\"> 1.005 </td>\n   <td style=\"text-align:right;\"> 0.992 </td>\n   <td style=\"text-align:right;\"> 1.018 </td>\n   <td style=\"text-align:right;\"> 0.749 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> systolicBP </td>\n   <td style=\"text-align:right;\"> 1.003 </td>\n   <td style=\"text-align:right;\"> 0.993 </td>\n   <td style=\"text-align:right;\"> 1.012 </td>\n   <td style=\"text-align:right;\"> 0.559 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: Robust</td></tr></tfoot>\n</table>\n`````\n:::\n:::\n\n\n::: callout-tip\n**Double adjustment**:\n\nDouble adjustment in PSM can offer an additional layer of control for confounding and enhance the robustness of treatment effect estimates. The primary goal of double adjustment is to further minimize bias in the estimated treatment effect, especially when the propensity score model may not fully balance all covariates across treatment groups. in this approach, The propensity score is estimated, typically using logistic regression, where the treatment assignment is regressed on observed covariates. Units (e.g., individuals) in the treatment group are matched with units in the control group based on their propensity scores. This aims to create comparable groups and balance observed covariates across treatment and control groups. After matching, an *outcome model is fitted to estimate the treatment effect while additionally adjusting for the same covariates used in the propensity score model*. This second adjustment in the outcome model is what constitutes the \"double\" in \"double adjustment.\"\n\nHowever, it should be applied thoughtfully, with careful consideration of model specification, covariate selection, and underlying assumptions to ensure valid and reliable results. Always consider the specific context of the study and consult statistical guidelines or experts when applying advanced methods like double adjustment in PSM.\n:::\n\n### Approach by Austin et al. (2018)\n\n#### Step 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Specify the PS model to estimate propensity scores\nps.formula3 <- as.formula(I(bmi == \"Not overweight\") ~ gender + age + race + income + education + \n                           married + cholesterol + diastolicBP + systolicBP)\n\n# Survey design\nrequire(survey)\nanalytic.design <- svydesign(id = ~psu, weights = ~interview.weight, strata = ~strata,\n                             data = analytic.data, nest = TRUE)\n```\n:::\n\n\n#### Step 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Propensity scores\nps.fit3 <- svyglm(ps.formula3, design = analytic.design, family = binomial(\"logit\"))\nanalytic.data$PS3 <- fitted(ps.fit3)\n\n# Caliper fixing to 0.2*sd(logit of PS)\ncaliper3 <- 0.2*sd(log(analytic.data$PS3/(1-analytic.data$PS3)))\n\n# Match exposed and unexposed subjects \nset.seed(504)\nmatch.obj3 <- matchit(ps.formula, data = analytic.data,\n                     distance = analytic.data$PS3, \n                     method = \"nearest\", \n                     replace = FALSE,\n                     caliper = caliper3, \n                     ratio = 1)\nanalytic.data$PS3 <- match.obj3$distance\n\n# Extract matched data\nmatched.data3 <- match.data(match.obj3) \n```\n:::\n\n\n#### Step 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Balance checking\ncov <- c(\"gender\", \"age\", \"race\", \"income\", \n         \"education\", \"married\", \"cholesterol\", \n         \"diastolicBP\", \"systolicBP\")\n\ntab1m3 <- CreateTableOne(strata = \"bmi\", vars = cov, data = matched.data3, test = F)\nprint(tab1m3, smd = TRUE)\n#>                          Stratified by bmi\n#>                           Overweight     Not overweight SMD   \n#>   n                         2029           2029               \n#>   gender = Male (%)          917 (45.2)    1009 (49.7)   0.091\n#>   age (mean (SD))          47.20 (17.50)  46.26 (17.62)  0.054\n#>   race (%)                                               0.071\n#>      Black                   443 (21.8)     416 (20.5)        \n#>      Hispanic                552 (27.2)     583 (28.7)        \n#>      Other                   313 (15.4)     351 (17.3)        \n#>      White                   721 (35.5)     679 (33.5)        \n#>   income (%)                                             0.067\n#>      <25k                    528 (26.0)     506 (24.9)        \n#>      Between.25kto54k        688 (33.9)     656 (32.3)        \n#>      Between.55kto99k        439 (21.6)     495 (24.4)        \n#>      Over100k                374 (18.4)     372 (18.3)        \n#>   education (%)                                          0.034\n#>      College                1165 (57.4)    1186 (58.5)        \n#>      High.School             654 (32.2)     653 (32.2)        \n#>      School                  210 (10.3)     190 ( 9.4)        \n#>   married (%)                                            0.026\n#>      Married                1216 (59.9)    1231 (60.7)        \n#>      Never.married           396 (19.5)     375 (18.5)        \n#>      Previously.married      417 (20.6)     423 (20.8)        \n#>   cholesterol (mean (SD)) 176.62 (38.32) 175.13 (38.65)  0.039\n#>   diastolicBP (mean (SD))  65.02 (13.44)  64.48 (13.37)  0.041\n#>   systolicBP (mean (SD))  117.98 (15.46) 116.37 (17.62)  0.097\n```\n:::\n\n\nAll SMDs are less than your specified cut-point? If yes, that indicates that there is good covariate balancing.\n\n#### Step 4\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Setup the design with survey features\nanalytic.with.miss$matched3 <- 0\nanalytic.with.miss$matched3[analytic.with.miss$ID %in% matched.data3$ID] <- 1\n\n# Survey setup for full data\nw.design03 <- svydesign(strata = ~strata, id = ~psu, weights = ~interview.weight, \n                       data = analytic.with.miss, nest = TRUE)\n\n# Subset matched data\nw.design.m3 <- subset(w.design03, matched3 == 1)\n\n# Outcome model\nout.formula <- as.formula(I(diabetes == \"Yes\") ~ bmi)\nfit3 <- svyglm(out.formula, design = w.design.m3, family = binomial(\"logit\"))\nsumm(fit3, exp = TRUE, confint = TRUE, digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 4058 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> I(diabetes == \"Yes\") </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> Survey-weighted generalized linear model </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Family </td>\n   <td style=\"text-align:right;\"> binomial </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Link </td>\n   <td style=\"text-align:right;\"> logit </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (Cragg-Uhler) </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (McFadden) </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> AIC </td>\n   <td style=\"text-align:right;\"> 2364.398 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> exp(Est.) </th>\n   <th style=\"text-align:right;\"> 2.5% </th>\n   <th style=\"text-align:right;\"> 97.5% </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 0.169 </td>\n   <td style=\"text-align:right;\"> 0.142 </td>\n   <td style=\"text-align:right;\"> 0.202 </td>\n   <td style=\"text-align:right;\"> -19.891 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> bmiNot overweight </td>\n   <td style=\"text-align:right;\"> 0.244 </td>\n   <td style=\"text-align:right;\"> 0.178 </td>\n   <td style=\"text-align:right;\"> 0.334 </td>\n   <td style=\"text-align:right;\"> -8.825 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: Robust</td></tr></tfoot>\n</table>\n`````\n:::\n:::\n\n\n#### Double adjustment\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Outcome model with covariates adjustment\nfit3.DA <- svyglm(I(diabetes == \"Yes\") ~ bmi + gender + age + race + income + \n                 education + married + cholesterol + diastolicBP + systolicBP, \n               design = w.design.m, family = binomial(\"logit\"))\nsumm(fit3.DA, exp = TRUE, confint = TRUE, digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 4094 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> I(diabetes == \"Yes\") </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> Survey-weighted generalized linear model </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Family </td>\n   <td style=\"text-align:right;\"> binomial </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Link </td>\n   <td style=\"text-align:right;\"> logit </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (Cragg-Uhler) </td>\n   <td style=\"text-align:right;\"> 0.212 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (McFadden) </td>\n   <td style=\"text-align:right;\"> 0.166 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> AIC </td>\n   <td style=\"text-align:right;\"> 2063.466 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> exp(Est.) </th>\n   <th style=\"text-align:right;\"> 2.5% </th>\n   <th style=\"text-align:right;\"> 97.5% </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.199 </td>\n   <td style=\"text-align:right;\"> -4.101 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> bmiNot overweight </td>\n   <td style=\"text-align:right;\"> 0.235 </td>\n   <td style=\"text-align:right;\"> 0.159 </td>\n   <td style=\"text-align:right;\"> 0.348 </td>\n   <td style=\"text-align:right;\"> -7.219 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> genderMale </td>\n   <td style=\"text-align:right;\"> 1.317 </td>\n   <td style=\"text-align:right;\"> 1.082 </td>\n   <td style=\"text-align:right;\"> 1.604 </td>\n   <td style=\"text-align:right;\"> 2.740 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> age </td>\n   <td style=\"text-align:right;\"> 1.051 </td>\n   <td style=\"text-align:right;\"> 1.044 </td>\n   <td style=\"text-align:right;\"> 1.059 </td>\n   <td style=\"text-align:right;\"> 13.280 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> raceHispanic </td>\n   <td style=\"text-align:right;\"> 0.896 </td>\n   <td style=\"text-align:right;\"> 0.649 </td>\n   <td style=\"text-align:right;\"> 1.237 </td>\n   <td style=\"text-align:right;\"> -0.665 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> raceOther </td>\n   <td style=\"text-align:right;\"> 1.158 </td>\n   <td style=\"text-align:right;\"> 0.565 </td>\n   <td style=\"text-align:right;\"> 2.374 </td>\n   <td style=\"text-align:right;\"> 0.401 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> raceWhite </td>\n   <td style=\"text-align:right;\"> 0.778 </td>\n   <td style=\"text-align:right;\"> 0.507 </td>\n   <td style=\"text-align:right;\"> 1.193 </td>\n   <td style=\"text-align:right;\"> -1.152 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> incomeBetween.25kto54k </td>\n   <td style=\"text-align:right;\"> 0.830 </td>\n   <td style=\"text-align:right;\"> 0.551 </td>\n   <td style=\"text-align:right;\"> 1.251 </td>\n   <td style=\"text-align:right;\"> -0.889 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> incomeBetween.55kto99k </td>\n   <td style=\"text-align:right;\"> 0.872 </td>\n   <td style=\"text-align:right;\"> 0.621 </td>\n   <td style=\"text-align:right;\"> 1.224 </td>\n   <td style=\"text-align:right;\"> -0.794 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> incomeOver100k </td>\n   <td style=\"text-align:right;\"> 0.669 </td>\n   <td style=\"text-align:right;\"> 0.418 </td>\n   <td style=\"text-align:right;\"> 1.072 </td>\n   <td style=\"text-align:right;\"> -1.669 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> educationHigh.School </td>\n   <td style=\"text-align:right;\"> 0.948 </td>\n   <td style=\"text-align:right;\"> 0.733 </td>\n   <td style=\"text-align:right;\"> 1.225 </td>\n   <td style=\"text-align:right;\"> -0.408 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> educationSchool </td>\n   <td style=\"text-align:right;\"> 0.872 </td>\n   <td style=\"text-align:right;\"> 0.448 </td>\n   <td style=\"text-align:right;\"> 1.695 </td>\n   <td style=\"text-align:right;\"> -0.405 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> marriedNever.married </td>\n   <td style=\"text-align:right;\"> 1.055 </td>\n   <td style=\"text-align:right;\"> 0.677 </td>\n   <td style=\"text-align:right;\"> 1.646 </td>\n   <td style=\"text-align:right;\"> 0.237 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> marriedPreviously.married </td>\n   <td style=\"text-align:right;\"> 0.849 </td>\n   <td style=\"text-align:right;\"> 0.534 </td>\n   <td style=\"text-align:right;\"> 1.348 </td>\n   <td style=\"text-align:right;\"> -0.694 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> cholesterol </td>\n   <td style=\"text-align:right;\"> 0.991 </td>\n   <td style=\"text-align:right;\"> 0.986 </td>\n   <td style=\"text-align:right;\"> 0.995 </td>\n   <td style=\"text-align:right;\"> -3.810 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> diastolicBP </td>\n   <td style=\"text-align:right;\"> 1.005 </td>\n   <td style=\"text-align:right;\"> 0.992 </td>\n   <td style=\"text-align:right;\"> 1.018 </td>\n   <td style=\"text-align:right;\"> 0.749 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> systolicBP </td>\n   <td style=\"text-align:right;\"> 1.003 </td>\n   <td style=\"text-align:right;\"> 0.993 </td>\n   <td style=\"text-align:right;\"> 1.012 </td>\n   <td style=\"text-align:right;\"> 0.559 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: Robust</td></tr></tfoot>\n</table>\n`````\n:::\n:::\n\n\n## References\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}