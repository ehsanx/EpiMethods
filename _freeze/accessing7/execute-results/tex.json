{
  "hash": "f20020b784a76f9c43561bf69005a3dc",
  "result": {
    "markdown": "## Linking mortality data {.unnumbered}\n\nThis tutorial provides instructions on linking public-use US mortality data with the [NHANES](https://www.cdc.gov/nchs/nhanes/index.htm) dataset. One can also follow the same steps to link the mortality data with the [NHIS](https://www.cdc.gov/nchs/nhis/index.htm).\n\n### Download mortality data\n\nThe public-use mortality data can be downloaded directly from the [CDC website](https://ftp.cdc.gov/pub/Health_Statistics/NCHS/datalinkage/linked_mortality/). Datasets are available in .dat format, separately for each cycle of NHANES and NHIS.\n\n\n\n::: {.cell hash='accessing7_cache/pdf/mort1_509fd4e81e980e1eb09b434c80eac9e3'}\n::: {.cell-output-display}\n![](Images/accessing/mortality_link.png){width=100%}\n:::\n:::\n\n\n\nOn the same website, CDC also provided R, SAS, and Stata codes with instructions on how to download the datasets directly from the website.\n\n\n\n::: {.cell hash='accessing7_cache/pdf/mort2_237d038ae512ae9523fd0994df80d889'}\n::: {.cell-output-display}\n![](Images/accessing/codes.png){width=70%}\n:::\n:::\n\n\n\nWe can click on the desired survey link to download and save the datasets on our own hard drive. The dataset will be directly downloaded to our specified download folder. Alternatively, we can right-click on the desired survey link and select `Save link as...`\n\n\n\n::: {.cell hash='accessing7_cache/pdf/mort3_8fa098b7738b88dc734b095108d64dd6'}\n::: {.cell-output-display}\n![](Images/accessing/mortSave.png){width=90%}\n:::\n:::\n\n\n\nNote that the data file is saved as `<survey name>_MORT_2019_PUBLIC.dat`. In our example, we downloaded mortality data for the NHANES 2013-14 participants. Hence, the name of the file should be `NHANES_2013_2014_MORT_2019_PUBLIC.dat`.\n\n\n\n::: {.cell hash='accessing7_cache/pdf/mort4_362ac91a233c8179d483bd4705566885'}\n::: {.cell-output-display}\n![](Images/accessing/mortSaveData.png){width=30%}\n:::\n:::\n\n\n\n### Link mortality data to NHANES\n\nLet us link the mortality data to the NHANES 2013-14 cycle. The steps are as follows:\n\n-   Download morality data for the NHANES 2013-14 cycle\n-   Load the morality data on the R environment\n-   Load NHANES 2013-14 cycle\n-   Merge two datasets using the unique identifier\n\n#### Download morality data\n\nWe can follow the steps described above to download the mortality dataset directly from the CDC website.\n\n#### Load the morality data on the R environment\n\nTo load the dataset, we can use the `read_fwf` function from the `readr` package.\n\n\n\n::: {.cell hash='accessing7_cache/pdf/mortdataload_5b52d3dfb9c8dff6abca5c260f4b8091'}\n\n```{.r .cell-code}\nlibrary(readr)\nlibrary(dplyr)\n#> Warning: package 'dplyr' was built under R version 4.2.3\n#> \n#> Attaching package: 'dplyr'\n#> The following objects are masked from 'package:stats':\n#> \n#>     filter, lag\n#> The following objects are masked from 'package:base':\n#> \n#>     intersect, setdiff, setequal, union\n\ndat.mort <- read_fwf(\n  file = \"Data/accessing/NHANES_2013_2014_MORT_2019_PUBLIC.dat\",\n  col_types = \"iiiiiiii\",\n  fwf_cols(SEQN = c(1,6), \n           eligstat = c(15,15),\n           mortstat = c(16,16),\n           ucod_leading = c(17,19),\n           diabetes = c(20,20),\n           hyperten = c(21,21),\n           permth_int = c(43,45),\n           permth_exm = c(46,48)),\n  na = c(\"\", \".\"))\n\nhead(dat.mort)\n#> # A tibble: 6 x 8\n#>    SEQN eligstat mortstat ucod_leading diabetes hyperten permth_int permth_exm\n#>   <int>    <int>    <int>        <int>    <int>    <int>      <int>      <int>\n#> 1 73557        1        0           NA       NA       NA         78         78\n#> 2 73558        1        1            7        1        0         58         58\n#> 3 73559        1        0           NA       NA       NA         83         82\n#> 4 73560        2       NA           NA       NA       NA         NA         NA\n#> 5 73561        1        1           10        0        0         10          9\n#> 6 73562        1        0           NA       NA       NA         68         68\n```\n:::\n\n\n\nIn the code chuck above,\n\n-   SEQN: unique identifier for NHANES\n\n-   eligstat: Eligibility Status for Mortality Follow-up\n\n    -   1 = Eligible\n    -   2 = Under age 18, not available for public release\n    -   3 = Ineligible\n\n-   mortstat: Mortality Status\n\n    -   0 = Assumed alive\n    -   1 = Assumed deceased\n    -   NA = Ineligible or under age 18\n\n-   ucod_leading: Underlying Cause of Death\n\n    -   1 = Diseases of heart (I00-I09, I11, I13, I20-I51)\n    -   2 = Malignant neoplasms (C00-C97)\n    -   3 = Chronic lower respiratory diseases (J40-J47)\n    -   4 = Accidents (unintentional injuries) (V01-X59, Y85-Y86)\n    -   5 = Cerebrovascular diseases (I60-I69)\n    -   6 = Alzheimer's disease (G30)\n    -   7 = Diabetes mellitus (E10-E14)\n    -   8 = Influenza and pneumonia (J09-J18)\n    -   9 = Nephritis, nephrotic syndrome and nephrosis (N00-N07, N17-N19, N25-N27)\n    -   10 = All other causes\n    -   NA = Ineligible, under age 18, assumed alive, or no cause of death data available\n\n-   diabetes: Diabetes Flag from Multiple Cause of Death (MCOD)\n\n    -   0 = No - Condition not listed as a multiple cause of death\n    -   1 = Yes - Condition listed as a multiple cause of death\n    -   NA = Assumed alive, under age 18, ineligible for mortality follow-up, or MCOD not available\n\n-   hyperten: Hypertension Flag from Multiple Cause of Death (MCOD)\n\n    -   0 = No - Condition not listed as a multiple cause of death\n    -   1 = Yes - Condition listed as a multiple cause of death\n    -   NA = Assumed alive, under age 18, ineligible for mortality follow-up, or MCOD not available\n\n-   permth_int: Person-Months of Follow-up from NHANES Interview date\n\n-   permth_exm: Person-Months of Follow-up from NHANES Mobile Examination Center (MEC) Date\n\nLet us see the basic summary statistics of some variables:\n\n\n\n::: {.cell hash='accessing7_cache/pdf/mortdatastat_d10d2062f667f063a1160f5e6f845704'}\n\n```{.r .cell-code}\n# Mortality Status\ntable(dat.mort$mortstat, useNA = \"always\")\n#> \n#>    0    1 <NA> \n#> 5633  467 4075\n\n# Person-Months of Follow-up from NHANES Interview date\nsummary(dat.mort$permth_int)\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n#>    1.00   65.00   72.00   70.34   79.00   85.00    4075\n\n# Underlying Cause of Death\ntable(dat.mort$ucod_leading, useNA = \"always\")\n#> \n#>    1    2    3    4    5    6    7    8    9   10 <NA> \n#>  136   99   24   14   28   17   21    9   16  103 9708\n```\n:::\n\n\n\n#### Load NHANES 2013-14 cycle\n\nLet the open the NHANES 2013-14 dataset we created in the previous chapter on [Reproducing results](accessing4.html).\n\n\n\n::: {.cell hash='accessing7_cache/pdf/openNHANES_78f6b443b11525bfb8536a2346a3f13d'}\n\n```{.r .cell-code}\n# Load data\nload(\"Data/accessing/analyticNHANES2013.RData\")\nls()\n#> [1] \"analytic.data3\"  \"dat.mort\"        \"has_annotations\" \"merged.data\"\n\n# NHANES 2013-14\nhead(analytic.data3)\n#>    SEQN RIDEXPRG RIAGENDR RIDAGEYR           RIDRETH3 WTINT2YR SDMVPSU SDMVSTRA\n#> 1 73557     <NA>     Male       69 Non-Hispanic Black 13281.24       1      112\n#> 2 73558     <NA>     Male       54 Non-Hispanic White 23682.06       1      108\n#> 3 73559     <NA>     Male       72 Non-Hispanic White 57214.80       1      109\n#> 5 73561     <NA>   Female       73 Non-Hispanic White 63709.67       2      116\n#> 6 73562     <NA>     Male       56   Mexican American 24978.14       1      111\n#> 8 73564     <NA>   Female       61 Non-Hispanic White 60325.10       1      114\n#>   BMXBMI   AgeCat Gender     Race psu strata survey.weight\n#> 1   26.7 [60,Inf)   Male    Black   1    112      13281.24\n#> 2   28.6  [40,60)   Male    White   1    108      23682.06\n#> 3   28.9 [60,Inf)   Male    White   1    109      57214.80\n#> 5   19.7 [60,Inf) Female    White   2    116      63709.67\n#> 6   41.7  [40,60)   Male Hispanic   1    111      24978.14\n#> 8   35.7 [60,Inf) Female    White   1    114      60325.10\ndim(analytic.data3)\n#> [1] 5455   15\n```\n:::\n\n\n\n#### Merge mortality data and NHANES 2013-14 using unique identifier\n\nLet us merge the mortality and NHANES datasets using the `SEQN` variable.\n\n\n\n::: {.cell hash='accessing7_cache/pdf/joinNHANES_86b07dee31210ae022ebf8c8a23d68c6'}\n\n```{.r .cell-code}\n# Merge datasets\ndat.nhanes <- merge(analytic.data3, dat.mort, by = \"SEQN\", all.x = T)\ndim(dat.nhanes)\n#> [1] 5455   22\nhead(dat.nhanes)\n#>    SEQN RIDEXPRG RIAGENDR RIDAGEYR           RIDRETH3 WTINT2YR SDMVPSU SDMVSTRA\n#> 1 73557     <NA>     Male       69 Non-Hispanic Black 13281.24       1      112\n#> 2 73558     <NA>     Male       54 Non-Hispanic White 23682.06       1      108\n#> 3 73559     <NA>     Male       72 Non-Hispanic White 57214.80       1      109\n#> 4 73561     <NA>   Female       73 Non-Hispanic White 63709.67       2      116\n#> 5 73562     <NA>     Male       56   Mexican American 24978.14       1      111\n#> 6 73564     <NA>   Female       61 Non-Hispanic White 60325.10       1      114\n#>   BMXBMI   AgeCat Gender     Race psu strata survey.weight eligstat mortstat\n#> 1   26.7 [60,Inf)   Male    Black   1    112      13281.24        1        0\n#> 2   28.6  [40,60)   Male    White   1    108      23682.06        1        1\n#> 3   28.9 [60,Inf)   Male    White   1    109      57214.80        1        0\n#> 4   19.7 [60,Inf) Female    White   2    116      63709.67        1        1\n#> 5   41.7  [40,60)   Male Hispanic   1    111      24978.14        1        0\n#> 6   35.7 [60,Inf) Female    White   1    114      60325.10        1        0\n#>   ucod_leading diabetes hyperten permth_int permth_exm\n#> 1           NA       NA       NA         78         78\n#> 2            7        1        0         58         58\n#> 3           NA       NA       NA         83         82\n#> 4           10        0        0         10          9\n#> 5           NA       NA       NA         68         68\n#> 6           NA       NA       NA         63         62\n```\n:::\n\n\n\n#### Table 1\n\nNow we will use the `dat.nhanes` dataset to create Table 1 with utilizing survey features (i.e., psu, strata, and survey weights). First, we will create the survey design. Second, we will report Table 1 with age, sex, race, eligibility, all-cause mortality status, diabetes-related death, hypertension-related death, and follow-up times.\n\n\n\n::: {.cell hash='accessing7_cache/pdf/tab1_ee66f6ae352b17bca12dbb47687711ca'}\n\n```{.r .cell-code}\nlibrary(tableone)\nlibrary(survey)\n\n# Make eligibility and mortality status as factor variable\nfactor.vars <- c(\"eligstat\", \"mortstat\", \"diabetes\", \"hyperten\")\ndat.nhanes[,factor.vars] <- lapply(dat.nhanes[,factor.vars] , factor)\n\n# Survey design\nw.design <- svydesign(id = ~psu, strata = ~strata, weights = ~survey.weight, \n                      data = dat.nhanes, nest = T)\n\n# Table 1 - unweighted frequency or mean\ntab1a <- CreateTableOne(var = c(\"AgeCat\", \"Gender\", \"Race\", \"eligstat\", \"mortstat\", \n                                \"diabetes\", \"hyperten\", \"permth_int\", \"permth_exm\"),\n                        data = dat.nhanes, includeNA = T)\nprint(tab1a, showAllLevels = T, format = \"f\")\n#>                         \n#>                          level    Overall      \n#>   n                                5455        \n#>   AgeCat                 [0,20)       0        \n#>                          [20,40)   1810        \n#>                          [40,60)   1896        \n#>                          [60,Inf)  1749        \n#>   Gender                 Female    2817        \n#>                          Male      2638        \n#>   Race                   White     2343        \n#>                          Black     1115        \n#>                          Asian      623        \n#>                          Hispanic  1214        \n#>                          <NA>       160        \n#>   eligstat               1         5445        \n#>                          3           10        \n#>   mortstat               0         5030        \n#>                          1          415        \n#>                          <NA>        10        \n#>   diabetes               0          374        \n#>                          1           41        \n#>                          <NA>      5040        \n#>   hyperten               0          344        \n#>                          1           71        \n#>                          <NA>      5040        \n#>   permth_int (mean (SD))          70.40 (12.18)\n#>   permth_exm (mean (SD))          69.49 (12.20)\n\n# Table 1 - weighted percentage or mean\ntab1b <- svyCreateTableOne(var = c(\"AgeCat\", \"Gender\", \"Race\", \"eligstat\", \"mortstat\", \n                                \"diabetes\", \"hyperten\", \"permth_int\", \"permth_exm\"), \n                           data = w.design, includeNA = T)\nprint(tab1b, showAllLevels = T, format = \"p\")\n#>                         \n#>                          level    Overall             \n#>   n                                217464332.1        \n#>   AgeCat (%)             [0,20)            0.0        \n#>                          [20,40)          35.5        \n#>                          [40,60)          37.5        \n#>                          [60,Inf)         27.0        \n#>   Gender (%)             Female           51.4        \n#>                          Male             48.6        \n#>   Race (%)               White            66.1        \n#>                          Black            11.4        \n#>                          Asian             5.2        \n#>                          Hispanic         14.7        \n#>                          <NA>              2.7        \n#>   eligstat (%)           1                99.9        \n#>                          3                 0.1        \n#>   mortstat (%)           0                93.6        \n#>                          1                 6.2        \n#>                          <NA>              0.1        \n#>   diabetes (%)           0                 5.5        \n#>                          1                 0.7        \n#>                          <NA>             93.8        \n#>   hyperten (%)           0                 5.2        \n#>                          1                 1.0        \n#>                          <NA>             93.8        \n#>   permth_int (mean (SD))                 70.71 (11.28)\n#>   permth_exm (mean (SD))                 69.80 (11.31)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}