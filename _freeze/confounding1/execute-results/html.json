{
  "hash": "6fcbd8a50c47622de75a15ddbe7e2beb",
  "result": {
    "markdown": "## Confounding {.unnumbered}\n\n\n::: {.cell hash='confounding1_cache/html/setup_289c7c205d6a10e14ce878a31f6142a4'}\n\n```{.r .cell-code}\n# devtools::install_github('osofr/simcausal')\nrequire(simcausal)\n```\n:::\n\n\nBig data: **What if we had 1,000,000 (one million) observations?** Would that give us true result? Let's try to answer that using Directed acyclic graphs (DAGs).\n\nLet us consider\n\n-   L is continuous variable\n-   A is binary treatment\n-   Y is continuous outcome\n\n### Non-null effect\n\n-   True treatment effect = 1.3\n\n#### Data generating process\n\n\n::: {.cell hash='confounding1_cache/html/dgm1_51794aff5e4387535ce27ca31d30d579'}\n\n```{.r .cell-code}\nrequire(simcausal)\nD <- DAG.empty()\nD <- D + \n  node(\"L\", distr = \"rnorm\", mean = 10, sd = 1) + \n  node(\"A\", distr = \"rbern\", prob = plogis(-10 + 1.1*L)) +\n  node(\"Y\", distr = \"rnorm\", mean = 0.5 * L + 1.3 * A, sd = .1)\nDset <- set.DAG(D)\n```\n:::\n\n\n#### Generate DAG\n\n\n::: {.cell hash='confounding1_cache/html/dag1_cc6e0cdeb8f1635cd8f77656326563df'}\n\n```{.r .cell-code}\nplotDAG(Dset, xjitter = 0.1, yjitter = .9,\n        edge_attrs = list(width = 0.5, arrow.width = 0.4, arrow.size = 0.7),\n        vertex_attrs = list(size = 12, label.cex = 0.8))\n#> using the following vertex attributes:\n#> 120.8NAdarkbluenone0\n#> using the following edge attributes:\n#> 0.50.40.7black1\n```\n\n::: {.cell-output-display}\n![](confounding1_files/figure-html/dag1-1.png){width=672}\n:::\n:::\n\n\n#### Generate Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(simcausal)\nObs.Data <- sim(DAG = Dset, n = 1000000, rndseed = 123)\nhead(Obs.Data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"ID\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"L\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"A\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Y\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"9.439524\",\"3\":\"1\",\"4\":\"6.165097\",\"_rn_\":\"1\"},{\"1\":\"2\",\"2\":\"9.769823\",\"3\":\"1\",\"4\":\"6.040117\",\"_rn_\":\"2\"},{\"1\":\"3\",\"2\":\"11.558708\",\"3\":\"1\",\"4\":\"7.121178\",\"_rn_\":\"3\"},{\"1\":\"4\",\"2\":\"10.070508\",\"3\":\"0\",\"4\":\"4.943313\",\"_rn_\":\"4\"},{\"1\":\"5\",\"2\":\"10.129288\",\"3\":\"1\",\"4\":\"6.438245\",\"_rn_\":\"5\"},{\"1\":\"6\",\"2\":\"11.715065\",\"3\":\"1\",\"4\":\"7.073990\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n#### Estimate effect\n\n\n::: {.cell hash='confounding1_cache/html/est_5de2b1c925dfbba161283d0e6ed0b3a2'}\n\n```{.r .cell-code}\n# Not adjusted for L\nfit0 <- glm(Y ~ A, family=\"gaussian\", data=Obs.Data)\nround(coef(fit0),2)\n#> (Intercept)           A \n#>        4.69        1.75\n\n# Adjusted for L\nfit <- glm(Y ~ A + L, family=\"gaussian\", data=Obs.Data)\nround(coef(fit),2)\n#> (Intercept)           A           L \n#>         0.0         1.3         0.5\n```\n:::\n\n\n### Null effect\n\n-   True treatment effect = 0\n\n#### Data generating process\n\n\n::: {.cell hash='confounding1_cache/html/dgm2_0b7a92e715a56d3dfd3c619c3553002e'}\n\n```{.r .cell-code}\nrequire(simcausal)\nD <- DAG.empty()\nD <- D + \n  node(\"L\", distr = \"rnorm\", mean = 10, sd = 1) + \n  node(\"A\", distr = \"rbern\", prob = plogis(-10 + 1.1*L)) +\n  node(\"Y\", distr = \"rnorm\", mean = 0.5 * L, sd = .1)\nDset <- set.DAG(D)\n```\n:::\n\n\n#### Generate DAG\n\n\n::: {.cell hash='confounding1_cache/html/dag2_97d7f6ecdebbc67c0c3aac101d1db053'}\n\n```{.r .cell-code}\nplotDAG(Dset, xjitter = 0.1, yjitter = .9,\n        edge_attrs = list(width = 0.5, arrow.width = 0.4, arrow.size = 0.7),\n        vertex_attrs = list(size = 12, label.cex = 0.8))\n```\n\n::: {.cell-output-display}\n![](confounding1_files/figure-html/dag2-1.png){width=672}\n:::\n:::\n\n\n#### Generate Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(simcausal)\nObs.Data <- sim(DAG = Dset, n = 1000000, rndseed = 123)\nhead(Obs.Data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"ID\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"L\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"A\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Y\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"9.439524\",\"3\":\"1\",\"4\":\"4.865097\",\"_rn_\":\"1\"},{\"1\":\"2\",\"2\":\"9.769823\",\"3\":\"1\",\"4\":\"4.740117\",\"_rn_\":\"2\"},{\"1\":\"3\",\"2\":\"11.558708\",\"3\":\"1\",\"4\":\"5.821178\",\"_rn_\":\"3\"},{\"1\":\"4\",\"2\":\"10.070508\",\"3\":\"0\",\"4\":\"4.943313\",\"_rn_\":\"4\"},{\"1\":\"5\",\"2\":\"10.129288\",\"3\":\"1\",\"4\":\"5.138245\",\"_rn_\":\"5\"},{\"1\":\"6\",\"2\":\"11.715065\",\"3\":\"1\",\"4\":\"5.773990\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n#### Estimate effect\n\n\n::: {.cell hash='confounding1_cache/html/est2_8de02d54cd7c3f4f805b6f33ca7c9c70'}\n\n```{.r .cell-code}\n# Not adjusted for L\nfit0 <- glm(Y ~ A, family = \"gaussian\", data = Obs.Data)\nround(coef(fit0),2)\n#> (Intercept)           A \n#>        4.69        0.45\n\n# Adjusted for L\nfit <- glm(Y ~ A + L, family = \"gaussian\", data = Obs.Data)\nround(coef(fit),2)\n#> (Intercept)           A           L \n#>         0.0         0.0         0.5\n```\n:::\n\n\n### Video content (optional)\n\n::: callout-tip\nFor those who prefer a video walkthrough, feel free to watch the video below, which offers a description of an earlier version of the above content.\n:::\n\n::: {style=\"position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;\"}\n<iframe src=\"https://www.youtube.com/embed/EcX7ILtp9aQ\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;\" allowfullscreen>\n\n</iframe>\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}