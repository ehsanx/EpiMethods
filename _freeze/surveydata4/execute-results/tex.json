{
  "hash": "b95e594808a053a4d15c0da2cfe9d66f",
  "result": {
    "markdown": "## CCHS: Regression {.unnumbered}\n\nThis tutorial is for a complex data analysis, specifically using regression techniques to analyze survey data.\n\nLet us load necessary R packages for the analysis:\n\n\n\n::: {.cell hash='surveydata4_cache/pdf/setup_a8a8a2fe62df770710bf6fbd64758a84'}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(survey)\nlibrary(knitr)\nlibrary(car)\nlibrary(tableone)\nlibrary(DataExplorer)\nlibrary(Publish)\nlibrary(ROCR)\nlibrary(WeightedROC)\nlibrary(jtools)\nlibrary(MASS)\n```\n:::\n\n\n\n### Load data\n\nLoads a dataset and provides some quick data checks, like the dimensions and summary of weights.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(\"Data/surveydata/cchs123w.RData\")\nls()\n#> [1] \"analytic.miss\"   \"analytic2\"       \"has_annotations\" \"w.design\"\ndim(analytic.miss)\n#> [1] 397173     23\ndim(analytic2)\n#> [1] 185613     22\nsummary(weights(w.design))\n#> Length  Class   Mode \n#>      0   NULL   NULL\n```\n:::\n\n\n\n### Logistic for complex survey\n\nPerforms a simple logistic regression using the complex survey data, focusing on the relationship between cardiovascular disease and osteoarthritis.\n\n\n\n::: {.cell hash='surveydata4_cache/pdf/logistc_0f0ede65844b06e5803947816e22b516'}\n\n```{.r .cell-code}\nformula0 <- as.formula(I(CVD==\"event\") ~ OA)\n\n## Crude regression\nfit2 <- svyglm(formula0, \n              design = w.design, \n              family = binomial(logit))\nrequire(Publish)\npublish(fit2)\n#>  Variable   Units OddsRatio       CI.95 p-value \n#>        OA Control       Ref                     \n#>                OA      4.52 [4.19;4.87]  <1e-04\n```\n:::\n\n\n\n### Multivariable analysis\n\nRuns a more complex logistic regression model, adding multiple covariates to better understand the relationship.\n\n\n\n::: {.cell hash='surveydata4_cache/pdf/multivariable_b932df73f28f70e793e6acd7a429c395'}\n\n```{.r .cell-code}\nformula1 <- as.formula(I(CVD==\"event\") ~ OA + age + sex + married + race + \n              edu + income + bmi + phyact + doctor + stress + \n              smoke + drink + fruit + bp + diab + province + immigrate)\n\nfit3 <- svyglm(formula1, \n              design = w.design, \n              family = binomial(logit))\npublish(fit3)\n#>   Variable             Units OddsRatio         CI.95     p-value \n#>         OA           Control       Ref                           \n#>                           OA      1.52   [1.40;1.66]     < 1e-04 \n#>        age       20-29 years       Ref                           \n#>                  30-39 years      1.29   [0.98;1.69]   0.0707636 \n#>                  40-49 years      2.74   [2.17;3.47]     < 1e-04 \n#>                  50-59 years      6.24   [4.97;7.83]     < 1e-04 \n#>                  60-64 years      9.71  [7.68;12.29]     < 1e-04 \n#>            65 years and over     15.85 [12.57;20.00]     < 1e-04 \n#>                         teen      0.46   [0.20;1.07]   0.0707295 \n#>        sex            Female       Ref                           \n#>                         Male      1.73   [1.60;1.88]     < 1e-04 \n#>    married        not single       Ref                           \n#>                       single      0.97   [0.90;1.05]   0.5209444 \n#>       race         Non-white       Ref                           \n#>                        White      1.44   [1.19;1.75]   0.0002219 \n#>        edu          < 2ndary       Ref                           \n#>                    2nd grad.      0.90   [0.80;1.00]   0.0512330 \n#>              Other 2nd grad.      0.97   [0.83;1.13]   0.6737665 \n#>               Post-2nd grad.      0.93   [0.85;1.02]   0.1016562 \n#>     income   $29,999 or less       Ref                           \n#>              $30,000-$49,999      0.74   [0.67;0.81]     < 1e-04 \n#>              $50,000-$79,999      0.64   [0.58;0.72]     < 1e-04 \n#>              $80,000 or more      0.58   [0.51;0.66]     < 1e-04 \n#>        bmi       Underweight       Ref                           \n#>               healthy weight      0.86   [0.67;1.10]   0.2350526 \n#>                   Overweight      0.88   [0.69;1.12]   0.3033213 \n#>     phyact            Active       Ref                           \n#>                     Inactive      1.21   [1.10;1.34]   0.0001345 \n#>                     Moderate      1.08   [0.97;1.21]   0.1771985 \n#>     doctor                No       Ref                           \n#>                          Yes      1.75   [1.49;2.06]     < 1e-04 \n#>     stress  Not too stressed       Ref                           \n#>                     stressed      1.30   [1.18;1.42]     < 1e-04 \n#>      smoke      Never smoker       Ref                           \n#>               Current smoker      1.18   [1.05;1.32]   0.0050518 \n#>                Former smoker      1.21   [1.11;1.33]     < 1e-04 \n#>      drink       Never drank       Ref                           \n#>              Current drinker      0.82   [0.68;0.98]   0.0290605 \n#>                Former driker      1.13   [0.93;1.36]   0.2133779 \n#>      fruit 0-3 daily serving       Ref                           \n#>            4-6 daily serving      0.94   [0.86;1.03]   0.1758214 \n#>             6+ daily serving      1.09   [0.97;1.23]   0.1311029 \n#>         bp                No       Ref                           \n#>                          Yes      2.35   [2.16;2.55]     < 1e-04 \n#>       diab                No       Ref                           \n#>                          Yes      1.86   [1.66;2.07]     < 1e-04 \n#>   province             South       Ref                           \n#>                        North      1.21   [0.90;1.62]   0.2103030 \n#>  immigrate     not immigrant       Ref                           \n#>                   > 10 years      1.02   [0.89;1.16]   0.8057243 \n#>                       recent      1.06   [0.73;1.53]   0.7651069\n```\n:::\n\n\n\n#### Model fit assessment\n\n#### Variability explained\n\nPseudo-R-square values indicate how much of the total variability in the outcomes is explainable by the fitted model (analogous to R-square). For a continuous outcome, we can compute R-square, while R-square cannot be calculated when the outcome variable is categorical, nominal or ordinal. We use pseudo-R-squared measures when the dependent variable is not continuous but a likelihood function is used to fit a model. Popular Pseudo-R-square measures are:\n\n1.  [Cox/Snell](https://en.wikipedia.org/wiki/Pseudo-R-squared) (never reaches max 1)\n2.  [Nagelkerke R-square](https://en.wikipedia.org/wiki/Pseudo-R-squared) (scaled to max 1)\n\n-   The larger Cox & Snell estimate is the better the model.\n-   These Pseudo-R-square values should be interpreted with caution (if not ignored).\n-   They offer little confidence in interpreting the model fit.\n-   Survey weighted version of them are available.\n-   Not trivial to decide which statistic to use under complex surveys.\n\nEvaluates the model fit using Akaike Information Criterion (AIC) and pseudo R-squared metrics.\n\n\n\n::: {.cell hash='surveydata4_cache/pdf/fit_1be6742f69302227b5f9a0bbb3eddc32'}\n\n```{.r .cell-code}\nfit3 <- svyglm(formula1, \n              design = w.design, \n              family = quasibinomial(logit)) # publish does not work\nAIC(fit3) \n#>        eff.p          AIC     deltabar \n#>    67.752064 45362.706032     2.053093\n\n# AIC for survey weighted regressions\npsrsq(fit3, method = \"Cox-Snell\")\n#> [1] 0.06091896\npsrsq(fit3, method = \"Nagelkerke\")\n#> [1] 0.2307586\n# Nagelkerke and Cox-Snell pseudo-rsquared statistics\n```\n:::\n\n\n\n### Backward Elimination\n\n-   Model comparisons\n    -   LRT-aprroximation\n    -   Wald-based\n\n#### Checking one by one\n\nChecks the significance of each variable one by one and removes those that are not statistically significant.\n\n\n\n::: {.cell hash='surveydata4_cache/pdf/be_a0fd2231ddab8107c2f259085cff2f84'}\n\n```{.r .cell-code}\nround(sort(summary(fit3)$coef[,\"Pr(>|t|)\"]),2)\n#>            (Intercept)   age65 years and over                  bpYes \n#>                   0.00                   0.00                   0.00 \n#>         age60-64 years         age50-59 years                sexMale \n#>                   0.00                   0.00                   0.00 \n#>                diabYes                   OAOA  income$80,000 or more \n#>                   0.00                   0.00                   0.00 \n#>         age40-49 years  income$50,000-$79,999              doctorYes \n#>                   0.00                   0.00                   0.00 \n#>  income$30,000-$49,999         stressstressed     smokeFormer smoker \n#>                   0.00                   0.00                   0.00 \n#>         phyactInactive              raceWhite    smokeCurrent smoker \n#>                   0.00                   0.00                   0.01 \n#>   drinkCurrent drinker           edu2nd grad.                ageteen \n#>                   0.03                   0.05                   0.07 \n#>         age30-39 years      eduPost-2nd grad.  fruit6+ daily serving \n#>                   0.07                   0.10                   0.13 \n#> fruit4-6 daily serving         phyactModerate          provinceNorth \n#>                   0.18                   0.18                   0.21 \n#>     drinkFormer driker      bmihealthy weight          bmiOverweight \n#>                   0.21                   0.24                   0.30 \n#>          marriedsingle     eduOther 2nd grad.        immigraterecent \n#>                   0.52                   0.67                   0.77 \n#>    immigrate> 10 years \n#>                   0.81\n# bmiOverweight is associated with largest p-value\n# but what about other categories?\n\nregTermTest(fit3,~bmi) # coef of all bmi cat = 0\n#> Wald test for bmi\n#>  in svyglm(formula = formula1, design = w.design, family = quasibinomial(logit))\n#> F =  0.7591291  on  2  and  185579  df: p= 0.46808\nfit4 <- update(fit3, .~. -bmi) \n\nanova(fit3, fit4)\n#> Working (Rao-Scott+F) LRT for bmi\n#>  in svyglm(formula = formula1, design = w.design, family = quasibinomial(logit))\n#> Working 2logLR =  1.424634 p= 0.49071 \n#> (scale factors:  1.1 0.93 );  denominator df= 185579\n# high p-value (in both wald and Anova) makes it more likely that you should exclude bmi\nAIC(fit3,fit4) \n#>         eff.p      AIC deltabar\n#> [1,] 67.75206 45362.71 2.053093\n#> [2,] 64.30460 45358.26 2.074342\nround(sort(summary(fit4)$coef[,\"Pr(>|t|)\"]),2)\n#>            (Intercept)   age65 years and over                  bpYes \n#>                   0.00                   0.00                   0.00 \n#>         age60-64 years         age50-59 years                sexMale \n#>                   0.00                   0.00                   0.00 \n#>                diabYes                   OAOA  income$80,000 or more \n#>                   0.00                   0.00                   0.00 \n#>         age40-49 years  income$50,000-$79,999              doctorYes \n#>                   0.00                   0.00                   0.00 \n#>  income$30,000-$49,999         stressstressed     smokeFormer smoker \n#>                   0.00                   0.00                   0.00 \n#>         phyactInactive              raceWhite    smokeCurrent smoker \n#>                   0.00                   0.00                   0.00 \n#>   drinkCurrent drinker           edu2nd grad.         age30-39 years \n#>                   0.03                   0.05                   0.07 \n#>                ageteen      eduPost-2nd grad.  fruit6+ daily serving \n#>                   0.07                   0.10                   0.13 \n#> fruit4-6 daily serving         phyactModerate          provinceNorth \n#>                   0.17                   0.17                   0.21 \n#>     drinkFormer driker          marriedsingle     eduOther 2nd grad. \n#>                   0.21                   0.53                   0.67 \n#>        immigraterecent    immigrate> 10 years \n#>                   0.76                   0.81\n```\n:::\n\n\n\n#### Using AIC to automate\n\nUses stepwise regression guided by AIC to automatically select the most important variables.\n\n\n\n::: {.cell hash='surveydata4_cache/pdf/aic_57882fe80c22d49d8c804312d698f794'}\n\n```{.r .cell-code}\nrequire(MASS)\nformula1b <- as.formula(I(CVD==\"event\") ~ OA + age + sex)\nfit1b <- svyglm(formula1b, \n              design = w.design, \n              family = binomial(logit))\nfit5 <- stepAIC(fit1b, direction = \"backward\")\n#> Start:  AIC=47384.51\n#> I(CVD == \"event\") ~ OA + age + sex\n#> \n#>        Df Deviance   AIC\n#> <none>       47353 47385\n#> - sex   1    47634 47658\n#> - OA    1    47679 47702\n#> - age   6    54414 54291\n```\n:::\n\n::: {.cell hash='surveydata4_cache/pdf/resround_6637b60537e52859334b7d38241a951c'}\n\n```{.r .cell-code}\npublish(fit5)\n#>  Variable             Units OddsRatio         CI.95   p-value \n#>        OA           Control       Ref                         \n#>                          OA      1.81   [1.66;1.97]   < 1e-04 \n#>       age       20-29 years       Ref                         \n#>                 30-39 years      1.40   [1.07;1.84]   0.01374 \n#>                 40-49 years      3.39   [2.69;4.27]   < 1e-04 \n#>                 50-59 years      9.42  [7.55;11.76]   < 1e-04 \n#>                 60-64 years     17.78 [14.22;22.23]   < 1e-04 \n#>           65 years and over     33.82 [27.26;41.97]   < 1e-04 \n#>                        teen      0.45   [0.20;1.02]   0.05462 \n#>       sex            Female       Ref                         \n#>                        Male      1.57   [1.46;1.69]   < 1e-04\nround(sort(summary(fit5)$coef[,\"Pr(>|t|)\"]),2)\n#>          (Intercept) age65 years and over       age60-64 years \n#>                 0.00                 0.00                 0.00 \n#>       age50-59 years                 OAOA              sexMale \n#>                 0.00                 0.00                 0.00 \n#>       age40-49 years       age30-39 years              ageteen \n#>                 0.00                 0.01                 0.05\n```\n:::\n\n\n\n#### Using AIC, but keeping importants\n\nSimilar to the previous step but ensures certain important variables remain in the model.\n\n\n\n::: {.cell hash='surveydata4_cache/pdf/aic2_72767f0b1f8382faf3afe77dd95afaa2'}\n\n```{.r .cell-code}\nformula1c <- as.formula(I(CVD==\"event\") ~ OA + age + sex + married + race +\n                         edu + income + bmi + phyact + fruit + bp + diab + \n                         doctor + stress + smoke + drink + province + immigrate)\nscope <- list(upper = ~ OA + age + sex + married + race +\n                         edu + income + bmi + phyact + fruit + bp + diab + \n                         doctor + stress + smoke + drink + province + immigrate,\n              lower = ~ OA + age + sex + married + race +\n                         edu + income + bmi + phyact + fruit + bp + diab)\n\nfit1c <- svyglm(formula1c, design = w.design, family = binomial(logit))\n\nfitstep <- step(fit1c, scope = scope, trace = FALSE, k = 2, direction = \"backward\")\n# k = 2 gives the genuine AIC\n```\n:::\n\n::: {.cell hash='surveydata4_cache/pdf/res_0909dfb2af16d23e03cc2eac5e1b35e7'}\n\n```{.r .cell-code}\npublish(fitstep)\n#>  Variable             Units OddsRatio         CI.95     p-value \n#>        OA           Control       Ref                           \n#>                          OA      1.52   [1.40;1.66]     < 1e-04 \n#>       age       20-29 years       Ref                           \n#>                 30-39 years      1.29   [0.98;1.70]   0.0697699 \n#>                 40-49 years      2.74   [2.17;3.47]     < 1e-04 \n#>                 50-59 years      6.24   [4.97;7.83]     < 1e-04 \n#>                 60-64 years      9.71  [7.68;12.28]     < 1e-04 \n#>           65 years and over     15.85 [12.57;19.98]     < 1e-04 \n#>                        teen      0.46   [0.20;1.07]   0.0705660 \n#>       sex            Female       Ref                           \n#>                        Male      1.73   [1.60;1.88]     < 1e-04 \n#>   married        not single       Ref                           \n#>                      single      0.97   [0.90;1.05]   0.5042496 \n#>      race         Non-white       Ref                           \n#>                       White      1.41   [1.18;1.70]   0.0001986 \n#>       edu          < 2ndary       Ref                           \n#>                   2nd grad.      0.90   [0.80;1.00]   0.0524940 \n#>             Other 2nd grad.      0.97   [0.83;1.13]   0.6732446 \n#>              Post-2nd grad.      0.93   [0.85;1.02]   0.1045975 \n#>    income   $29,999 or less       Ref                           \n#>             $30,000-$49,999      0.74   [0.67;0.81]     < 1e-04 \n#>             $50,000-$79,999      0.64   [0.58;0.72]     < 1e-04 \n#>             $80,000 or more      0.58   [0.51;0.66]     < 1e-04 \n#>       bmi       Underweight       Ref                           \n#>              healthy weight      0.86   [0.67;1.10]   0.2316915 \n#>                  Overweight      0.88   [0.69;1.12]   0.2982852 \n#>    phyact            Active       Ref                           \n#>                    Inactive      1.22   [1.10;1.34]   0.0001227 \n#>                    Moderate      1.08   [0.97;1.21]   0.1754422 \n#>     fruit 0-3 daily serving       Ref                           \n#>           4-6 daily serving      0.94   [0.86;1.03]   0.1807666 \n#>            6+ daily serving      1.09   [0.97;1.23]   0.1295281 \n#>        bp                No       Ref                           \n#>                         Yes      2.35   [2.16;2.55]     < 1e-04 \n#>      diab                No       Ref                           \n#>                         Yes      1.85   [1.66;2.07]     < 1e-04 \n#>    doctor                No       Ref                           \n#>                         Yes      1.75   [1.49;2.05]     < 1e-04 \n#>    stress  Not too stressed       Ref                           \n#>                    stressed      1.30   [1.18;1.42]     < 1e-04 \n#>     smoke      Never smoker       Ref                           \n#>              Current smoker      1.17   [1.05;1.31]   0.0053412 \n#>               Former smoker      1.21   [1.10;1.33]     < 1e-04 \n#>     drink       Never drank       Ref                           \n#>             Current drinker      0.82   [0.68;0.98]   0.0254942 \n#>               Former driker      1.12   [0.93;1.36]   0.2205315\nround(sort(summary(fitstep)$coef[,\"Pr(>|t|)\"]),2)\n#>            (Intercept)   age65 years and over                  bpYes \n#>                   0.00                   0.00                   0.00 \n#>         age60-64 years         age50-59 years                sexMale \n#>                   0.00                   0.00                   0.00 \n#>                diabYes                   OAOA  income$80,000 or more \n#>                   0.00                   0.00                   0.00 \n#>         age40-49 years  income$50,000-$79,999              doctorYes \n#>                   0.00                   0.00                   0.00 \n#>  income$30,000-$49,999         stressstressed     smokeFormer smoker \n#>                   0.00                   0.00                   0.00 \n#>         phyactInactive              raceWhite    smokeCurrent smoker \n#>                   0.00                   0.00                   0.01 \n#>   drinkCurrent drinker           edu2nd grad.         age30-39 years \n#>                   0.03                   0.05                   0.07 \n#>                ageteen      eduPost-2nd grad.  fruit6+ daily serving \n#>                   0.07                   0.10                   0.13 \n#>         phyactModerate fruit4-6 daily serving     drinkFormer driker \n#>                   0.18                   0.18                   0.22 \n#>      bmihealthy weight          bmiOverweight          marriedsingle \n#>                   0.23                   0.30                   0.50 \n#>     eduOther 2nd grad. \n#>                   0.67\n```\n:::\n\n\n\n#### Assess interactions\n\nCheck biologically interesting ones.\n\n##### Check one by one\n\nChecks if there is a significant interaction effect between 'age' and 'sex'.\n\n\n\n::: {.cell hash='surveydata4_cache/pdf/interactions0_1656a12b94c71d1446fd9069e0c11b89'}\n\n```{.r .cell-code}\nfit8a <- update(fitstep, .~. + interaction(age,sex))\nanova(fitstep, fit8a) # keep interaction\n#> Working (Rao-Scott+F) LRT for interaction(age, sex)\n#>  in svyglm(formula = I(CVD == \"event\") ~ OA + age + sex + married + \n#>     race + edu + income + bmi + phyact + fruit + bp + diab + \n#>     doctor + stress + smoke + drink + interaction(age, sex), \n#>     design = w.design, family = binomial(logit))\n#> Working 2logLR =  40.16528 p= 1.2167e-06 \n#> (scale factors:  1.3 1.2 1.2 0.93 0.78 0.71 );  denominator df= 185576\n```\n:::\n\n\n\nChecks if there is a significant interaction effect between 'sex' and 'diabetes'.\n\n\n\n::: {.cell hash='surveydata4_cache/pdf/interactions1_3a4dec52d81ca64eb2c0bd6860667059'}\n\n```{.r .cell-code}\nfit8b <- update(fitstep, .~. + interaction(sex,diab))\nanova(fitstep, fit8b) # Do not keep this interaction\n#> Working (Rao-Scott+F) LRT for interaction(sex, diab)\n#>  in svyglm(formula = I(CVD == \"event\") ~ OA + age + sex + married + \n#>     race + edu + income + bmi + phyact + fruit + bp + diab + \n#>     doctor + stress + smoke + drink + interaction(sex, diab), \n#>     design = w.design, family = binomial(logit))\n#> Working 2logLR =  0.4591456 p= 0.49597 \n#> df=1;  denominator df= 185581\n```\n:::\n\n\n\nChecks if there is a significant interaction effect between 'BMI' and 'diabetes'.\n\n\n\n::: {.cell hash='surveydata4_cache/pdf/interactions2_6238ddc84fe09acc7adaa7e67ee6ecd2'}\n\n```{.r .cell-code}\nfit8c <- update(fitstep, .~. + interaction(bmi,diab))\nanova(fitstep, fit8c) # keep this interaction\n#> Working (Rao-Scott+F) LRT for interaction(bmi, diab)\n#>  in svyglm(formula = I(CVD == \"event\") ~ OA + age + sex + married + \n#>     race + edu + income + bmi + phyact + fruit + bp + diab + \n#>     doctor + stress + smoke + drink + interaction(bmi, diab), \n#>     design = w.design, family = binomial(logit))\n#> Working 2logLR =  7.92727 p= 0.02533 \n#> (scale factors:  1.4 0.6 );  denominator df= 185580\n```\n:::\n\n\n\n##### Add all significant interactions in 1 model\n\nUpdates the model to include significant interaction terms.\n\nNote that we have 0 effect modifier, 2 interactions\n\n\n\n::: {.cell hash='surveydata4_cache/pdf/interactions3_f3a4899dc4db7067c8137764cf00c50a'}\n\n```{.r .cell-code}\nfit9 <- update(fitstep, .~. + interaction(age,sex) + interaction(bmi,diab))\nrequire(jtools)\nsumm(fit9, confint = TRUE, digits = 3)\n```\n\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{lr}\n\\toprule\n\\cellcolor{gray!6}{Observations} & \\cellcolor{gray!6}{185613}\\\\\nDependent variable & I(CVD == \"event\")\\\\\n\\cellcolor{gray!6}{Type} & \\cellcolor{gray!6}{Survey-weighted generalized linear model}\\\\\nFamily & binomial\\\\\n\\cellcolor{gray!6}{Link} & \\cellcolor{gray!6}{logit}\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table} \\begin{table}[!h]\n\\centering\n\\begin{tabular}{lr}\n\\toprule\n\\cellcolor{gray!6}{Pseudo-R² (Cragg-Uhler)} & \\cellcolor{gray!6}{0.233}\\\\\nPseudo-R² (McFadden) & 0.207\\\\\n\\cellcolor{gray!6}{AIC} & \\cellcolor{gray!6}{41548.160}\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table} \\begin{table}[!h]\n\\centering\n\\begin{threeparttable}\n\\begin{tabular}{lrrrrr}\n\\toprule\n  & Est. & 2.5\\% & 97.5\\% & t val. & p\\\\\n\\midrule\n\\cellcolor{gray!6}{(Intercept)} & \\cellcolor{gray!6}{-5.590} & \\cellcolor{gray!6}{-6.046} & \\cellcolor{gray!6}{-5.135} & \\cellcolor{gray!6}{-24.069} & \\cellcolor{gray!6}{0.000}\\\\\nOAOA & 0.438 & 0.352 & 0.523 & 10.043 & 0.000\\\\\n\\cellcolor{gray!6}{age30-39 years} & \\cellcolor{gray!6}{0.299} & \\cellcolor{gray!6}{-0.118} & \\cellcolor{gray!6}{0.717} & \\cellcolor{gray!6}{1.405} & \\cellcolor{gray!6}{0.160}\\\\\nage40-49 years & 1.158 & 0.794 & 1.522 & 6.236 & 0.000\\\\\n\\cellcolor{gray!6}{age50-59 years} & \\cellcolor{gray!6}{2.181} & \\cellcolor{gray!6}{1.831} & \\cellcolor{gray!6}{2.531} & \\cellcolor{gray!6}{12.212} & \\cellcolor{gray!6}{0.000}\\\\\n\\addlinespace\nage60-64 years & 2.619 & 2.263 & 2.976 & 14.395 & 0.000\\\\\n\\cellcolor{gray!6}{age65 years and over} & \\cellcolor{gray!6}{3.033} & \\cellcolor{gray!6}{2.680} & \\cellcolor{gray!6}{3.387} & \\cellcolor{gray!6}{16.833} & \\cellcolor{gray!6}{0.000}\\\\\nageteen & -0.695 & -1.704 & 0.314 & -1.350 & 0.177\\\\\n\\cellcolor{gray!6}{sexMale} & \\cellcolor{gray!6}{-0.028} & \\cellcolor{gray!6}{-0.447} & \\cellcolor{gray!6}{0.390} & \\cellcolor{gray!6}{-0.133} & \\cellcolor{gray!6}{0.895}\\\\\nmarriedsingle & -0.016 & -0.096 & 0.064 & -0.382 & 0.703\\\\\n\\addlinespace\n\\cellcolor{gray!6}{raceWhite} & \\cellcolor{gray!6}{0.348} & \\cellcolor{gray!6}{0.165} & \\cellcolor{gray!6}{0.531} & \\cellcolor{gray!6}{3.724} & \\cellcolor{gray!6}{0.000}\\\\\nedu2nd grad. & -0.107 & -0.217 & 0.003 & -1.906 & 0.057\\\\\n\\cellcolor{gray!6}{eduOther 2nd grad.} & \\cellcolor{gray!6}{-0.039} & \\cellcolor{gray!6}{-0.192} & \\cellcolor{gray!6}{0.114} & \\cellcolor{gray!6}{-0.498} & \\cellcolor{gray!6}{0.618}\\\\\neduPost-2nd grad. & -0.081 & -0.173 & 0.010 & -1.746 & 0.081\\\\\n\\cellcolor{gray!6}{income\\$30,000-\\$49,999} & \\cellcolor{gray!6}{-0.304} & \\cellcolor{gray!6}{-0.400} & \\cellcolor{gray!6}{-0.208} & \\cellcolor{gray!6}{-6.215} & \\cellcolor{gray!6}{0.000}\\\\\n\\addlinespace\nincome\\$50,000-\\$79,999 & -0.444 & -0.552 & -0.336 & -8.034 & 0.000\\\\\n\\cellcolor{gray!6}{income\\$80,000 or more} & \\cellcolor{gray!6}{-0.555} & \\cellcolor{gray!6}{-0.684} & \\cellcolor{gray!6}{-0.426} & \\cellcolor{gray!6}{-8.424} & \\cellcolor{gray!6}{0.000}\\\\\nbmihealthy weight & -1.406 & -2.677 & -0.135 & -2.167 & 0.030\\\\\n\\cellcolor{gray!6}{bmiOverweight} & \\cellcolor{gray!6}{-1.110} & \\cellcolor{gray!6}{-2.375} & \\cellcolor{gray!6}{0.154} & \\cellcolor{gray!6}{-1.721} & \\cellcolor{gray!6}{0.085}\\\\\nphyactInactive & 0.194 & 0.094 & 0.293 & 3.817 & 0.000\\\\\n\\addlinespace\n\\cellcolor{gray!6}{phyactModerate} & \\cellcolor{gray!6}{0.077} & \\cellcolor{gray!6}{-0.034} & \\cellcolor{gray!6}{0.187} & \\cellcolor{gray!6}{1.353} & \\cellcolor{gray!6}{0.176}\\\\\nfruit4-6 daily serving & -0.062 & -0.155 & 0.031 & -1.313 & 0.189\\\\\n\\cellcolor{gray!6}{fruit6+ daily serving} & \\cellcolor{gray!6}{0.094} & \\cellcolor{gray!6}{-0.023} & \\cellcolor{gray!6}{0.211} & \\cellcolor{gray!6}{1.579} & \\cellcolor{gray!6}{0.114}\\\\\nbpYes & 0.861 & 0.778 & 0.944 & 20.354 & 0.000\\\\\n\\cellcolor{gray!6}{diabYes} & \\cellcolor{gray!6}{1.745} & \\cellcolor{gray!6}{0.462} & \\cellcolor{gray!6}{3.027} & \\cellcolor{gray!6}{2.667} & \\cellcolor{gray!6}{0.008}\\\\\n\\addlinespace\ndoctorYes & 0.535 & 0.372 & 0.697 & 6.447 & 0.000\\\\\n\\cellcolor{gray!6}{stressstressed} & \\cellcolor{gray!6}{0.256} & \\cellcolor{gray!6}{0.164} & \\cellcolor{gray!6}{0.347} & \\cellcolor{gray!6}{5.483} & \\cellcolor{gray!6}{0.000}\\\\\nsmokeCurrent smoker & 0.152 & 0.039 & 0.266 & 2.628 & 0.009\\\\\n\\cellcolor{gray!6}{smokeFormer smoker} & \\cellcolor{gray!6}{0.177} & \\cellcolor{gray!6}{0.082} & \\cellcolor{gray!6}{0.272} & \\cellcolor{gray!6}{3.654} & \\cellcolor{gray!6}{0.000}\\\\\ndrinkCurrent drinker & -0.205 & -0.381 & -0.029 & -2.277 & 0.023\\\\\n\\addlinespace\n\\cellcolor{gray!6}{drinkFormer driker} & \\cellcolor{gray!6}{0.116} & \\cellcolor{gray!6}{-0.072} & \\cellcolor{gray!6}{0.303} & \\cellcolor{gray!6}{1.210} & \\cellcolor{gray!6}{0.226}\\\\\ninteraction(age, sex)30-39 years.Female & -0.083 & -0.622 & 0.457 & -0.300 & 0.764\\\\\n\\cellcolor{gray!6}{interaction(age, sex)40-49 years.Female} & \\cellcolor{gray!6}{-0.302} & \\cellcolor{gray!6}{-0.766} & \\cellcolor{gray!6}{0.161} & \\cellcolor{gray!6}{-1.278} & \\cellcolor{gray!6}{0.201}\\\\\ninteraction(age, sex)50-59 years.Female & -0.810 & -1.258 & -0.362 & -3.543 & 0.000\\\\\n\\cellcolor{gray!6}{interaction(age, sex)60-64 years.Female} & \\cellcolor{gray!6}{-0.787} & \\cellcolor{gray!6}{-1.237} & \\cellcolor{gray!6}{-0.337} & \\cellcolor{gray!6}{-3.428} & \\cellcolor{gray!6}{0.001}\\\\\n\\addlinespace\ninteraction(age, sex)65 years and over.Female & -0.603 & -1.035 & -0.170 & -2.733 & 0.006\\\\\n\\cellcolor{gray!6}{interaction(age, sex)teen.Female} & \\cellcolor{gray!6}{-0.129} & \\cellcolor{gray!6}{-1.806} & \\cellcolor{gray!6}{1.548} & \\cellcolor{gray!6}{-0.151} & \\cellcolor{gray!6}{0.880}\\\\\ninteraction(bmi, diab)healthy weight.No & 1.380 & 0.085 & 2.675 & 2.089 & 0.037\\\\\n\\cellcolor{gray!6}{interaction(bmi, diab)Overweight.No} & \\cellcolor{gray!6}{1.085} & \\cellcolor{gray!6}{-0.204} & \\cellcolor{gray!6}{2.373} & \\cellcolor{gray!6}{1.650} & \\cellcolor{gray!6}{0.099}\\\\\n\\bottomrule\n\\end{tabular}\n\\begin{tablenotes}\n\\item Standard errors: Robust\n\\end{tablenotes}\n\\end{threeparttable}\n\\end{table}\n:::\n:::\n\n::: {.cell hash='surveydata4_cache/pdf/interactions4_f3278ec0ec8da29a5b698782186e2126'}\n\n```{.r .cell-code}\nfit9 <- update(fitstep, .~. + age:sex + bmi:diab)\npublish(fit9)\n#>                                            Variable             Units OddsRatio         CI.95     p-value \n#>                                                  OA           Control       Ref                           \n#>                                                                    OA      1.55   [1.42;1.69]     < 1e-04 \n#>                                             married        not single       Ref                           \n#>                                                                single      0.98   [0.91;1.07]   0.7026897 \n#>                                                race         Non-white       Ref                           \n#>                                                                 White      1.42   [1.18;1.70]   0.0001960 \n#>                                                 edu          < 2ndary       Ref                           \n#>                                                             2nd grad.      0.90   [0.81;1.00]   0.0566536 \n#>                                                       Other 2nd grad.      0.96   [0.83;1.12]   0.6183383 \n#>                                                        Post-2nd grad.      0.92   [0.84;1.01]   0.0807393 \n#>                                              income   $29,999 or less       Ref                           \n#>                                                       $30,000-$49,999      0.74   [0.67;0.81]     < 1e-04 \n#>                                                       $50,000-$79,999      0.64   [0.58;0.71]     < 1e-04 \n#>                                                       $80,000 or more      0.57   [0.50;0.65]     < 1e-04 \n#>                                              phyact            Active       Ref                           \n#>                                                              Inactive      1.21   [1.10;1.34]   0.0001349 \n#>                                                              Moderate      1.08   [0.97;1.21]   0.1760803 \n#>                                               fruit 0-3 daily serving       Ref                           \n#>                                                     4-6 daily serving      0.94   [0.86;1.03]   0.1892549 \n#>                                                      6+ daily serving      1.10   [0.98;1.23]   0.1142759 \n#>                                                  bp                No       Ref                           \n#>                                                                   Yes      2.37   [2.18;2.57]     < 1e-04 \n#>                                              doctor                No       Ref                           \n#>                                                                   Yes      1.71   [1.45;2.01]     < 1e-04 \n#>                                              stress  Not too stressed       Ref                           \n#>                                                              stressed      1.29   [1.18;1.42]     < 1e-04 \n#>                                               smoke      Never smoker       Ref                           \n#>                                                        Current smoker      1.16   [1.04;1.30]   0.0085960 \n#>                                                         Former smoker      1.19   [1.09;1.31]   0.0002579 \n#>                                               drink       Never drank       Ref                           \n#>                                                       Current drinker      0.81   [0.68;0.97]   0.0227934 \n#>                                                         Former driker      1.12   [0.93;1.35]   0.2264702 \n#>               age(20-29 years): sex(Male vs Female)                        0.97   [0.64;1.48]   0.8945322 \n#>               age(30-39 years): sex(Male vs Female)                        1.06   [0.75;1.49]   0.7583565 \n#>               age(40-49 years): sex(Male vs Female)                        1.32   [1.07;1.62]   0.0091527 \n#>               age(50-59 years): sex(Male vs Female)                        2.18   [1.85;2.58]     < 1e-04 \n#>               age(60-64 years): sex(Male vs Female)                        2.14   [1.80;2.53]     < 1e-04 \n#>         age(65 years and over): sex(Male vs Female)                        1.78   [1.58;1.99]     < 1e-04 \n#>                      age(teen): sex(Male vs Female)                        1.11   [0.22;5.62]   0.9033924 \n#>        sex(Female): age(30-39 years vs 20-29 years)                        1.24   [0.87;1.77]   0.2276609 \n#>        sex(Female): age(40-49 years vs 20-29 years)                        2.35   [1.75;3.16]     < 1e-04 \n#>        sex(Female): age(50-59 years vs 20-29 years)                        3.94   [2.95;5.27]     < 1e-04 \n#>        sex(Female): age(60-64 years vs 20-29 years)                        6.25   [4.66;8.39]     < 1e-04 \n#>  sex(Female): age(65 years and over vs 20-29 years)                       11.37  [8.60;15.02]     < 1e-04 \n#>               sex(Female): age(teen vs 20-29 years)                        0.44   [0.11;1.69]   0.2320840 \n#>          sex(Male): age(30-39 years vs 20-29 years)                        1.35   [0.89;2.05]   0.1599938 \n#>          sex(Male): age(40-49 years vs 20-29 years)                        3.18   [2.21;4.58]     < 1e-04 \n#>          sex(Male): age(50-59 years vs 20-29 years)                        8.85  [6.24;12.56]     < 1e-04 \n#>          sex(Male): age(60-64 years vs 20-29 years)                       13.73  [9.61;19.61]     < 1e-04 \n#>    sex(Male): age(65 years and over vs 20-29 years)                       20.77 [14.59;29.57]     < 1e-04 \n#>                 sex(Male): age(teen vs 20-29 years)                        0.50   [0.18;1.37]   0.1769155 \n#>                   bmi(Underweight): diab(Yes vs No)                        5.72  [1.59;20.63]   0.0076561 \n#>                bmi(healthy weight): diab(Yes vs No)                        1.44   [1.19;1.75]   0.0002221 \n#>                    bmi(Overweight): diab(Yes vs No)                        1.93   [1.70;2.20]     < 1e-04 \n#>        diab(No): bmi(healthy weight vs Underweight)                        0.97   [0.76;1.25]   0.8394972 \n#>            diab(No): bmi(Overweight vs Underweight)                        0.97   [0.76;1.25]   0.8400722 \n#>       diab(Yes): bmi(healthy weight vs Underweight)                        0.25   [0.07;0.87]   0.0302066 \n#>           diab(Yes): bmi(Overweight vs Underweight)                        0.33   [0.09;1.17]   0.0852377\n```\n:::\n\n::: {.cell hash='surveydata4_cache/pdf/interactions5_0069a084a155f6535559dc492997eacd'}\n\n```{.r .cell-code}\nbasic.model <- eval(fit5$call[[2]])\nbasic.model\n#> I(CVD == \"event\") ~ OA + age + sex\n#> attr(,\"variables\")\n#> list(I(CVD == \"event\"), OA, age, sex)\n#> attr(,\"factors\")\n#>                   OA age sex\n#> I(CVD == \"event\")  0   0   0\n#> OA                 1   0   0\n#> age                0   1   0\n#> sex                0   0   1\n#> attr(,\"term.labels\")\n#> [1] \"OA\"  \"age\" \"sex\"\n#> attr(,\"order\")\n#> [1] 1 1 1\n#> attr(,\"intercept\")\n#> [1] 1\n#> attr(,\"response\")\n#> [1] 1\n#> attr(,\".Environment\")\n#> <environment: R_GlobalEnv>\n#> attr(,\"predvars\")\n#> list(I(CVD == \"event\"), OA, age, sex)\n#> attr(,\"dataClasses\")\n#> I(CVD == \"event\")                OA               age               sex \n#>         \"logical\"          \"factor\"          \"factor\"          \"factor\" \n#>         (weights) \n#>         \"numeric\"\n\naic.int.model <- eval(fit9$call[[2]])\naic.int.model\n#> I(CVD == \"event\") ~ OA + age + sex + married + race + edu + income + \n#>     bmi + phyact + fruit + bp + diab + doctor + stress + smoke + \n#>     drink + age:sex + bmi:diab\n```\n:::\n\n\n\n### Saving data\n\nSaves the final regression models for future use.\n\n\n\n::: {.cell hash='surveydata4_cache/pdf/save_d23e80d651267bf8c91eb30dedeead60'}\n\n```{.r .cell-code}\nsave(basic.model, aic.int.model, file = \"Data/surveydata/cchs123w2.RData\")\n```\n:::\n\n\n\n\n### Video content (optional)\n\n::: callout-tip\nFor those who prefer a video walkthrough, feel free to watch the video below, which offers a description of an earlier version of the above content.\n:::\n\n::: {style=\"position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;\"}\n<iframe src=\"https://www.youtube.com/embed/ebFkdeHV6m8\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;\" allowfullscreen>\n\n</iframe>\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"table\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"babel\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"greek\",\"english\"]}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}