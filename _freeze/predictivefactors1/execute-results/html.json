{
  "hash": "a2b799fe924884a0a08d550114b94b63",
  "result": {
    "markdown": "## Collinear predictors {.unnumbered}\n\nIn this tutorial, we'll continue with the data analysis. We'll focus on an analysis of an NHANES data. This data contains over 1200 observations and 33 variables. These variables come in various types: numeric, categorical, and binary. Our primary goal is to fit a linear regression model to predict cholesterol levels.\n\n\n\n::: {.cell hash='predictivefactors1_cache/html/setup_ada1c387083defe0ac5d7b2f28aabc48'}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(rms)\nlibrary(Hmisc)\n```\n:::\n\n\n### Load data\n\nLet us load the dataset and see structure of the variables:\n\n\n::: {.cell hash='predictivefactors1_cache/html/load_c8e3069978f01f6ac0e29c3c4422aec8'}\n\n```{.r .cell-code}\nload(file = \"Data/predictivefactors/cholesterolNHANES15.RData\")\n#head(analytic)\nstr(analytic)\n#> 'data.frame':\t1267 obs. of  33 variables:\n#>  $ ID                   : num  83732 83733 83741 83747 83750 ...\n#>  $ gender               : chr  \"Male\" \"Male\" \"Male\" \"Male\" ...\n#>  $ age                  : num  62 53 22 46 45 30 60 69 24 70 ...\n#>  $ born                 : chr  \"Born in 50 US states or Washingt\" \"Others\" \"Born in 50 US states or Washingt\" \"Others\" ...\n#>  $ race                 : chr  \"White\" \"White\" \"Black\" \"White\" ...\n#>  $ education            : chr  \"College\" \"High.School\" \"College\" \"College\" ...\n#>  $ married              : chr  \"Married\" \"Previously.married\" \"Never.married\" \"Married\" ...\n#>  $ income               : chr  \"Between.55kto99k\" \"<25k\" \"Between.25kto54k\" \"<25k\" ...\n#>  $ weight               : num  135630 25282 39353 35674 97002 ...\n#>  $ psu                  : num  1 1 2 1 1 1 1 2 1 2 ...\n#>  $ strata               : num  125 125 128 121 125 124 128 120 130 132 ...\n#>  $ diastolicBP          : num  70 88 70 94 70 50 74 70 72 54 ...\n#>  $ systolicBP           : num  128 146 110 144 116 104 142 146 126 144 ...\n#>  $ bodyweight           : num  94.8 90.4 76.6 86.2 76.2 71.2 75.6 84 89.2 81.7 ...\n#>  $ bodyheight           : num  184 171 165 177 178 ...\n#>  $ bmi                  : num  27.8 30.8 28 27.6 24.1 26.6 35.9 31 26.9 27 ...\n#>  $ waist                : num  101.1 107.9 86.6 104.3 90.1 ...\n#>  $ smoke                : chr  \"Not.at.all\" \"Every.day\" \"Some.days\" \"Every.day\" ...\n#>  $ alcohol              : num  1 6 8 1 3 2 1 1 2 2 ...\n#>  $ cholesterol          : num  173 265 164 242 181 184 205 287 126 192 ...\n#>  $ cholesterolM2        : num  4.47 6.85 4.24 6.26 4.68 4.76 5.3 7.42 3.26 4.97 ...\n#>  $ triglycerides        : num  158 170 77 497 63 62 169 245 95 64 ...\n#>  $ uric.acid            : num  4.2 7 6 6.5 5.4 5.5 5.1 4.3 7.6 7.1 ...\n#>  $ protein              : num  7.5 7.4 7.4 6.8 7.4 6.7 7.4 6.8 7.3 7.2 ...\n#>  $ bilirubin            : num  0.5 0.6 0.2 0.5 0.7 0.8 0.4 0.6 1.2 1.2 ...\n#>  $ phosphorus           : num  4.7 4.4 5.3 3.6 3.9 3.4 3.9 4.4 3.2 3 ...\n#>  $ sodium               : num  136 140 139 138 138 136 139 140 140 139 ...\n#>  $ potassium            : num  4.3 4.55 4.16 4.27 3.91 3.97 3.99 4.25 3.8 4.63 ...\n#>  $ globulin             : num  2.9 2.9 3 2.6 2.8 2.5 3.2 2.3 2.7 2.6 ...\n#>  $ calcium              : num  9.8 9.8 9.3 9.3 9.3 9.4 9.6 9.6 9.6 9.6 ...\n#>  $ physical.work        : chr  \"No\" \"No\" \"No\" \"No\" ...\n#>  $ physical.recreational: chr  \"No\" \"No\" \"Yes\" \"No\" ...\n#>  $ diabetes             : chr  \"Yes\" \"No\" \"No\" \"No\" ...\n#>  - attr(*, \"na.action\")= 'omit' Named int [1:3739] 3 4 5 6 8 9 13 14 15 16 ...\n#>   ..- attr(*, \"names\")= chr [1:3739] \"3\" \"4\" \"5\" \"6\" ...\n```\n:::\n\n\n### Describe the data\n\n\n::: {.cell hash='predictivefactors1_cache/html/data_239a149da818fe44f8e70a8ee9e2b933'}\n\n```{.r .cell-code}\nrequire(rms)\ndescribe(analytic) \n#> analytic \n#> \n#>  33  Variables      1267  Observations\n#> --------------------------------------------------------------------------------\n#> ID \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0     1267        1    88660     3366    84250    84687 \n#>      .25      .50      .75      .90      .95 \n#>    86019    88692    91252    92670    93089 \n#> \n#> lowest : 83732 83733 83741 83747 83750, highest: 93617 93633 93643 93659 93685\n#> --------------------------------------------------------------------------------\n#> gender \n#>        n  missing distinct \n#>     1267        0        2 \n#>                         \n#> Value      Female   Male\n#> Frequency     496    771\n#> Proportion  0.391  0.609\n#> --------------------------------------------------------------------------------\n#> age \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0       61        1    49.91    19.18       24       27 \n#>      .25      .50      .75      .90      .95 \n#>       36       51       63       72       78 \n#> \n#> lowest : 20 21 22 23 24, highest: 76 77 78 79 80\n#> --------------------------------------------------------------------------------\n#> born \n#>        n  missing distinct \n#>     1267        0        2 \n#>                                                                             \n#> Value      Born in 50 US states or Washingt                           Others\n#> Frequency                               991                              276\n#> Proportion                            0.782                            0.218\n#> --------------------------------------------------------------------------------\n#> race \n#>        n  missing distinct \n#>     1267        0        4 \n#>                                               \n#> Value         Black Hispanic    Other    White\n#> Frequency       246      337      132      552\n#> Proportion    0.194    0.266    0.104    0.436\n#> --------------------------------------------------------------------------------\n#> education \n#>        n  missing distinct \n#>     1267        0        3 \n#>                                               \n#> Value          College High.School      School\n#> Frequency          648         523          96\n#> Proportion       0.511       0.413       0.076\n#> --------------------------------------------------------------------------------\n#> married \n#>        n  missing distinct \n#>     1267        0        3 \n#>                                                                    \n#> Value                 Married      Never.married Previously.married\n#> Frequency                 751                226                290\n#> Proportion              0.593              0.178              0.229\n#> --------------------------------------------------------------------------------\n#> income \n#>        n  missing distinct \n#>     1267        0        4 \n#>                                                                               \n#> Value                  <25k Between.25kto54k Between.55kto99k         Over100k\n#> Frequency               344              435              297              191\n#> Proportion            0.272            0.343            0.234            0.151\n#> --------------------------------------------------------------------------------\n#> weight \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0     1184        1    48904    44337     9158    11549 \n#>      .25      .50      .75      .90      .95 \n#>    19540    30335    63822   121803   151546 \n#> \n#> lowest :   5470.041   5948.955   6197.660   6480.947   6703.837\n#> highest: 203562.855 207197.232 213611.345 218138.797 224891.623\n#> --------------------------------------------------------------------------------\n#> psu \n#>        n  missing distinct     Info     Mean      Gmd \n#>     1267        0        2     0.75    1.493   0.5003 \n#>                       \n#> Value          1     2\n#> Frequency    642   625\n#> Proportion 0.507 0.493\n#> --------------------------------------------------------------------------------\n#> strata \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0       15    0.994    126.3    4.792      120      121 \n#>      .25      .50      .75      .90      .95 \n#>      123      126      130      132      133 \n#> \n#> lowest : 119 120 121 122 123, highest: 129 130 131 132 133\n#>                                                                             \n#> Value        119   120   121   122   123   124   125   126   127   128   129\n#> Frequency     47    74   118    63    77    66   114   104   107    65    53\n#> Proportion 0.037 0.058 0.093 0.050 0.061 0.052 0.090 0.082 0.084 0.051 0.042\n#>                                   \n#> Value        130   131   132   133\n#> Frequency     99   120    95    65\n#> Proportion 0.078 0.095 0.075 0.051\n#> --------------------------------------------------------------------------------\n#> diastolicBP \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0       41    0.997    70.37    13.99       52       54 \n#>      .25      .50      .75      .90      .95 \n#>       62       70       78       86       92 \n#> \n#> lowest :   0  26  34  38  40, highest: 104 106 108 110 112\n#> --------------------------------------------------------------------------------\n#> systolicBP \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0       56    0.998    126.5     19.3    102.0    106.0 \n#>      .25      .50      .75      .90      .95 \n#>    114.0    124.0    136.0    148.8    160.0 \n#> \n#> lowest :  84  88  90  92  94, highest: 194 196 206 218 236\n#> --------------------------------------------------------------------------------\n#> bodyweight \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0      615        1    84.95    23.56    56.29    61.10 \n#>      .25      .50      .75      .90      .95 \n#>    69.70    81.40    97.00   113.44   127.47 \n#> \n#> lowest :  39.7  39.8  40.7  42.6  42.7, highest: 161.9 166.3 175.7 175.9 178.4\n#> --------------------------------------------------------------------------------\n#> bodyheight \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0      376        1    169.2    10.66    153.8    157.0 \n#>      .25      .50      .75      .90      .95 \n#>    162.6    169.3    176.2    181.1    184.2 \n#> \n#> lowest : 143.8 144.2 145.2 145.9 146.2, highest: 194.6 195.1 195.6 198.4 201.0\n#> --------------------------------------------------------------------------------\n#> bmi \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0      284        1    29.58    7.403    20.60    22.06 \n#>      .25      .50      .75      .90      .95 \n#>    24.80    28.60    33.30    38.24    42.00 \n#> \n#> lowest : 16.3 17.5 17.6 17.7 17.9, highest: 57.2 57.6 59.4 60.7 64.5\n#> --------------------------------------------------------------------------------\n#> waist \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0      544        1    101.8    18.47     77.1     81.4 \n#>      .25      .50      .75      .90      .95 \n#>     90.5    100.3    111.2    122.8    132.5 \n#> \n#> lowest :  65.0  65.5  66.5  68.2  68.7, highest: 159.2 159.8 160.2 160.5 161.5\n#> --------------------------------------------------------------------------------\n#> smoke \n#>        n  missing distinct \n#>     1267        0        3 \n#>                                            \n#> Value       Every.day Not.at.all  Some.days\n#> Frequency         448        665        154\n#> Proportion      0.354      0.525      0.122\n#> --------------------------------------------------------------------------------\n#> alcohol \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0       14    0.952    3.109    2.419        1        1 \n#>      .25      .50      .75      .90      .95 \n#>        1        2        4        6        8 \n#> \n#> lowest :  1  2  3  4  5, highest: 10 11 12 14 15\n#>                                                                             \n#> Value          1     2     3     4     5     6     7     8     9    10    11\n#> Frequency    336   371   189   106    79    95    10    26     4    20     1\n#> Proportion 0.265 0.293 0.149 0.084 0.062 0.075 0.008 0.021 0.003 0.016 0.001\n#>                             \n#> Value         12    14    15\n#> Frequency     23     1     6\n#> Proportion 0.018 0.001 0.005\n#> --------------------------------------------------------------------------------\n#> cholesterol \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0      203        1    193.1    47.47    132.0    142.0 \n#>      .25      .50      .75      .90      .95 \n#>    162.5    191.0    217.0    248.0    268.0 \n#> \n#> lowest :  81  93  97 100 101, highest: 345 348 349 358 545\n#> --------------------------------------------------------------------------------\n#> cholesterolM2 \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0      203        1    4.994    1.228    3.410    3.670 \n#>      .25      .50      .75      .90      .95 \n#>    4.205    4.940    5.610    6.410    6.930 \n#> \n#> lowest :  2.09  2.40  2.51  2.59  2.61, highest:  8.92  9.00  9.03  9.26 14.09\n#> --------------------------------------------------------------------------------\n#> triglycerides \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0      361        1    165.8    124.1     48.0     59.0 \n#>      .25      .50      .75      .90      .95 \n#>     84.0    127.0    201.5    309.0    396.6 \n#> \n#> lowest :   18   21   24   25   31, highest:  964 1020 1157 1253 3061\n#> --------------------------------------------------------------------------------\n#> uric.acid \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0       84        1    5.598    1.626     3.43     3.80 \n#>      .25      .50      .75      .90      .95 \n#>     4.60     5.50     6.50     7.40     8.00 \n#> \n#> lowest :  1.6  2.2  2.3  2.4  2.5, highest: 10.2 10.3 11.7 12.2 18.0\n#> --------------------------------------------------------------------------------\n#> protein \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0       32    0.995    7.126   0.5095      6.4      6.6 \n#>      .25      .50      .75      .90      .95 \n#>      6.8      7.1      7.4      7.7      7.9 \n#> \n#> lowest : 5.7 5.8 5.9 6.0 6.1, highest: 8.4 8.5 8.6 8.8 9.0\n#> --------------------------------------------------------------------------------\n#> bilirubin \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0       31    0.984   0.5467   0.2949      0.2      0.2 \n#>      .25      .50      .75      .90      .95 \n#>      0.4      0.5      0.7      0.9      1.0 \n#> \n#> lowest : 0.00 0.01 0.02 0.03 0.04, highest: 1.80 2.00 2.10 2.60 3.30\n#> --------------------------------------------------------------------------------\n#> phosphorus \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0       37    0.996    3.642    0.593      2.8      3.0 \n#>      .25      .50      .75      .90      .95 \n#>      3.3      3.6      4.0      4.3      4.5 \n#> \n#> lowest : 1.8 2.0 2.2 2.3 2.4, highest: 5.2 5.3 5.4 5.6 6.1\n#> --------------------------------------------------------------------------------\n#> sodium \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0       20    0.977    138.5    2.383      135      136 \n#>      .25      .50      .75      .90      .95 \n#>      137      139      140      141      142 \n#> \n#> lowest : 124 126 129 130 131, highest: 142 143 144 146 148\n#>                                                                             \n#> Value        124   126   129   130   131   132   133   134   135   136   137\n#> Frequency      1     1     1     1     5     4    11    23    46    93   176\n#> Proportion 0.001 0.001 0.001 0.001 0.004 0.003 0.009 0.018 0.036 0.073 0.139\n#>                                                                 \n#> Value        138   139   140   141   142   143   144   146   148\n#> Frequency    235   260   206   112    55    29     6     1     1\n#> Proportion 0.185 0.205 0.163 0.088 0.043 0.023 0.005 0.001 0.001\n#> --------------------------------------------------------------------------------\n#> potassium \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0      175        1    3.985   0.3725     3.45     3.57 \n#>      .25      .50      .75      .90      .95 \n#>     3.78     3.98     4.19     4.40     4.54 \n#> \n#> lowest : 2.60 2.92 2.96 3.07 3.09, highest: 5.15 5.21 5.36 5.37 5.51\n#> --------------------------------------------------------------------------------\n#> globulin \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0       29    0.994    2.799   0.4536      2.2      2.3 \n#>      .25      .50      .75      .90      .95 \n#>      2.5      2.8      3.0      3.3      3.5 \n#> \n#> lowest : 1.6 1.8 1.9 2.0 2.1, highest: 4.1 4.2 4.3 4.5 5.5\n#> --------------------------------------------------------------------------------\n#> calcium \n#>        n  missing distinct     Info     Mean      Gmd      .05      .10 \n#>     1267        0       25    0.991    9.335   0.3786      8.8      8.9 \n#>      .25      .50      .75      .90      .95 \n#>      9.1      9.3      9.6      9.7      9.9 \n#> \n#> lowest :  8.4  8.5  8.6  8.7  8.8, highest: 10.4 10.5 10.7 11.0 11.1\n#> --------------------------------------------------------------------------------\n#> physical.work \n#>        n  missing distinct \n#>     1267        0        2 \n#>                       \n#> Value         No   Yes\n#> Frequency    895   372\n#> Proportion 0.706 0.294\n#> --------------------------------------------------------------------------------\n#> physical.recreational \n#>        n  missing distinct \n#>     1267        0        2 \n#>                       \n#> Value         No   Yes\n#> Frequency   1002   265\n#> Proportion 0.791 0.209\n#> --------------------------------------------------------------------------------\n#> diabetes \n#>        n  missing distinct \n#>     1267        0        2 \n#>                     \n#> Value        No  Yes\n#> Frequency  1064  203\n#> Proportion 0.84 0.16\n#> --------------------------------------------------------------------------------\n```\n:::\n\n\n### Collinearity\n\nAvoiding collinear variables can result in a more interpretable, stable, and efficient predictive model. Collinearity refers to a situation in which two or more predictor variables in a multiple regression model are highly correlated, meaning that one can be linearly predicted from the others with substantial accuracy. Collinearity poses several issues for predictive analysis:\n\n**Reduced Interpretability**:\nWhen predictor variables are highly correlated, it becomes challenging to isolate the impact of individual predictors on the response variable. In other words, it is difficult to determine which predictor is genuinely influential in explaining variance in the response variable. This reduces the interpretability of the model.\n\n**Unstable Coefficients**:\nCollinearity can lead to inflated standard errors of the regression coefficients. This means that the coefficients can be very sensitive to small changes in the data, making the model unstable and less generalizable to new, unseen data.\n\n**Overfitting**:\nWhen predictors are collinear, the model is more likely to fit to the noise in the data rather than the actual signal. This is a manifestation of overfitting, where the model becomes too complex and captures random noise. Overfitted models will perform poorly on new, unseen data.\n\n**Inefficiency**:\nIncluding redundant variables (collinear variables) does not add additional information to the model. This could be inefficient, especially when dealing with large datasets, as it increases computational costs without improving model performance.\n\n#### Multicollinearity Diagnostics\nSeveral techniques are available for diagnosing multicollinearity, including:\n\n- [Variance Inflation Factor (VIF)](https://en.wikipedia.org/wiki/Variance_inflation_factor): The VIF is a measure of multicollinearity, which measures how much the variance of a regression coefficient is increased because of multicollinearity. A general rule of thumb is that if VIF exceeds 4 or 5, multicollinearity is present. \n\n- [Eigenvalues and Eigenvectors of the correlation/covariance matrix](https://sam-black.medium.com/analyzing-the-eigenvalues-of-a-covariance-matrix-to-identify-multicollinearity-de488c719e1b): The eigenvalues of the correlation matrix can also be used to measure the presence of multicollinearity, with one or more eigenvalues close to zero indicating multicollinearity.\n\n- Pairwise correlation matrices: Large correlation coefficients in the correlation matrix of predictors indicate the possibility of multicollinearity. \n\n#### Remedies\n\nSome common ways to handle collinearity include:\n\n- Removing one of the correlated predictors\n- Combining correlated predictors into a single composite predictor\n- Using regularization techniques like [Ridge Regression](https://en.wikipedia.org/wiki/Ridge_regression), which can help handle collinearity by adding a penalty term. Ridge regression adds a small amount of bias to the regression estimates, which in turn reduces the standard error, addresses the collinearity issue to some extent, and makes the results more reliable.\n\n### Identify collinear predictors\n\n::: callout-tip\nWe can also use `hclust` and `varclus` or variable clustering, i.e., to identify collinear predictors\n:::\n\n::: column-margin\n`hclust` is the hierarchical clustering function where default is squared Spearman correlation coefficients to detect monotonic but nonlinear relationships.\n:::\n\n\n::: {.cell hash='predictivefactors1_cache/html/collinear_5ef87d3c2bfc90c9b3cbd8c6aa4e6e50'}\n\n```{.r .cell-code}\nrequire(Hmisc)\nsel.names <- c(\"gender\", \"age\", \"born\", \"race\", \"education\", \n               \"married\", \"income\", \"diastolicBP\", \"systolicBP\", \n               \"bodyweight\", \"bodyheight\", \"bmi\", \"waist\", \"smoke\",\n               \"alcohol\",  \"cholesterol\", \"triglycerides\", \n               \"uric.acid\", \"protein\", \"bilirubin\", \"phosphorus\",\n               \"sodium\", \"potassium\", \"globulin\", \"calcium\", \n               \"physical.work\", \"physical.recreational\", \n               \"diabetes\")\nvar.cluster <- varclus(~., data = analytic[sel.names])\n# var.cluster\nplot(var.cluster)\n```\n\n::: {.cell-output-display}\n![](predictivefactors1_files/figure-html/collinear-1.png){width=672}\n:::\n:::\n\n\nIn this plot, [Spearman correlation](https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient) or Spearman's $\\rho$(rho) assesses the monotonic but nonlinear relationships predictors. We can also specify linear relationships such as Pearson correlation. A high correlation coefficient indicates predictors are highly correlated. For example, Spearman's $\\rho$ is more than 0.8 for bodyweight, BMI, and waist, indicating high collinearity between these predictors.\n\n### Video content (optional)\n\n::: callout-tip\nFor those who prefer a video walkthrough, feel free to watch the video below, which offers a description of an earlier version of the above content.\n:::\n\n::: {style=\"position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;\"}\n<iframe src=\"https://www.youtube.com/embed/5nNZpsuQ_Fg\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;\" allowfullscreen>\n\n</iframe>\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}