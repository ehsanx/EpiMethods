{
  "hash": "263fc5ed7d66fd763dd8e6724780cfe6",
  "result": {
    "markdown": "## CCHS: Bivariate analysis {.unnumbered}\n\nThe following tutorial is performing bivariate analysis on our CCHS analytic dataset to examine relationships between two variables (association question). \n\nWe load several R packages required for bivariate analysis, statistical tests, and data visualization.\n\n\n::: {.cell hash='surveydata3_cache/html/setup_4c797e4c1226c123debebe1d89a16543'}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(survey)\nlibrary(knitr)\nlibrary(car)\nlibrary(tableone)\nlibrary(DataExplorer)\nlibrary(Publish)\nlibrary(ROCR)\nlibrary(WeightedROC)\nlibrary(jtools)\n```\n:::\n\n\n### Load data\n\nWe load the dataset into the R environment and lists all available variables and objects. \n\n\n::: {.cell hash='surveydata3_cache/html/load_10b9018a5ee6f7e7ffa668c5389a630c'}\n\n```{.r .cell-code}\nload(\"Data/surveydata/cchs123b.RData\")\nls()\n#> [1] \"analytic.miss\" \"analytic2\"\n```\n:::\n\n\n### Preparing data\n\n#### Weights\n\nHere, the weights of survey respondents are accumulated, to account for the combination of different cycles of the data.\n\n\n::: {.cell hash='surveydata3_cache/html/wgt_df3c28a68904ba0426323909f7c5f54b'}\n\n```{.r .cell-code}\nanalytic.miss$weight <- analytic.miss$weight/3 # 3 cycles combined\n```\n:::\n\n\n#### Fixing variable types\n\nWe convert several variables to categorical or \"factor\" types, which are better suited for some statistical analysis when variables have categories.\n\n\n::: {.cell hash='surveydata3_cache/html/vartype_1a69c4442fcd57ae0f45e60dc66c22b0'}\n\n```{.r .cell-code}\nvar.names <- c(\"CVD\", \"age\", \"sex\", \"married\", \"race\", \"edu\", \"income\", \"bmi\", \n               \"phyact\", \"doctor\", \"stress\", \"smoke\", \"drink\", \"fruit\", \"bp\", \n               \"diab\", \"province\", \"OA\", \"immigrate\")\nanalytic.miss[var.names] <- lapply(analytic.miss[var.names] , factor)\nstr(analytic.miss)\n#> 'data.frame':\t397173 obs. of  22 variables:\n#>  $ CVD      : Factor w/ 2 levels \"event\",\"no event\": 1 2 2 2 2 2 2 2 2 2 ...\n#>  $ age      : Factor w/ 7 levels \"20-29 years\",..: 6 6 2 6 1 6 3 7 1 1 ...\n#>  $ sex      : Factor w/ 2 levels \"Female\",\"Male\": 1 1 2 1 1 2 2 2 1 2 ...\n#>  $ married  : Factor w/ 2 levels \"not single\",\"single\": 2 2 1 2 2 1 1 2 2 2 ...\n#>  $ race     : Factor w/ 2 levels \"Non-white\",\"White\": 2 2 2 2 2 2 2 2 2 2 ...\n#>  $ edu      : Factor w/ 4 levels \"< 2ndary\",\"2nd grad.\",..: 2 4 4 4 4 4 4 1 4 4 ...\n#>  $ income   : Factor w/ 4 levels \"$29,999 or less\",..: 1 1 4 1 2 2 1 1 NA 4 ...\n#>  $ bmi      : Factor w/ 3 levels \"Underweight\",..: NA NA 2 NA 2 NA 3 NA 2 3 ...\n#>  $ phyact   : Factor w/ 3 levels \"Active\",\"Inactive\",..: 2 2 2 2 2 2 1 1 2 3 ...\n#>  $ doctor   : Factor w/ 2 levels \"No\",\"Yes\": 2 2 2 2 2 2 2 2 2 2 ...\n#>  $ stress   : Factor w/ 2 levels \"Not too stressed\",..: 1 1 2 1 1 1 1 NA 1 1 ...\n#>  $ smoke    : Factor w/ 3 levels \"Never smoker\",..: 3 1 3 3 2 2 3 1 2 2 ...\n#>  $ drink    : Factor w/ 3 levels \"Never drank\",..: 2 1 2 2 2 2 3 1 2 2 ...\n#>  $ fruit    : Factor w/ 3 levels \"0-3 daily serving\",..: 2 2 2 3 3 3 2 2 2 2 ...\n#>  $ bp       : Factor w/ 2 levels \"No\",\"Yes\": 1 1 1 1 1 1 1 1 1 1 ...\n#>  $ diab     : Factor w/ 2 levels \"No\",\"Yes\": 1 1 1 1 1 1 1 1 1 1 ...\n#>  $ province : Factor w/ 2 levels \"South\",\"North\": 1 1 1 1 1 1 1 1 1 1 ...\n#>  $ weight   : num  47.6 23.8 56.1 23.8 65.4 ...\n#>  $ cycle    : Factor w/ 3 levels \"11\",\"21\",\"31\": 1 1 1 1 1 1 1 1 1 1 ...\n#>  $ ID       : int  1 2 3 4 5 6 7 8 9 10 ...\n#>  $ OA       : Factor w/ 2 levels \"Control\",\"OA\": 1 1 1 1 1 1 1 1 1 1 ...\n#>  $ immigrate: Factor w/ 3 levels \"not immigrant\",..: 1 1 3 1 1 1 1 1 1 1 ...\n```\n:::\n\n\nThe code identifies rows where data is missing and labels them for later analyses.\n\n\n::: {.cell hash='surveydata3_cache/html/vartype2_c627f960293d815d6a2c77f54c5a5489'}\n\n```{.r .cell-code}\nanalytic.miss$miss <- 1\nhead(analytic.miss$ID) # full data\n#> [1] 1 2 3 4 5 6\nhead(analytic2$ID) # complete case\n#> [1]  3  5  7 10 11 13\nhead(analytic.miss$ID[analytic.miss$ID %in% analytic2$ID])\n#> [1]  3  5  7 10 11 13\nanalytic.miss$miss[analytic.miss$ID %in% analytic2$ID] <- 0\ntable(analytic.miss$miss)\n#> \n#>      0      1 \n#> 185613 211560\n```\n:::\n\n\n### Setting Design\n\nThe code sets up the survey design, specifying weights (but no specific clustering and stratification, as they are unavailable for CCHS public access data), for use in survey-weighted analyses.\n\n\n::: {.cell hash='surveydata3_cache/html/desgin0_f6ac381bf207894e46ade403e49187d3'}\n\n```{.r .cell-code}\nrequire(survey)\nsummary(analytic.miss$weight)\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n#>    0.39   21.76   42.21   66.70   81.07 2384.98\nw.design0 <- svydesign(id=~1, weights=~weight, \n                      data=analytic.miss)\nsummary(weights(w.design0))\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n#>    0.39   21.76   42.21   66.70   81.07 2384.98\nsd(weights(w.design0))\n#> [1] 80.34263\n```\n:::\n\n\nThis creates a subset of the data where there are no missing values. Note that subset was done to the design object `w.design0`, not the data `analytic.miss`.\n\n\n::: {.cell hash='surveydata3_cache/html/desgin1_a67e84146e60daa1e1212b62a3b009f3'}\n\n```{.r .cell-code}\nw.design <- subset(w.design0, miss == 0)\nsummary(weights(w.design))\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n#>    0.39   23.85   45.98   71.54   87.30 2384.98\nsd(weights(w.design))\n#> [1] 84.97819\n```\n:::\n\n\n### Bivariate analysis\n\n#### Table 1 (weighted)\n\n##### Stratified by exposure\n\nThese tables contain descriptive statistics, stratified by different categories. They can be useful for understanding how variables relate to the exposure or outcome in the data.\n\n\n::: {.cell hash='surveydata3_cache/html/tab2_33fde99e162e9fab4aacf053a5721551'}\n\n```{.r .cell-code}\nrequire(tableone)\nvar.names <- c(\"CVD\", \"age\", \"sex\", \"married\", \"race\", \"edu\", \"income\", \"bmi\", \n               \"phyact\", \"doctor\", \"stress\", \"smoke\", \"drink\", \"fruit\", \"bp\", \n               \"diab\", \"province\", \"immigrate\") # exclude \"OA\"\n# tab1 <- CreateTableOne(var = var.names, strata= \"OA\", data=analytic.miss, test = TRUE)\n# print(tab1)\ntab2 <- svyCreateTableOne(var = var.names, strata= \"OA\", \n                          data=w.design, test = TRUE)\nprint(tab2)\n#>                        Stratified by OA\n#>                         Control            OA                p      test\n#>   n                     12124961.5         1153392.2                    \n#>   CVD = no event (%)    11786450.6 (97.2)  1020965.5 (88.5)  <0.001     \n#>   age (%)                                                    <0.001     \n#>      20-29 years         2668880.8 (22.0)    28317.5 ( 2.5)             \n#>      30-39 years         3009426.7 (24.8)    77159.3 ( 6.7)             \n#>      40-49 years         3108300.9 (25.6)   211515.1 (18.3)             \n#>      50-59 years         1900845.3 (15.7)   350264.7 (30.4)             \n#>      60-64 years          546041.8 ( 4.5)   163724.7 (14.2)             \n#>      65 years and over    624706.7 ( 5.2)   322033.4 (27.9)             \n#>      teen                 266759.3 ( 2.2)      377.4 ( 0.0)             \n#>   sex = Male (%)         6374765.5 (52.6)   379850.5 (32.9)  <0.001     \n#>   married = single (%)   4120611.0 (34.0)   367647.7 (31.9)  <0.001     \n#>   race = White (%)      10312228.2 (85.0)  1081778.6 (93.8)  <0.001     \n#>   edu (%)                                                    <0.001     \n#>      < 2ndary            1752318.3 (14.5)   309652.8 (26.8)             \n#>      2nd grad.           2314713.1 (19.1)   203437.5 (17.6)             \n#>      Other 2nd grad.     1078645.2 ( 8.9)    79255.1 ( 6.9)             \n#>      Post-2nd grad.      6979284.9 (57.6)   561046.8 (48.6)             \n#>   income (%)                                                 <0.001     \n#>      $29,999 or less     2051640.6 (16.9)   353862.9 (30.7)             \n#>      $30,000-$49,999     2436063.7 (20.1)   272484.1 (23.6)             \n#>      $50,000-$79,999     3495902.5 (28.8)   275115.8 (23.9)             \n#>      $80,000 or more     4141354.6 (34.2)   251929.4 (21.8)             \n#>   bmi (%)                                                    <0.001     \n#>      Underweight          346004.9 ( 2.9)    22064.6 ( 1.9)             \n#>      healthy weight      6019004.1 (49.6)   431570.2 (37.4)             \n#>      Overweight          5759952.5 (47.5)   699757.4 (60.7)             \n#>   phyact (%)                                                 <0.001     \n#>      Active              3037314.2 (25.1)   216879.5 (18.8)             \n#>      Inactive            5982492.3 (49.3)   647856.2 (56.2)             \n#>      Moderate            3105154.9 (25.6)   288656.5 (25.0)             \n#>   doctor = Yes (%)      10087473.8 (83.2)  1090763.9 (94.6)  <0.001     \n#>   stress = stressed (%)  3123770.9 (25.8)   301895.2 (26.2)   0.420     \n#>   smoke (%)                                                  <0.001     \n#>      Never smoker        4043479.9 (33.3)   320323.7 (27.8)             \n#>      Current smoker      3219168.6 (26.5)   275835.7 (23.9)             \n#>      Former smoker       4862313.0 (40.1)   557232.7 (48.3)             \n#>   drink (%)                                                  <0.001     \n#>      Never drank          678435.7 ( 5.6)    66085.0 ( 5.7)             \n#>      Current drinker    10297713.4 (84.9)   887808.2 (77.0)             \n#>      Former driker       1148812.3 ( 9.5)   199498.9 (17.3)             \n#>   fruit (%)                                                  <0.001     \n#>      0-3 daily serving   3214156.0 (26.5)   236483.8 (20.5)             \n#>      4-6 daily serving   6001124.3 (49.5)   588323.8 (51.0)             \n#>      6+ daily serving    2909681.1 (24.0)   328584.5 (28.5)             \n#>   bp = Yes (%)           1212548.2 (10.0)   347269.8 (30.1)  <0.001     \n#>   diab = Yes (%)          377876.2 ( 3.1)   104541.0 ( 9.1)  <0.001     \n#>   province = North (%)     27124.3 ( 0.2)     1825.1 ( 0.2)  <0.001     \n#>   immigrate (%)                                              <0.001     \n#>      not immigrant       9898636.6 (81.6)   994682.5 (86.2)             \n#>      > 10 years          1384672.6 (11.4)   146879.8 (12.7)             \n#>      recent               841652.3 ( 6.9)    11829.8 ( 1.0)\n```\n:::\n\n\n##### Stratified by outcome\n\nThis table is generally useful for logistic regression analysis\n\n\n::: {.cell hash='surveydata3_cache/html/tab3_2b98967c136b6c1f81993e8e0f9fe7b9'}\n\n```{.r .cell-code}\nvar.names <- c(\"OA\", \"age\", \"sex\", \"married\", \"race\", \"edu\", \"income\", \"bmi\", \n               \"phyact\", \"doctor\", \"stress\", \"smoke\", \"drink\", \"fruit\", \"bp\", \n               \"diab\", \"province\", \"immigrate\") # exclude \"CVD\"\ntab3 <- svyCreateTableOne(var = var.names, strata= \"CVD\", data=w.design, test = TRUE)\nprint(tab3)\n#>                        Stratified by CVD\n#>                         event            no event           p      test\n#>   n                     470937.5         12807416.1                    \n#>   OA = OA (%)           132426.7 (28.1)   1020965.5 ( 8.0)  <0.001     \n#>   age (%)                                                   <0.001     \n#>      20-29 years         14966.0 ( 3.2)   2682232.3 (20.9)             \n#>      30-39 years         24105.5 ( 5.1)   3062480.5 (23.9)             \n#>      40-49 years         63520.1 (13.5)   3256296.0 (25.4)             \n#>      50-59 years        122613.0 (26.0)   2128497.0 (16.6)             \n#>      60-64 years         72328.3 (15.4)    637438.1 ( 5.0)             \n#>      65 years and over  172742.2 (36.7)    773997.8 ( 6.0)             \n#>      teen                  662.3 ( 0.1)    266474.4 ( 2.1)             \n#>   sex = Male (%)        267743.8 (56.9)   6486872.2 (50.6)  <0.001     \n#>   married = single (%)  143747.0 (30.5)   4344511.8 (33.9)  <0.001     \n#>   race = White (%)      434591.6 (92.3)  10959415.2 (85.6)  <0.001     \n#>   edu (%)                                                   <0.001     \n#>      < 2ndary           147338.4 (31.3)   1914632.6 (14.9)             \n#>      2nd grad.           77705.6 (16.5)   2440445.0 (19.1)             \n#>      Other 2nd grad.     30921.3 ( 6.6)   1126979.0 ( 8.8)             \n#>      Post-2nd grad.     214972.2 (45.6)   7325359.4 (57.2)             \n#>   income (%)                                                <0.001     \n#>      $29,999 or less    164929.4 (35.0)   2240574.2 (17.5)             \n#>      $30,000-$49,999    109988.2 (23.4)   2598559.6 (20.3)             \n#>      $50,000-$79,999    103091.1 (21.9)   3667927.1 (28.6)             \n#>      $80,000 or more     92928.7 (19.7)   4300355.3 (33.6)             \n#>   bmi (%)                                                   <0.001     \n#>      Underweight          8844.4 ( 1.9)    359225.0 ( 2.8)             \n#>      healthy weight     173475.1 (36.8)   6277099.2 (49.0)             \n#>      Overweight         288617.9 (61.3)   6171091.9 (48.2)             \n#>   phyact (%)                                                <0.001     \n#>      Active              85140.3 (18.1)   3169053.4 (24.7)             \n#>      Inactive           274968.8 (58.4)   6355379.7 (49.6)             \n#>      Moderate           110828.4 (23.5)   3282983.0 (25.6)             \n#>   doctor = Yes (%)      445493.3 (94.6)  10732744.5 (83.8)  <0.001     \n#>   stress = stressed (%) 113282.5 (24.1)   3312383.7 (25.9)   0.023     \n#>   smoke (%)                                                 <0.001     \n#>      Never smoker       119434.6 (25.4)   4244368.9 (33.1)             \n#>      Current smoker      97328.0 (20.7)   3397676.3 (26.5)             \n#>      Former smoker      254174.9 (54.0)   5165370.9 (40.3)             \n#>   drink (%)                                                 <0.001     \n#>      Never drank         29444.3 ( 6.3)    715076.4 ( 5.6)             \n#>      Current drinker    344405.1 (73.1)  10841116.6 (84.6)             \n#>      Former driker       97088.1 (20.6)   1251223.1 ( 9.8)             \n#>   fruit (%)                                                  0.001     \n#>      0-3 daily serving  111803.5 (23.7)   3338836.3 (26.1)             \n#>      4-6 daily serving  233403.5 (49.6)   6356044.7 (49.6)             \n#>      6+ daily serving   125730.4 (26.7)   3112535.1 (24.3)             \n#>   bp = Yes (%)          209257.0 (44.4)   1350561.0 (10.5)  <0.001     \n#>   diab = Yes (%)         78762.9 (16.7)    403654.4 ( 3.2)  <0.001     \n#>   province = North (%)     702.8 ( 0.1)     28246.6 ( 0.2)   0.005     \n#>   immigrate (%)                                             <0.001     \n#>      not immigrant      389553.0 (82.7)  10503766.2 (82.0)             \n#>      > 10 years          69008.0 (14.7)   1462544.4 (11.4)             \n#>      recent              12376.5 ( 2.6)    841105.5 ( 6.6)\n```\n:::\n\n\nHow did they calculate the p-values? Hint: `svychisq` (see below).\n\n#### Proportions and Design Effect\n\nThis part computes proportions and design effects, which help understand the influence of the sampling design on the estimated statistics.\n\n\n::: {.cell hash='surveydata3_cache/html/fit0_28a593fbea4fd4093c365604d3f0f2eb'}\n\n```{.r .cell-code}\nrequire(survey)\n# Computing survey statistics on subsets of a survey defined by factor(s).\nfit0a <- svyby(~CVD,~OA,design=w.design, svymean,deff=TRUE)\nfit0a\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"OA\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"CVDevent\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CVDno event\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"se.CVDevent\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"se.CVDno event\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"DEff.CVDevent\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"DEff.CVDno event\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Control\",\"2\":\"0.02791851\",\"3\":\"0.9720815\",\"4\":\"0.0005622009\",\"5\":\"0.0005622009\",\"6\":\"1.939714\",\"7\":\"1.939714\",\"_rn_\":\"Control\"},{\"1\":\"OA\",\"2\":\"0.11481495\",\"3\":\"0.8851851\",\"4\":\"0.0032372797\",\"5\":\"0.0032372797\",\"6\":\"2.239419\",\"7\":\"2.239419\",\"_rn_\":\"OA\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nconfint(fit0a)\n#>                          2.5 %    97.5 %\n#> Control:CVDevent    0.02681661 0.0290204\n#> OA:CVDevent         0.10847000 0.1211599\n#> Control:CVDno event 0.97097960 0.9731834\n#> OA:CVDno event      0.87884010 0.8915300\n# 7.45% OA patients estimated to have CVD event.\n# 95% CI:  (0.067, 0.0816)\n```\n:::\n\n\nLet\n\n-   $\\theta$ = parameter (population slope) and\\\n-   $\\hat(\\theta)$ = statistic (estimated slope).\n\n$b = \\frac{\\sum[w (y_i-\\bar{y}) (x_i-\\bar{x})]}{\\sum[w (x_i-\\bar{x})^2]}$\n\nDE = Effect of complex survey on the SEs, relative to a SRS of equal size.\n\n-   $D^2(\\hat{\\theta}) = \\frac{Var(\\hat{\\theta})_{Complex Survey}}{Var(\\hat{\\theta})_{SRS}}$\n-   $D^2(\\hat{\\theta}) = \\frac{SE(\\hat{\\theta})^2_{Complex Survey}}{SE(\\hat{\\theta})^2_{SRS}}$\n\nNote:\n\n1.  SE increases as value of weight increases (CCHS).\n2.  NHANES has more things to worry about (strata, PSU)\n\nDEFF = 2 means that the variance of the sample proportion, when choosing the sample by complex survey sampling, is nearly 2 times as large as the variance of the same estimator under simple random sampling/SRS.\n\n\n::: {.cell hash='surveydata3_cache/html/fit1_ee19adebcba157146276a05c3246228b'}\n\n```{.r .cell-code}\nfit0b <- svyby(~CVD,~diab,design=w.design, svymean,deff=TRUE)\nfit0b\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"diab\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"CVDevent\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CVDno event\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"se.CVDevent\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"se.CVDno event\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"DEff.CVDevent\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"DEff.CVDno event\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"No\",\"2\":\"0.03064837\",\"3\":\"0.9693516\",\"4\":\"0.0005536175\",\"5\":\"0.0005536175\",\"6\":\"1.853271\",\"7\":\"1.853271\",\"_rn_\":\"No\"},{\"1\":\"Yes\",\"2\":\"0.16326711\",\"3\":\"0.8367329\",\"4\":\"0.0064671407\",\"5\":\"0.0064671407\",\"6\":\"2.635026\",\"7\":\"2.635026\",\"_rn_\":\"Yes\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nconfint(fit0b)\n#>                     2.5 %     97.5 %\n#> No:CVDevent     0.0295633 0.03173344\n#> Yes:CVDevent    0.1505917 0.17594247\n#> No:CVDno event  0.9682666 0.97043670\n#> Yes:CVDno event 0.8240575 0.84940825\n```\n:::\n\n\n#### Testing association\n\nHere, Chi-square tests are conducted to test the association between different variables. Two variants of the test are used: Rao-Scott and Thomas-Rao modifications. These adaptations are used when the data come from a complex survey design.\n\n-   Tests for hypothesis\n    -   Rao-Scott modifications (chi-sq)\n    -   Thomas-Rao modifications (F)\n\n\n::: {.cell hash='surveydata3_cache/html/testchisq_43bb306df3b6da3e4c8e34e6bfdb61e4'}\n\n```{.r .cell-code}\n# Rao-Scott modifications (chi-sq)\nsvychisq(~CVD+OA,design=w.design, statistic=\"Chisq\")\n#> \n#> \tPearson's X^2: Rao & Scott adjustment\n#> \n#> data:  svychisq(~CVD + OA, design = w.design, statistic = \"Chisq\")\n#> X-squared = 3249.7, df = 1, p-value < 2.2e-16\n\n# Thomas-Rao modifications (F)\nsvychisq(~CVD+OA,design=w.design, statistic=\"F\") \n#> \n#> \tPearson's X^2: Rao & Scott adjustment\n#> \n#> data:  svychisq(~CVD + OA, design = w.design, statistic = \"F\")\n#> F = 1863, ndf = 1, ddf = 185612, p-value < 2.2e-16\n\n# Both provide strong evidence to reject the null hypothesis.\n# Conclusion: there is a significant (at 5%) association \n# between CVD prevalence and OA.\nsvychisq(~CVD+fruit,design=w.design, statistic=\"F\") \n#> \n#> \tPearson's X^2: Rao & Scott adjustment\n#> \n#> data:  svychisq(~CVD + fruit, design = w.design, statistic = \"F\")\n#> F = 7.1241, ndf = 1.9758e+00, ddf = 3.6673e+05, p-value = 0.0008503\nsvychisq(~CVD+province,design=w.design, statistic=\"Chisq\") \n#> \n#> \tPearson's X^2: Rao & Scott adjustment\n#> \n#> data:  svychisq(~CVD + province, design = w.design, statistic = \"Chisq\")\n#> X-squared = 1.4848, df = 1, p-value = 0.00492\n```\n:::\n\n\n### Saving data\n\nFinally, the dataset, along with any new variables or subsets created during the analysis, is saved for future use.\n\n\n::: {.cell hash='surveydata3_cache/html/save_aa9bb9098a83e59a8d49170de71aa10c'}\n\n```{.r .cell-code}\nsave(w.design, analytic.miss, analytic2, file = \"Data/surveydata/cchs123w.RData\")\n```\n:::\n\n\n\n### Video content (optional)\n\n::: callout-tip\nFor those who prefer a video walkthrough, feel free to watch the video below, which offers a description of an earlier version of the above content.\n:::\n\n::: {style=\"position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;\"}\n<iframe src=\"https://www.youtube.com/embed/5q_GyL5FsVg\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;\" allowfullscreen>\n\n</iframe>\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}