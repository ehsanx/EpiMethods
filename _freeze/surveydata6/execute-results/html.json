{
  "hash": "e088a85f9a41a8dc79ca718d87a593da",
  "result": {
    "markdown": "## NHANES: Blood Pressure {.unnumbered}\n\nThe tutorial aims to guide the user through the process of analyzing health survey data, focusing specifically on the relationship between various demographic factors and blood pressure levels.\n\nRequired packages are imported for data manipulation and statistical analysis.\n\n\n::: {.cell hash='surveydata6_cache/html/setup_bc12e86dcad55381535370e7a7c2a953'}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(survey)\n```\n:::\n\n\n### Load data\n\nNHANES survey data is loaded into the workspace.\n\n\n::: {.cell hash='surveydata6_cache/html/loading_de33d414958287ad47281ad98d123a58'}\n\n```{.r .cell-code}\nload(file = \"Data/surveydata/NHANESsample.Rdata\")\nls()\n#> [1] \"analytic.data\"   \"has_annotations\"\n```\n:::\n\n\n### Regression summary\n\n#### Bivariate Regression\n\nFour separate models are constructed to explore the relationship between blood pressure and individual demographic variables like race, age, gender, and marital status.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit1r <- glm(blood.pressure ~ race, data=analytic.data))\n#> \n#> Call:\n#> glm(formula = blood.pressure ~ race, data = analytic.data)\n#> \n#> Deviance Residuals: \n#>     Min       1Q   Median       3Q      Max  \n#> -66.501   -8.437    0.217    8.400   53.563  \n#> \n#> Coefficients:\n#>                        Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)             65.4408     0.3566 183.528  < 2e-16 ***\n#> raceNon-Hispanic Black   2.1594     0.4891   4.415 1.02e-05 ***\n#> raceNon-Hispanic White   0.9957     0.4498   2.214   0.0269 *  \n#> raceOther Hispanic       0.3422     0.5553   0.616   0.5378    \n#> raceOther race           3.0601     0.5326   5.746 9.54e-09 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for gaussian family taken to be 168.7193)\n#> \n#>     Null deviance: 1202625  on 7086  degrees of freedom\n#> Residual deviance: 1194870  on 7082  degrees of freedom\n#>   (2884 observations deleted due to missingness)\n#> AIC: 56463\n#> \n#> Number of Fisher Scoring iterations: 2\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit1a <- glm(blood.pressure ~ age.centred, data=analytic.data))\n#> \n#> Call:\n#> glm(formula = blood.pressure ~ age.centred, data = analytic.data)\n#> \n#> Deviance Residuals: \n#>     Min       1Q   Median       3Q      Max  \n#> -59.275   -8.046    0.366    8.083   54.057  \n#> \n#> Coefficients:\n#>              Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept) 68.297917   0.158325   431.4   <2e-16 ***\n#> age.centred  0.179501   0.006623    27.1   <2e-16 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for gaussian family taken to be 153.7967)\n#> \n#>     Null deviance: 1202625  on 7086  degrees of freedom\n#> Residual deviance: 1089649  on 7085  degrees of freedom\n#>   (2884 observations deleted due to missingness)\n#> AIC: 55804\n#> \n#> Number of Fisher Scoring iterations: 2\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit1g <- glm(blood.pressure ~ gender, data=analytic.data))\n#> \n#> Call:\n#> glm(formula = blood.pressure ~ gender, data = analytic.data)\n#> \n#> Deviance Residuals: \n#>     Min       1Q   Median       3Q      Max  \n#> -63.998   -7.998    0.002    8.514   54.002  \n#> \n#> Coefficients:\n#>              Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)   67.4863     0.2210 305.409  < 2e-16 ***\n#> genderFemale  -1.4885     0.3091  -4.816  1.5e-06 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for gaussian family taken to be 169.1886)\n#> \n#>     Null deviance: 1202625  on 7086  degrees of freedom\n#> Residual deviance: 1198702  on 7085  degrees of freedom\n#>   (2884 observations deleted due to missingness)\n#> AIC: 56480\n#> \n#> Number of Fisher Scoring iterations: 2\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit1m <- glm(blood.pressure ~ marital, data=analytic.data))\n#> \n#> Call:\n#> glm(formula = blood.pressure ~ marital, data = analytic.data)\n#> \n#> Deviance Residuals: \n#>     Min       1Q   Median       3Q      Max  \n#> -55.664   -7.625   -0.593    7.407   50.336  \n#> \n#> Coefficients:\n#>                           Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                70.5934     0.2129 331.648   <2e-16 ***\n#> maritalNever married       -0.9293     0.4430  -2.098   0.0360 *  \n#> maritalPreviously married  -0.9689     0.4200  -2.307   0.0211 *  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for gaussian family taken to be 141.0891)\n#> \n#>     Null deviance: 723763  on 5124  degrees of freedom\n#> Residual deviance: 722658  on 5122  degrees of freedom\n#>   (4846 observations deleted due to missingness)\n#> AIC: 39915\n#> \n#> Number of Fisher Scoring iterations: 2\n```\n:::\n\n\n#### Multivariate Regression\n\nA more comprehensive model is built, combining all the aforementioned demographic factors to predict blood pressure.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit1 <- glm(blood.pressure ~ race + age.centred + gender + marital, data=analytic.data))\n#> \n#> Call:\n#> glm(formula = blood.pressure ~ race + age.centred + gender + \n#>     marital, data = analytic.data)\n#> \n#> Deviance Residuals: \n#>     Min       1Q   Median       3Q      Max  \n#> -58.794   -7.601   -0.159    7.409   52.141  \n#> \n#> Coefficients:\n#>                            Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)               70.879238   0.436140 162.515  < 2e-16 ***\n#> raceNon-Hispanic Black     2.632298   0.539123   4.883 1.08e-06 ***\n#> raceNon-Hispanic White     0.432023   0.486314   0.888 0.374389    \n#> raceOther Hispanic         0.042382   0.596004   0.071 0.943313    \n#> raceOther race             2.854707   0.576021   4.956 7.43e-07 ***\n#> age.centred               -0.039408   0.010467  -3.765 0.000168 ***\n#> genderFemale              -2.728473   0.332506  -8.206 2.87e-16 ***\n#> maritalNever married      -1.786003   0.468287  -3.814 0.000138 ***\n#> maritalPreviously married  0.001345   0.439870   0.003 0.997560    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for gaussian family taken to be 137.6355)\n#> \n#>     Null deviance: 723763  on 5124  degrees of freedom\n#> Residual deviance: 704143  on 5116  degrees of freedom\n#>   (4846 observations deleted due to missingness)\n#> AIC: 39794\n#> \n#> Number of Fisher Scoring iterations: 2\n```\n:::\n\n\n### Including survey features\n\nThe tutorial takes into account the complex survey design by creating a new survey design object (based on survey features such as, sampling weight, strata and cluster).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(survey)\n#> Loading required package: survey\n#> Loading required package: grid\n#> Loading required package: Matrix\n#> Loading required package: survival\n#> \n#> Attaching package: 'survey'\n#> The following object is masked from 'package:graphics':\n#> \n#>     dotchart\nanalytic.design <- svydesign(strata=~SDMVSTRA, id=~SDMVPSU, weights=~WTMEC2YR, data=analytic.data, nest=TRUE)\n```\n:::\n\n\nBox plots and summary statistics are generated to visualize how blood pressure varies across different demographic groups, considering the survey weights and design.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsvyboxplot(blood.pressure~race, design = analytic.design, col=\"grey\", \n           ylab=\"Blood Pressure\", \n           xlab =\"Race\")\n```\n\n::: {.cell-output-display}\n![](surveydata6_files/figure-html/survey2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsvyby(~blood.pressure, by=~race, design = analytic.design, na.rm=TRUE, ci=TRUE, svymean)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"race\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"blood.pressure\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"se\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Mexican American\",\"2\":\"66.61500\",\"3\":\"0.2756435\",\"_rn_\":\"Mexican American\"},{\"1\":\"Non-Hispanic Black\",\"2\":\"68.66411\",\"3\":\"0.6794312\",\"_rn_\":\"Non-Hispanic Black\"},{\"1\":\"Non-Hispanic White\",\"2\":\"68.53319\",\"3\":\"0.4619354\",\"_rn_\":\"Non-Hispanic White\"},{\"1\":\"Other Hispanic\",\"2\":\"66.81714\",\"3\":\"0.8128909\",\"_rn_\":\"Other Hispanic\"},{\"1\":\"Other race\",\"2\":\"69.22413\",\"3\":\"0.4280046\",\"_rn_\":\"Other race\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nsvyboxplot(blood.pressure~gender, design = analytic.design, col=\"grey\", \n           ylab=\"Blood Pressure\", \n           xlab =\"Gender\")\n```\n\n::: {.cell-output-display}\n![](surveydata6_files/figure-html/survey2-2.png){width=672}\n:::\n\n```{.r .cell-code}\nsvyby (~blood.pressure, by=~gender, design = analytic.design, na.rm=TRUE, ci=TRUE, svymean)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"gender\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"blood.pressure\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"se\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Male\",\"2\":\"69.28980\",\"3\":\"0.4552303\",\"_rn_\":\"Male\"},{\"1\":\"Female\",\"2\":\"67.38015\",\"3\":\"0.4446360\",\"_rn_\":\"Female\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nsvyboxplot(blood.pressure~marital, design = analytic.design, col=\"grey\", \n           ylab=\"Blood Pressure\", \n           xlab =\"Marital Status\")\n```\n\n::: {.cell-output-display}\n![](surveydata6_files/figure-html/survey2-3.png){width=672}\n:::\n\n```{.r .cell-code}\nsvyby (~blood.pressure, by=~marital, design = analytic.design, na.rm=TRUE, ci=TRUE, svymean)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"marital\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"blood.pressure\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"se\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Married\",\"2\":\"70.82622\",\"3\":\"0.4978471\",\"_rn_\":\"Married\"},{\"1\":\"Never married\",\"2\":\"69.62996\",\"3\":\"0.5592240\",\"_rn_\":\"Never married\"},{\"1\":\"Previously married\",\"2\":\"70.32240\",\"3\":\"0.5233053\",\"_rn_\":\"Previously married\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n#### Bivariate Regression\n\nNew regression models are constructed using the survey design object to understand how each demographic variable impacts blood pressure while taking survey features into consideration.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(survey)\nsummary(fit1r <- svyglm(blood.pressure ~ race, design=analytic.design))\n#> \n#> Call:\n#> svyglm(formula = blood.pressure ~ race, design = analytic.design)\n#> \n#> Survey design:\n#> svydesign(strata = ~SDMVSTRA, id = ~SDMVPSU, weights = ~WTMEC2YR, \n#>     data = analytic.data, nest = TRUE)\n#> \n#> Coefficients:\n#>                        Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)             66.6150     0.2756 241.671  < 2e-16 ***\n#> raceNon-Hispanic Black   2.0491     0.6144   3.335 0.006650 ** \n#> raceNon-Hispanic White   1.9182     0.4269   4.493 0.000912 ***\n#> raceOther Hispanic       0.2021     0.7825   0.258 0.800928    \n#> raceOther race           2.6091     0.3998   6.527 4.27e-05 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for gaussian family taken to be 179.8689)\n#> \n#> Number of Fisher Scoring iterations: 2\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit1a <- svyglm(blood.pressure ~ age.centred, design=analytic.design))\n#> \n#> Call:\n#> svyglm(formula = blood.pressure ~ age.centred, design = analytic.design)\n#> \n#> Survey design:\n#> svydesign(strata = ~SDMVSTRA, id = ~SDMVPSU, weights = ~WTMEC2YR, \n#>     data = analytic.data, nest = TRUE)\n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept) 69.25489    0.47091  147.07  < 2e-16 ***\n#> age.centred  0.15142    0.01503   10.08  8.5e-08 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for gaussian family taken to be 169.12)\n#> \n#> Number of Fisher Scoring iterations: 2\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit1g <- svyglm(blood.pressure ~ gender, design=analytic.design))\n#> \n#> Call:\n#> svyglm(formula = blood.pressure ~ gender, design = analytic.design)\n#> \n#> Survey design:\n#> svydesign(strata = ~SDMVSTRA, id = ~SDMVPSU, weights = ~WTMEC2YR, \n#>     data = analytic.data, nest = TRUE)\n#> \n#> Coefficients:\n#>              Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)   69.2898     0.4552 152.208  < 2e-16 ***\n#> genderFemale  -1.9096     0.4233  -4.511 0.000488 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for gaussian family taken to be 179.4491)\n#> \n#> Number of Fisher Scoring iterations: 2\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit1m <- svyglm(blood.pressure ~ marital, design=analytic.design))\n#> \n#> Call:\n#> svyglm(formula = blood.pressure ~ marital, design = analytic.design)\n#> \n#> Survey design:\n#> svydesign(strata = ~SDMVSTRA, id = ~SDMVPSU, weights = ~WTMEC2YR, \n#>     data = analytic.data, nest = TRUE)\n#> \n#> Coefficients:\n#>                           Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                70.8262     0.4978 142.265   <2e-16 ***\n#> maritalNever married       -1.1963     0.5482  -2.182   0.0481 *  \n#> maritalPreviously married  -0.5038     0.4258  -1.183   0.2579    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for gaussian family taken to be 175.0038)\n#> \n#> Number of Fisher Scoring iterations: 2\n```\n:::\n\n\n#### Multivariate Regression\n\nA final, more complex model is fitted, which includes multiple demographic variables and also considers the survey design.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanalytic.design2 <- svydesign(strata=~SDMVSTRA, id=~SDMVPSU, weights=~WTMEC2YR, data=analytic.data, nest=TRUE)\nsummary(fit1 <- svyglm(blood.pressure ~ race + age.centred + gender + marital, design=analytic.design2))\n#> \n#> Call:\n#> svyglm(formula = blood.pressure ~ race + age.centred + gender + \n#>     marital, design = analytic.design2)\n#> \n#> Survey design:\n#> svydesign(strata = ~SDMVSTRA, id = ~SDMVPSU, weights = ~WTMEC2YR, \n#>     data = analytic.data, nest = TRUE)\n#> \n#> Coefficients:\n#>                           Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)               71.14686    0.37976 187.348 3.26e-14 ***\n#> raceNon-Hispanic Black     2.30248    0.84786   2.716 0.029953 *  \n#> raceNon-Hispanic White     1.08919    0.35921   3.032 0.019055 *  \n#> raceOther Hispanic         0.07339    1.20016   0.061 0.952947    \n#> raceOther race             2.11590    0.45579   4.642 0.002363 ** \n#> age.centred               -0.02223    0.01566  -1.419 0.198767    \n#> genderFemale              -2.91901    0.43979  -6.637 0.000294 ***\n#> maritalNever married      -1.74002    0.48086  -3.619 0.008526 ** \n#> maritalPreviously married  0.22443    0.45139   0.497 0.634278    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for gaussian family taken to be 171.5455)\n#> \n#> Number of Fisher Scoring iterations: 2\n```\n:::\n\n\n## A note about Predictive models\n\nIn statistical analyses involving survey data, it's crucial to account for the survey's design features. These features can include sampling weights, stratification, and clustering, among others. Ignoring these could lead to biased estimates and incorrect conclusions. Considering such survey design features make the analysis more robust and reliable in terms of inference.\n\nHowever, when the goal shifts from inference to prediction, additional challenges come into play. Specifically, the model may perform well on the data used to fit it (the \"training\" data) but not generalize well to new, unseen data. This discrepancy between training performance and generalization to new data is often referred to as \"overfitting,\" and the optimism of the model refers to the extent to which it overestimates its predictive performance on new data based on its performance on the training data.\n\nOptimism-correction techniques are methodologies designed to address this issue. They allow you to evaluate how well your model is likely to perform on new data, not just the data you used to build it. Methods for optimism correction often involve techniques like cross-validation, bootstrapping, or specialized types of model validation that help in estimating the 'true' predictive performance of the model. Some of these techniques were discussed in the [predictive modelling](predictivefactors.html) chapter.\n\n### Video content (optional)\n\n::: callout-tip\nFor those who prefer a video walkthrough, feel free to watch the video below, which offers a description of an earlier version of the above content.\n:::\n\n::: {style=\"position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;\"}\n<iframe src=\"https://www.youtube.com/embed/6GfpPKPnLEE\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;\" allowfullscreen>\n\n</iframe>\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}