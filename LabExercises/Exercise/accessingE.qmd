## Exercise {.unnumbered}

We will use the following article

```{r ubc7, echo=FALSE, out.width = '100%'}
knitr::include_graphics("Images/accessing/examplepaper.png")
```

Palis, Marchand & Oviedo-Joekes. (2018). The relationship between sense of community belonging and self-rated mental health among Canadians with mental or substance use disorders. Journal of Mental Health, 1-8. DOI: 10.1080/09638237.2018.1437602 (available in the "Library Online Course Reserves": [open link](https://www.researchgate.net/profile/Heather_Palis/publication/323136807_The_relationship_between_sense_of_community_belonging_and_self-rated_mental_health_among_Canadians_with_mental_or_substance_use_disorders/links/5a96ff210f7e9ba42974c0dd/The-relationship-between-sense-of-community-belonging-and-self-rated-mental-health-among-Canadians-with-mental-or-substance-use-disorders.pdf).

- Download the [CCHS MH topical index](https://gsg.uottawa.ca/data/teaching/escc-cchs/fmgd_pumf/2012/cchs_mh_topical_index.pdf)
- Download the [CCHS MH Data Dictionary](https://gsg.uottawa.ca/data/teaching/escc-cchs/fmgd_pumf/2012/cchs_mh_datadictionary.pdf)

## Question I: [60% grade]

### 1(a) Importing dataset
```{r}
# Importing dataset
load("Data/accessing/cchsMH.RData") 
```
 
### 1(b) Subsetting according to eligibility

Subset the dataset according to the eligibility criteria / restriction specified in the paper

- Identify the variable needed for eligibility criteria 
- Identify the outcome variable
- Identify the explanatory variable
- Identify the potential confounders
- Identify the survey weight variable

- **Hint**
  1. Read 
    - the first paragraph of **Analytic sample** (page 2) for the eligibility criteria, and 
    - first and second paragraphs of **Study variables** for rest of the variables,
    - third paragraph of the **Statistical analyses** for the survey weights variable.
  2. eligibility criteria was determined based on **one** variable. Only work with 'YES' category.
  3. Outcome variable has a category 'NOT STATED', but for our analysis, we will omit anyone associated with this category.
  4. For explanatory variable, we have categories such as DON'T KNOW, REFUSAL and NOT STATED. We will not use these categories (omit anyone with these categories).
  5. There were **five** potential confounders.
  6. Potentially useful functions: 
    - [%in%](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/match)
    - [levels](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/levels)
    - [recode](https://rdrr.io/cran/car/man/recode.html)
    - [subset](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/subset)
    - [as.factor](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/factor)
    - [relevel](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/relevel)
    
  or [dplyr ways](https://ehsanx.github.io/intro2R/data-analysis-with-dplyr.html):
    - [filter](https://www.rdocumentation.org/packages/dplyr/versions/0.7.8/topics/filter)
    - [select](https://www.rdocumentation.org/packages/dplyr/versions/0.7.8/topics/select)

```{r}
# your code here

```

### 1(c) Retaining necessary variables

In the dataset, retain only the variables associated with outcome measure, explanatory variable, potential confounders and survey weight

```{r}
# your code here

```

### 1(d) Creating analytic dataset

  - Assign missing values for categories such as DON'T KNOW, REFUSAL and NOT STATED.
  - 'recode' the variables as shown in Table 1 (choose any function of your choice). Here is an example (but feel free to use other functions. In R there are many other ways to do this same task):

```{r}
## your code here
# levels(your.data.frame$your.age.variable) <- 
#   list("15 to 24 years" = c("15 TO 19 YEARS", "20 TO 24 YEARS"),
#        "25 to 34 years" = c("25 TO 29 YEARS", "30 TO 34 YEARS"),
#        "35 to 44 years" = c("35 TO 39 YEARS", "40 TO 44 YEARS"),
#        "45 to 54 years" = c("45 TO 49 YEARS", "50 TO 54 YEARS"),
#        "55 to 64 years" = c("55 TO 59 YEARS", "60 TO 64 YEARS"),
#        "65 years or older" = c("65 TO 69 YEARS", "70 TO 74 YEARS", 
#        "75 TO 79 YEARS", "80 YEARS OR MORE"))
```

### 1(e) Number of columns and variable names

report the number of columns in your analytic dataset, and the variable names.

```{r}
# your code here

```

## Question II: [20% grade]

### 2(a) Table 1 

Reproduce Table 1 presented in the above paper (omit the 'Main source of income' variable). If necessary, drop other variables from the analytic dataset that are not presented in Table 1. 

The table you produce should report numbers as follows:

```{r ubc8, echo=FALSE, out.width = '100%'}
knitr::include_graphics("Images/accessing/reproducetable.png")
```

- **Hint**
  -  You can produce 1 table with total, and another table stratified by the necessary variable.

```{r,warning=FALSE,message=FALSE}
# your code here
require(tableone)

```

## Question III: [20% grade]

### 3(a) Subset

Subset the dataset excluding 'Very good or excellent' responses from the self-rated mental health variable

```{r}
# your code here

```

### 3(b) Recode 

Recode self-rated mental health variable and make it a binary variable: 'Good' vs. 'Poor' (simplifying category labels only). Convert that variable to a factor variable with 'Poor' being the reference level.

```{r}
# your code here

```

### 3(c) Regression
Run a logistic regression model for finding the relationship between community belonging (Reference: Very weak) and self-rated mental health (Reference: Poor) among respondents with mental or substance use disorders. Adjust the model for three confounders: sex, age, and race/ethnicity. 

```{r}
# your code here

```

### 3(d) Reporting odds ratio
Report the odds ratios and associated confidence intervals (use Publish package).

```{r,warning=FALSE,message=FALSE}
require(Publish)
# your code here

```